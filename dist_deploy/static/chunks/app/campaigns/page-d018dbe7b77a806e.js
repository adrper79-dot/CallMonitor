(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[134],{3010:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(95155),l=s(12115),r=s(36489),c=s(20063),d=s(76806),n=s(97003),i=s(67812),o=s(83209),m=s(96633),x=s(25016),h=s(6191),u=s(35299);let p=(0,s(71847).A)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var f=s(2479);function j(){var e,a;let{data:s}=(0,r.useSession)(),j=(0,c.useRouter)(),[g,N]=(0,l.useState)([]),[y,v]=(0,l.useState)(!0),[b,w]=(0,l.useState)(null),[C,A]=(0,l.useState)(null),k=null==s||null==(e=s.user)?void 0:e.id;(0,l.useEffect)(()=>{k&&_()},[k]),(0,l.useEffect)(()=>{C&&R()},[C]);let _=async()=>{try{let e=await fetch("/api/users/".concat(k,"/organization"),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch organization");let a=await e.json();A(a.organization_id)}catch(e){f.v.error("Error fetching organization",e,{userId:k}),w("Failed to load organization")}},R=async()=>{try{v(!0),w(null);let e=await fetch("/api/campaigns?orgId=".concat(C),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch campaigns");let a=await e.json();N(a.campaigns||[])}catch(e){f.v.error("Error fetching campaigns",e,{organizationId:C}),w("Failed to load campaigns")}finally{v(!1)}};return s&&k?(0,t.jsx)(d.AppShell,{organizationName:void 0,userEmail:(null==s||null==(a=s.user)?void 0:a.email)||void 0,children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Campaign Manager"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Manage bulk call campaigns for secret shopper, surveys, and outbound calls"})]}),(0,t.jsxs)(n.$,{onClick:()=>j.push("/campaigns/new"),children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"New Campaign"]})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{children:[(0,t.jsx)(o.ZB,{children:"Campaigns"}),(0,t.jsx)(o.BT,{children:"View and manage your call campaigns"})]}),(0,t.jsx)(o.Wu,{children:y?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(u.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):b?(0,t.jsx)("div",{className:"rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:b}):0===g.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(p,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"mt-4 text-sm font-medium",children:"No campaigns yet"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Create your first campaign to get started"}),(0,t.jsxs)(n.$,{onClick:()=>j.push("/campaigns/new"),className:"mt-4",children:[(0,t.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]}):(0,t.jsx)("div",{className:"rounded-lg border",children:(0,t.jsxs)(m.XI,{children:[(0,t.jsx)(m.A0,{children:(0,t.jsxs)(m.Hj,{children:[(0,t.jsx)(m.nd,{children:"Campaign"}),(0,t.jsx)(m.nd,{children:"Type"}),(0,t.jsx)(m.nd,{children:"Status"}),(0,t.jsx)(m.nd,{children:"Progress"}),(0,t.jsx)(m.nd,{children:"Created"}),(0,t.jsx)(m.nd,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(m.BF,{children:g.map(e=>(0,t.jsxs)(m.Hj,{className:"cursor-pointer",onClick:()=>j.push("/campaigns/".concat(e.id)),children:[(0,t.jsx)(m.nA,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground truncate max-w-md",children:e.description})]})}),(0,t.jsx)(m.nA,{children:(0,t.jsx)(i.E,{variant:"secondary",className:"capitalize",children:e.call_flow_type.replace("_"," ")})}),(0,t.jsx)(m.nA,{children:(e=>{let a={draft:{label:"Draft",variant:"secondary"},scheduled:{label:"Scheduled",variant:"default"},active:{label:"Active",variant:"success"},paused:{label:"Paused",variant:"secondary"},completed:{label:"Completed",variant:"success"},canceled:{label:"Canceled",variant:"error"}}[e];return(0,t.jsx)(i.E,{variant:a.variant,children:a.label})})(e.status)}),(0,t.jsxs)(m.nA,{children:[(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:e.calls_completed}),(0,t.jsxs)("span",{className:"text-muted-foreground",children:[" / ",e.total_targets]})]}),e.total_targets>0&&(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-1",children:(0,t.jsx)("div",{className:"bg-primary h-1.5 rounded-full",style:{width:"".concat(e.calls_completed/e.total_targets*100,"%")}})})]}),(0,t.jsx)(m.nA,{children:(0,x.Yq)(e.created_at)}),(0,t.jsx)(m.nA,{className:"text-right",children:(0,t.jsx)(n.$,{variant:"ghost",size:"sm",onClick:a=>{a.stopPropagation(),j.push("/campaigns/".concat(e.id))},children:"View"})})]},e.id))})]})})})]}),g.length>0&&(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 mt-6",children:[(0,t.jsx)(o.Zp,{children:(0,t.jsxs)(o.Wu,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-semibold",children:g.length}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Campaigns"})]})}),(0,t.jsx)(o.Zp,{children:(0,t.jsxs)(o.Wu,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-semibold",children:g.filter(e=>"active"===e.status).length}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Active"})]})}),(0,t.jsx)(o.Zp,{children:(0,t.jsxs)(o.Wu,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-semibold",children:g.reduce((e,a)=>e+a.calls_completed,0)}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Calls Completed"})]})}),(0,t.jsx)(o.Zp,{children:(0,t.jsxs)(o.Wu,{className:"pt-6",children:[(0,t.jsx)("div",{className:"text-2xl font-semibold",children:g.reduce((e,a)=>e+a.calls_successful,0)}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Successful Calls"})]})})]})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Please sign in to access campaigns."})]})})}},6191:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},35299:(e,a,s)=>{"use strict";s.d(a,{A:()=>t});let t=(0,s(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},67387:(e,a,s)=>{Promise.resolve().then(s.bind(s,3010))},83209:(e,a,s)=>{"use strict";s.d(a,{BT:()=>i,Wu:()=>o,ZB:()=>n,Zp:()=>c,aR:()=>d,wL:()=>m});var t=s(95155),l=s(12115),r=s(25016);function c(e){let{children:a,className:s="",header:l,footer:c,padding:d="md",...n}=e;return(0,t.jsxs)("div",{className:(0,r.cn)("bg-white border border-gray-200 rounded-md",s),...n,children:[l&&(0,t.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:l}),(0,t.jsx)("div",{className:{none:"",sm:"p-3",md:"p-4",lg:"p-6"}[d],children:a}),c&&(0,t.jsx)("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:c})]})}let d=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});d.displayName="CardHeader";let n=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("h3",{ref:a,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...l})});n.displayName="CardTitle";let i=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-gray-500",s),...l})});i.displayName="CardDescription";let o=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("p-6 pt-0",s),...l})});o.displayName="CardContent";let m=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{ref:a,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})});m.displayName="CardFooter"},96633:(e,a,s)=>{"use strict";s.d(a,{A0:()=>d,BF:()=>n,Hj:()=>i,XI:()=>c,nA:()=>m,nd:()=>o});var t=s(95155),l=s(12115),r=s(25016);let c=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:a,className:(0,r.cn)("w-full caption-bottom text-sm",s),...l})})});c.displayName="Table";let d=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("thead",{ref:a,className:(0,r.cn)("[&_tr]:border-b",s),...l})});d.displayName="TableHeader";let n=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("tbody",{ref:a,className:(0,r.cn)("[&_tr:last-child]:border-0",s),...l})});n.displayName="TableBody",l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("tfoot",{ref:a,className:(0,r.cn)("border-t bg-gray-50 font-medium [&>tr]:last:border-b-0",s),...l})}).displayName="TableFooter";let i=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("tr",{ref:a,className:(0,r.cn)("border-b transition-colors hover:bg-gray-50 data-[state=selected]:bg-gray-100",s),...l})});i.displayName="TableRow";let o=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("th",{ref:a,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0",s),...l})});o.displayName="TableHead";let m=l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("td",{ref:a,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...l})});m.displayName="TableCell",l.forwardRef((e,a)=>{let{className:s,...l}=e;return(0,t.jsx)("caption",{ref:a,className:(0,r.cn)("mt-4 text-sm text-gray-500",s),...l})}).displayName="TableCaption"}},e=>{e.O(0,[2619,1356,6964,7627,4739,9871,8441,1255,7358],()=>e(e.s=67387)),_N_E=e.O()}]);