(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{20063:(e,s,t)=>{"use strict";var a=t(47260);t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},32473:(e,s,t)=>{"use strict";t.d(s,{f:()=>r});var a=t(95155);function r(e){let{label:s,value:t,change:r,trend:l,className:n=""}=e,i="up"===l?"↑":"down"===l?"↓":null;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-5 hover:border-gray-300 transition-colors ".concat(n),children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:s}),(0,a.jsx)("p",{className:"text-3xl font-semibold text-gray-900 tabular-nums mb-1",children:t}),r&&(0,a.jsxs)("p",{className:"text-sm ".concat("up"===l?"text-success":"down"===l?"text-error":"text-gray-500"),children:[i&&(0,a.jsx)("span",{className:"mr-1",children:i}),r]})]})}t(12115)},48038:(e,s,t)=>{"use strict";t.d(s,{u:()=>l});var a=t(95155),r=t(12115);function l(e){let s,{date:t,fallback:l="—",format:n="short",className:i}=e,[c,d]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{d(!0)},[]),!t)return(0,a.jsx)("span",{className:i,children:l});let o="string"==typeof t?new Date(t):t;if(!c){let e=o.toISOString().slice(0,16).replace("T"," ");return(0,a.jsx)("span",{className:i,suppressHydrationWarning:!0,children:e})}try{switch(n){case"short":s=o.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});break;case"long":s=o.toLocaleString(void 0,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"});break;case"time":s=o.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"});break;case"relative":s=function(e){let s=Math.floor((new Date().getTime()-e.getTime())/1e3),t=Math.floor(s/60),a=Math.floor(t/60),r=Math.floor(a/24);return s<60?"Just now":t<60?"".concat(t,"m ago"):a<24?"".concat(a,"h ago"):r<7?"".concat(r,"d ago"):e.toLocaleDateString(void 0,{month:"short",day:"numeric"})}(o);break;default:s=o.toLocaleString()}}catch(e){s=o.toISOString().slice(0,16).replace("T"," ")}return(0,a.jsx)("span",{className:i,suppressHydrationWarning:!0,children:s})}},63273:(e,s,t)=>{"use strict";t.d(s,{A:()=>d,P:()=>c});var a=t(95155),r=t(12115),l=t(32473),n=t(67812),i=t(2479);function c(e){var s,t;let{organizationId:c}=e,[d,o]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(null);if((0,r.useEffect)(()=>{if(!c)return void m(!1);let e=!0;return m(!0),x(null),fetch("/api/analytics/surveys",{credentials:"include"}).then(e=>e.json()).then(s=>{if(e){if((null==s?void 0:s.success)===!1){var t;x((null==s||null==(t=s.error)?void 0:t.message)||"Unable to load survey analytics"),o(null);return}o(s.metrics||null)}}).catch(s=>{e&&(i.v.error("SurveyAnalyticsWidget: fetch failed",s),x("Unable to load survey analytics"))}).finally(()=>{e&&m(!1)}),()=>{e=!1}},[c]),u)return(0,a.jsxs)("section",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,a.jsx)("div",{className:"h-4 w-32 bg-gray-100 rounded mb-4 animate-pulse"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"h-20 bg-gray-100 rounded animate-pulse"},e))})]});if(h)return(0,a.jsx)("section",{className:"bg-white border border-gray-200 rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500",children:h})});let g=null!=(t=null==d?void 0:d.total_surveys)?t:0,p=(null==d?void 0:d.avg_score)!==null&&(null==d?void 0:d.avg_score)!==void 0?d.avg_score.toFixed(1):"—",v=(null==d?void 0:d.response_rate)!==null&&(null==d?void 0:d.response_rate)!==void 0?"".concat(d.response_rate.toFixed(1),"%"):"—",b=(null==d||null==(s=d.trend_7d)?void 0:s.reduce((e,s)=>e+s.count,0))||0;return(0,a.jsxs)("section",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Survey Analytics"}),(0,a.jsx)(n.E,{variant:g>0?"success":"default",children:g>0?"Active":"No data"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsx)(l.f,{label:"Surveys",value:g}),(0,a.jsx)(l.f,{label:"Avg Score",value:p}),(0,a.jsx)(l.f,{label:"Response Rate",value:v})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-3",children:["Last 7 days: ",b," completed survey",1===b?"":"s"]})]})}let d=c},73917:(e,s,t)=>{Promise.resolve().then(t.bind(t,81284)),Promise.resolve().then(t.bind(t,76806))},81284:(e,s,t)=>{"use strict";t.d(s,{default:()=>p});var a=t(95155),r=t(12115),l=t(52619),n=t.n(l),i=t(21297),c=t(32473),d=t(2521),o=t(48038),u=t(67812),m=t(1719);function h(e){let{organizationId:s}=e,[t,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(!0),[d,o]=(0,r.useState)(null);return((0,r.useEffect)(()=>{if(!s)return void c(!1);let e=!0;return c(!0),o(null),fetch("/api/scorecards/alerts",{credentials:"include"}).then(e=>e.json()).then(s=>{if(e){if((null==s?void 0:s.success)===!1){o((null==s?void 0:s.error)||"Unable to load alerts"),l([]);return}l(s.alerts||[])}}).catch(s=>{e&&(o((null==s?void 0:s.message)||"Unable to load alerts"),l([]))}).finally(()=>{e&&c(!1)}),()=>{e=!1}},[s]),i)?(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Loading alerts..."})}):d?(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500",children:d})}):(0,a.jsxs)("section",{"aria-label":"QA Alerts",className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"QA Alerts"}),(0,a.jsx)(u.E,{variant:t.length?"warning":"success",children:t.length?"".concat(t.length," flagged"):"No flags"})]}),0===t.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No failed criteria detected."}):(0,a.jsx)("ul",{className:"space-y-3",children:t.slice(0,6).map(e=>{var s;return(0,a.jsxs)("li",{className:"border border-gray-100 rounded-md p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.scorecard_name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString()})]}),(0,a.jsxs)(u.E,{variant:"error",children:[null!=(s=e.total_score)?s:0,"%"]})]}),e.failures.length>0&&(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-2",children:["Failed: ",e.failures.slice(0,3).map(e=>e.name).join(", ")]}),e.call_id&&(0,a.jsx)(n(),{href:"/voice?callId=".concat(e.call_id),className:"inline-block mt-2 text-xs text-primary-600 hover:text-primary-700",children:"Review call"})]},e.id)})})]})}var x=t(63273),g=t(72560);function p(e){let{organizationId:s}=e,{plan:t,role:l}=(0,i.e)(s),[u,p]=(0,r.useState)(null),[y,N]=(0,r.useState)([]),[S,w]=(0,r.useState)(!0),_=t&&["insights","global","business","enterprise"].includes(t);return((0,r.useEffect)(()=>{s&&Promise.all([fetch("/api/calls?orgId=".concat(s,"&limit=5"),{credentials:"include"}).then(e=>e.json()),fetch("/api/bookings?status=pending&limit=3",{credentials:"include"}).then(e=>e.json()).catch(()=>({bookings:[]}))]).then(e=>{let[s,t]=e,a=s.calls||[],r=t.bookings||[],l=new Date().toDateString(),n=a.filter(e=>new Date(e.created_at).toDateString()===l).length,i=a.filter(e=>{var s;return null==(s=e.sentiment_summary)?void 0:s.positive_percent}),c=i.length>0?Math.round(i.reduce((e,s)=>{var t;return e+((null==(t=s.sentiment_summary)?void 0:t.positive_percent)||50)},0)/i.length):50;p({totalCalls:s.total||a.length,callsToday:n,avgSentiment:c,scheduledCalls:r.length,recordingsCount:a.filter(e=>e.recording_url).length,translationsCount:a.filter(e=>e.translation).length}),N(a.slice(0,5)),w(!1)}).catch(()=>w(!1))},[s]),S)?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[1,2,3,4].map(e=>(0,a.jsx)("div",{className:"h-24 bg-gray-100 rounded-md animate-pulse"},e))})}):(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("section",{"aria-label":"Key Metrics",className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsx)(c.f,{label:"Total Calls",value:(null==u?void 0:u.totalCalls)||0,change:(null==u?void 0:u.callsToday)?"+".concat(u.callsToday," today"):void 0,trend:(null==u?void 0:u.callsToday)?"up":"neutral"}),(0,a.jsx)(c.f,{label:"Avg Sentiment",value:"".concat((null==u?void 0:u.avgSentiment)||50,"%"),change:(null==u?void 0:u.avgSentiment)&&u.avgSentiment>=60?"Positive":"Neutral",trend:(null==u?void 0:u.avgSentiment)&&u.avgSentiment>=60?"up":"neutral"}),(0,a.jsx)(c.f,{label:"Recordings",value:(null==u?void 0:u.recordingsCount)||0}),(0,a.jsx)(c.f,{label:"Scheduled",value:(null==u?void 0:u.scheduledCalls)||0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6","data-tour":"dashboard-grid",children:[(0,a.jsxs)("section",{"aria-label":"Quick Actions",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),(0,a.jsx)(n(),{href:"/voice-operations",className:"block w-full py-4 px-6 bg-primary-600 hover:bg-primary-700 text-white text-center font-semibold rounded-lg shadow-sm transition-colors",children:(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),"Make a Call"]})}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-4 space-y-1",children:[(0,a.jsx)(v,{href:"/bookings",title:"Schedule Call",description:"Book a future call"}),(0,a.jsx)(v,{href:"/settings?tab=targets",title:"Manage Targets",description:"Add or edit call targets"}),("business"===t||"enterprise"===t)&&(0,a.jsx)(v,{href:"/settings?tab=shopper",title:"Secret Shopper",description:"Create evaluation scripts"})]})]}),(0,a.jsxs)("section",{"aria-label":"Recent Activity",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Calls"}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-md overflow-hidden",children:0===y.length?(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("svg",{className:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-2",children:"No calls yet"}),(0,a.jsx)(n(),{href:"/voice-operations",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Make your first call"})]}):(0,a.jsx)("ul",{className:"divide-y divide-gray-100",children:y.map(e=>(0,a.jsx)("li",{children:(0,a.jsxs)(n(),{href:"/voice-operations?callId=".concat(e.id),className:"flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.to_number||(0,a.jsx)(o.u,{date:e.created_at,format:"short"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)(b,{status:e.status}),e.duration_seconds&&(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(e.duration_seconds/60)," min"]})]})]}),e.sentiment_summary&&(0,a.jsx)(j,{sentiment:e.sentiment_summary.overall})]})},e.id))})}),y.length>0&&(0,a.jsx)(n(),{href:"/voice-operations",className:"block text-center text-sm text-primary-600 hover:text-primary-700 font-medium",children:"View all calls"})]}),(0,a.jsxs)("section",{"aria-label":"Intelligence",className:"space-y-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Intelligence"}),(0,a.jsxs)("div",{className:"space-y-4",children:[_&&(0,a.jsx)(x.A,{organizationId:s}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Sentiment Trend"}),(0,a.jsx)(d.z,{value:(null==u?void 0:u.avgSentiment)||50,color:(null==u?void 0:u.avgSentiment)&&u.avgSentiment>=60?"green":(null==u?void 0:u.avgSentiment)&&u.avgSentiment>=40?"orange":"red",showValue:!0}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Based on recent call analysis"})]}),(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-3",children:"Active Features"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f,{label:"Recording",enabled:!0}),(0,a.jsx)(f,{label:"Transcription",enabled:!0}),(0,a.jsx)(f,{label:"Sentiment Analysis",enabled:!0}),(0,a.jsx)(f,{label:"Translation",enabled:"global"===t||"business"===t||"enterprise"===t}),(0,a.jsx)(f,{label:"Secret Shopper",enabled:"business"===t||"enterprise"===t})]})]}),(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Current Plan"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900 capitalize mt-1",children:t||"Free"})]}),(0,a.jsx)(n(),{href:"/settings?tab=billing",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Upgrade"})]})})]})]})]}),(0,a.jsxs)("section",{"aria-label":"Team Visibility",className:"grid grid-cols-1 lg:grid-cols-3 gap-6","data-tour":"activity-feed",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-md p-4",children:(0,a.jsx)(m.A,{organizationId:s,limit:12})})}),(0,a.jsx)(h,{organizationId:s})]}),(0,a.jsx)(g.WB,{tourId:"dashboard",steps:g.ke})]})}function v(e){let{href:s,title:t,description:r}=e;return(0,a.jsxs)(n(),{href:s,className:"block p-3 rounded-md hover:bg-gray-50 transition-colors group",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900 text-sm group-hover:text-primary-600",children:t}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:r})]})}function b(e){let{status:s}=e;return(0,a.jsx)(u.E,{variant:{completed:"success",in_progress:"default",failed:"error",pending:"warning",queued:"default"}[s]||"default",children:{completed:"Completed",in_progress:"In Progress",failed:"Failed",pending:"Pending",queued:"Queued"}[s]||s})}function j(e){let{sentiment:s}=e;return(0,a.jsx)(u.E,{variant:{POSITIVE:"success",NEGATIVE:"error",NEUTRAL:"default"}[s]||"default",children:s.charAt(0)+s.slice(1).toLowerCase()})}function f(e){let{label:s,enabled:t}=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,a.jsx)("span",{className:"text-sm text-gray-700",children:s}),(0,a.jsx)(u.E,{variant:t?"success":"default",children:t?"Active":"Upgrade"})]})}}},e=>{e.O(0,[2619,1356,7627,4739,9871,2560,9655,8441,1255,7358],()=>e(e.s=73917)),_N_E=e.O()}]);