(()=>{var a={};a.id=75,a.ids=[75],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:a=>{"use strict";a.exports=require("querystring")},12294:(a,b,c)=>{"use strict";c.d(b,{dj:()=>d.d});var d=c(21564)},12412:a=>{"use strict";a.exports=require("assert")},14985:a=>{"use strict";a.exports=require("dns")},17585:(a,b,c)=>{"use strict";c.d(b,{d:()=>e});var d=c(21124);function e({checked:a=!1,onChange:b,onCheckedChange:c,disabled:e=!1,className:f="",...g}){return(0,d.jsx)("button",{type:"button",role:"switch","aria-checked":a,"aria-disabled":e,onClick:()=>{if(e)return;let d=!a;b?.(d),c?.(d)},disabled:e,className:`inline-flex items-center h-6 w-11 rounded-full p-0.5 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-primary-600 focus:ring-offset-2 ${e?"bg-gray-200 cursor-not-allowed opacity-60":a?"bg-primary-600 cursor-pointer":"bg-gray-300 cursor-pointer hover:bg-gray-400"} ${f}`,...g,children:(0,d.jsx)("span",{className:`inline-block h-5 w-5 rounded-full bg-white transform transition-transform shadow-sm ${a?"translate-x-5":"translate-x-0"}`})})}c(38301)},18031:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(75338),e=c(49338);function f(){return(0,d.jsx)(e.Loading,{message:"Loading Voice Operations...",fullScreen:!0,showLogo:!0})}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},22544:(a,b,c)=>{"use strict";c.d(b,{E:()=>e});var d=c(21124);function e({children:a,className:b="",variant:c="default",...e}){return(0,d.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${{default:"bg-gray-100 text-gray-700",secondary:"bg-gray-100 text-gray-700",success:"bg-success-light text-green-700",warning:"bg-warning-light text-amber-700",error:"bg-error-light text-red-700",info:"bg-info-light text-blue-700"}[c]} ${b}`,...e,children:a})}c(38301)},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30248:(a,b,c)=>{"use strict";c.d(b,{TroubleshootChatToggle:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call TroubleshootChatToggle() from the server but TroubleshootChatToggle is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\components\\admin\\TroubleshootChatToggle.tsx","TroubleshootChatToggle")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},38859:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g});var d=c(21124);c(38301);var e=c(3991),f=c.n(e);function g({error:a,reset:b}){return(0,d.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:(0,d.jsx)("div",{className:"max-w-md w-full text-center",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm p-8",children:[(0,d.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-amber-100 flex items-center justify-center",children:(0,d.jsx)("svg",{className:"w-8 h-8 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),(0,d.jsx)("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Unable to load Voice Operations"}),(0,d.jsx)("p",{className:"text-gray-600 mb-6",children:"There was a problem loading the call interface. Please try again."}),(0,d.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,d.jsx)("button",{onClick:()=>b(),className:"w-full py-2.5 px-4 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg transition-colors",children:"Try again"}),(0,d.jsx)(f(),{href:"/dashboard",className:"w-full py-2.5 px-4 border border-gray-300 text-gray-700 hover:bg-gray-50 font-medium rounded-lg transition-colors block",children:"Back to Dashboard"})]}),a.digest&&(0,d.jsxs)("p",{className:"mt-4 text-xs text-gray-400",children:["Error ID: ",a.digest]})]})})})}},40348:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["voice-operations",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,48847)),"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\voice-operations\\page.tsx"]}]},{error:[()=>Promise.resolve().then(c.bind(c,92233)),"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\voice-operations\\error.tsx"],loading:[()=>Promise.resolve().then(c.bind(c,18031)),"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\voice-operations\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,16953)),"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(c.bind(c,90391)),"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\loading.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,I=["C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\voice-operations\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/voice-operations/page",pathname:"/voice-operations",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:".next",relativeProjectDir:""});async function L(a,b,d){var C;let G="/voice-operations/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},48847:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>u});var d=c(75338),e=c(74515),f=c(3208),g=c(1093),h=c(73588),i=c(30477);let j=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},k=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let m=(0,e.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:c=2,absoluteStrokeWidth:d,className:f="",children:g,iconNode:h,...i},j)=>(0,e.createElement)("svg",{ref:j,...l,width:b,height:b,stroke:a,strokeWidth:d?24*Number(c)/Number(b):c,className:k("lucide",f),...!g&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(i)&&{"aria-hidden":"true"},...i},[...h.map(([a,b])=>(0,e.createElement)(a,b)),...Array.isArray(g)?g:[g]])),n=(a,b)=>{let c=(0,e.forwardRef)(({className:c,...d},f)=>(0,e.createElement)(m,{ref:f,iconNode:b,className:k(`lucide-${j(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,c),...d}));return c.displayName=j(a),c},o=n("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var p=c(65169),q=c.n(p);function r({title:a="Sign in required",description:b="Please sign in to access this secure area.",redirectUrl:c="/voice-operations"}){return(0,d.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 px-4",children:(0,d.jsxs)("div",{className:"w-full max-w-md text-center",children:[(0,d.jsx)("div",{className:"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-primary-50",children:(0,d.jsx)(o,{className:"h-8 w-8 text-primary-600",strokeWidth:1.5})}),(0,d.jsx)("h2",{className:"mb-2 text-2xl font-semibold text-gray-900 tracking-tight",children:a}),(0,d.jsx)("p",{className:"mb-8 text-gray-500 text-base leading-relaxed",children:b}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("a",{href:`/signin?callbackUrl=${encodeURIComponent(c)}`,className:"flex w-full items-center justify-center rounded-lg bg-primary-600 px-6 py-3 text-sm font-medium text-white transition-colors hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Sign In with Email"}),(0,d.jsxs)("p",{className:"text-sm text-gray-500",children:["Don't have an account?"," ",(0,d.jsx)(q(),{href:"/signup",className:"font-medium text-primary-600 hover:text-primary-700 hover:underline",children:"Create one"})]})]})]})})}let s=n("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var t=c(30248);async function u(a){let{authOptions:b}=await Promise.all([c.e(9376),c.e(6147)]).then(c.bind(c,66147)),e=await (0,g.getServerSession)(b),j=e?.user?.id||e?.user?.email;if(!e?.user||!j)return(0,d.jsx)(r,{title:"Voice Operations",description:"Please sign in to access your voice dashboard and manage calls.",redirectUrl:"/voice-operations"});let k=e.user?.id;if(!k&&e.user?.email){let{data:a}=await f.A.from("users").select("id").eq("email",e.user.email).single();k=a?.id}let l=null,m=null;try{let a=k||e.user?.id;a||i.v.warn("Voice page: No user ID available for org lookup");let{data:b}=await f.A.from("users").select("organization_id").eq("id",a).single();if(b?.organization_id){l=b.organization_id;let{data:a}=await f.A.from("organizations").select("name").eq("id",l).single();m=a?.name||null}if(l&&k){let{data:a}=await f.A.from("org_members").select("role").eq("organization_id",l).eq("user_id",k).single();a&&a.role}}catch(a){i.v.error("Failed to fetch organization for voice page",a)}let n=[];try{let a=f.A.from("calls").select("id,organization_id,system_id,status,started_at,ended_at,created_by,call_sid").order("started_at",{ascending:!1}).limit(50);l&&a.eq("organization_id",l);let{data:b,error:c}=await a;if(c)throw c;n=b||[]}catch(a){return(0,d.jsx)("div",{className:"flex h-screen items-center justify-center bg-gray-50 text-gray-900",children:(0,d.jsxs)("div",{className:"text-center max-w-sm px-4",children:[(0,d.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-red-100",children:(0,d.jsx)(s,{className:"h-6 w-6 text-red-600"})}),(0,d.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Unable to load calls"}),(0,d.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:String(a?.message??"We encountered an error loading your voice data. Please try again later.")})]})})}return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.default,{initialCalls:n,organizationId:l,organizationName:m||void 0}),["owner","admin"].includes(userRole)&&(0,d.jsx)(t.TroubleshootChatToggle,{})]})}},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},59976:(a,b,c)=>{Promise.resolve().then(c.bind(c,38859))},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65169:(a,b,c)=>{let{createProxy:d}=c(39893);a.exports=d("C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\node_modules\\next\\dist\\client\\app-dir\\link.js")},67725:(a,b,c)=>{"use strict";c.d(b,{U:()=>i,g:()=>j});var d=c(21124),e=c(38301);let f={recording_enabled:"record",transcription_enabled:"transcribe",translation_enabled:"translate",translation_from:"translate_from",translation_to:"translate_to",survey_enabled:"survey",secret_shopper_enabled:"synthetic_caller"};function g(a){let b={};for(let[c,d]of Object.entries(a))b[f[c]||c]=d;return b}let h=(0,e.createContext)(null);function i({organizationId:a,children:b}){let[c,f]=(0,e.useState)(null),[i,j]=(0,e.useState)(!0),[k,l]=(0,e.useState)(null),m=(0,e.useCallback)(async b=>{if(!a)throw Error("Organization ID required");try{l(null);let{quick_dial_number:d,from_number:e,target_id:h,campaign_id:i,...j}=b,k={};if("quick_dial_number"in b&&(k.quick_dial_number=d),"from_number"in b&&(k.from_number=e),"target_id"in b&&(k.target_id=h),"campaign_id"in b&&(k.campaign_id=i),Object.keys(k).length>0&&f(a=>({...a||{},...k})),0===Object.keys(j).length)return{...c||{},...k};let m=g(j),n=await fetch("/api/voice/config",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({orgId:a,modulations:m})});if(!n.ok){let a=await n.json().catch(()=>({error:"Failed to update config"}));throw Error(a.error?.message||a.error||"Failed to update config")}let o={...(await n.json()).config||{},quick_dial_number:k.quick_dial_number??c?.quick_dial_number,from_number:k.from_number??c?.from_number,target_id:k.target_id??c?.target_id,campaign_id:k.campaign_id??c?.campaign_id};return f(o),o}catch(a){throw l(a?.message||"Failed to update config"),a}},[a,c]);return(0,d.jsx)(h.Provider,{value:{config:c,loading:i,error:k,updateConfig:m},children:b})}function j(a){let b=(0,e.useContext)(h);if(b)return b;let[c,d]=(0,e.useState)(null),[f,i]=(0,e.useState)(!0),[j,k]=(0,e.useState)(null),l=(0,e.useCallback)(async b=>{if(!a)throw Error("Organization ID required");let{quick_dial_number:e,from_number:f,target_id:h,campaign_id:i,...j}=b,k={};if("quick_dial_number"in b&&(k.quick_dial_number=e),"from_number"in b&&(k.from_number=f),"target_id"in b&&(k.target_id=h),"campaign_id"in b&&(k.campaign_id=i),Object.keys(k).length>0&&d(a=>({...a||{},...k})),0===Object.keys(j).length)return{...c||{},...k};let l=g(j),m=await fetch("/api/voice/config",{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({orgId:a,modulations:l})});if(!m.ok){let a=await m.json().catch(()=>({error:"Failed to update config"}));throw Error(a.error?.message||a.error||"Failed to update config")}let n={...(await m.json()).config||{},quick_dial_number:k.quick_dial_number??c?.quick_dial_number,from_number:k.from_number??c?.from_number,target_id:k.target_id??c?.target_id,campaign_id:k.campaign_id??c?.campaign_id};return d(n),n},[a,c]);return{config:c,loading:f,error:j,updateConfig:l}}},68224:a=>{a.exports=function(a,b){let c;if("function"!=typeof a)throw TypeError(`Expected the first argument to be a \`function\`, got \`${typeof a}\`.`);let d=0;return function(...e){clearTimeout(c);let f=Date.now(),g=b-(f-d);g<=0?(d=f,a.apply(this,e)):c=setTimeout(()=>{d=Date.now(),a.apply(this,e)},g)}}},69607:(a,b,c)=>{Promise.resolve().then(c.bind(c,30248)),Promise.resolve().then(c.bind(c,73588)),Promise.resolve().then(c.t.bind(c,65169,23))},73128:(a,b,c)=>{Promise.resolve().then(c.bind(c,92233))},73588:(a,b,c)=>{"use strict";c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Ultimate Warrior\\\\My project\\\\gemini-project\\\\components\\\\voice\\\\VoiceOperationsClient.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\components\\voice\\VoiceOperationsClient.tsx","default")},74075:a=>{"use strict";a.exports=require("zlib")},77598:a=>{"use strict";a.exports=require("node:crypto")},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},81630:a=>{"use strict";a.exports=require("http")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},86610:(a,b,c)=>{"use strict";c.d(b,{default:()=>bW});var d=c(21124),e=c(38301),f=c.n(e),g=c(67725),h=c(55108);let i=(0,e.createContext)(null);function j({organizationId:a,children:b}){let f=function(a){let[b,d]=(0,e.useState)("disconnected"),[f,g]=(0,e.useState)(null),[i,j]=(0,e.useState)("idle"),[k,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(!1),[o,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(null),s=(0,e.useRef)(null),t=(0,e.useRef)(null),u=(0,e.useRef)(null),v=(0,e.useRef)(null),w=(0,e.useRef)(null);(0,e.useRef)(null);let x=(0,e.useCallback)(async()=>{if(!a)return void g("Organization ID required");if("registered"!==b&&"connecting"!==b)try{d("initializing"),g(null),console.log("[SIP.js] Fetching SIP credentials...");let a=await (0,h.$P)("/api/webrtc/session");if(!a.success||!a.session)throw Error("Failed to get SIP session");let{id:b,sip_username:e,sip_password:f,sip_domain:i,websocket_url:k,ice_servers:m}=a.session;p(b),console.log("[SIP.js] Got credentials, importing library..."),d("connecting");let{UserAgent:n,Registerer:o}=await c.e(2102).then(c.bind(c,92102));console.log("[SIP.js] Requesting microphone access..."),w.current=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});let q=`sip:${e}@${i}`;console.log("[SIP.js] Connecting as:",q);let r=new n({uri:n.makeURI(q),transportOptions:{server:k},authorizationUsername:e,authorizationPassword:f,sessionDescriptionHandlerFactoryOptions:{peerConnectionConfiguration:{iceServers:m}},logLevel:"warn",delegate:{onInvite:a=>{console.log("[SIP.js] Incoming call from:",a.remoteIdentity?.uri?.toString()),a.accept({sessionDescriptionHandlerOptions:{constraints:{audio:!0,video:!1},peerConnectionConfiguration:{iceServers:m}}}).then(()=>{console.log("[SIP.js] Call accepted"),u.current=a,j("active"),d("on_call");let b=a.sessionDescriptionHandler;b?.peerConnection&&(w.current&&w.current.getTracks().forEach(a=>{b.peerConnection.addTrack(a,w.current),console.log("[SIP.js] Added local track:",a.kind)}),b.peerConnection.ontrack=a=>{if("audio"===a.track.kind&&v.current){console.log("[SIP.js] Got remote audio track");let b=new MediaStream([a.track]);v.current.srcObject=b,v.current.play().catch(a=>console.error("[SIP.js] Audio play error",a))}},b.peerConnection.getReceivers().forEach(a=>{if(a.track?.kind==="audio"&&v.current){let b=new MediaStream([a.track]);v.current.srcObject=b,v.current.play().catch(a=>console.error("[SIP.js] Audio play error",a))}})),a.stateChange.addListener(a=>{console.log("[SIP.js] Inbound call state:",a),"Terminated"===a&&(j("idle"),l(null),d("registered"),u.current=null)})}).catch(a=>{console.error("[SIP.js] Failed to accept call",a),g("Failed to accept incoming call"),j("idle")})}}});s.current=r,await r.start(),console.log("[SIP.js] UserAgent started");let x=new o(r);t.current=x,x.stateChange.addListener(a=>{console.log("[SIP.js] Registerer state:",a),"Registered"===a?d("registered"):"Unregistered"===a&&d("disconnected")}),await x.register(),console.log("[SIP.js] Registration sent")}catch(a){console.error("[SIP.js] Connect Error",a),g(a.message||"Connection failed"),d("error")}},[a,b]),y=(0,e.useCallback)(async()=>{try{if(u.current){try{u.current.bye()}catch(a){}u.current=null}t.current&&(await t.current.unregister(),t.current=null),s.current&&(await s.current.stop(),s.current=null),w.current&&(w.current.getTracks().forEach(a=>a.stop()),w.current=null),await (0,h.Al)("/api/webrtc/session").catch(()=>{}),d("disconnected"),j("idle"),l(null)}catch(a){console.error("[SIP.js] Disconnect error",a),d("disconnected")}},[]),z=(0,e.useCallback)(async a=>{if("registered"!==b)return void g("Not registered with SIP server");try{j("dialing"),g(null),console.log("[SIP.js] Requesting server-side dial:",a);let b=await (0,h.$P)("/api/webrtc/dial",{phoneNumber:a,sessionId:o});if(!b.success)throw Error(b.error?.message||"Failed to dial");console.log("[SIP.js] Server dial initiated:",b.callSid),l({id:b.callId||"server-call",phone_number:a,started_at:new Date,duration:0})}catch(a){console.error("[SIP.js] Call error",a),g(a.message||"Call failed"),j("idle")}},[b,o]),A=(0,e.useCallback)(async()=>{if(u.current)try{j("ending"),"Established"===u.current.state?await u.current.bye():await u.current.cancel(),u.current=null,j("idle"),l(null),d("registered")}catch(a){console.error("[SIP.js] Hangup error",a),j("idle"),l(null),u.current=null}},[]);return{connect:x,disconnect:y,status:b,error:f,makeCall:z,hangUp:A,callState:i,currentCall:k,mute:(0,e.useCallback)(()=>{w.current&&(w.current.getAudioTracks().forEach(a=>{a.enabled=!1}),n(!0))},[]),unmute:(0,e.useCallback)(()=>{w.current&&(w.current.getAudioTracks().forEach(a=>{a.enabled=!0}),n(!1))},[]),isMuted:m,quality:q,sessionId:o}}(a);return(0,d.jsx)(i.Provider,{value:f,children:b})}function k(){let a=(0,e.useContext)(i);if(!a)throw Error("useWebRTCContext must be used within WebRTCProvider");return a}let l=(0,e.createContext)(void 0);function m({children:a}){let[b,c]=(0,e.useState)(""),f=/^\+[1-9]\d{1,14}$/.test(b);return(0,d.jsx)(l.Provider,{value:{targetNumber:b,setTargetNumber:c,isValid:f},children:a})}function n(){let a=(0,e.useContext)(l);if(!a)throw Error("useTargetNumber must be used within a TargetNumberProvider");return a}let o=(0,e.createContext)(null);function p({children:a}){let b=(0,e.useRef)(null);return(0,d.jsx)(o.Provider,{value:{sdkPromiseRef:b},children:a})}var q=c(92179),r=c(19217),s=c(22544);function t({organizationId:a,organizationName:b}){let{role:c,plan:e,loading:f}=(0,q.e)(a),g=e?e.charAt(0).toUpperCase()+e.slice(1):"",h=c?c.charAt(0).toUpperCase()+c.slice(1):"",i=e&&!["global","enterprise"].includes(e.toLowerCase());return(0,d.jsxs)("header",{className:"w-full h-14 border-b border-gray-200 bg-white px-6 flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"Wordis Bond"}),b&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{className:"text-gray-300",children:"|"}),(0,d.jsx)("span",{className:"text-sm text-gray-500",children:b})]})]}),(0,d.jsx)("div",{className:"flex items-center gap-4",children:!f&&(0,d.jsxs)(d.Fragment,{children:[e&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Plan:"}),(0,d.jsx)(s.E,{variant:"info",children:g})]}),c&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Role:"}),(0,d.jsx)(s.E,{variant:"default",children:h})]}),i&&(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>{window.location.href="/settings/billing?upgrade=true"},"aria-label":"Upgrade plan",children:"Upgrade"})]})})]})}var u=c(7629),v=c(23312);function w(a,[b,c]){return Math.min(c,Math.max(b,a))}var x=c(87868),y=c(43515),z=c(92808),A=c(2332),B=c(10498),C=c(7412),D=c(70904),E=c(69998),F=c(75656),G=c(12432),H=c(61611),I=c(99978),J=Symbol("radix.slottable");function K(a){return e.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===J}var L=c(71700),M=c(11720),N=c(68829),O=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"});e.forwardRef((a,b)=>(0,d.jsx)(I.sG.span,{...a,ref:b,style:{...O,...a.style}})).displayName="VisuallyHidden";var P=c(61225),Q=c(36409),R=[" ","Enter","ArrowUp","ArrowDown"],S=[" ","Enter"],T="Select",[U,V,W]=(0,y.N)(T),[X,Y]=(0,A.A)(T,[W,G.Bk]),Z=(0,G.Bk)(),[$,_]=X(T),[aa,ab]=X(T),ac=a=>{let{__scopeSelect:b,children:c,open:f,defaultOpen:g,onOpenChange:h,value:i,defaultValue:j,onValueChange:k,dir:l,name:m,autoComplete:n,disabled:o,required:p,form:q}=a,r=Z(b),[s,t]=e.useState(null),[u,v]=e.useState(null),[w,x]=e.useState(!1),y=(0,B.jH)(l),[z,A]=(0,M.i)({prop:f,defaultProp:g??!1,onChange:h,caller:T}),[C,D]=(0,M.i)({prop:i,defaultProp:j,onChange:k,caller:T}),E=e.useRef(null),H=!s||q||!!s.closest("form"),[I,J]=e.useState(new Set),K=Array.from(I).map(a=>a.props.value).join(";");return(0,d.jsx)(G.bL,{...r,children:(0,d.jsxs)($,{required:p,scope:b,trigger:s,onTriggerChange:t,valueNode:u,onValueNodeChange:v,valueNodeHasChildren:w,onValueNodeHasChildrenChange:x,contentId:(0,F.B)(),value:C,onValueChange:D,open:z,onOpenChange:A,dir:y,triggerPointerDownPosRef:E,disabled:o,children:[(0,d.jsx)(U.Provider,{scope:b,children:(0,d.jsx)(aa,{scope:a.__scopeSelect,onNativeOptionAdd:e.useCallback(a=>{J(b=>new Set(b).add(a))},[]),onNativeOptionRemove:e.useCallback(a=>{J(b=>{let c=new Set(b);return c.delete(a),c})},[]),children:c})}),H?(0,d.jsxs)(aP,{"aria-hidden":!0,required:p,tabIndex:-1,name:m,autoComplete:n,value:C,onChange:a=>D(a.target.value),disabled:o,form:q,children:[void 0===C?(0,d.jsx)("option",{value:""}):null,Array.from(I)]},K):null]})})};ac.displayName=T;var ad="SelectTrigger",ae=e.forwardRef((a,b)=>{let{__scopeSelect:c,disabled:f=!1,...g}=a,h=Z(c),i=_(ad,c),j=i.disabled||f,k=(0,z.s)(b,i.onTriggerChange),l=V(c),m=e.useRef("touch"),[n,o,p]=aR(a=>{let b=l().filter(a=>!a.disabled),c=b.find(a=>a.value===i.value),d=aS(b,a,c);void 0!==d&&i.onValueChange(d.value)}),q=a=>{j||(i.onOpenChange(!0),p()),a&&(i.triggerPointerDownPosRef.current={x:Math.round(a.pageX),y:Math.round(a.pageY)})};return(0,d.jsx)(G.Mz,{asChild:!0,...h,children:(0,d.jsx)(I.sG.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:j,"data-disabled":j?"":void 0,"data-placeholder":aQ(i.value)?"":void 0,...g,ref:k,onClick:(0,x.mK)(g.onClick,a=>{a.currentTarget.focus(),"mouse"!==m.current&&q(a)}),onPointerDown:(0,x.mK)(g.onPointerDown,a=>{m.current=a.pointerType;let b=a.target;b.hasPointerCapture(a.pointerId)&&b.releasePointerCapture(a.pointerId),0===a.button&&!1===a.ctrlKey&&"mouse"===a.pointerType&&(q(a),a.preventDefault())}),onKeyDown:(0,x.mK)(g.onKeyDown,a=>{let b=""!==n.current;a.ctrlKey||a.altKey||a.metaKey||1!==a.key.length||o(a.key),(!b||" "!==a.key)&&R.includes(a.key)&&(q(),a.preventDefault())})})})});ae.displayName=ad;var af="SelectValue",ag=e.forwardRef((a,b)=>{let{__scopeSelect:c,className:e,style:f,children:g,placeholder:h="",...i}=a,j=_(af,c),{onValueNodeHasChildrenChange:k}=j,l=void 0!==g,m=(0,z.s)(b,j.onValueNodeChange);return(0,N.N)(()=>{k(l)},[k,l]),(0,d.jsx)(I.sG.span,{...i,ref:m,style:{pointerEvents:"none"},children:aQ(j.value)?(0,d.jsx)(d.Fragment,{children:h}):g})});ag.displayName=af;var ah=e.forwardRef((a,b)=>{let{__scopeSelect:c,children:e,...f}=a;return(0,d.jsx)(I.sG.span,{"aria-hidden":!0,...f,ref:b,children:e||"â–¼"})});ah.displayName="SelectIcon";var ai=a=>(0,d.jsx)(H.Z,{asChild:!0,...a});ai.displayName="SelectPortal";var aj="SelectContent",ak=e.forwardRef((a,b)=>{let c=_(aj,a.__scopeSelect),[f,g]=e.useState();return((0,N.N)(()=>{g(new DocumentFragment)},[]),c.open)?(0,d.jsx)(ao,{...a,ref:b}):f?v.createPortal((0,d.jsx)(al,{scope:a.__scopeSelect,children:(0,d.jsx)(U.Slot,{scope:a.__scopeSelect,children:(0,d.jsx)("div",{children:a.children})})}),f):null});ak.displayName=aj;var[al,am]=X(aj),an=function(a){let b=function(a){let b=e.forwardRef((a,b)=>{let{children:c,...d}=a;if(e.isValidElement(c)){var f;let a,g,h=(f=c,(g=(a=Object.getOwnPropertyDescriptor(f.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.ref:(g=(a=Object.getOwnPropertyDescriptor(f,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?f.props.ref:f.props.ref||f.ref),i=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==e.Fragment&&(i.ref=b?(0,z.t)(b,h):h),e.cloneElement(c,i)}return e.Children.count(c)>1?e.Children.only(null):null});return b.displayName=`${a}.SlotClone`,b}(a),c=e.forwardRef((a,c)=>{let{children:f,...g}=a,h=e.Children.toArray(f),i=h.find(K);if(i){let a=i.props.children,f=h.map(b=>b!==i?b:e.Children.count(a)>1?e.Children.only(null):e.isValidElement(a)?a.props.children:null);return(0,d.jsx)(b,{...g,ref:c,children:e.isValidElement(a)?e.cloneElement(a,void 0,f):null})}return(0,d.jsx)(b,{...g,ref:c,children:f})});return c.displayName=`${a}.Slot`,c}("SelectContent.RemoveScroll"),ao=e.forwardRef((a,b)=>{let{__scopeSelect:c,position:f="item-aligned",onCloseAutoFocus:g,onEscapeKeyDown:h,onPointerDownOutside:i,side:j,sideOffset:k,align:l,alignOffset:m,arrowPadding:n,collisionBoundary:o,collisionPadding:p,sticky:q,hideWhenDetached:r,avoidCollisions:s,...t}=a,u=_(aj,c),[v,w]=e.useState(null),[y,A]=e.useState(null),B=(0,z.s)(b,a=>w(a)),[F,G]=e.useState(null),[H,I]=e.useState(null),J=V(c),[K,L]=e.useState(!1),M=e.useRef(!1);e.useEffect(()=>{if(v)return(0,P.Eq)(v)},[v]),(0,D.Oh)();let N=e.useCallback(a=>{let[b,...c]=J().map(a=>a.ref.current),[d]=c.slice(-1),e=document.activeElement;for(let c of a)if(c===e||(c?.scrollIntoView({block:"nearest"}),c===b&&y&&(y.scrollTop=0),c===d&&y&&(y.scrollTop=y.scrollHeight),c?.focus(),document.activeElement!==e))return},[J,y]),O=e.useCallback(()=>N([F,v]),[N,F,v]);e.useEffect(()=>{K&&O()},[K,O]);let{onOpenChange:R,triggerPointerDownPosRef:S}=u;e.useEffect(()=>{if(v){let a={x:0,y:0},b=b=>{a={x:Math.abs(Math.round(b.pageX)-(S.current?.x??0)),y:Math.abs(Math.round(b.pageY)-(S.current?.y??0))}},c=c=>{a.x<=10&&a.y<=10?c.preventDefault():v.contains(c.target)||R(!1),document.removeEventListener("pointermove",b),S.current=null};return null!==S.current&&(document.addEventListener("pointermove",b),document.addEventListener("pointerup",c,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",c,{capture:!0})}}},[v,R,S]),e.useEffect(()=>{let a=()=>R(!1);return window.addEventListener("blur",a),window.addEventListener("resize",a),()=>{window.removeEventListener("blur",a),window.removeEventListener("resize",a)}},[R]);let[T,U]=aR(a=>{let b=J().filter(a=>!a.disabled),c=b.find(a=>a.ref.current===document.activeElement),d=aS(b,a,c);d&&setTimeout(()=>d.ref.current.focus())}),W=e.useCallback((a,b,c)=>{let d=!M.current&&!c;(void 0!==u.value&&u.value===b||d)&&(G(a),d&&(M.current=!0))},[u.value]),X=e.useCallback(()=>v?.focus(),[v]),Y=e.useCallback((a,b,c)=>{let d=!M.current&&!c;(void 0!==u.value&&u.value===b||d)&&I(a)},[u.value]),Z="popper"===f?aq:ap,$=Z===aq?{side:j,sideOffset:k,align:l,alignOffset:m,arrowPadding:n,collisionBoundary:o,collisionPadding:p,sticky:q,hideWhenDetached:r,avoidCollisions:s}:{};return(0,d.jsx)(al,{scope:c,content:v,viewport:y,onViewportChange:A,itemRefCallback:W,selectedItem:F,onItemLeave:X,itemTextRefCallback:Y,focusSelectedItem:O,selectedItemText:H,position:f,isPositioned:K,searchRef:T,children:(0,d.jsx)(Q.A,{as:an,allowPinchZoom:!0,children:(0,d.jsx)(E.n,{asChild:!0,trapped:u.open,onMountAutoFocus:a=>{a.preventDefault()},onUnmountAutoFocus:(0,x.mK)(g,a=>{u.trigger?.focus({preventScroll:!0}),a.preventDefault()}),children:(0,d.jsx)(C.qW,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:h,onPointerDownOutside:i,onFocusOutside:a=>a.preventDefault(),onDismiss:()=>u.onOpenChange(!1),children:(0,d.jsx)(Z,{role:"listbox",id:u.contentId,"data-state":u.open?"open":"closed",dir:u.dir,onContextMenu:a=>a.preventDefault(),...t,...$,onPlaced:()=>L(!0),ref:B,style:{display:"flex",flexDirection:"column",outline:"none",...t.style},onKeyDown:(0,x.mK)(t.onKeyDown,a=>{let b=a.ctrlKey||a.altKey||a.metaKey;if("Tab"===a.key&&a.preventDefault(),b||1!==a.key.length||U(a.key),["ArrowUp","ArrowDown","Home","End"].includes(a.key)){let b=J().filter(a=>!a.disabled).map(a=>a.ref.current);if(["ArrowUp","End"].includes(a.key)&&(b=b.slice().reverse()),["ArrowUp","ArrowDown"].includes(a.key)){let c=a.target,d=b.indexOf(c);b=b.slice(d+1)}setTimeout(()=>N(b)),a.preventDefault()}})})})})})})});ao.displayName="SelectContentImpl";var ap=e.forwardRef((a,b)=>{let{__scopeSelect:c,onPlaced:f,...g}=a,h=_(aj,c),i=am(aj,c),[j,k]=e.useState(null),[l,m]=e.useState(null),n=(0,z.s)(b,a=>m(a)),o=V(c),p=e.useRef(!1),q=e.useRef(!0),{viewport:r,selectedItem:s,selectedItemText:t,focusSelectedItem:u}=i,v=e.useCallback(()=>{if(h.trigger&&h.valueNode&&j&&l&&r&&s&&t){let a=h.trigger.getBoundingClientRect(),b=l.getBoundingClientRect(),c=h.valueNode.getBoundingClientRect(),d=t.getBoundingClientRect();if("rtl"!==h.dir){let e=d.left-b.left,f=c.left-e,g=a.left-f,h=a.width+g,i=Math.max(h,b.width),k=w(f,[10,Math.max(10,window.innerWidth-10-i)]);j.style.minWidth=h+"px",j.style.left=k+"px"}else{let e=b.right-d.right,f=window.innerWidth-c.right-e,g=window.innerWidth-a.right-f,h=a.width+g,i=Math.max(h,b.width),k=w(f,[10,Math.max(10,window.innerWidth-10-i)]);j.style.minWidth=h+"px",j.style.right=k+"px"}let e=o(),g=window.innerHeight-20,i=r.scrollHeight,k=window.getComputedStyle(l),m=parseInt(k.borderTopWidth,10),n=parseInt(k.paddingTop,10),q=parseInt(k.borderBottomWidth,10),u=m+n+i+parseInt(k.paddingBottom,10)+q,v=Math.min(5*s.offsetHeight,u),x=window.getComputedStyle(r),y=parseInt(x.paddingTop,10),z=parseInt(x.paddingBottom,10),A=a.top+a.height/2-10,B=s.offsetHeight/2,C=m+n+(s.offsetTop+B);if(C<=A){let a=e.length>0&&s===e[e.length-1].ref.current;j.style.bottom="0px";let b=Math.max(g-A,B+(a?z:0)+(l.clientHeight-r.offsetTop-r.offsetHeight)+q);j.style.height=C+b+"px"}else{let a=e.length>0&&s===e[0].ref.current;j.style.top="0px";let b=Math.max(A,m+r.offsetTop+(a?y:0)+B);j.style.height=b+(u-C)+"px",r.scrollTop=C-A+r.offsetTop}j.style.margin="10px 0",j.style.minHeight=v+"px",j.style.maxHeight=g+"px",f?.(),requestAnimationFrame(()=>p.current=!0)}},[o,h.trigger,h.valueNode,j,l,r,s,t,h.dir,f]);(0,N.N)(()=>v(),[v]);let[x,y]=e.useState();(0,N.N)(()=>{l&&y(window.getComputedStyle(l).zIndex)},[l]);let A=e.useCallback(a=>{a&&!0===q.current&&(v(),u?.(),q.current=!1)},[v,u]);return(0,d.jsx)(ar,{scope:c,contentWrapper:j,shouldExpandOnScrollRef:p,onScrollButtonChange:A,children:(0,d.jsx)("div",{ref:k,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:(0,d.jsx)(I.sG.div,{...g,ref:n,style:{boxSizing:"border-box",maxHeight:"100%",...g.style}})})})});ap.displayName="SelectItemAlignedPosition";var aq=e.forwardRef((a,b)=>{let{__scopeSelect:c,align:e="start",collisionPadding:f=10,...g}=a,h=Z(c);return(0,d.jsx)(G.UC,{...h,...g,ref:b,align:e,collisionPadding:f,style:{boxSizing:"border-box",...g.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});aq.displayName="SelectPopperPosition";var[ar,as]=X(aj,{}),at="SelectViewport",au=e.forwardRef((a,b)=>{let{__scopeSelect:c,nonce:f,...g}=a,h=am(at,c),i=as(at,c),j=(0,z.s)(b,h.onViewportChange),k=e.useRef(0);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:f}),(0,d.jsx)(U.Slot,{scope:c,children:(0,d.jsx)(I.sG.div,{"data-radix-select-viewport":"",role:"presentation",...g,ref:j,style:{position:"relative",flex:1,overflow:"hidden auto",...g.style},onScroll:(0,x.mK)(g.onScroll,a=>{let b=a.currentTarget,{contentWrapper:c,shouldExpandOnScrollRef:d}=i;if(d?.current&&c){let a=Math.abs(k.current-b.scrollTop);if(a>0){let d=window.innerHeight-20,e=Math.max(parseFloat(c.style.minHeight),parseFloat(c.style.height));if(e<d){let f=e+a,g=Math.min(d,f),h=f-g;c.style.height=g+"px","0px"===c.style.bottom&&(b.scrollTop=h>0?h:0,c.style.justifyContent="flex-end")}}}k.current=b.scrollTop})})})]})});au.displayName=at;var av="SelectGroup",[aw,ax]=X(av);e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=(0,F.B)();return(0,d.jsx)(aw,{scope:c,id:f,children:(0,d.jsx)(I.sG.div,{role:"group","aria-labelledby":f,...e,ref:b})})}).displayName=av;var ay="SelectLabel",az=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=ax(ay,c);return(0,d.jsx)(I.sG.div,{id:f.id,...e,ref:b})});az.displayName=ay;var aA="SelectItem",[aB,aC]=X(aA),aD=e.forwardRef((a,b)=>{let{__scopeSelect:c,value:f,disabled:g=!1,textValue:h,...i}=a,j=_(aA,c),k=am(aA,c),l=j.value===f,[m,n]=e.useState(h??""),[o,p]=e.useState(!1),q=(0,z.s)(b,a=>k.itemRefCallback?.(a,f,g)),r=(0,F.B)(),s=e.useRef("touch"),t=()=>{g||(j.onValueChange(f),j.onOpenChange(!1))};if(""===f)throw Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,d.jsx)(aB,{scope:c,value:f,disabled:g,textId:r,isSelected:l,onItemTextChange:e.useCallback(a=>{n(b=>b||(a?.textContent??"").trim())},[]),children:(0,d.jsx)(U.ItemSlot,{scope:c,value:f,disabled:g,textValue:m,children:(0,d.jsx)(I.sG.div,{role:"option","aria-labelledby":r,"data-highlighted":o?"":void 0,"aria-selected":l&&o,"data-state":l?"checked":"unchecked","aria-disabled":g||void 0,"data-disabled":g?"":void 0,tabIndex:g?void 0:-1,...i,ref:q,onFocus:(0,x.mK)(i.onFocus,()=>p(!0)),onBlur:(0,x.mK)(i.onBlur,()=>p(!1)),onClick:(0,x.mK)(i.onClick,()=>{"mouse"!==s.current&&t()}),onPointerUp:(0,x.mK)(i.onPointerUp,()=>{"mouse"===s.current&&t()}),onPointerDown:(0,x.mK)(i.onPointerDown,a=>{s.current=a.pointerType}),onPointerMove:(0,x.mK)(i.onPointerMove,a=>{s.current=a.pointerType,g?k.onItemLeave?.():"mouse"===s.current&&a.currentTarget.focus({preventScroll:!0})}),onPointerLeave:(0,x.mK)(i.onPointerLeave,a=>{a.currentTarget===document.activeElement&&k.onItemLeave?.()}),onKeyDown:(0,x.mK)(i.onKeyDown,a=>{(k.searchRef?.current===""||" "!==a.key)&&(S.includes(a.key)&&t()," "===a.key&&a.preventDefault())})})})})});aD.displayName=aA;var aE="SelectItemText",aF=e.forwardRef((a,b)=>{let{__scopeSelect:c,className:f,style:g,...h}=a,i=_(aE,c),j=am(aE,c),k=aC(aE,c),l=ab(aE,c),[m,n]=e.useState(null),o=(0,z.s)(b,a=>n(a),k.onItemTextChange,a=>j.itemTextRefCallback?.(a,k.value,k.disabled)),p=m?.textContent,q=e.useMemo(()=>(0,d.jsx)("option",{value:k.value,disabled:k.disabled,children:p},k.value),[k.disabled,k.value,p]),{onNativeOptionAdd:r,onNativeOptionRemove:s}=l;return(0,N.N)(()=>(r(q),()=>s(q)),[r,s,q]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(I.sG.span,{id:k.textId,...h,ref:o}),k.isSelected&&i.valueNode&&!i.valueNodeHasChildren?v.createPortal(h.children,i.valueNode):null]})});aF.displayName=aE;var aG="SelectItemIndicator",aH=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a;return aC(aG,c).isSelected?(0,d.jsx)(I.sG.span,{"aria-hidden":!0,...e,ref:b}):null});aH.displayName=aG;var aI="SelectScrollUpButton",aJ=e.forwardRef((a,b)=>{let c=am(aI,a.__scopeSelect),f=as(aI,a.__scopeSelect),[g,h]=e.useState(!1),i=(0,z.s)(b,f.onScrollButtonChange);return(0,N.N)(()=>{if(c.viewport&&c.isPositioned){let a=function(){h(b.scrollTop>0)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),g?(0,d.jsx)(aM,{...a,ref:i,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop-b.offsetHeight)}}):null});aJ.displayName=aI;var aK="SelectScrollDownButton",aL=e.forwardRef((a,b)=>{let c=am(aK,a.__scopeSelect),f=as(aK,a.__scopeSelect),[g,h]=e.useState(!1),i=(0,z.s)(b,f.onScrollButtonChange);return(0,N.N)(()=>{if(c.viewport&&c.isPositioned){let a=function(){let a=b.scrollHeight-b.clientHeight;h(Math.ceil(b.scrollTop)<a)},b=c.viewport;return a(),b.addEventListener("scroll",a),()=>b.removeEventListener("scroll",a)}},[c.viewport,c.isPositioned]),g?(0,d.jsx)(aM,{...a,ref:i,onAutoScroll:()=>{let{viewport:a,selectedItem:b}=c;a&&b&&(a.scrollTop=a.scrollTop+b.offsetHeight)}}):null});aL.displayName=aK;var aM=e.forwardRef((a,b)=>{let{__scopeSelect:c,onAutoScroll:f,...g}=a,h=am("SelectScrollButton",c),i=e.useRef(null),j=V(c),k=e.useCallback(()=>{null!==i.current&&(window.clearInterval(i.current),i.current=null)},[]);return e.useEffect(()=>()=>k(),[k]),(0,N.N)(()=>{let a=j().find(a=>a.ref.current===document.activeElement);a?.ref.current?.scrollIntoView({block:"nearest"})},[j]),(0,d.jsx)(I.sG.div,{"aria-hidden":!0,...g,ref:b,style:{flexShrink:0,...g.style},onPointerDown:(0,x.mK)(g.onPointerDown,()=>{null===i.current&&(i.current=window.setInterval(f,50))}),onPointerMove:(0,x.mK)(g.onPointerMove,()=>{h.onItemLeave?.(),null===i.current&&(i.current=window.setInterval(f,50))}),onPointerLeave:(0,x.mK)(g.onPointerLeave,()=>{k()})})}),aN=e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a;return(0,d.jsx)(I.sG.div,{"aria-hidden":!0,...e,ref:b})});aN.displayName="SelectSeparator";var aO="SelectArrow";e.forwardRef((a,b)=>{let{__scopeSelect:c,...e}=a,f=Z(c),g=_(aO,c),h=am(aO,c);return g.open&&"popper"===h.position?(0,d.jsx)(G.i3,{...f,...e,ref:b}):null}).displayName=aO;var aP=e.forwardRef(({__scopeSelect:a,value:b,...c},f)=>{let g=e.useRef(null),h=(0,z.s)(f,g),i=function(a){let b=e.useRef({value:a,previous:a});return e.useMemo(()=>(b.current.value!==a&&(b.current.previous=b.current.value,b.current.value=a),b.current.previous),[a])}(b);return e.useEffect(()=>{let a=g.current;if(!a)return;let c=Object.getOwnPropertyDescriptor(window.HTMLSelectElement.prototype,"value").set;if(i!==b&&c){let d=new Event("change",{bubbles:!0});c.call(a,b),a.dispatchEvent(d)}},[i,b]),(0,d.jsx)(I.sG.select,{...c,style:{...O,...c.style},ref:h,defaultValue:b})});function aQ(a){return""===a||void 0===a}function aR(a){let b=(0,L.c)(a),c=e.useRef(""),d=e.useRef(0),f=e.useCallback(a=>{let e=c.current+a;b(e),function a(b){c.current=b,window.clearTimeout(d.current),""!==b&&(d.current=window.setTimeout(()=>a(""),1e3))}(e)},[b]),g=e.useCallback(()=>{c.current="",window.clearTimeout(d.current)},[]);return e.useEffect(()=>()=>window.clearTimeout(d.current),[]),[c,f,g]}function aS(a,b,c){var d,e;let f=b.length>1&&Array.from(b).every(a=>a===b[0])?b[0]:b,g=c?a.indexOf(c):-1,h=(d=a,e=Math.max(g,0),d.map((a,b)=>d[(e+b)%d.length]));1===f.length&&(h=h.filter(a=>a!==c));let i=h.find(a=>a.textValue.toLowerCase().startsWith(f.toLowerCase()));return i!==c?i:void 0}aP.displayName="SelectBubbleInput";var aT=c(23339);let aU=(0,aT.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),aV=(0,aT.A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var aW=c(71613);let aX=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(ae,{ref:e,className:`flex h-10 w-full items-center justify-between rounded-md border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-background placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 ${a||""}`,...c,children:[b,(0,d.jsx)(ah,{asChild:!0,children:(0,d.jsx)(aU,{className:"h-4 w-4 opacity-50"})})]}));aX.displayName=ae.displayName;let aY=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(aJ,{ref:c,className:`flex cursor-default items-center justify-center py-1 ${a||""}`,...b,children:(0,d.jsx)(aV,{className:"h-4 w-4"})}));aY.displayName=aJ.displayName;let aZ=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(aL,{ref:c,className:`flex cursor-default items-center justify-center py-1 ${a||""}`,...b,children:(0,d.jsx)(aU,{className:"h-4 w-4"})}));aZ.displayName=aL.displayName;let a$=e.forwardRef(({className:a,children:b,position:c="popper",...e},f)=>(0,d.jsx)(ai,{children:(0,d.jsxs)(ak,{ref:f,className:`relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white text-gray-900 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 ${"popper"===c?"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1":""} ${a||""}`,position:c,...e,children:[(0,d.jsx)(aY,{}),(0,d.jsx)(au,{className:`p-1 ${"popper"===c?"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]":""}`,children:b}),(0,d.jsx)(aZ,{})]})}));a$.displayName=ak.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(az,{ref:c,className:`py-1.5 pl-8 pr-2 text-sm font-semibold ${a||""}`,...b})).displayName=az.displayName;let a_=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(aD,{ref:e,className:`relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-gray-100 focus:text-gray-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50 ${a||""}`,...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(aH,{children:(0,d.jsx)(aW.A,{className:"h-4 w-4"})})}),(0,d.jsx)(aF,{children:b})]}));a_.displayName=aD.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(aN,{ref:c,className:`-mx-1 my-1 h-px bg-gray-200 ${a||""}`,...b})).displayName=aN.displayName;var a0=c(88900),a1=c(55794);function a2({calls:a,selectedCallId:b,organizationId:c,onSelect:f}){let[g,h]=(0,e.useState)(a),[i,j]=(0,e.useState)(a),[k,l]=(0,e.useState)(0),[m,n]=(0,e.useState)("all"),[o,p]=(0,e.useState)(""),[q,t]=(0,e.useState)("date"),[v,w]=(0,e.useState)(1),[x,y]=(0,e.useState)(!1),z=(0,e.useRef)(null),{updates:A,connected:B}=(0,a1.x)(c||null),{data:C}=(0,a1.n)(async()=>{if(!c)return[];try{let a=await fetch(`/api/calls?orgId=${encodeURIComponent(c)}&page=${v}&limit=20`,{credentials:"include"});if(a.ok)return(await a.json()).calls||[];return[]}catch{return[]}},5e3,!B&&null!==c),D=i.slice(0,20*v),E=i.length>20*v;function F(a){l(a);let b=z.current,c=b?.querySelectorAll('[role="listitem"]')[a];c?.focus()}return(0,d.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,d.jsxs)("div",{className:"p-4 bg-white border-b border-gray-200 space-y-3",children:[(0,d.jsx)(u.p,{type:"search",value:o,onChange:a=>p(a.target.value),placeholder:"Search calls...",className:"w-full"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,d.jsxs)(ac,{value:m,onValueChange:a=>n(a),children:[(0,d.jsx)(aX,{children:(0,d.jsx)(ag,{placeholder:"All Status"})}),(0,d.jsxs)(a$,{children:[(0,d.jsx)(a_,{value:"all",children:"All Status"}),(0,d.jsx)(a_,{value:"active",children:"Active"}),(0,d.jsx)(a_,{value:"completed",children:"Completed"}),(0,d.jsx)(a_,{value:"failed",children:"Failed"})]})]}),(0,d.jsxs)(ac,{value:q,onValueChange:a=>t(a),children:[(0,d.jsx)(aX,{children:(0,d.jsx)(ag,{placeholder:"Newest First"})}),(0,d.jsxs)(a$,{children:[(0,d.jsx)(a_,{value:"date",children:"Newest First"}),(0,d.jsx)(a_,{value:"score",children:"By Score"}),(0,d.jsx)(a_,{value:"duration",children:"By Duration"})]})]})]}),!B&&(0,d.jsx)("div",{className:"text-xs text-warning",children:"Offline mode - using cached data"})]}),(0,d.jsxs)("div",{className:"flex-1 overflow-auto",ref:z,onKeyDown:function(a){if(D&&0!==D.length){if("ArrowDown"===a.key)a.preventDefault(),F(Math.min(D.length-1,k+1));else if("ArrowUp"===a.key)a.preventDefault(),F(Math.max(0,k-1));else if("Enter"===a.key||" "===a.key){a.preventDefault();let b=D[k];b&&f?.(b.id)}}},children:[x?(0,d.jsx)("div",{className:"text-center text-gray-500 py-8",children:"Loading..."}):0===D.length?(0,d.jsx)("div",{className:"text-center text-gray-500 py-8",children:"No calls found"}):(0,d.jsxs)("table",{className:"w-full border-collapse bg-white",children:[(0,d.jsx)("thead",{className:"sticky top-0 bg-gray-50 border-b border-gray-200 z-10",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wide text-left",children:"ID"}),(0,d.jsx)("th",{className:"px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wide text-left",children:"Status"}),(0,d.jsx)("th",{className:"px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wide text-left",children:"Date"}),(0,d.jsx)("th",{className:"px-4 py-3 text-xs font-medium text-gray-500 uppercase tracking-wide text-left",children:"User"})]})}),(0,d.jsx)("tbody",{className:"divide-y divide-gray-100",children:D.map((a,c)=>{var e;let g=b===a.id;return(0,d.jsxs)("tr",{role:"listitem",tabIndex:0,"aria-selected":g,onClick:()=>f?.(a.id),onFocus:()=>l(c),onKeyDown:b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),f?.(a.id))},className:`cursor-pointer transition-colors ${g?"bg-primary-50":"hover:bg-gray-50"}`,children:[(0,d.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,d.jsxs)("span",{className:"font-mono text-xs text-gray-900",children:[a.id.slice(0,8),"..."]})}),(0,d.jsx)("td",{className:"px-4 py-3",children:(0,d.jsx)(s.E,{variant:"completed"===(e=a.status)?"success":"in_progress"===e||"ringing"===e?"info":"failed"===e||"no-answer"===e||"busy"===e?"error":"default",children:a.status??"unknown"})}),(0,d.jsx)("td",{className:"px-4 py-3 text-sm text-gray-600",children:(0,d.jsx)(a0.u,{date:a.started_at,format:"short"})}),(0,d.jsx)("td",{className:"px-4 py-3 text-sm text-gray-500",children:a.created_by||"â€”"})]},a.id)})})]}),E&&(0,d.jsx)("div",{className:"p-4 bg-white border-t border-gray-200 text-center",children:(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:function(){w(a=>a+1)},children:["Load More (",i.length-D.length," remaining)"]})})]}),(0,d.jsxs)("div",{className:"p-3 bg-white border-t border-gray-200 text-xs text-gray-500",children:[D.length," of ",i.length," calls"]})]})}var a3=c(3991),a4=c.n(a3),a5=c(12294);let a6=(0,e.createContext)(null);function a7({defaultValue:a,children:b,className:c=""}){let[f,g]=(0,e.useState)(a);return(0,d.jsx)(a6.Provider,{value:{activeTab:f,setActiveTab:g},children:(0,d.jsx)("div",{className:c,children:b})})}function a8({children:a,className:b=""}){return(0,d.jsx)("div",{className:`flex border-b border-slate-800 ${b}`,role:"tablist",children:a})}function a9({value:a,children:b,className:c=""}){let f=(0,e.useContext)(a6);if(!f)throw Error("TabsTrigger must be used within Tabs");let{activeTab:g,setActiveTab:h}=f,i=g===a;return(0,d.jsx)("button",{role:"tab","aria-selected":i,onClick:()=>h(a),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 ${i?"border-indigo-500 text-indigo-400":"border-transparent text-slate-400 hover:text-slate-100"} ${c}`,children:b})}function ba({value:a,children:b,className:c=""}){let f=(0,e.useContext)(a6);if(!f)throw Error("TabsContent must be used within Tabs");let{activeTab:g}=f;return g!==a?null:(0,d.jsx)("div",{role:"tabpanel",className:c,children:b})}function bb({recordingUrl:a,transcriptPreview:b,onPlay:c}){let f=(0,e.useRef)(null),[g,h]=(0,e.useState)(!1),[i,j]=(0,e.useState)(0),[k,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(1);function o(){let a=f.current;a&&(a.paused?a.play().catch(()=>{}):a.pause())}function p(a){let b=f.current;b&&(b.currentTime=Math.max(0,Math.min(b.duration||0,b.currentTime+a)))}function q(a){if(null===a)return"0:00";let b=Math.floor(a/60),c=Math.floor(a%60);return`${b}:${c.toString().padStart(2,"0")}`}return(0,d.jsxs)("section",{"aria-label":"Audio player",role:"region",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-4",children:[(0,d.jsx)("button",{onClick:o,onKeyDown:function(a){" "===a.key||"Spacebar"===a.key?(a.preventDefault(),o()):"ArrowRight"===a.key?(a.preventDefault(),p(5)):"ArrowLeft"===a.key?(a.preventDefault(),p(-5)):"ArrowUp"===a.key?(a.preventDefault(),n(Math.min(1,m+.1))):"ArrowDown"===a.key&&(a.preventDefault(),n(Math.max(0,m-.1)))},"aria-pressed":g,"aria-label":g?"Pause audio":"Play audio",className:"inline-flex items-center justify-center h-12 w-12 rounded-full bg-[#1E3A5F] text-white hover:bg-[#15294A] focus:outline-none focus:ring-2 focus:ring-[#1E3A5F] focus:ring-offset-2",children:(0,d.jsx)("span",{"aria-hidden":!0,children:g?"â–®â–®":"â–¶"})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("div",{className:"text-sm text-gray-800 mb-1",children:"Recording"}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("input",{type:"range",min:"0",max:k||0,value:i,onChange:function(a){let b=f.current;if(!b)return;let c=parseFloat(a.target.value);b.currentTime=c,j(c)},className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#1E3A5F]","aria-label":"Seek position"}),(0,d.jsxs)("span",{className:"text-xs text-gray-500 font-mono min-w-[4rem] text-right",children:[q(i)," / ",q(k)]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("label",{className:"text-xs text-gray-500",htmlFor:"volume-control",children:"Volume"}),(0,d.jsx)("input",{id:"volume-control",type:"range",min:"0",max:"1",step:"0.1",value:m,onChange:a=>n(parseFloat(a.target.value)),className:"w-20 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#1E3A5F]","aria-label":"Volume control"})]}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:function(){let b=document.createElement("a");b.href=a,b.download=`recording-${Date.now()}.mp3`,b.click()},"aria-label":"Download recording",children:"Download"})]}),(0,d.jsx)("audio",{ref:f,src:a,className:"hidden",preload:"metadata","aria-label":"Audio recording"}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>p(-5),"aria-label":"Rewind 5 seconds",children:"-5s"}),(0,d.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>p(5),"aria-label":"Forward 5 seconds",children:"+5s"}),b&&(0,d.jsx)("a",{href:"#transcript",className:"text-xs text-[#1E3A5F] hover:underline ml-auto",onClick:a=>{a.preventDefault(),document.getElementById("artifact-transcript")?.scrollIntoView({behavior:"smooth"})},children:"View Transcript â†’"})]}),b&&(0,d.jsxs)("div",{className:"p-3 bg-gray-50 rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Transcript Preview"}),(0,d.jsx)("div",{className:"text-sm text-gray-700 line-clamp-3",children:b})]})]})}var bc=c(4803);function bd({transcript:a}){let[b,c]=(0,e.useState)(!1),f="string"==typeof a?a:a?.text?a.text:a?.transcript?a.transcript:JSON.stringify(a,null,2),g=a?.words||a?.segments||[],h=g.length>0;async function i(){try{await navigator.clipboard.writeText(f),c(!0),setTimeout(()=>c(!1),2e3)}catch(a){bc.v.error("TranscriptView: clipboard copy failed",a)}}function j(a){let b=Math.floor(a/1e3),c=Math.floor(b/60);return`${c}:${(b%60).toString().padStart(2,"0")}`}return(0,d.jsxs)("section",{"aria-labelledby":"transcript-view",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{id:"transcript-view",className:"text-base font-semibold text-[#333333]",children:"Transcript"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:i,"aria-label":b?"Copied to clipboard":"Copy transcript to clipboard",children:b?"Copied!":"Copy"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:function(){let a=new Blob([f],{type:"text/plain"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`transcript-${Date.now()}.txt`,c.click(),URL.revokeObjectURL(b)},"aria-label":"Export transcript as text file",children:"Export TXT"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:function(){let b=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`transcript-${Date.now()}.json`,d.click(),URL.revokeObjectURL(c)},"aria-label":"Export transcript as JSON file",children:"Export JSON"})]})]}),h?(0,d.jsx)("div",{className:"space-y-2 max-h-[60vh] overflow-y-auto bg-white border border-[#E5E5E5] rounded p-4",children:g.map((a,b)=>(0,d.jsx)("div",{className:"p-3 bg-[#FAFAFA] border-l-4 border-[#4E79A7] rounded",children:(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(void 0!==a.start||void 0!==a.end)&&(0,d.jsxs)("div",{className:"text-xs text-[#999999] font-mono whitespace-nowrap flex-shrink-0",children:[void 0!==a.start&&j(a.start),void 0!==a.start&&void 0!==a.end&&" - ",void 0!==a.end&&j(a.end)]}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[a.speaker&&(0,d.jsxs)("div",{className:"text-xs font-medium text-[#4E79A7] mb-1",children:["Speaker ",a.speaker]}),(0,d.jsx)("div",{className:"text-sm text-[#333333]",children:a.text||a.word}),void 0!==a.confidence&&(0,d.jsxs)("div",{className:"text-xs text-[#666666] mt-1",children:["Confidence: ",(100*a.confidence).toFixed(1),"%"]})]})]})},b))}):(0,d.jsx)("div",{className:"p-4 bg-white border border-[#E5E5E5] rounded",children:(0,d.jsx)("pre",{className:"text-sm text-[#333333] whitespace-pre-wrap font-sans max-h-[60vh] overflow-y-auto",children:f})})]})}function be({translation:a,originalTranscript:b}){let[c,f]=(0,e.useState)("side-by-side"),[g,h]=(0,e.useState)(!0),i="string"==typeof a?a:a?.text?a.text:a?.translation?a.translation:JSON.stringify(a,null,2),j=b?.text||("string"==typeof b?b:"")||"Original transcript not available",k=a?.from_language||a?.from||"Unknown",l=a?.to_language||a?.to||"Unknown",m=a?.translated_audio_url||a?.audio_url||null;return(0,d.jsxs)("section",{"aria-labelledby":"translation-view",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{id:"translation-view",className:"text-lg font-medium text-gray-800",children:"Translation"}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsxs)(s.E,{variant:"info",children:[k," â†’ ",l]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(r.$,{variant:"side-by-side"===c?"default":"outline",size:"sm",onClick:()=>f("side-by-side"),children:"Side by Side"}),(0,d.jsx)(r.$,{variant:"toggle"===c?"default":"outline",size:"sm",onClick:()=>f("toggle"),children:"Toggle"})]})]})]}),"side-by-side"===c?(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,d.jsx)(s.E,{variant:"default",children:k})}),(0,d.jsx)("div",{className:"text-sm text-gray-800 whitespace-pre-wrap max-h-[50vh] overflow-y-auto",children:j})]}),(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,d.jsx)(s.E,{variant:"info",children:l})}),m&&(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsxs)("audio",{controls:!0,className:"w-full h-8",style:{maxWidth:"100%"},preload:"metadata",children:[(0,d.jsx)("source",{src:m,type:"audio/mpeg"}),"Your browser does not support audio playback."]})}),(0,d.jsx)("div",{className:"text-sm text-gray-800 whitespace-pre-wrap max-h-[50vh] overflow-y-auto",children:i})]})]}):(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsxs)(r.$,{variant:g?"default":"outline",size:"sm",onClick:()=>h(!0),children:["Original (",k,")"]}),(0,d.jsxs)(r.$,{variant:g?"outline":"default",size:"sm",onClick:()=>h(!1),children:["Translation (",l,")"]})]}),(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[!g&&m&&(0,d.jsx)("div",{className:"mb-3",children:(0,d.jsxs)("audio",{controls:!0,className:"w-full h-8",style:{maxWidth:"100%"},preload:"metadata",children:[(0,d.jsx)("source",{src:m,type:"audio/mpeg"}),"Your browser does not support audio playback."]})}),(0,d.jsx)("div",{className:"text-sm text-gray-800 whitespace-pre-wrap max-h-[50vh] overflow-y-auto",children:g?j:i})]})]})]})}function bf({survey:a}){let b=a?.results||a?.responses||a||{},c=a?.questions||[],e=a?.sentiment||a?.sentiment_analysis,f=a?.score||a?.overall_score,g=Array.isArray(a?.responses)?a.responses:Array.isArray(a?.results?.responses)?a.results.responses:[],h=g.length>0&&g[0]?.question_index!==void 0;return(0,d.jsxs)("section",{"aria-labelledby":"survey-results",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{id:"survey-results",className:"text-lg font-medium text-gray-800",children:"Survey Results"}),void 0!==f&&(0,d.jsxs)(s.E,{variant:f>=4?"success":f>=3?"warning":"error",children:["Score: ",f,"/5"]})]}),e&&(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-gray-800 mb-2",children:"Sentiment Analysis"}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(s.E,{variant:"positive"===e?"success":"negative"===e?"error":"warning",children:e}),a?.sentiment_score&&(0,d.jsxs)("span",{className:"text-sm text-gray-500",children:["Confidence: ",(100*a.sentiment_score).toFixed(1),"%"]})]})]}),h?(0,d.jsx)("div",{className:"space-y-4",children:g.map(a=>(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"text-sm font-medium text-gray-800 mb-2",children:["Q",a.question_index,": ",a.question||"Question"]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:a.value||a.digit||"No response"}),a.digit&&(0,d.jsxs)(s.E,{variant:"info",children:["DTMF: ",a.digit]})]})]},`${a.question_index}-${a.digit||a.value}`))}):c.length>0?(0,d.jsx)("div",{className:"space-y-4",children:c.map((a,b)=>(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-gray-800 mb-2",children:a.question||a.text}),(0,d.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:["Response: ",a.response||a.answer||"No response"]}),void 0!==a.score&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-xs text-gray-500",children:"Score:"}),(0,d.jsxs)(s.E,{variant:a.score>=4?"success":a.score>=3?"warning":"error",children:[a.score,"/5"]})]})]},b))}):(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"text-sm text-gray-500 mb-2",children:"Survey Responses:"}),(0,d.jsx)("pre",{className:"text-xs text-gray-700 whitespace-pre-wrap font-mono",children:JSON.stringify(b,null,2)})]}),a?.breakdown&&(0,d.jsxs)("div",{className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-gray-800 mb-2",children:"Score Breakdown"}),(0,d.jsx)("div",{className:"space-y-2",children:Object.entries(a.breakdown).map(([a,b])=>(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-slate-300",children:a}),(0,d.jsx)(s.E,{variant:"default",children:b})]},a))})]})]})}function bg({manifest:a}){let[b,c]=(0,e.useState)(!1);if(!a)return(0,d.jsx)("div",{className:"p-4 bg-gray-50 rounded-md text-gray-500 text-sm border border-gray-200",children:"No evidence manifest available"});let f=a.manifest_id||a.id||"unknown",g=a.created_at||a.createdAt||"unknown",h=Array.isArray(a.artifacts)?a.artifacts.length:0,i=a.manifest_hash||a.hash||a.manifestHash||"n/a";return(0,d.jsxs)("section",{role:"region","aria-label":"Evidence manifest summary",className:"w-full p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-xs text-gray-500",children:"Manifest"}),(0,d.jsx)("div",{className:"text-sm text-gray-800 font-medium",children:f}),(0,d.jsx)("div",{className:"text-xs text-gray-500",children:new Date(g).toLocaleString()})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("div",{className:"text-xs text-gray-500",children:"Artifacts"}),(0,d.jsx)("div",{className:"text-sm text-gray-800",children:h}),(0,d.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:i})]})]}),(0,d.jsx)("div",{className:"mt-3 flex items-center justify-end",children:(0,d.jsx)("button",{onClick:()=>c(a=>!a),"aria-expanded":b,className:"text-xs text-[#1E3A5F] hover:underline focus:outline-none focus:ring-2 focus:ring-[#1E3A5F] rounded px-2 py-1",children:b?"Hide JSON":"Show full manifest"})}),b?(0,d.jsx)("pre",{className:"mt-3 p-3 rounded bg-gray-50 text-gray-800 text-xs font-mono overflow-auto max-h-80 border border-gray-200",tabIndex:0,"aria-label":"Full evidence manifest JSON",children:(0,d.jsx)("code",{children:JSON.stringify(a,null,2)})}):null]})}function bh({manifest:a}){let[b,c]=(0,e.useState)(!1);function f(){let b=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`evidence-manifest-${a.id||Date.now()}.json`,d.click(),URL.revokeObjectURL(c)}return(0,d.jsxs)("section",{"aria-labelledby":"manifest-view",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{id:"manifest-view",className:"text-base font-semibold text-[#333333]",children:"Evidence Manifest"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:f,"aria-label":"Export manifest as JSON",children:"Export JSON"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:function(){f()},"aria-label":"Download manifest",children:"Download"})]})]}),(0,d.jsx)(bg,{manifest:a}),b&&(0,d.jsxs)("div",{className:"p-4 bg-white border border-[#E5E5E5] rounded",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-[#333333] mb-3",children:"Provenance Metadata"}),(0,d.jsxs)("div",{className:"space-y-2 text-xs",children:[a.producer&&(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)("span",{className:"text-[#666666] font-medium min-w-[80px]",children:"Producer:"}),(0,d.jsx)("span",{className:"text-[#333333]",children:a.producer})]}),a.created_at&&(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)("span",{className:"text-[#666666] font-medium min-w-[80px]",children:"Created:"}),(0,d.jsx)("span",{className:"text-[#333333]",children:new Date(a.created_at).toLocaleString()})]}),a.manifest_hash&&(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)("span",{className:"text-[#666666] font-medium min-w-[80px]",children:"Hash:"}),(0,d.jsx)("code",{className:"text-[#333333] font-mono bg-[#FAFAFA] px-2 py-1 rounded",children:a.manifest_hash})]})]})]}),(0,d.jsxs)("div",{className:"bg-white border border-[#E5E5E5] rounded",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-[#E5E5E5]",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-[#333333]",children:"Full Manifest JSON"}),(0,d.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>c(!b),"aria-expanded":b,"aria-label":b?"Collapse manifest JSON":"Expand manifest JSON",children:b?"Collapse":"Expand"})]}),b&&(0,d.jsx)("div",{className:"p-4",children:(0,d.jsx)("pre",{className:"text-xs text-[#333333] whitespace-pre-wrap font-mono max-h-[60vh] overflow-y-auto bg-[#FAFAFA] p-4 rounded",children:JSON.stringify(a,null,2)})})]})]})}var bi=c(6391);function bj({score:a}){let b=a.score,c=a.breakdown||{},e=a.scorecard_id;return(0,d.jsxs)("section",{"aria-labelledby":"score-view",className:"w-full space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{id:"score-view",className:"text-base font-semibold text-[#333333]",children:"Call Score"}),e&&(0,d.jsxs)(s.E,{variant:"info","aria-label":`Scorecard: ${e}`,children:["Scorecard: ",e]})]}),(0,d.jsxs)("div",{className:"p-6 bg-white border border-[#E5E5E5] rounded text-center",children:[(0,d.jsxs)("div",{className:"text-4xl font-semibold text-[#333333] mb-3 tabular-nums",children:[b,"%"]}),(0,d.jsx)(s.E,{variant:b>=80?"success":b>=60?"warning":"error",className:"text-base px-4 py-1.5",children:b>=90?"Excellent":b>=80?"Good":b>=70?"Fair":b>=60?"Needs Improvement":"Poor"})]}),Object.keys(c).length>0&&(0,d.jsxs)("div",{className:"p-5 bg-white border border-[#E5E5E5] rounded",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-[#333333] mb-4",children:"Score Breakdown"}),(0,d.jsx)("div",{className:"space-y-4",children:Object.entries(c).map(([a,b])=>{let c="number"==typeof b?b:b?.score||0,e=c>=80?"green":c>=60?"orange":"red";return(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-[#333333]",children:a}),"object"==typeof b&&b?.notes&&(0,d.jsx)("div",{className:"text-xs text-[#666666] mt-0.5",children:b.notes})]}),(0,d.jsxs)("span",{className:"text-sm font-medium text-[#333333] tabular-nums ml-4",children:[c,"%"]})]}),(0,d.jsx)(bi.z,{value:c,color:e,showValue:!1})]},a)})})]}),e&&(0,d.jsxs)("div",{className:"p-4 bg-white border border-[#E5E5E5] rounded",children:[(0,d.jsx)("div",{className:"text-sm font-semibold text-[#333333] mb-2",children:"Scorecard Information"}),(0,d.jsxs)("div",{className:"text-xs text-[#666666]",children:["This score was calculated using scorecard: ",(0,d.jsx)("code",{className:"text-[#333333] font-mono bg-[#FAFAFA] px-1 py-0.5 rounded",children:e})]})]})]})}function bk({callId:a,organizationId:b,recording:c,transcript:f,translation:g,manifest:h,score:i,survey:j,transcriptionStatus:k}){let l=!!c?.recording_url,m=!!f,n=!!g,o=!!j,p=!!h,q=!!i,s=l||m||n,t="queued"===k||"processing"===k,[v,w]=(0,e.useState)(!1),[x,y]=(0,e.useState)(""),[z,A]=(0,e.useState)(!1),[B,C]=(0,e.useState)(null),D=async()=>{if(!x||!x.includes("@"))return void C({type:"error",message:"Please enter a valid email address"});A(!0),C(null);try{let b=await fetch(`/api/calls/${a}/email`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:x,includeRecording:l,includeTranscript:m,includeTranslation:n})}),c=await b.json();c.success?(C({type:"success",message:`Artifacts sent to ${x}`}),y(""),setTimeout(()=>{w(!1),C(null)},3e3)):C({type:"error",message:c.error||"Failed to send email"})}catch(a){C({type:"error",message:a?.message||"Failed to send email"})}finally{A(!1)}},E=l?"recording":m?"transcript":p?"manifest":"recording";return(0,d.jsxs)("section",{"aria-labelledby":"artifact-viewer",className:"w-full bg-white rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[(0,d.jsx)("h3",{id:"artifact-viewer",className:"text-lg font-medium text-gray-800",children:"Artifacts"}),s&&(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>w(!v),className:"text-sm",children:"Email Artifacts"})]}),v&&(0,d.jsxs)("div",{className:"p-4 bg-gray-50 border-b border-gray-200",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Send all artifacts as email attachments (files, not links):"}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(u.p,{type:"email",placeholder:"recipient@example.com",value:x,onChange:a=>y(a.target.value),className:"flex-1",disabled:z}),(0,d.jsx)(r.$,{onClick:D,disabled:z||!x,className:"whitespace-nowrap",children:z?"Sending...":"Send"})]}),B&&(0,d.jsx)("p",{className:`text-sm mt-2 ${"success"===B.type?"text-green-600":"text-red-600"}`,children:B.message}),(0,d.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Includes: ",[l&&"Recording",m&&"Transcript",n&&"Translation"].filter(Boolean).join(", ")||"No artifacts"]})]}),(0,d.jsxs)(a7,{defaultValue:E,className:"w-full",children:[(0,d.jsxs)(a8,{className:"w-full border-b border-gray-200",children:[l&&(0,d.jsx)(a9,{value:"recording",children:"Recording"}),m&&(0,d.jsx)(a9,{value:"transcript",children:"Transcript"}),n&&(0,d.jsx)(a9,{value:"translation",children:"Translation"}),o&&(0,d.jsx)(a9,{value:"survey",children:"Survey"}),p&&(0,d.jsx)(a9,{value:"manifest",children:"Manifest"}),q&&(0,d.jsx)(a9,{value:"score",children:"Score"})]}),l&&(0,d.jsx)(ba,{value:"recording",className:"p-4",children:(0,d.jsx)(bb,{recordingUrl:c.recording_url,transcriptPreview:c.transcript_json?.text||null})}),m&&(0,d.jsx)(ba,{value:"transcript",className:"p-4",children:(0,d.jsx)(bd,{transcript:f})}),n&&(0,d.jsx)(ba,{value:"translation",className:"p-4",children:(0,d.jsx)(be,{translation:g,originalTranscript:f})}),o&&(0,d.jsx)(ba,{value:"survey",className:"p-4",children:(0,d.jsx)(bf,{survey:j})}),p&&(0,d.jsx)(ba,{value:"manifest",className:"p-4",children:(0,d.jsx)(bh,{manifest:h})}),q&&(0,d.jsx)(ba,{value:"score",className:"p-4",children:(0,d.jsx)(bj,{score:i})}),!l&&!m&&!n&&!o&&!p&&!q&&!t&&(0,d.jsx)("div",{className:"p-8 text-center text-slate-400",children:"No artifacts available for this call yet."}),t&&!m&&(0,d.jsx)("div",{className:"p-6 text-center",children:(0,d.jsxs)("div",{className:"inline-flex items-center gap-3 px-4 py-3 bg-blue-900/30 border border-blue-700/50 rounded-lg",children:[(0,d.jsxs)("svg",{className:"animate-spin h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-blue-300",children:"queued"===k?"Transcription queued":"Transcribing audio..."}),(0,d.jsx)("p",{className:"text-xs text-blue-400/70",children:"This typically takes 1-3 minutes"})]})]})}),"failed"===k&&!m&&(0,d.jsx)("div",{className:"p-6 text-center",children:(0,d.jsxs)("div",{className:"inline-flex items-center gap-3 px-4 py-3 bg-red-900/30 border border-red-700/50 rounded-lg",children:[(0,d.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,d.jsxs)("div",{className:"text-left",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-red-300",children:"Transcription failed"}),(0,d.jsx)("p",{className:"text-xs text-red-400/70",children:"The audio could not be transcribed"})]})]})})]})]})}function bl({transcriptJson:a}){let{sentiment_analysis:b,sentiment_summary:c,entities:e,chapters:f,utterances:g,content_safety:h,iab_categories:i}=a;return b||e||f||g?(0,d.jsxs)("div",{className:"space-y-4",children:[c&&(0,d.jsxs)("section",{"aria-label":"Sentiment Analysis",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Sentiment Analysis"}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:`inline-flex items-center justify-center w-20 h-20 rounded-full mb-3 ${"POSITIVE"===c.overall?"bg-[#E8F5E9]":"NEGATIVE"===c.overall?"bg-[#FFEBEE]":"bg-gray-100"}`,children:(0,d.jsx)("span",{className:`text-3xl ${"POSITIVE"===c.overall?"text-[#59A14F]":"NEGATIVE"===c.overall?"text-[#E15759]":"text-gray-500"}`,children:"POSITIVE"===c.overall?"\uD83D\uDE0A":"NEGATIVE"===c.overall?"\uD83D\uDE1F":"\uD83D\uDE10"})}),(0,d.jsx)("p",{className:"text-xl font-semibold text-[#333333] capitalize mb-1",children:c.overall.toLowerCase()}),(0,d.jsx)("p",{className:"text-xs text-[#666666]",children:"Overall Sentiment"})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)(bi.z,{label:"Positive",value:c.positive_percent,color:"green",showValue:!0}),(0,d.jsx)(bi.z,{label:"Neutral",value:c.neutral_percent,color:"blue",showValue:!0}),(0,d.jsx)(bi.z,{label:"Negative",value:c.negative_percent,color:"red",showValue:!0}),(0,d.jsxs)("p",{className:"text-xs text-[#999999] text-right",children:["Based on ",c.segment_count," analyzed segments"]})]})]})]}),f&&f.length>0&&(0,d.jsxs)("section",{"aria-label":"Call Topics",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Call Topics"}),(0,d.jsx)("div",{className:"space-y-3",children:f.map((a,b)=>(0,d.jsx)("div",{className:"p-4 bg-[#FAFAFA] border-l-4 border-[#4E79A7] rounded",children:(0,d.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("h4",{className:"font-medium text-[#333333] text-sm",children:a.headline}),(0,d.jsx)("p",{className:"text-sm text-[#666666] mt-1",children:a.summary})]}),(0,d.jsxs)("span",{className:"text-xs text-[#999999] whitespace-nowrap",children:[bm(a.start)," - ",bm(a.end)]})]})},b))})]}),e&&e.length>0&&(0,d.jsxs)("section",{"aria-label":"Detected Entities",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Detected Entities"}),(0,d.jsx)("div",{className:"space-y-4",children:(function(a){let b={};return a.forEach(a=>{b[a.entity_type]||(b[a.entity_type]=[]),b[a.entity_type].some(b=>b.text===a.text)||b[a.entity_type].push(a)}),Object.entries(b)})(e).map(([a,b])=>{var c;return(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-xs text-[#666666] uppercase tracking-wide mb-2",children:{person_name:"People",organization:"Companies",location:"Places",phone_number:"Phone Numbers",email_address:"Emails",date:"Dates",money_amount:"Money",occupation:"Occupations",medical_condition:"Medical",blood_type:"Medical",drug:"Medications"}[c=a]||c.replace(/_/g," ")}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:b.map((b,c)=>(0,d.jsx)("span",{className:`inline-flex items-center px-2 py-1 text-xs font-medium rounded ${{person_name:"bg-[#E3F2FD] text-[#4E79A7] border border-[#BBDEFB]",organization:"bg-[#F3E5F5] text-[#AF7AA1] border border-[#E1BEE7]",location:"bg-[#E8F5E9] text-[#59A14F] border border-[#C8E6C9]",phone_number:"bg-[#FFF8E1] text-[#F57C00] border border-[#FFE082]",email_address:"bg-[#E0F2F1] text-[#76B7B2] border border-[#B2DFDB]",date:"bg-[#FCE4EC] text-[#C2185B] border border-[#F8BBD0]",money_amount:"bg-[#E8F5E9] text-[#388E3C] border border-[#C8E6C9]"}[a]||"bg-gray-100 text-[#666666] border border-gray-200"}`,children:b.text},c))})]},a)})})]}),g&&g.length>0&&(0,d.jsxs)("section",{"aria-label":"Speaker Timeline",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Speaker Timeline"}),(0,d.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[g.slice(0,20).map((a,b)=>(0,d.jsxs)("div",{className:`flex gap-3 p-3 rounded border-l-4 ${"A"===a.speaker?"bg-[#E3F2FD] border-l-[#4E79A7]":"bg-[#F3E5F5] border-l-[#AF7AA1]"}`,children:[(0,d.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold text-white flex-shrink-0 ${"A"===a.speaker?"bg-[#4E79A7]":"bg-[#AF7AA1]"}`,children:a.speaker}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-sm text-[#333333]",children:a.text}),(0,d.jsx)("p",{className:"text-xs text-[#666666] mt-1",children:bm(a.start)})]})]},b)),g.length>20&&(0,d.jsxs)("p",{className:"text-xs text-[#999999] text-center pt-2",children:["+",g.length-20," more segments"]})]})]}),h&&h.results&&h.results.length>0&&(0,d.jsxs)("section",{"aria-label":"Content Safety",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Content Flags"}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:h.results.map((a,b)=>(0,d.jsxs)("span",{className:"inline-flex items-center px-3 py-1 bg-[#FFF8E1] text-[#F57C00] border border-[#FFE082] rounded text-sm font-medium",children:[a.label," (",Math.round(100*a.confidence),"%)"]},b))})]}),i&&i.results&&i.results.length>0&&(0,d.jsxs)("section",{"aria-label":"Topic Categories",className:"bg-white border border-[#E5E5E5] rounded p-5",children:[(0,d.jsx)("h3",{className:"text-base font-semibold text-[#333333] mb-4",children:"Topic Categories"}),(0,d.jsx)("div",{className:"flex flex-wrap gap-2",children:i.results.slice(0,10).map((a,b)=>(0,d.jsx)("span",{className:"inline-flex items-center px-3 py-1 bg-gray-100 text-[#666666] border border-gray-200 rounded text-sm",title:`Relevance: ${Math.round(100*a.relevance)}%`,children:a.label.split(">").pop()?.trim()||a.label},b))})]})]}):(0,d.jsxs)("div",{className:"p-6 bg-white border border-[#E5E5E5] rounded text-center",children:[(0,d.jsx)("p",{className:"text-sm text-[#666666] mb-2",children:"Analytics not available for this call"}),(0,d.jsx)("p",{className:"text-xs text-[#999999]",children:"Enable transcription to unlock AI-powered insights"})]})}function bm(a){let b=Math.floor(a/1e3),c=Math.floor(b/60);return`${c}:${(b%60).toString().padStart(2,"0")}`}let bn={agreed:{label:"Agreed",description:"All parties agreed on the terms",icon:"âœ“",color:"bg-green-100 text-green-800"},declined:{label:"Declined",description:"Customer/party declined the offer",icon:"âœ—",color:"bg-red-100 text-red-800"},partial:{label:"Partial Agreement",description:"Some items agreed, some not",icon:"â—",color:"bg-yellow-100 text-yellow-800"},inconclusive:{label:"Inconclusive",description:"No clear outcome from the call",icon:"?",color:"bg-gray-100 text-gray-800"},pending_review:{label:"Pending Review",description:"Needs management review",icon:"â³",color:"bg-blue-100 text-blue-800"},follow_up_required:{label:"Follow-up Required",description:"Requires a follow-up call",icon:"â†»",color:"bg-purple-100 text-purple-800"}},bo={high:{label:"High Confidence",description:"Clear, explicit agreement or decline",color:"bg-green-100 text-green-800"},medium:{label:"Medium Confidence",description:"Somewhat implicit or ambiguous",color:"bg-yellow-100 text-yellow-800"},low:{label:"Low Confidence",description:"Many uncertainties, needs review",color:"bg-orange-100 text-orange-800"},disputed:{label:"Disputed",description:"Parties disagree on the outcome",color:"bg-red-100 text-red-800"}};function bp({callId:a,organizationId:b,callCompleted:c,existingOutcome:f,onOutcomeSaved:g,enableAISummary:h=!0}){let[i,j]=(0,e.useState)(f?.outcomeStatus||"inconclusive"),[k,l]=(0,e.useState)(f?.confidenceLevel||"high"),[m,n]=(0,e.useState)(f?.summaryText||""),[o,p]=(0,e.useState)(f?.summarySource||"human"),[q,s]=(0,e.useState)(f?.readbackConfirmed||!1),[t,u]=(0,e.useState)(f?.agreedItems||[]),[v,w]=(0,e.useState)(f?.declinedItems||[]),[x,y]=(0,e.useState)(f?.ambiguities||[]),[z,A]=(0,e.useState)(f?.followUpActions||[]),[B,C]=(0,e.useState)(!f),[D,E]=(0,e.useState)(!1),[F,G]=(0,e.useState)(!1),[H,I]=(0,e.useState)(!1),[J,K]=(0,e.useState)(null),[L,M]=(0,e.useState)(""),[N,O]=(0,e.useState)(""),[P,Q]=(0,e.useState)(""),[R,S]=(0,e.useState)(""),T=(0,e.useCallback)(async()=>{G(!0),K(null),I(!1);try{let b=await fetch(`/api/calls/${a}/summary`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({use_call_transcript:!0,include_structured_extraction:!0})});if(!b.ok){let a=await b.json();throw Error(a.error?.message||"Failed to generate summary")}let c=(await b.json()).data;n(c.summary_text),p("ai_generated"),I(!0),c.potential_agreements?.length>0&&u(c.potential_agreements.map(a=>({term:a,confirmed:!1}))),c.potential_concerns?.length>0&&y(c.potential_concerns.map(a=>({issue:a}))),c.recommended_followup?.length>0&&A(c.recommended_followup.map(a=>({action:a})))}catch(a){K(a.message||"Failed to generate AI summary")}finally{G(!1)}},[a]),U=(0,e.useCallback)(async()=>{E(!0),K(null);try{let b="ai_generated"===o?"ai_confirmed":o,c=await fetch(`/api/calls/${a}/outcome`,{method:f?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({outcome_status:i,confidence_level:k,agreed_items:t,declined_items:v,ambiguities:x,follow_up_actions:z,summary_text:m,summary_source:b,readback_confirmed:q})});if(!c.ok){let a=await c.json();throw Error(a.error?.message||"Failed to save outcome")}let d=await c.json();g&&g(d.data.outcome),C(!1),I(!1)}catch(a){K(a.message||"Failed to save outcome declaration")}finally{E(!1)}},[a,f,i,k,t,v,x,z,m,o,q,g]),V=()=>{L.trim()&&(u([...t,{term:L.trim(),confirmed:!0}]),M(""))},W=()=>{N.trim()&&(w([...v,{term:N.trim()}]),O(""))},X=()=>{P.trim()&&(y([...x,{issue:P.trim()}]),Q(""))},Y=()=>{R.trim()&&(A([...z,{action:R.trim()}]),S(""))};if(!c)return null;if(!B&&f){let a=bn[f.outcomeStatus]||bn.inconclusive;return(0,d.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:(0,d.jsxs)("div",{className:"p-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-lg ${a.color}`,children:a.icon}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"font-semibold text-gray-900",children:"Outcome Declared"}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:a.label})]})]}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>C(!0),children:"Edit"})]}),f.summaryText&&(0,d.jsxs)("p",{className:"mt-3 text-sm text-gray-600 border-t border-gray-100 pt-3",children:[f.summaryText.slice(0,200),f.summaryText.length>200?"...":""]})]})})}return(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,d.jsx)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"font-semibold text-gray-900",children:"Declare Outcome"}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Record what was agreed, declined, or left unclear"})]}),f&&(0,d.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>C(!1),children:"Cancel"})]})}),(0,d.jsxs)("div",{className:"p-4 space-y-6",children:[J&&(0,d.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-sm text-red-700",children:J}),H&&(0,d.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-md",children:[(0,d.jsx)("p",{className:"text-sm text-amber-800 font-medium",children:"AI-Generated Summary - Requires Human Review"}),(0,d.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"This summary was generated by AI. Please review carefully and edit if needed before confirming."})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Outcome Status ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Object.keys(bn).map(a=>{let b=bn[a];return(0,d.jsx)("button",{onClick:()=>j(a),className:`
                    p-3 rounded-md border text-left transition-colors
                    ${i===a?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-gray-300"}
                  `,children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm ${b.color}`,children:b.icon}),(0,d.jsx)("span",{className:"font-medium text-gray-900 text-sm",children:b.label})]})},a)})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confidence Level"}),(0,d.jsx)("div",{className:"flex gap-2 flex-wrap",children:Object.keys(bo).map(a=>{let b=bo[a];return(0,d.jsx)("button",{onClick:()=>l(a),className:`
                    px-3 py-1.5 rounded-md text-sm font-medium transition-colors
                    ${k===a?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
                  `,children:b.label},a)})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What Was Agreed"}),(0,d.jsxs)("div",{className:"space-y-2",children:[t.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-md",children:[(0,d.jsx)("span",{className:"text-green-600",children:"âœ“"}),(0,d.jsx)("span",{className:"flex-1 text-sm text-gray-900",children:a.term}),(0,d.jsx)("button",{onClick:()=>u(t.filter((a,c)=>c!==b)),className:"text-gray-400 hover:text-red-500",children:"\xd7"})]},b)),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("input",{type:"text",value:L,onChange:a=>M(a.target.value),onKeyDown:a=>"Enter"===a.key&&V(),placeholder:"Add agreed item...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:V,children:"Add"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What Was Declined / Not Agreed"}),(0,d.jsxs)("div",{className:"space-y-2",children:[v.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-red-50 rounded-md",children:[(0,d.jsx)("span",{className:"text-red-600",children:"âœ—"}),(0,d.jsx)("span",{className:"flex-1 text-sm text-gray-900",children:a.term}),(0,d.jsx)("button",{onClick:()=>w(v.filter((a,c)=>c!==b)),className:"text-gray-400 hover:text-red-500",children:"\xd7"})]},b)),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("input",{type:"text",value:N,onChange:a=>O(a.target.value),onKeyDown:a=>"Enter"===a.key&&W(),placeholder:"Add declined item...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:W,children:"Add"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ambiguities / Unclear Items"}),(0,d.jsxs)("div",{className:"space-y-2",children:[x.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 rounded-md",children:[(0,d.jsx)("span",{className:"text-yellow-600",children:"?"}),(0,d.jsx)("span",{className:"flex-1 text-sm text-gray-900",children:a.issue}),(0,d.jsx)("button",{onClick:()=>y(x.filter((a,c)=>c!==b)),className:"text-gray-400 hover:text-red-500",children:"\xd7"})]},b)),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("input",{type:"text",value:P,onChange:a=>Q(a.target.value),onKeyDown:a=>"Enter"===a.key&&X(),placeholder:"Add ambiguity...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:X,children:"Add"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Follow-up Actions"}),(0,d.jsxs)("div",{className:"space-y-2",children:[z.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-md",children:[(0,d.jsx)("span",{className:"text-blue-600",children:"â†’"}),(0,d.jsx)("span",{className:"flex-1 text-sm text-gray-900",children:a.action}),(0,d.jsx)("button",{onClick:()=>A(z.filter((a,c)=>c!==b)),className:"text-gray-400 hover:text-red-500",children:"\xd7"})]},b)),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)("input",{type:"text",value:R,onChange:a=>S(a.target.value),onKeyDown:a=>"Enter"===a.key&&Y(),placeholder:"Add follow-up action...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm"}),(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:Y,children:"Add"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Summary"}),h&&(0,d.jsx)(r.$,{variant:"outline",size:"sm",onClick:T,disabled:F,children:F?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("svg",{className:"w-4 h-4 mr-1.5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Generating..."]}):"âœ¨ Generate AI Summary"})]}),(0,d.jsx)("textarea",{value:m,onChange:a=>{n(a.target.value),"ai_generated"===o&&(p("human"),I(!1))},placeholder:"Enter a summary of the call outcome...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm resize-none",rows:4}),"human"!==o&&(0,d.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Summary source: ","ai_generated"===o?"AI-generated (pending confirmation)":"AI-confirmed"]})]}),(0,d.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-md",children:[(0,d.jsx)("input",{type:"checkbox",id:"readback-confirmed",checked:q,onChange:a=>s(a.target.checked),className:"mt-1"}),(0,d.jsxs)("label",{htmlFor:"readback-confirmed",className:"text-sm text-gray-700",children:[(0,d.jsx)("span",{className:"font-medium",children:"Read-back Confirmed"}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Check if the summary was read back to the customer and they confirmed it was accurate."})]})]}),(0,d.jsx)("div",{className:"p-3 bg-blue-50 border border-blue-100 rounded-md",children:(0,d.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,d.jsx)("strong",{children:"Reminder:"})," You are declaring the outcome. The system records your declaration. AI may assist with summary generation, but you are responsible for verifying accuracy."]})})]}),(0,d.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex gap-2 justify-end",children:[f&&(0,d.jsx)(r.$,{variant:"outline",onClick:()=>C(!1),disabled:D,children:"Cancel"}),(0,d.jsx)(r.$,{onClick:U,disabled:D,className:"bg-primary-600 hover:bg-primary-700 text-white",children:D?"Saving...":f?"Update Outcome":"Declare Outcome"})]})]})}function bq({callId:a,organizationId:b,onModulationChange:c}){let{call:f,recording:h,transcript:i,translation:j,manifest:k,score:l,survey:m,transcriptionStatus:n,loading:o,error:p}=function(a){let[b,c]=(0,e.useState)(null),[d,f]=(0,e.useState)(!0),[g,h]=(0,e.useState)(null);(0,e.useRef)(null);let i=(0,e.useRef)(!0),j=(0,e.useCallback)(async(b=!1)=>{if(!a)return null;try{b&&(f(!0),h(null));let d=await fetch(`/api/calls/${encodeURIComponent(a)}`,{credentials:"include"});if(!d.ok){let b=await fetch(`/api/calls/getCallStatus?callId=${encodeURIComponent(a)}`,{credentials:"include"});if(!b.ok)throw Error("Failed to fetch call details");let d=await b.json(),e={call:d.call||null,recording:d.recording||null,transcript:d.recording?.transcript_json||null,translation:null,manifest:d.evidence_manifest||null,score:null,survey:null,transcriptionStatus:null};return i.current&&c(e),e}let e=await d.json();return i.current&&c(e),e}catch(a){return i.current&&(h(a?.message||"Failed to load call details"),c(null)),null}finally{b&&i.current&&f(!1)}},[a]),k=(0,e.useCallback)(()=>j(!0),[j]);return{call:b?.call||null,recording:b?.recording||null,transcript:b?.transcript||null,translation:b?.translation||null,manifest:b?.manifest||null,score:b?.score||null,survey:b?.survey||null,transcriptionStatus:b?.transcriptionStatus||null,loading:d,error:g,refetch:k}}(a),{config:q}=(0,g.g)(b),{toast:t}=(0,a5.dj)(),[u,v]=(0,e.useState)(!1),[w,x]=(0,e.useState)(null),[y,z]=(0,e.useState)(!1);(0,e.useCallback)(async()=>{if(a){z(!0);try{let b=await fetch(`/api/calls/${a}/outcome`,{method:"GET",credentials:"include"});if(b.ok){let a=await b.json();a.success&&a.data.outcome&&x(a.data.outcome)}}catch(a){console.debug("No existing outcome found")}finally{z(!1)}}},[a]);let A=(0,e.useCallback)(a=>{x(a),t({title:"Outcome Declared",description:"Call outcome has been recorded successfully"})},[t]);async function B(){if(a)try{v(!0);let b=await fetch(`/api/calls/${a}/export`,{method:"GET",credentials:"include"});if(!b.ok){let a=await b.json().catch(()=>({error:"Export failed"}));throw Error(a.error||"Failed to export evidence")}let c=await b.blob(),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`evidence-${a.slice(0,8)}.zip`,document.body.appendChild(e),e.click(),window.URL.revokeObjectURL(d),document.body.removeChild(e),t({title:"Evidence Downloaded",description:"Complete evidence bundle exported successfully"})}catch(a){t({title:"Export Failed",description:a?.message||"Failed to download evidence bundle",variant:"destructive"})}finally{v(!1)}}if(!a)return(0,d.jsx)("div",{className:"flex items-center justify-center py-12 text-gray-400",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("svg",{className:"w-12 h-12 mx-auto mb-3 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,d.jsx)("p",{className:"text-sm",children:"Select a call to view details"})]})});if(o)return(0,d.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,d.jsx)("div",{className:"loading-spinner"}),(0,d.jsx)("span",{className:"ml-3 text-gray-500",children:"Loading call details..."})]});if(p)return(0,d.jsxs)("div",{className:"p-4 bg-error-light border border-red-200 rounded-md text-error",children:["Error: ",p]});if(!f)return(0,d.jsx)("div",{className:"p-4 bg-gray-50 rounded-md text-gray-500 text-center",children:"Call not found"});let C="completed"===f.status?"success":"failed"===f.status||"no-answer"===f.status||"busy"===f.status?"error":(f.status,"default");return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("section",{"aria-labelledby":"call-header",className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{id:"call-header",className:"text-lg font-semibold text-gray-900 mb-2",children:"Call Details"}),(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,d.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide",children:"Status:"}),(0,d.jsx)(s.E,{variant:C,children:f.status||"unknown"})]}),(0,d.jsxs)("div",{className:"text-xs text-gray-400 font-mono",children:["ID: ",f.id.slice(0,8),"..."]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 mb-1 uppercase tracking-wide",children:"Duration"}),(0,d.jsx)("div",{className:"text-lg font-mono text-gray-900 tabular-nums",children:((a,b)=>{if(!a)return"â€”";if(!b)return"In progress...";let c=new Date(a),d=Math.floor((new Date(b).getTime()-c.getTime())/1e3),e=Math.floor(d/60);return`${e}:${(d%60).toString().padStart(2,"0")}`})(f.started_at,f.ended_at)}),l&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 mb-1 uppercase tracking-wide",children:"Score"}),(0,d.jsxs)(s.E,{variant:l.score>=80?"success":l.score>=60?"warning":"error",children:[l.score,"%"]})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm border-t border-gray-100 pt-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Started"}),(0,d.jsx)("div",{className:"text-gray-900",children:f.started_at?new Date(f.started_at).toLocaleString():"â€”"})]}),f.ended_at&&(0,d.jsxs)("div",{children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-1",children:"Ended"}),(0,d.jsx)("div",{className:"text-gray-900",children:new Date(f.ended_at).toLocaleString()})]})]})]}),(0,d.jsxs)("section",{"aria-label":"Quick actions",className:"flex flex-wrap gap-2",children:["completed"===f.status&&(0,d.jsx)(a4(),{href:`/review?callId=${f.id}`,children:(0,d.jsxs)(r.$,{variant:"outline",size:"sm",className:"gap-1.5",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Review Evidence"]})}),"completed"===f.status&&(0,d.jsx)(r.$,{variant:"outline",size:"sm",className:"gap-1.5",onClick:B,disabled:u,children:u?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("svg",{className:"w-4 h-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Exporting..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Download Evidence"]})}),h?.recording_url&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{document.getElementById("artifact-recording")?.scrollIntoView({behavior:"smooth"})},className:"gap-1.5",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"Recording"]}),i&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{document.getElementById("artifact-transcript")?.scrollIntoView({behavior:"smooth"})},className:"gap-1.5",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Transcript"]}),i?.sentiment_analysis&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{document.getElementById("call-analytics")?.scrollIntoView({behavior:"smooth"})},className:"gap-1.5",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Analytics"]}),k&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{document.getElementById("artifact-manifest")?.scrollIntoView({behavior:"smooth"})},className:"gap-1.5",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Manifest"]})]}),["completed","failed","no-answer","busy","in_progress"].includes(f.status||"")&&b&&(0,d.jsx)("section",{"aria-label":"Outcome Declaration",children:(0,d.jsx)(bp,{callId:f.id,organizationId:b,callCompleted:["completed","failed","no-answer","busy"].includes(f.status||""),existingOutcome:w,onOutcomeSaved:A,enableAISummary:!0})}),i&&(i.sentiment_analysis||i.entities||i.chapters)&&(0,d.jsx)("section",{id:"call-analytics","aria-label":"Call Analytics",children:(0,d.jsx)(bl,{transcriptJson:i})}),b&&(0,d.jsxs)("section",{"aria-labelledby":"modulations-used",className:"p-4 bg-white rounded-md border border-gray-200",children:[(0,d.jsx)("h3",{id:"modulations-used",className:"text-sm font-semibold text-gray-900 mb-3",children:"Features Used for This Call"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[(0,d.jsx)(br,{label:"Recording",enabled:q?.record}),(0,d.jsx)(br,{label:"Transcribe",enabled:q?.transcribe}),(0,d.jsx)(br,{label:"Translate",enabled:q?.translate}),(0,d.jsx)(br,{label:"Survey",enabled:q?.survey}),(0,d.jsx)(br,{label:"Shopper",enabled:q?.synthetic_caller})]}),(0,d.jsx)("p",{className:"text-xs text-gray-400 mt-3 italic",children:"These are the features that were active when this call was placed."})]}),(0,d.jsx)(bk,{callId:f.id,recording:h,transcript:i,translation:j,manifest:k,score:l,survey:m,transcriptionStatus:n})]})}function br({label:a,enabled:b}){return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[b?(0,d.jsx)("svg",{className:"w-4 h-4 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):(0,d.jsx)("svg",{className:"w-4 h-4 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,d.jsx)("circle",{cx:"12",cy:"12",r:"3"})}),(0,d.jsx)("span",{className:"text-xs text-gray-600",children:a})]})}function bs({children:a,className:b="",label:c,error:e,hint:f,id:g,...h}){let i=g||`select-${Math.random().toString(36).substring(2,11)}`,j=e?`${i}-error`:void 0,k=f&&!e?`${i}-hint`:void 0;return(0,d.jsxs)("div",{className:"w-full",children:[c&&(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",htmlFor:i,children:c}),(0,d.jsx)("select",{id:i,className:`w-full h-10 px-3 bg-white border rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-0 transition-colors duration-150 disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed ${e?"border-error focus:ring-error focus:border-error":"border-gray-300 focus:ring-primary-600 focus:border-primary-600"} ${b}`,"aria-invalid":e?"true":void 0,"aria-describedby":e?j:f?k:void 0,...h,children:a}),f&&!e&&(0,d.jsx)("p",{id:k,className:"mt-1.5 text-sm text-gray-500",children:f}),e&&(0,d.jsx)("p",{id:j,className:"mt-1.5 text-sm text-error",role:"alert",children:e})]})}function bt({open:a,onOpenChange:b,title:c,children:f,footer:g}){let h=(0,e.useRef)(null);return a?(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",role:"dialog","aria-modal":"true","aria-labelledby":c?"dialog-title":void 0,children:(0,d.jsxs)("div",{ref:h,className:"bg-slate-900 border border-slate-800 rounded-lg shadow-lg max-w-lg w-full mx-4 max-h-[90vh] overflow-auto",children:[c&&(0,d.jsx)("div",{className:"px-6 py-4 border-b border-slate-800",children:(0,d.jsx)("h2",{id:"dialog-title",className:"text-lg font-semibold text-slate-100",children:c})}),(0,d.jsx)("div",{className:"px-6 py-4",children:f}),g&&(0,d.jsx)("div",{className:"px-6 py-4 border-t border-slate-800 flex justify-end gap-2",children:g})]})}):null}function bu({organizationId:a}){let{config:b,loading:c,updateConfig:f}=(0,g.g)(a),{role:h}=(0,q.e)(a),{toast:i}=(0,a5.dj)(),{targetNumber:j,setTargetNumber:k}=n(),[l,m]=(0,e.useState)([]),[o,p]=(0,e.useState)([]),[s,t]=(0,e.useState)(!0),[v,w]=(0,e.useState)(!1),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)({phone_number:"",name:""}),[B,C]=(0,e.useState)(""),[D,E]=(0,e.useState)(!1),[F,G]=(0,e.useState)(!1),H=(0,e.useRef)(null),I=(0,e.useRef)(null),J="owner"===h||"admin"===h,K=l.filter(a=>a.is_active&&(a.phone_number.includes(j)||a.name?.toLowerCase().includes(j.toLowerCase()))).slice(0,5),L=a=>/^\+[1-9]\d{1,14}$/.test(a),M=L(j),N=a=>{let b=a.replace(/[^\d+]/g,"");return b.length>0&&!b.startsWith("+")&&(b.startsWith("1")&&b.length>10&&(b=b.slice(1)),b="+1"+b),b};async function O(){if(a&&J){if(!L(z.phone_number))return void i({title:"Invalid phone number",description:"Phone number must be in E.164 format (e.g., +12025551234)",variant:"destructive"});try{w(!0);let b=await fetch("/api/voice/targets",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({organization_id:a,phone_number:z.phone_number,name:z.name||void 0})}),c=await b.json();if(c.success&&c.target)m([...l,c.target]),0===l.length&&await f({target_id:c.target.id}),y(!1),A({phone_number:"",name:""}),i({title:"Target saved",description:`Added ${c.target.phone_number} to your targets.`});else throw Error(c.error?.message||c.error||"Failed to add target")}catch(a){i({title:"Error",description:a?.message||"Failed to add target",variant:"destructive"})}finally{w(!1)}}}return s||c?(0,d.jsx)("div",{className:"p-4 bg-white rounded-lg border border-[#E5E5E5]",children:(0,d.jsxs)("div",{className:"animate-pulse space-y-3",children:[(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,d.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]})}):(0,d.jsxs)("section",{"aria-labelledby":"target-campaign-selector",className:"w-full p-4 bg-white rounded-lg border border-[#E5E5E5] shadow-sm","data-tour":"target-selector",children:[(0,d.jsx)("h3",{id:"target-campaign-selector",className:"text-base font-semibold text-[#333333] mb-1",children:"Who are you calling?"}),(0,d.jsx)("p",{className:"text-xs text-[#666666] mb-4",children:"Enter a phone number or select from recent targets"}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("label",{className:"block text-sm font-medium text-[#333333] mb-1.5",children:["Phone Number to Call ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-lg text-gray-400",children:"+"}),(0,d.jsx)("input",{ref:H,type:"tel",inputMode:"tel",autoComplete:"off",value:j,onChange:a=>{var b;let c;return c=b=a.target.value,void(/^\d{10,}$/.test(b.replace(/\D/g,""))&&!b.startsWith("+")&&(c=N(b)),k(c),E(c.length>0&&K.length>0),L(c)&&f({quick_dial_number:c,target_id:null}))},onBlur:()=>{if(j&&!j.startsWith("+")){let a=N(j);k(a),L(a)&&f({quick_dial_number:a,target_id:null})}},onFocus:()=>E(j.length>0&&K.length>0),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),H.current?.blur())},placeholder:"(202) 555-1234 or +12025551234",className:`
                w-full pl-10 pr-4 py-3 text-lg font-mono rounded-lg border-2 transition-all
                focus:outline-none focus:ring-2 focus:ring-offset-1
                ${M?"border-green-400 focus:ring-green-300 bg-green-50":j.length>0?"border-amber-300 focus:ring-amber-200":"border-gray-200 focus:ring-primary-300 focus:border-primary-400"}
              `,"aria-describedby":"target-hint","aria-expanded":D,"aria-autocomplete":"list"}),M&&(0,d.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-green-500",children:"âœ“"})]}),D&&K.length>0&&(0,d.jsxs)("div",{ref:I,className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg overflow-hidden",children:[(0,d.jsx)("div",{className:"text-xs text-gray-500 px-3 py-1.5 bg-gray-50 border-b",children:"Recent Targets"}),K.map(a=>(0,d.jsxs)("button",{type:"button",onClick:()=>{k(a.phone_number),E(!1),f({target_id:a.id,quick_dial_number:null}),i({title:"Target selected",description:a.name?`${a.name} (${a.phone_number})`:a.phone_number})},className:"w-full px-3 py-2 text-left hover:bg-primary-50 transition-colors flex items-center justify-between group",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-mono text-gray-900",children:a.phone_number}),a.name&&(0,d.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:a.name})]}),(0,d.jsx)("span",{className:"text-xs text-primary-600 opacity-0 group-hover:opacity-100",children:"Select"})]},a.id))]}),(0,d.jsx)("p",{id:"target-hint",className:"text-xs text-[#666666] mt-1",children:j&&!M?"Include + and country code (e.g., +1 for US)":"E.164 format with country code"})]}),M&&(0,d.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,d.jsxs)("div",{className:"text-sm text-green-800 flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-lg",children:"âœ“"}),(0,d.jsxs)("span",{children:["Ready to call ",(0,d.jsx)("span",{className:"font-mono font-bold",children:j})]})]}),B&&L(B)&&(0,d.jsxs)("div",{className:"text-xs text-green-700 mt-1 ml-6",children:["Bridge call via ",B]})]}),(0,d.jsxs)("details",{className:"group border border-gray-200 rounded-lg",open:F,onToggle:a=>G(a.target.open),children:[(0,d.jsxs)("summary",{className:"px-4 py-3 cursor-pointer text-sm font-medium text-gray-600 hover:text-gray-800 flex items-center justify-between list-none",children:[(0,d.jsxs)("span",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-gray-400 group-open:rotate-90 transition-transform",children:"â–¶"}),"Advanced Options"]}),(B||b?.campaign_id)&&(0,d.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:[B?"Bridge":"",b?.campaign_id?"Campaign":""].filter(Boolean).join(" + ")})]}),(0,d.jsxs)("div",{className:"px-4 pb-4 space-y-4 border-t border-gray-100 pt-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-[#333333]",children:"Call me first at"}),(0,d.jsx)("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:"Bridge Call"})]}),(0,d.jsx)(u.p,{type:"tel",inputMode:"tel",autoComplete:"off",value:B,onChange:a=>{var b;C(b=a.target.value),(!b||L(b))&&f({from_number:b||null})},onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),a.target.blur())},placeholder:"+12025551234",className:"font-mono"}),(0,d.jsxs)("p",{className:"text-xs text-[#666666] mt-1.5 leading-relaxed",children:[(0,d.jsx)("strong",{children:"How it works:"})," We'll call your phone first. When you answer, we connect you to the target number. This keeps you in control and ensures the call is recorded from your end."]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(bs,{label:"Campaign",value:b?.campaign_id||"",onChange:a=>{J&&f({campaign_id:a.target.value||null})},disabled:!J,children:[(0,d.jsx)("option",{value:"",children:"None (single call)"}),o.filter(a=>a.is_active).map(a=>(0,d.jsx)("option",{value:a.id,children:a.name},a.id))]}),(0,d.jsx)("p",{className:"text-xs text-[#666666] mt-1",children:"Group calls under a campaign for reporting"})]}),J&&j&&M&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{A({phone_number:j,name:""}),y(!0)},className:"w-full",children:["\uD83D\uDCBE Save ",j," to Targets"]})]})]}),!J&&(0,d.jsx)("p",{className:"text-xs text-[#666666] italic",children:"Only Owners and Admins can modify target settings."})]}),(0,d.jsxs)(bt,{open:x,onOpenChange:y,title:"Save Target",children:[(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)(u.p,{label:"Phone Number",type:"tel",value:z.phone_number,onChange:a=>A({...z,phone_number:a.target.value}),placeholder:"+12025551234",required:!0}),(0,d.jsx)(u.p,{label:"Name (makes it easier to find later)",value:z.name,onChange:a=>A({...z,name:a.target.value}),placeholder:"e.g., Main Support Line"})]}),(0,d.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,d.jsx)(r.$,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),(0,d.jsx)(r.$,{onClick:O,disabled:v||!z.phone_number,children:v?"Saving...":"Save Target"})]})]})]})}function bv({organizationId:a,onCallPlaced:b}){let{role:c}=(0,q.e)(a),f=(0,q.J)(a,"call","execute"),{config:h,updateConfig:i}=(0,g.g)(a),{toast:j}=(0,a5.dj)(),{updates:k,connected:l}=(0,a1.x)(a),[m,n]=(0,e.useState)(!1),[o,p]=(0,e.useState)(null),[t,u]=(0,e.useState)(null),[v,w]=(0,e.useState)(0),x=(0,e.useRef)(!1);(0,e.useRef)(null);let y=h?.target_id||h?.quick_dial_number,z=h?.quick_dial_number||(h?.target_id?`Target: ${h.target_id.slice(0,8)}...`:null),A=h?.from_number||null;async function B(){if(!x.current){if(!a||!f||!y)return void j({title:"Cannot place call",description:"Enter a phone number or select a target first",variant:"destructive"});try{x.current=!0,n(!0),u("initiating");let c={organization_id:a,campaign_id:h.campaign_id||null,modulations:{record:h.record||!1,transcribe:h.transcribe||!1,translate:h.translate||!1,survey:h.survey||!1,synthetic_caller:h.synthetic_caller||!1}};h.quick_dial_number?c.to_number=h.quick_dial_number:h.target_id&&(c.target_id=h.target_id),h.from_number&&(c.from_number=h.from_number,c.flow_type="bridge");let d=await fetch("/api/voice/call",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(c)});if(!d.ok){let a=await d.json().catch(()=>({error:"Failed to place call"})),b="object"==typeof a.error?a.error?.message||a.error?.code||JSON.stringify(a.error):a.error||"Failed to place call";throw Error(b)}let e=(await d.json()).call_id;p(e),u("ringing"),w(0),b?.(e),j({title:"Call placed",description:`Call ${e.slice(0,8)}... is being initiated`})}catch(a){u(null),j({title:"Error",description:a?.message||"Failed to place call",variant:"destructive"})}finally{n(!1),x.current=!1}}}h?.from_number;let C="completed"===t?"success":"failed"===t||"no-answer"===t||"busy"===t?"error":"in_progress"===t?"success":"ringing"===t?"warning":"default";return f?(0,d.jsx)("section",{className:"bg-white rounded-md border border-gray-200 p-6",children:(0,d.jsxs)("div",{className:"space-y-4",children:[y&&(0,d.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,d.jsx)("span",{className:"font-medium",children:"Calling:"})," ",(0,d.jsx)("span",{className:"font-mono",children:z})]}),A&&(0,d.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:["Agent phone: ",(0,d.jsx)("span",{className:"font-mono",children:A}),(0,d.jsx)("span",{className:"text-xs ml-2",children:"(bridge call)"})]})]}),(0,d.jsx)(r.$,{type:"button",onClick:a=>{a.preventDefault(),a.stopPropagation(),B()},disabled:m||!y||null!==o,variant:"primary",size:"lg",className:"w-full h-14 text-base","aria-label":"Place call",children:m?(0,d.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,d.jsxs)("svg",{className:"w-5 h-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Placing Call..."]}):o?"Call in Progress":"Place Call"}),o&&t&&(0,d.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"Status"}),(0,d.jsx)(s.E,{variant:C,children:t})]}),"in_progress"===t&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"Duration"}),(0,d.jsx)("span",{className:"text-sm font-mono text-gray-900",children:(a=>{let b=Math.floor(a/60);return`${b}:${(a%60).toString().padStart(2,"0")}`})(v)})]}),(0,d.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:["ID: ",o.slice(0,8),"..."]}),!l&&(0,d.jsx)("div",{className:"mt-2 text-xs text-warning",children:"Real-time updates disconnected"})]}),!y&&(0,d.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Enter a phone number above to place a call"})]})}):(0,d.jsx)("div",{className:"bg-white rounded-md border border-gray-200 p-4",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Only Owners, Admins, and Operators can place calls."})})}f().forwardRef(({className:a,children:b,...c},e)=>(0,d.jsx)("div",{ref:e,className:`${a||""}`,...c,children:b})).displayName="DialogContent",f().forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:`flex flex-col space-y-1.5 text-center sm:text-left ${a||""}`,...b})).displayName="DialogHeader",f().forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:`flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 ${a||""}`,...b})).displayName="DialogFooter",f().forwardRef(({className:a,...b},c)=>(0,d.jsx)("h2",{ref:c,className:`text-lg font-semibold leading-none tracking-tight ${a||""}`,...b})).displayName="DialogTitle",f().forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:`text-sm text-muted-foreground ${a||""}`,...b})).displayName="DialogDescription";let bw=function({organizationId:a,onCallPlaced:b}){let c=k(),{config:f}=(0,g.g)(a),{toast:h}=(0,a5.dj)(),{targetNumber:i,isValid:j}=n(),{connect:l,disconnect:m,makeCall:o,hangUp:p,mute:q,unmute:t,status:u,callState:v,currentCall:w,isMuted:x,quality:y,error:z}=c,A=f?.quick_dial_number||f?.target_id,B=f?.quick_dial_number||(f?.target_id?`Target: ${f.target_id.slice(0,8)}...`:null),C=(0,e.useCallback)(async()=>{try{await l(),h({title:"Connected",description:"WebRTC is ready for browser calling"})}catch(a){h({title:"Connection Failed",description:a?.message||"Could not connect to WebRTC",variant:"destructive"})}},[l,h]),D=(0,e.useCallback)(async()=>{try{await m(),h({title:"Disconnected",description:"WebRTC session ended"})}catch(a){}},[m,h]),E=(0,e.useCallback)(async()=>{if(!j)return void h({title:"Invalid phone number",description:"Please enter a valid phone number in E.164 format (starts with +)",variant:"destructive"});console.log("[WebRTCCallControls] Attempting call with:",{phoneNumber:i,hasValidNumber:j});try{await o(i),w?.id&&b?.(w.id)}catch(a){h({title:"Call Failed",description:a?.message||"Could not place call",variant:"destructive"})}},[j,i,f,o,w,b,h]),F=(0,e.useCallback)(async()=>{try{await p()}catch(a){}},[p]);return"disconnected"===u||"error"===u?(0,d.jsx)("section",{className:"bg-white rounded-md border border-gray-200 p-6",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center mb-3",children:(0,d.jsx)("svg",{className:"w-6 h-6 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"})})}),(0,d.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"Browser Calling"}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mb-4",children:"Connect to enable calling from your browser using your computer's microphone."})]}),(0,d.jsxs)(r.$,{onClick:C,variant:"primary",size:"lg",className:"w-full h-14 text-base",children:[(0,d.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"})}),"Connect Microphone"]}),z&&(0,d.jsx)("p",{className:"text-sm text-error text-center",children:z})]})}):"initializing"===u||"connecting"===u?(0,d.jsx)("section",{className:"bg-white rounded-md border border-gray-200 p-6",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"mx-auto w-12 h-12 rounded-full bg-primary-50 flex items-center justify-center mb-3 animate-pulse",children:(0,d.jsxs)("svg",{className:"w-6 h-6 text-primary-500 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,d.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"Connecting..."}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Requesting microphone access and connecting to SignalWire"})]})}):(0,d.jsx)("section",{className:"bg-white rounded-md border border-gray-200 p-6",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:"w-2 h-2 rounded-full bg-success animate-pulse"}),(0,d.jsx)("span",{className:"text-sm text-gray-600",children:"Browser connected"})]}),(0,d.jsx)("button",{onClick:D,className:"text-xs text-gray-500 hover:text-gray-700 underline",children:"Disconnect"})]}),A&&"idle"===v&&(0,d.jsx)("div",{className:"p-4 bg-gray-50 rounded-md border border-gray-200",children:(0,d.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,d.jsx)("span",{className:"font-medium",children:"Calling:"})," ",(0,d.jsx)("span",{className:"font-mono",children:B})]})}),w&&(0,d.jsxs)("div",{className:"p-4 bg-success-light rounded-md border border-success/20",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium text-success-dark",children:"Active Call"}),(0,d.jsx)(s.E,{variant:"success",children:v})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-600 font-mono",children:w.phone_number}),(0,d.jsx)("span",{className:"text-lg font-mono text-gray-900 tabular-nums",children:(a=>{let b=Math.floor(a/60);return`${b}:${(a%60).toString().padStart(2,"0")}`})(w.duration)})]}),y&&(0,d.jsxs)("div",{className:"mt-3 pt-3 border-t border-success/10 grid grid-cols-2 gap-2 text-xs",children:[y.audio_bitrate&&(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-gray-500",children:"Bitrate:"})," ",(0,d.jsxs)("span",{className:"font-mono",children:[Math.round(y.audio_bitrate/1e3),"kbps"]})]}),void 0!==y.packet_loss_percent&&(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-gray-500",children:"Loss:"})," ",(0,d.jsxs)("span",{className:"font-mono",children:[y.packet_loss_percent.toFixed(1),"%"]})]})]})]}),"idle"===v&&(0,d.jsxs)(r.$,{onClick:E,disabled:!j,variant:"primary",size:"lg",className:"w-full h-14 text-base",children:[(0,d.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),"Place Call (Browser)"]}),("dialing"===v||"ringing"===v)&&(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-center gap-3 py-4",children:[(0,d.jsx)("svg",{className:"w-8 h-8 text-primary-500 animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),(0,d.jsx)("span",{className:"text-lg font-medium text-gray-700",children:"dialing"===v?"Dialing...":"Ringing..."})]}),(0,d.jsx)(r.$,{onClick:F,variant:"outline",size:"lg",className:"w-full border-error text-error hover:bg-error-light",children:"Cancel"})]}),"active"===v&&(0,d.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,d.jsxs)(r.$,{onClick:x?t:q,variant:"outline",size:"lg",className:`flex flex-col items-center py-4 ${x?"bg-warning-light border-warning":""}`,children:[x?(0,d.jsx)("svg",{className:"w-6 h-6 mb-1 text-warning",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.25 9.75L19.5 12m0 0l2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6l4.72-4.72a.75.75 0 011.28.531V19.94a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.506-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.395C2.806 8.757 3.63 8.25 4.51 8.25H6.75z"})}):(0,d.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"})}),(0,d.jsx)("span",{className:"text-xs",children:x?"Unmute":"Mute"})]}),(0,d.jsxs)(r.$,{onClick:F,variant:"outline",size:"lg",className:"flex flex-col items-center py-4 border-error text-error hover:bg-error-light",children:[(0,d.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 3.75L18 6m0 0l2.25 2.25M18 6l2.25-2.25M18 6l-2.25 2.25m-12 8.25c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),(0,d.jsx)("span",{className:"text-xs",children:"End"})]}),(0,d.jsxs)(r.$,{variant:"outline",size:"lg",className:"flex flex-col items-center py-4 opacity-50",disabled:!0,children:[(0,d.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"})}),(0,d.jsx)("span",{className:"text-xs",children:"More"})]})]}),!j&&"idle"===v&&(0,d.jsx)("p",{className:"text-sm text-gray-500 text-center",children:"Enter a phone number above to place a call"})]})})};function bx({mode:a,onModeChange:b,webrtcStatus:c,disabled:e=!1}){return(0,d.jsxs)("div",{className:"bg-white rounded-md border border-gray-200 p-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-xs text-gray-500 uppercase tracking-wide font-medium",children:"Calling Mode"}),"browser"===a&&c&&(0,d.jsx)(s.E,{variant:"connected"===c||"on_call"===c?"success":"connecting"===c||"initializing"===c?"warning":"error"===c?"error":"default",className:"text-xs",children:c})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,d.jsxs)("button",{onClick:()=>b("phone"),disabled:e,className:`
            flex flex-col items-center justify-center p-3 rounded-md border-2 transition-all
            ${"phone"===a?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300 hover:bg-gray-50"}
            ${e?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,"aria-pressed":"phone"===a,children:[(0,d.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z"})}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Phone"}),(0,d.jsx)("span",{className:"text-xs text-gray-500 mt-0.5",children:"Rings your phone"})]}),(0,d.jsxs)("button",{onClick:()=>b("browser"),disabled:e,className:`
            flex flex-col items-center justify-center p-3 rounded-md border-2 transition-all
            ${"browser"===a?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300 hover:bg-gray-50"}
            ${e?"opacity-50 cursor-not-allowed":"cursor-pointer"}
          `,"aria-pressed":"browser"===a,children:[(0,d.jsx)("svg",{className:"w-6 h-6 mb-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18.75a6 6 0 006-6v-1.5m-6 7.5a6 6 0 01-6-6v-1.5m6 7.5v3.75m-3.75 0h7.5M12 15.75a3 3 0 01-3-3V4.5a3 3 0 116 0v8.25a3 3 0 01-3 3z"})}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Browser"}),(0,d.jsx)("span",{className:"text-xs text-gray-500 mt-0.5",children:"Uses headset"})]})]}),"browser"===a&&(0,d.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"Browser calling uses your computer's microphone and speakers. Make sure to grant microphone permission when prompted."})]})}var by=c(26701);function bz({children:a,className:b="",...c}){return(0,d.jsx)("label",{className:`text-sm font-medium ${b}`,...c,children:a})}var bA=c(17585);let bB={recording:["pro","insights","global","business","enterprise","standard","active"],transcription:["pro","insights","global","business","enterprise","standard","active"],translation:["global","business","enterprise"],real_time_translation_preview:["business","enterprise"],survey:["insights","global","business","enterprise"],secret_shopper:["insights","global","business","enterprise"],booking:["business","enterprise"],voice_cloning:["business","enterprise"]},bC=[{key:"record",label:"Source Recording",desc:"Immutable call audio (never modified)",feature:"recording",plan:"Pro+",badge:"Authoritative"},{key:"transcribe",label:"Canonical Transcript",desc:"AssemblyAI authoritative transcript (evidence-grade)",feature:"transcription",plan:"Pro+",badge:"Authoritative"},{key:"translate",label:"Post-Call Translation",desc:"Authoritative translation from canonical transcript",feature:"translation",plan:"Global+",badge:"Authoritative"},{key:"survey",label:"After-Call Survey",desc:"Automated survey with AI Survey Bot",feature:"survey",plan:"Insights+",badge:"Authoritative"},{key:"synthetic_caller",label:"Secret Shopper",desc:"AI caller with scoring",feature:"secret_shopper",plan:"Insights+",badge:"Authoritative"}],bD=[{value:"scale_1_5",label:"Scale 1-5"},{value:"scale_1_10",label:"Scale 1-10"},{value:"yes_no",label:"Yes/No"},{value:"multiple_choice",label:"Multiple Choice"},{value:"open_ended",label:"Open-ended"}],bE=[{code:"en",label:"English"},{code:"es",label:"Spanish"},{code:"fr",label:"French"}];function bF({callId:a,organizationId:b,initialModulations:c,onChange:f}){let{role:h,plan:i,loading:j}=(0,q.e)(b),{config:k,updateConfig:l,loading:m}=(0,g.g)(b),{capabilities:n}=function(a){let[b,c]=(0,e.useState)({}),[d,f]=(0,e.useState)(!0);return{capabilities:b,loading:d}}(0),o=k?.survey_prompts||[],p="object"==typeof k?.survey_prompts_locales&&k?.survey_prompts_locales?k.survey_prompts_locales:{},r=p.en||o,t=Array.isArray(k?.survey_question_types)?k?.survey_question_types:[],u=k&&!m?{record:k.record??!1,transcribe:k.transcribe??!1,translate:k.translate??!1,survey:k.survey??!1,synthetic_caller:k.synthetic_caller??!1}:c,[v,w]=(0,e.useState)(()=>({...u})),[x,y]=(0,e.useState)(()=>({record:!1,transcribe:!1,translate:!1,survey:!1,synthetic_caller:!1})),[z,A]=(0,e.useState)(null),B="owner"===h||"admin"===h;async function C(a){if(!B)return void A("Only Owners and Admins can modify settings");A(null);let b={...v},c={...v,[a]:!v[a]};w(c),y(b=>({...b,[a]:!0}));try{await l({[a]:c[a]}),await f(c)}catch(a){w(b),A(a?.message??"Update failed")}finally{y(b=>({...b,[a]:!1}))}}return(0,d.jsxs)("div",{className:"space-y-3",children:[bC.map(a=>{var b,c;let{disabled:e,reason:f}=(b=a.key,c=a.feature,j?{disabled:!0,reason:"Loading..."}:i?!function(a,b){let c=a.toLowerCase(),d=bB[b];return!d||d.includes(c)}(i,c)?{disabled:!0,reason:`Requires ${bC.find(a=>a.key===b)?.plan||"upgrade"}`}:B||"record"===b||"transcribe"===b?{disabled:!1}:{disabled:!0,reason:"Owner/Admin only"}:{disabled:!0,reason:"Plan not available"}),g=v[a.key],h="translate"===a.key&&!0===n.real_time_translation_preview,m=h?"Live Translation":a.label,o=h?"Real-time assist (preview only, not recorded)":a.desc,q=h?"Preview":a.badge;return(0,d.jsxs)("div",{className:"p-3 bg-gray-50 rounded-md border border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(bz,{htmlFor:`mod-${a.key}`,className:"text-sm font-medium text-gray-900",children:m}),(0,d.jsx)(s.E,{variant:"Authoritative"===q?"success":"warning",children:q}),e&&f&&(0,d.jsx)("span",{className:"text-xs text-gray-400",children:f})]}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:o})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3 ml-4",children:[(0,d.jsx)(bA.d,{id:`mod-${a.key}`,checked:g,onCheckedChange:()=>!e&&!x[a.key]&&C(a.key),disabled:e||x[a.key],"aria-label":a.label}),(0,d.jsx)("span",{className:`text-xs w-10 text-right tabular-nums ${x[a.key]?"text-gray-400":g?"text-success font-medium":"text-gray-400"}`,children:x[a.key]?"...":g?"On":"Off"})]})]}),"translate"===a.key&&(0,d.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-3",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)(bs,{label:"From Language",value:k?.translate_from||"",onChange:a=>l({translate_from:a.target.value||void 0}),disabled:!B,hint:g?void 0:"Select before enabling",children:[(0,d.jsx)("option",{value:"",children:"Select..."}),(0,d.jsx)("option",{value:"en",children:"English"}),(0,d.jsx)("option",{value:"es",children:"Spanish"}),(0,d.jsx)("option",{value:"fr",children:"French"}),(0,d.jsx)("option",{value:"de",children:"German"}),(0,d.jsx)("option",{value:"zh",children:"Chinese"}),(0,d.jsx)("option",{value:"ja",children:"Japanese"}),(0,d.jsx)("option",{value:"pt",children:"Portuguese"}),(0,d.jsx)("option",{value:"it",children:"Italian"}),(0,d.jsx)("option",{value:"ko",children:"Korean"}),(0,d.jsx)("option",{value:"ar",children:"Arabic"})]}),(0,d.jsxs)(bs,{label:"To Language",value:k?.translate_to||"",onChange:a=>l({translate_to:a.target.value||void 0}),disabled:!B,hint:g?void 0:"Select before enabling",children:[(0,d.jsx)("option",{value:"",children:"Select..."}),(0,d.jsx)("option",{value:"en",children:"English"}),(0,d.jsx)("option",{value:"es",children:"Spanish"}),(0,d.jsx)("option",{value:"fr",children:"French"}),(0,d.jsx)("option",{value:"de",children:"German"}),(0,d.jsx)("option",{value:"zh",children:"Chinese"}),(0,d.jsx)("option",{value:"ja",children:"Japanese"}),(0,d.jsx)("option",{value:"pt",children:"Portuguese"}),(0,d.jsx)("option",{value:"it",children:"Italian"}),(0,d.jsx)("option",{value:"ko",children:"Korean"}),(0,d.jsx)("option",{value:"ar",children:"Arabic"})]})]}),!g&&(!k?.translate_from||!k?.translate_to)&&(0,d.jsx)("p",{className:"text-xs text-warning",children:"Select both languages before enabling translation"}),g&&(0,d.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-gray-200",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-xs font-medium text-gray-700",children:"Voice Cloning"}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Clone caller voice"})]}),(0,d.jsx)(bA.d,{id:"voice-cloning-toggle",checked:k?.use_voice_cloning||!1,onCheckedChange:a=>l({use_voice_cloning:a}),disabled:!B,"aria-label":"Voice Cloning"})]})]}),g&&"survey"===a.key&&(0,d.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200 space-y-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Survey Questions (by locale)"}),(0,d.jsxs)(a7,{defaultValue:"en",children:[(0,d.jsx)(a8,{className:"mb-2",children:bE.map(a=>(0,d.jsx)(a9,{value:a.code,children:a.label},a.code))}),bE.map(a=>{var b;return(0,d.jsx)(ba,{value:a.code,children:(0,d.jsx)("textarea",{placeholder:"On a scale of 1-5, how satisfied were you? What could we improve?",value:("en"===(b=a.code)?r:p[b]||[]).join("\n"),onChange:b=>(function(a,b){let c=b.split("\n").filter(a=>a.trim()),d={...p};c.length>0?d[a]=c:delete d[a];let e={survey_prompts_locales:d};if("en"===a){let a=t.filter(a=>a.index<c.length);e.survey_prompts=c.length>0?c:[],e.survey_question_types=a}l(e)})(a.code,b.target.value),disabled:!B,rows:3,className:"w-full text-sm p-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-600 focus:border-primary-600"})},a.code)})]})]}),r.length>0&&(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("div",{className:"text-xs font-medium text-gray-700",children:"Question Types"}),r.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,d.jsxs)("div",{className:"text-xs text-gray-600 truncate",children:["Q",b+1,": ",a]}),(0,d.jsx)("select",{value:t.find(a=>a.index===b)?.type||"scale_1_5",onChange:a=>(function(a,b){let c=t.filter(b=>b.index!==a);c.push({index:a,type:b}),c.sort((a,b)=>a.index-b.index),l({survey_question_types:c})})(b,a.target.value),disabled:!B,className:"text-xs bg-white border border-gray-300 rounded px-2 py-1",children:bD.map(a=>(0,d.jsx)("option",{value:a.value,children:a.label},a.value))})]},`${b}-${a.slice(0,16)}`))]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email Results To"}),(0,d.jsx)("input",{type:"email",placeholder:"results@company.com",value:k?.survey_webhook_email||"",onChange:a=>l({survey_webhook_email:a.target.value||void 0}),disabled:!B,className:"w-full text-sm p-2 bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-600 focus:border-primary-600"})]})]}),g&&"synthetic_caller"===a.key&&(0,d.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,d.jsx)(bs,{label:"Script",value:k?.script_id||"",onChange:a=>l({script_id:a.target.value||null}),disabled:!B,children:(0,d.jsx)("option",{value:"",children:"Select a script..."})})})]},a.key)}),z&&(0,d.jsx)("div",{role:"alert",className:"text-sm text-error bg-error-light rounded-md p-3",children:z})]})}function bG({onBookingClick:a,onNewBooking:b,limit:c=5}){let[f,g]=(0,e.useState)([]),[h,i]=(0,e.useState)(!0),[j,k]=(0,e.useState)(null);return h?(0,d.jsx)("div",{className:"p-4 text-center text-slate-400",children:"Loading scheduled calls..."}):j?(0,d.jsx)("div",{className:"p-4 text-center text-red-400 text-sm",children:j}):(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,d.jsx)("h3",{className:"text-sm font-medium text-slate-300",children:"Scheduled Calls"}),b&&(0,d.jsx)(r.$,{size:"sm",variant:"outline",onClick:b,className:"text-xs h-7",children:"+ New"})]}),0===f.length?(0,d.jsx)("div",{className:"p-4 text-center text-slate-500 text-sm",children:"No upcoming scheduled calls"}):(0,d.jsx)("div",{className:"space-y-2",children:f.map(b=>(0,d.jsx)("div",{onClick:()=>a?.(b),className:"p-3 bg-slate-700/50 rounded-lg hover:bg-slate-700 transition-colors cursor-pointer",children:(0,d.jsx)("div",{className:"flex items-start justify-between",children:(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-medium text-white truncate",children:b.title}),(0,d.jsxs)("span",{className:`text-xs px-2 py-0.5 rounded-full border ${(a=>{switch(a){case"pending":return"bg-yellow-500/20 text-yellow-400 border-yellow-500";case"confirmed":return"bg-green-500/20 text-green-400 border-green-500";case"calling":return"bg-blue-500/20 text-blue-400 border-blue-500";case"completed":default:return"bg-slate-500/20 text-slate-400 border-slate-500";case"cancelled":case"failed":return"bg-red-500/20 text-red-400 border-red-500"}})(b.status)}`,children:[(a=>{switch(a){case"pending":return"â—‹";case"confirmed":case"completed":return"âœ“";case"calling":return"â—";case"cancelled":return"âœ•";case"failed":return"!";default:return"â€¢"}})(b.status)," ",b.status]})]}),(0,d.jsx)("div",{className:"text-sm text-slate-400 mt-1",children:b.attendee_name||b.attendee_phone}),(0,d.jsxs)("div",{className:"text-xs text-slate-500 mt-1",children:["\uD83D\uDD50 ",(0,d.jsx)(a0.u,{date:b.start_time,format:"short"})]})]})})},b.id))}),f.length>0&&(0,d.jsx)("div",{className:"text-center pt-2",children:(0,d.jsx)("button",{className:"text-xs text-blue-400 hover:text-blue-300 transition-colors",onClick:()=>window.location.href="/bookings",children:"View all scheduled calls â†’"})})]})}var bH=c(51587);function bI({organizationId:a,onComplete:b,onSkip:c}){var f;let[g,h]=(0,e.useState)("setup"),[i,j]=(0,e.useState)({targetNumber:"",targetName:"",fromNumber:"",record:!0,transcribe:!0}),[k,l]=(0,e.useState)(null),m=a=>/^\+[1-9]\d{1,14}$/.test(a);return(0,d.jsx)("div",{className:"max-w-md mx-auto",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[(0,d.jsx)("div",{className:"bg-primary-50 px-6 py-4 border-b border-primary-100",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"setup"===g?"Set Up Your First Call":"Ready to Call"}),(0,d.jsx)("p",{className:"text-sm text-gray-600 mt-0.5",children:"setup"===g?"Enter the number you want to call":"Review and place your first call"})]}),(0,d.jsx)("button",{onClick:c,className:"text-sm text-gray-500 hover:text-gray-700",children:"Skip"})]})}),(0,d.jsx)("div",{className:"px-6 py-3 border-b border-gray-100",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("div",{className:`
                flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium
                ${"ready"===g?"bg-success text-white":"bg-primary-600 text-white"}
              `,children:"ready"===g?(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):"1"}),(0,d.jsx)("div",{className:`flex-1 h-1 rounded ${"ready"===g?"bg-success":"bg-gray-200"}`}),(0,d.jsx)("div",{className:`
                flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium
                ${"ready"===g?"bg-primary-600 text-white":"bg-gray-100 text-gray-400"}
              `,children:"2"})]})}),(0,d.jsxs)("div",{className:"p-6",children:[k&&(0,d.jsxs)("div",{className:"mb-4 p-3 bg-error-light border border-red-200 rounded-md text-error text-sm flex items-center gap-2",children:[(0,d.jsx)("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),k]}),"setup"===g&&(0,d.jsxs)("div",{className:"space-y-5",children:[(0,d.jsx)("div",{children:(0,d.jsx)(u.p,{label:"Phone Number to Call *",type:"tel",value:i.targetNumber,onChange:a=>j({...i,targetNumber:a.target.value}),placeholder:"+12025551234",hint:((f=i.targetNumber)&&!f.startsWith("+")?"Add + and country code (e.g., +1 for US)":null)||"E.164 format (include country code)",autoFocus:!0})}),(0,d.jsx)(u.p,{label:"Name (optional)",value:i.targetName||"",onChange:a=>j({...i,targetName:a.target.value}),placeholder:"e.g., Main Support Line",hint:"For your reference"}),(0,d.jsxs)("details",{className:"group",children:[(0,d.jsxs)("summary",{className:"text-sm text-primary-600 cursor-pointer hover:text-primary-700 flex items-center gap-1",children:[(0,d.jsx)("svg",{className:"w-4 h-4 transition-transform group-open:rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"Add your phone number (for bridge calls)"]}),(0,d.jsx)("div",{className:"mt-3 pl-5",children:(0,d.jsx)(u.p,{label:"Your Phone Number",type:"tel",value:i.fromNumber||"",onChange:a=>j({...i,fromNumber:a.target.value}),placeholder:"+12025559876",hint:"We'll call you first, then connect to target"})})]})]}),"ready"===g&&(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Calling:"}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("p",{className:"text-base font-mono font-medium text-gray-900",children:i.targetNumber}),i.targetName&&(0,d.jsx)("p",{className:"text-sm text-gray-500",children:i.targetName})]})]}),i.fromNumber&&(0,d.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Via bridge:"}),(0,d.jsx)("span",{className:"text-sm font-mono text-gray-900",children:i.fromNumber})]})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Evidence Capture"}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:()=>j({...i,record:!i.record}),className:`
                      flex-1 p-3 rounded-lg border-2 transition-all
                      ${i.record?"border-success bg-success/5":"border-gray-200 hover:border-gray-300"}
                    `,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Record"}),(0,d.jsx)(bA.d,{checked:i.record,onCheckedChange:a=>j({...i,record:a})})]})}),(0,d.jsx)("button",{type:"button",onClick:()=>j({...i,transcribe:!i.transcribe}),className:`
                      flex-1 p-3 rounded-lg border-2 transition-all
                      ${i.transcribe?"border-success bg-success/5":"border-gray-200 hover:border-gray-300"}
                    `,children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Transcribe"}),(0,d.jsx)(bA.d,{checked:i.transcribe,onCheckedChange:a=>j({...i,transcribe:a})})]})})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 pt-2",children:[(0,d.jsx)(s.E,{variant:"secondary",className:"text-xs",children:"Immutable Evidence"}),(0,d.jsx)("span",{children:"All calls create court-ready records"})]})]})]}),(0,d.jsxs)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex gap-3",children:["ready"===g&&(0,d.jsx)(r.$,{variant:"outline",onClick:()=>{l(null),"ready"===g&&h("setup")},children:"Back"}),(0,d.jsx)(r.$,{variant:"primary",onClick:()=>{if(l(null),"setup"===g){if(!i.targetNumber)return void l("Please enter a phone number");if(!m(i.targetNumber))return void l("Please use E.164 format (e.g., +12025551234)");if(i.fromNumber&&!m(i.fromNumber))return void l("Your number should be in E.164 format (e.g., +12025551234)");h("ready")}else"ready"===g&&b(i)},className:"flex-1",children:"ready"===g?(0,d.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,d.jsx)("span",{})," Place Call"]}):"Continue"})]})]})})}function bJ({organizationId:a,onSelect:b,limit:c=5}){let[f,g]=(0,e.useState)([]),[h,i]=(0,e.useState)(!0),[j,k]=(0,e.useState)(!1);if(h)return(0,d.jsxs)("div",{className:"animate-pulse space-y-2",children:[(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"}),(0,d.jsx)("div",{className:"h-10 bg-gray-100 rounded"}),(0,d.jsx)("div",{className:"h-10 bg-gray-100 rounded"})]});if(0===f.length)return null;let l=j?f:f.slice(0,c);return(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Recent"}),f.length>c&&(0,d.jsx)("button",{onClick:()=>k(!j),className:"text-xs text-primary-600 hover:text-primary-700",children:j?"Show less":`+${f.length-c} more`})]}),(0,d.jsx)("div",{className:"space-y-1",children:l.map(a=>(0,d.jsxs)("button",{onClick:()=>b(a.number,a.name),className:"w-full flex items-center gap-3 p-2 rounded-md text-left hover:bg-gray-100 transition-colors group",children:[(0,d.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-100 group-hover:bg-primary-100 flex items-center justify-center flex-shrink-0",children:(0,d.jsx)("svg",{className:"w-4 h-4 text-gray-400 group-hover:text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-sm font-mono text-gray-900 truncate",children:a.number}),a.name&&(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate",children:a.name})]}),(0,d.jsxs)("div",{className:"text-right flex-shrink-0",children:[(0,d.jsx)("p",{className:"text-xs text-gray-400",children:(a=>{let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/6e4),d=Math.floor(c/60),e=Math.floor(d/24);return c<1?"Just now":c<60?`${c}m ago`:d<24?`${d}h ago`:e<7?`${e}d ago`:b.toLocaleDateString()})(a.lastCalled)}),a.callCount>1&&(0,d.jsxs)("p",{className:"text-xs text-gray-400",children:[a.callCount," calls"]})]}),(0,d.jsx)("svg",{className:"w-4 h-4 text-gray-300 group-hover:text-primary-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]},a.number))})]})}let bK=[{id:"tpl_disclosure",type:"disclosure_accepted",label:"Recording Disclosed",promptText:"Confirm that the customer was informed this call is being recorded",description:"The recording disclosure was played at call start. Mark confirmed when customer continues.",isRequired:!0,useCases:["general"],icon:"Volume2",displayOrder:1},{id:"tpl_recording_consent",type:"recording_consent",label:"Recording Consent",promptText:'Ask: "Do you consent to this call being recorded?"',description:"Obtain explicit verbal consent to record the call.",isRequired:!0,useCases:["compliance","legal","healthcare"],icon:"Mic",displayOrder:2},{id:"tpl_identity",type:"identity_verified",label:"Identity Verified",promptText:'Ask: "Can you please confirm your name and [verification question]?"',description:"Verify the caller's identity before discussing sensitive information.",isRequired:!1,useCases:["finance","healthcare","compliance"],icon:"BadgeCheck",displayOrder:3},{id:"tpl_terms",type:"terms_agreed",label:"Terms Acknowledged",promptText:'Ask: "Do you understand and agree to the terms as I\'ve explained them?"',description:"Confirm the customer understands and agrees to terms.",isRequired:!1,useCases:["sales","legal","finance"],icon:"FileText",displayOrder:4},{id:"tpl_price",type:"price_confirmed",label:"Price Confirmed",promptText:'Ask: "To confirm, you\'re agreeing to [price/amount]. Is that correct?"',description:"Obtain verbal confirmation of pricing or amounts.",isRequired:!1,useCases:["sales","finance"],icon:"DollarSign",displayOrder:5},{id:"tpl_scope",type:"scope_confirmed",label:"Scope Confirmed",promptText:'Ask: "Can you confirm you understand the scope of [service/work]?"',description:"Confirm understanding of what is included/excluded.",isRequired:!1,useCases:["sales","support"],icon:"ClipboardList",displayOrder:6},{id:"tpl_authorization",type:"authorization_given",label:"Authorization Given",promptText:'Ask: "Do you authorize us to proceed with [action]?"',description:"Obtain explicit authorization for an action.",isRequired:!1,useCases:["finance","healthcare","legal"],icon:"CheckCircle",displayOrder:7},{id:"tpl_understanding",type:"understanding_confirmed",label:"Understanding Confirmed",promptText:'Ask: "Do you have any questions about what we\'ve discussed?"',description:"Confirm the customer understands the key points.",isRequired:!1,useCases:["general","compliance"],icon:"Lightbulb",displayOrder:8}];function bL(a){switch(a){case"confirmed":return"bg-green-100 text-green-800";case"declined":return"bg-red-100 text-red-800";case"skipped":return"bg-yellow-100 text-yellow-800";case"not_applicable":return"bg-gray-100 text-gray-600";default:return"bg-blue-50 text-blue-800"}}let bM={customer:{label:"Customer",description:"The called party confirmed"},operator:{label:"Operator",description:"The operator confirmed"},third_party:{label:"Third Party",description:"A third party on the call confirmed"},both:{label:"Both Parties",description:"Both operator and customer confirmed"}};function bN({callId:a,organizationId:b,callDuration:c,templates:f=bK.filter(a=>a.isRequired||a.useCases.includes("general")),onConfirmationCaptured:g,onConfirmationSkipped:h,isCallActive:i=!0}){let[j,k]=(0,e.useState)(()=>f.map(b=>({id:`${a}-${b.id}`,template:b,status:"pending"}))),[l,m]=(0,e.useState)(null),[n,o]=(0,e.useState)("customer"),[p,q]=(0,e.useState)(""),[t,u]=(0,e.useState)(!1),[v,w]=(0,e.useState)(null),[x,y]=(0,e.useState)(""),z=(0,e.useCallback)(async()=>{if(l){u(!0);try{g&&await g({templateId:l.template.id,confirmationType:l.template.type,confirmerRole:n,recordingTimestamp:c,notes:p||void 0}),k(a=>a.map(a=>a.id===l.id?{...a,status:"confirmed",confirmedAt:new Date().toISOString(),confirmerRole:n,recordingTimestamp:c,notes:p}:a)),m(null),o("customer"),q("")}catch(a){bc.v.error("Failed to save confirmation",a,{activeItem:l?.id})}finally{u(!1)}}},[l,n,p,c,g]),A=(0,e.useCallback)(async()=>{if(v&&x){u(!0);try{h&&await h(v.template.id,x),k(a=>a.map(a=>a.id===v.id?{...a,status:"skipped",notes:x}:a)),w(null),y("")}catch(a){bc.v.error("Failed to skip confirmation",a,{skipItem:v?.id})}finally{u(!1)}}},[v,x,h]),B=a=>{let b=Math.floor(a/60);return`${b}:${(a%60).toString().padStart(2,"0")}`},C=j.filter(a=>"confirmed"===a.status).length,D=j.filter(a=>a.template.isRequired).length,E=j.filter(a=>a.template.isRequired&&"confirmed"===a.status).length;return(0,d.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,d.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-b border-gray-200",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)("h3",{className:"font-semibold text-gray-900",children:"Confirmation Checklist"})}),(0,d.jsxs)(s.E,{variant:E===D?"success":"default",children:[C,"/",j.length," Complete"]})]}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Ask the customer and mark when confirmed"})]}),(0,d.jsx)("div",{className:"divide-y divide-gray-100",children:j.map(a=>(0,d.jsx)("div",{className:`p-4 ${"confirmed"===a.status?"bg-green-50":"skipped"===a.status?"bg-yellow-50":"bg-white hover:bg-gray-50"}`,children:(0,d.jsxs)("div",{className:"flex items-start gap-3",children:[(0,d.jsx)("div",{className:`
                w-6 h-6 rounded-full flex items-center justify-center text-sm font-medium
                ${bL(a.status)}
              `,children:function(a){switch(a){case"confirmed":return"âœ“";case"declined":return"âœ—";case"skipped":return"â†’";case"not_applicable":return"â€”";default:return"â—‹"}}(a.status)}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-base",children:a.template.icon}),(0,d.jsx)("span",{className:"font-medium text-gray-900",children:a.template.label}),a.template.isRequired&&(0,d.jsx)(s.E,{variant:"secondary",className:"text-xs",children:"Required"})]}),(0,d.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a.template.promptText}),"confirmed"===a.status&&void 0!==a.recordingTimestamp&&(0,d.jsxs)("p",{className:"text-xs text-green-700 mt-1",children:["âœ“ Confirmed by ",bM[a.confirmerRole||"customer"].label," at ",B(a.recordingTimestamp)]}),"skipped"===a.status&&a.notes&&(0,d.jsxs)("p",{className:"text-xs text-yellow-700 mt-1",children:["Skipped: ",a.notes]})]}),"pending"===a.status&&i&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r.$,{size:"sm",variant:"ghost",onClick:()=>w(a),className:"text-gray-500 hover:text-gray-700",children:"Skip"}),(0,d.jsx)(r.$,{size:"sm",onClick:()=>m(a),className:"bg-primary-600 hover:bg-primary-700 text-white",children:"Mark Confirmed"})]}),"pending"!==a.status&&(0,d.jsx)(s.E,{className:bL(a.status),children:"confirmed"===a.status?"Confirmed":"skipped"===a.status?"Skipped":a.status})]})},a.id))}),(0,d.jsx)("div",{className:"px-4 py-2 bg-blue-50 border-t border-blue-100",children:(0,d.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,d.jsx)("strong",{children:"Reminder:"})," You ask the question. The customer answers. You mark it confirmed."]})}),l&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,d.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,d.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Confirm: ",l.template.label]})}),(0,d.jsxs)("div",{className:"p-4 space-y-4",children:[(0,d.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:l.template.description}),(0,d.jsxs)("p",{className:"text-sm font-medium text-gray-900 mt-2",children:['"',l.template.promptText,'"']})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Who confirmed?"}),(0,d.jsx)("div",{className:"flex gap-2 flex-wrap",children:Object.keys(bM).map(a=>(0,d.jsx)("button",{onClick:()=>o(a),className:`
                        px-3 py-1.5 rounded-md text-sm font-medium transition-colors
                        ${n===a?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
                      `,children:bM[a].label},a))})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,d.jsx)("span",{children:"Recording timestamp:"}),(0,d.jsx)(s.E,{variant:"secondary",children:B(c)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),(0,d.jsx)("textarea",{value:p,onChange:a=>q(a.target.value),placeholder:"Any additional context...",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm resize-none",rows:2})]})]}),(0,d.jsxs)("div",{className:"p-4 border-t border-gray-200 flex gap-2 justify-end",children:[(0,d.jsx)(r.$,{variant:"outline",onClick:()=>{m(null),q("")},disabled:t,children:"Cancel"}),(0,d.jsx)(r.$,{onClick:z,disabled:t,className:"bg-green-600 hover:bg-green-700 text-white",children:t?"Saving...":"Confirm Captured"})]})]})}),v&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,d.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,d.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,d.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["Skip: ",v.template.label]})}),(0,d.jsxs)("div",{className:"p-4 space-y-4",children:[v.template.isRequired&&(0,d.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3",children:(0,d.jsx)("p",{className:"text-sm text-yellow-800",children:"This is a required confirmation. Please provide a reason for skipping."})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for skipping"}),(0,d.jsx)("textarea",{value:x,onChange:a=>y(a.target.value),placeholder:"Why is this being skipped?",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm resize-none",rows:3,required:!0})]})]}),(0,d.jsxs)("div",{className:"p-4 border-t border-gray-200 flex gap-2 justify-end",children:[(0,d.jsx)(r.$,{variant:"outline",onClick:()=>{w(null),y("")},disabled:t,children:"Cancel"}),(0,d.jsx)(r.$,{onClick:A,disabled:t||!x.trim(),className:"bg-yellow-600 hover:bg-yellow-700 text-white",children:t?"Saving...":"Skip Confirmation"})]})]})})]})}function bO({callId:a,organizationId:b,status:c,targetNumber:f,fromNumber:g,duration:h,onViewDetails:i,onEndCall:j,onNewCall:k,showConfirmations:l=!0}){let[m,n]=(0,e.useState)(!1),[o,p]=(0,e.useState)(!1),q=a=>{let b=Math.floor(a/60);return`${b}:${(a%60).toString().padStart(2,"0")}`},t=async()=>{await navigator.clipboard.writeText(a),n(!0),setTimeout(()=>n(!1),2e3)},u={initiating:{color:"bg-blue-500",label:"Initiating",animate:!0},ringing:{color:"bg-amber-500",label:"Ringing",animate:!0},in_progress:{color:"bg-success",label:"Connected",animate:!0},completed:{color:"bg-gray-400",label:"Completed",animate:!1},failed:{color:"bg-error",label:"Failed",animate:!1},"no-answer":{color:"bg-warning",label:"No Answer",animate:!1},busy:{color:"bg-warning",label:"Busy",animate:!1}},v=u[c]||u.initiating,w=["initiating","ringing","in_progress"].includes(c),x=(0,e.useCallback)(async c=>{if(b)try{if(!(await fetch(`/api/calls/${a}/confirmations`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmation_type:c.confirmationType,prompt_text:c.templateId,confirmer_role:c.confirmerRole,recording_timestamp_seconds:c.recordingTimestamp,verification_method:"verbal",notes:c.notes})})).ok)throw Error("Failed to save confirmation")}catch(c){throw bc.v.error("Failed to save confirmation",c,{callId:a,organizationId:b}),c}},[a,b]),y=(0,e.useCallback)(async(b,c)=>{bc.v.debug("Confirmation skipped",{callId:a,templateId:b,reason:c})},[a]);return(0,d.jsxs)("div",{className:`
      rounded-lg border-2 overflow-hidden transition-colors
      ${w?"border-primary-200 bg-primary-50":"border-gray-200 bg-white"}
    `,children:[(0,d.jsxs)("div",{className:`
        px-4 py-3 flex items-center gap-3
        ${w?"bg-primary-100":"bg-gray-50"}
      `,children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:`w-3 h-3 rounded-full ${v.color}`}),v.animate&&(0,d.jsx)("div",{className:`absolute inset-0 w-3 h-3 rounded-full ${v.color} animate-ping opacity-75`})]}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:w?"Call Active":`Call ${v.label}`}),w&&(0,d.jsx)("p",{className:"text-xs text-gray-600",children:"in_progress"===c?`Duration: ${q(h)}`:v.label})]}),(0,d.jsx)(s.E,{variant:"completed"===c?"success":"failed"===c?"error":w?"default":"warning",children:v.label})]}),(0,d.jsxs)("div",{className:"p-4 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Calling"}),(0,d.jsx)("span",{className:"text-sm font-mono text-gray-900",children:f||"Unknown"})]}),g&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"From"}),(0,d.jsx)("span",{className:"text-sm font-mono text-gray-900",children:g})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Call ID"}),(0,d.jsxs)("button",{onClick:t,className:"flex items-center gap-1 text-sm font-mono text-primary-600 hover:text-primary-700",children:[a.slice(0,8),"...",m?(0,d.jsx)("svg",{className:"w-4 h-4 text-success",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})]})]}),("in_progress"===c||"completed"===c)&&h>0&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Duration"}),(0,d.jsx)("span",{className:"text-sm font-mono text-gray-900",children:q(h)})]}),w&&l&&b&&(0,d.jsx)("div",{className:"pt-2 border-t border-gray-100",children:(0,d.jsxs)("button",{onClick:()=>p(!o),className:"w-full flex items-center justify-between py-2 text-sm text-gray-700 hover:text-gray-900",children:[(0,d.jsxs)("span",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{children:"\uD83D\uDCCB"}),(0,d.jsx)("span",{className:"font-medium",children:"Confirmation Checklist"})]}),(0,d.jsx)("svg",{className:`w-4 h-4 transition-transform ${o?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]}),w&&l&&b&&o&&(0,d.jsx)("div",{className:"border-t border-gray-200",children:(0,d.jsx)(bN,{callId:a,organizationId:b,callDuration:h,onConfirmationCaptured:x,onConfirmationSkipped:y,isCallActive:w})}),(0,d.jsxs)("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-200 flex gap-2",children:[(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:i,className:"flex-1",children:[(0,d.jsxs)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View Details"]}),w&&j&&(0,d.jsxs)(r.$,{variant:"outline",size:"sm",onClick:j,className:"text-error border-error hover:bg-error-light",children:[(0,d.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M5 3a2 2 0 00-2 2v1c0 8.284 6.716 15 15 15h1a2 2 0 002-2v-3.28a1 1 0 00-.684-.948l-4.493-1.498a1 1 0 00-1.21.502l-1.13 2.257a11.042 11.042 0 01-5.516-5.517l2.257-1.128a1 1 0 00.502-1.21L9.228 3.683A1 1 0 008.279 3H5z"})}),"End"]}),!w&&(0,d.jsxs)(r.$,{variant:"primary",size:"sm",onClick:k,className:"flex-1",children:[(0,d.jsx)("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 4v16m8-8H4"})}),"New Call"]})]})]})}var bP=c(57613),bQ=c(71213);let bR=(0,aT.A)("phone-incoming",[["path",{d:"M16 2v6h6",key:"1mfrl5"}],["path",{d:"m22 2-6 6",key:"6f0sa0"}],["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),bS=(0,aT.A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var bT=c(72567);function bU({currentTab:a,onTabChange:b,callsCount:c,onScheduleClick:e}){let f=[{id:"dial",label:"Dial",icon:bQ.A},{id:"calls",label:"Calls",icon:bR},{id:"activity",label:"Activity",icon:bS}];return(0,d.jsxs)("nav",{className:"flex border-t border-gray-200 bg-white safe-area-bottom",children:[f.map(e=>{let f=a===e.id,g=e.icon;return(0,d.jsxs)("button",{onClick:()=>b(e.id),className:`
              flex-1 flex flex-col items-center py-3 px-2 min-h-[56px] transition-colors relative
              ${f?"text-primary-600 bg-primary-50":"text-gray-500 hover:bg-gray-50"}
            `,"aria-current":f?"page":void 0,children:[(0,d.jsx)(g,{className:"w-5 h-5 mb-1",strokeWidth:2}),(0,d.jsx)("span",{className:"text-xs font-medium",children:e.label}),"calls"===e.id&&c>0&&(0,d.jsx)("span",{className:"absolute top-2 right-1/4 bg-primary-600 text-white text-[10px] font-bold rounded-full min-w-[16px] h-4 flex items-center justify-center px-1",children:c>9?"9+":c})]},e.id)}),(0,d.jsxs)("button",{onClick:e,className:"flex-1 flex flex-col items-center py-3 px-2 min-h-[56px] text-gray-500 hover:bg-gray-50 transition-colors",children:[(0,d.jsx)(bT.A,{className:"w-5 h-5 mb-1",strokeWidth:2}),(0,d.jsx)("span",{className:"text-xs font-medium",children:"Schedule"})]})]})}function bV({mode:a,onModeChange:b,disabled:c}){let e=k();return(0,d.jsx)(bx,{mode:a,onModeChange:b,webrtcStatus:e.status,disabled:c})}function bW({initialCalls:a,organizationId:b,organizationName:c}){let[f,h]=(0,e.useState)(null),[i,k]=(0,e.useState)(!1),[l,n]=(0,e.useState)(!1),[o,q]=(0,e.useState)(!1),[r,s]=(0,e.useState)("phone"),[u,v]=(0,e.useState)(null),w=function(a){let[b,c]=(0,e.useState)(null),[d,f]=(0,e.useState)(0),g=b&&["completed","failed","busy","no-answer","canceled"].includes(b),h=(0,e.useCallback)(()=>{c(null),f(0)},[]);return{status:b,duration:d,setStatus:c,reset:h,isActive:!!a&&!g}}(u),[x,y]=(0,e.useState)("dial"),{updates:z}=(0,a1.x)(b),A=a=>{v(a),w.setStatus("initiating"),w.reset(),h(a)},B=async a=>{n(!1);let b=new CustomEvent("onboarding:complete",{detail:{targetNumber:a.targetNumber,targetName:a.targetName,fromNumber:a.fromNumber,record:a.record,transcribe:a.transcribe}});window.dispatchEvent(b)},C=(a,b)=>{},D=()=>{v(null),w.reset()};async function E(a){}return l&&0===a.length?(0,d.jsx)(g.U,{organizationId:b,children:(0,d.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,d.jsx)(t,{organizationId:b,organizationName:c}),(0,d.jsx)("div",{className:"py-12 px-4",children:(0,d.jsx)(bI,{organizationId:b,onComplete:B,onSkip:()=>n(!1)})})]})}):(0,d.jsx)(g.U,{organizationId:b,children:(0,d.jsx)(p,{children:(0,d.jsx)(j,{organizationId:b,children:(0,d.jsx)(m,{children:(0,d.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,d.jsx)(t,{organizationId:b,organizationName:c}),(0,d.jsxs)("div",{className:"hidden lg:flex flex-1 overflow-hidden",children:[(0,d.jsxs)("aside",{className:"w-72 border-r border-gray-200 flex flex-col overflow-hidden bg-white","data-tour":"call-list",children:[(0,d.jsx)("div",{className:"border-b border-gray-200 p-4",children:(0,d.jsx)(bG,{onBookingClick:a=>{},onNewBooking:()=>k(!0),limit:3})}),(0,d.jsx)(a2,{calls:a,selectedCallId:f,organizationId:b,onSelect:h})]}),(0,d.jsx)("main",{className:"flex-1 overflow-y-auto p-6",children:(0,d.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[u&&w.status&&(0,d.jsx)(bO,{callId:u,organizationId:b||void 0,status:w.status,duration:w.duration,onViewDetails:()=>h(u),onNewCall:D,showConfirmations:!0}),(0,d.jsx)("div",{className:"space-y-4","data-tour":"target-selector",children:(0,d.jsx)(bu,{organizationId:b})}),(0,d.jsx)("div",{className:"bg-white rounded-md border border-gray-200 p-4",children:(0,d.jsx)(bV,{mode:r,onModeChange:s,disabled:!!u})}),(0,d.jsxs)("div",{"data-tour":"place-call",children:["phone"===r&&!u&&(0,d.jsx)(bv,{organizationId:b,onCallPlaced:A}),"browser"===r&&(0,d.jsx)(bw,{organizationId:b,onCallPlaced:A})]}),(0,d.jsx)("div",{className:"bg-white rounded-md border border-gray-200 p-4",children:(0,d.jsx)(bJ,{organizationId:b,onSelect:C,limit:3})}),(0,d.jsxs)("section",{className:"bg-white rounded-md border border-gray-200","data-tour":"call-options",children:[(0,d.jsxs)("button",{onClick:()=>q(!o),className:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-gray-50 transition-colors",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h2",{className:"text-sm font-semibold text-gray-900",children:"Call Options"}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Recording, transcription, and more"})]}),o?(0,d.jsx)(aV,{className:"w-5 h-5 text-gray-400"}):(0,d.jsx)(aU,{className:"w-5 h-5 text-gray-400"})]}),o&&(0,d.jsx)("div",{className:"px-4 pb-4 border-t border-gray-100",children:(0,d.jsx)(bF,{callId:"org-default",organizationId:b,initialModulations:{record:!1,transcribe:!1,translate:!1,survey:!1,synthetic_caller:!1},onChange:E})})]}),(0,d.jsx)("div",{id:"call-detail-container",children:(0,d.jsx)(bq,{callId:f,organizationId:b,onModulationChange:E})})]})}),(0,d.jsx)("aside",{className:"w-72 border-l border-gray-200 overflow-y-auto p-4 bg-white","data-tour":"activity-feed",children:(0,d.jsx)(by.A,{organizationId:b,limit:20})})]}),(0,d.jsxs)("div",{className:"flex lg:hidden flex-col flex-1 overflow-hidden",children:[(0,d.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["dial"===x&&(0,d.jsxs)("div",{className:"p-4 space-y-4",children:[u&&w.status&&(0,d.jsx)(bO,{callId:u,organizationId:b||void 0,status:w.status,duration:w.duration,onViewDetails:()=>h(u),onNewCall:D,showConfirmations:!0}),(0,d.jsx)(bu,{organizationId:b}),(0,d.jsx)("div",{className:"bg-white rounded-md border border-gray-200 p-4",children:(0,d.jsx)(bV,{mode:r,onModeChange:s,disabled:!!u})}),"phone"===r&&!u&&(0,d.jsx)(bv,{organizationId:b,onCallPlaced:A}),"browser"===r&&(0,d.jsx)(bw,{organizationId:b,onCallPlaced:A}),(0,d.jsx)("div",{className:"bg-white rounded-md border border-gray-200 p-4",children:(0,d.jsx)(bJ,{organizationId:b,onSelect:C,limit:3})}),(0,d.jsxs)("details",{className:"bg-white rounded-md border border-gray-200 group",children:[(0,d.jsxs)("summary",{className:"p-4 cursor-pointer font-medium text-gray-900 flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Call Options"}),(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Tap to expand"})]}),(0,d.jsx)("div",{className:"p-4 pt-0 border-t border-gray-200",children:(0,d.jsx)(bF,{callId:"org-default",organizationId:b,initialModulations:{record:!1,transcribe:!1,translate:!1,survey:!1,synthetic_caller:!1},onChange:E})})]}),(0,d.jsxs)("details",{className:"bg-white rounded-md border border-gray-200",children:[(0,d.jsxs)("summary",{className:"p-4 cursor-pointer font-medium text-gray-900 flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Scheduled Calls"}),(0,d.jsx)("span",{className:"text-sm text-gray-500",children:"Tap to view"})]}),(0,d.jsx)("div",{className:"p-4 pt-0 border-t border-gray-200",children:(0,d.jsx)(bG,{onBookingClick:a=>{},onNewBooking:()=>k(!0),limit:5})})]}),(0,d.jsx)("div",{id:"call-detail-container",children:(0,d.jsx)(bq,{callId:f,organizationId:b,onModulationChange:E})})]}),"calls"===x&&(0,d.jsx)(a2,{calls:a,selectedCallId:f,organizationId:b,onSelect:a=>{h(a),y("dial")}}),"activity"===x&&(0,d.jsx)("div",{className:"p-4",children:(0,d.jsx)(by.A,{organizationId:b,limit:30})})]}),(0,d.jsx)(bU,{currentTab:x,onTabChange:y,callsCount:a.length,onScheduleClick:()=>k(!0)})]}),(0,d.jsx)(bH.L,{isOpen:i,onClose:()=>k(!1),onSuccess:a=>{k(!1)}}),(0,d.jsx)(bP.WB,{tourId:"voice",steps:bP.AN})]})})})})})}},91645:a=>{"use strict";a.exports=require("net")},92233:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\Ultimate Warrior\\\\My project\\\\gemini-project\\\\app\\\\voice-operations\\\\error.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\Ultimate Warrior\\My project\\gemini-project\\app\\voice-operations\\error.tsx","default")},92575:(a,b,c)=>{Promise.resolve().then(c.bind(c,93683)),Promise.resolve().then(c.bind(c,86610)),Promise.resolve().then(c.t.bind(c,3991,23))},93683:(a,b,c)=>{"use strict";let d;c.d(b,{TroubleshootChatToggle:()=>ge});var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c(21124),D=c(38301),E="vercel.ai.error",F=Symbol.for(E),G=class a extends(f=Error,e=F,f){constructor({name:a,message:b,cause:c}){super(b),this[e]=!0,this.name=a,this.cause=c}static isInstance(b){return a.hasMarker(b,E)}static hasMarker(a,b){let c=Symbol.for(b);return null!=a&&"object"==typeof a&&c in a&&"boolean"==typeof a[c]&&!0===a[c]}},H=Symbol.for("vercel.ai.error.AI_APICallError");Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");function I(a){return null==a?"unknown error":"string"==typeof a?a:a instanceof Error?a.message:JSON.stringify(a)}var J="AI_InvalidArgumentError",K=`vercel.ai.error.${J}`,L=Symbol.for(K),M=class extends(h=G,g=L,h){constructor({message:a,cause:b,argument:c}){super({name:J,message:a,cause:b}),this[g]=!0,this.argument=c}static isInstance(a){return G.hasMarker(a,K)}},N=Symbol.for("vercel.ai.error.AI_InvalidPromptError");Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var O="AI_JSONParseError",P=`vercel.ai.error.${O}`,Q=Symbol.for(P),R=class extends(j=G,i=Q,j){constructor({text:a,cause:b}){super({name:O,message:`JSON parsing failed: Text: ${a}.
Error message: ${I(b)}`,cause:b}),this[i]=!0,this.text=a}static isInstance(a){return G.hasMarker(a,P)}},S=Symbol.for("vercel.ai.error.AI_LoadAPIKeyError");Symbol.for("vercel.ai.error.AI_LoadSettingError");Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");Symbol.for("vercel.ai.error.AI_NoSuchModelError");Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var T="AI_TypeValidationError",U=`vercel.ai.error.${T}`,V=Symbol.for(U),W=class a extends(l=G,k=V,l){constructor({value:a,cause:b,context:c}){let d="Type validation failed";if((null==c?void 0:c.field)&&(d+=` for ${c.field}`),(null==c?void 0:c.entityName)||(null==c?void 0:c.entityId)){d+=" (";let a=[];c.entityName&&a.push(c.entityName),c.entityId&&a.push(`id: "${c.entityId}"`),d+=a.join(", "),d+=")"}super({name:T,message:`${d}: Value: ${JSON.stringify(a)}.
Error message: ${I(b)}`,cause:b}),this[k]=!0,this.value=a,this.context=c}static isInstance(a){return G.hasMarker(a,U)}static wrap({value:b,cause:c,context:d}){var e,f,g;return a.isInstance(c)&&c.value===b&&(null==(e=c.context)?void 0:e.field)===(null==d?void 0:d.field)&&(null==(f=c.context)?void 0:f.entityName)===(null==d?void 0:d.entityName)&&(null==(g=c.context)?void 0:g.entityId)===(null==d?void 0:d.entityId)?c:new a({value:b,cause:c,context:d})}},X=Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");Symbol("ZodOutput"),Symbol("ZodInput");class Y{constructor(){this._map=new Map,this._idmap=new Map}add(a,...b){let c=b[0];if(this._map.set(a,c),c&&"object"==typeof c&&"id"in c){if(this._idmap.has(c.id))throw Error(`ID ${c.id} already exists in the registry`);this._idmap.set(c.id,a)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(a){let b=this._map.get(a);return b&&"object"==typeof b&&"id"in b&&this._idmap.delete(b.id),this._map.delete(a),this}get(a){let b=a._zod.parent;if(b){let c={...this.get(b)??{}};return delete c.id,{...c,...this._map.get(a)}}return this._map.get(a)}has(a){return this._map.has(a)}}let Z=new Y;function $(a){let b=Object.values(a).filter(a=>"number"==typeof a);return Object.entries(a).filter(([a,c])=>-1===b.indexOf(+a)).map(([a,b])=>b)}function _(a,b){return"bigint"==typeof b?b.toString():b}function aa(a){return{get value(){{let b=a();return Object.defineProperty(this,"value",{value:b}),b}}}}function ab(a){let b=+!!a.startsWith("^"),c=a.endsWith("$")?a.length-1:a.length;return a.slice(b,c)}function ac(a,b,c){Object.defineProperty(a,b,{get(){{let d=c();return a[b]=d,d}},set(c){Object.defineProperty(a,b,{value:c})},configurable:!0})}function ad(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!0,configurable:!0})}function ae(a){return JSON.stringify(a)}let af=Error.captureStackTrace?Error.captureStackTrace:(...a)=>{};function ag(a){return"object"==typeof a&&null!==a&&!Array.isArray(a)}let ah=aa(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(a){return!1}});function ai(a){if(!1===ag(a))return!1;let b=a.constructor;if(void 0===b)return!0;let c=b.prototype;return!1!==ag(c)&&!1!==Object.prototype.hasOwnProperty.call(c,"isPrototypeOf")}let aj=new Set(["string","number","symbol"]);function ak(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function al(a,b,c){let d=new a._zod.constr(b??a._zod.def);return(!b||c?.parent)&&(d._zod.parent=a),d}function am(a){if(!a)return{};if("string"==typeof a)return{error:()=>a};if(a?.message!==void 0){if(a?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");a.error=a.message}return(delete a.message,"string"==typeof a.error)?{...a,error:()=>a.error}:a}let an={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function ao(a,b=0){for(let c=b;c<a.issues.length;c++)if(a.issues[c]?.continue!==!0)return!0;return!1}function ap(a,b){return b.map(b=>(b.path??(b.path=[]),b.path.unshift(a),b))}function aq(a){return"string"==typeof a?a:a?.message}function ar(a,b,c){let d={...a,path:a.path??[]};return a.message||(d.message=aq(a.inst?._zod.def?.error?.(a))??aq(b?.error?.(a))??aq(c.customError?.(a))??aq(c.localeError?.(a))??"Invalid input"),delete d.inst,delete d.continue,b?.reportInput||delete d.input,d}function as(a){return Array.isArray(a)?"array":"string"==typeof a?"string":"unknown"}function at(...a){let[b,c,d]=a;return"string"==typeof b?{message:b,code:"custom",input:c,inst:d}:{...b}}class au{constructor(a){this.counter=0,this.metadataRegistry=a?.metadata??Z,this.target=a?.target??"draft-2020-12",this.unrepresentable=a?.unrepresentable??"throw",this.override=a?.override??(()=>{}),this.io=a?.io??"output",this.seen=new Map}process(a,b={path:[],schemaPath:[]}){var c;let d=a._zod.def,e=this.seen.get(a);if(e)return e.count++,b.schemaPath.includes(a)&&(e.cycle=b.path),e.schema;let f={schema:{},count:1,cycle:void 0,path:b.path};this.seen.set(a,f);let g=a._zod.toJSONSchema?.();if(g)f.schema=g;else{let c={...b,schemaPath:[...b.schemaPath,a],path:b.path},e=a._zod.parent;if(e)f.ref=e,this.process(e,c),this.seen.get(e).isParent=!0;else{let b=f.schema;switch(d.type){case"string":{b.type="string";let{minimum:c,maximum:d,format:e,patterns:g,contentEncoding:h}=a._zod.bag;if("number"==typeof c&&(b.minLength=c),"number"==typeof d&&(b.maxLength=d),e&&(b.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[e]??e,""===b.format&&delete b.format),h&&(b.contentEncoding=h),g&&g.size>0){let a=[...g];1===a.length?b.pattern=a[0].source:a.length>1&&(f.schema.allOf=[...a.map(a=>({..."draft-7"===this.target?{type:"string"}:{},pattern:a.source}))])}break}case"number":{let{minimum:c,maximum:d,format:e,multipleOf:f,exclusiveMaximum:g,exclusiveMinimum:h}=a._zod.bag;"string"==typeof e&&e.includes("int")?b.type="integer":b.type="number","number"==typeof h&&(b.exclusiveMinimum=h),"number"==typeof c&&(b.minimum=c,"number"==typeof h&&(h>=c?delete b.minimum:delete b.exclusiveMinimum)),"number"==typeof g&&(b.exclusiveMaximum=g),"number"==typeof d&&(b.maximum=d,"number"==typeof g&&(g<=d?delete b.maximum:delete b.exclusiveMaximum)),"number"==typeof f&&(b.multipleOf=f);break}case"boolean":case"success":b.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":b.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":b.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:e,maximum:f}=a._zod.bag;"number"==typeof e&&(b.minItems=e),"number"==typeof f&&(b.maxItems=f),b.type="array",b.items=this.process(d.element,{...c,path:[...c.path,"items"]});break}case"object":{b.type="object",b.properties={};let a=d.shape;for(let d in a)b.properties[d]=this.process(a[d],{...c,path:[...c.path,"properties",d]});let e=new Set([...new Set(Object.keys(a))].filter(a=>{let b=d.shape[a]._zod;return"input"===this.io?void 0===b.optin:void 0===b.optout}));e.size>0&&(b.required=Array.from(e)),d.catchall?._zod.def.type==="never"?b.additionalProperties=!1:d.catchall?d.catchall&&(b.additionalProperties=this.process(d.catchall,{...c,path:[...c.path,"additionalProperties"]})):"output"===this.io&&(b.additionalProperties=!1);break}case"union":b.anyOf=d.options.map((a,b)=>this.process(a,{...c,path:[...c.path,"anyOf",b]}));break;case"intersection":{let a=this.process(d.left,{...c,path:[...c.path,"allOf",0]}),e=this.process(d.right,{...c,path:[...c.path,"allOf",1]}),f=a=>"allOf"in a&&1===Object.keys(a).length;b.allOf=[...f(a)?a.allOf:[a],...f(e)?e.allOf:[e]];break}case"tuple":{b.type="array";let e=d.items.map((a,b)=>this.process(a,{...c,path:[...c.path,"prefixItems",b]}));if("draft-2020-12"===this.target?b.prefixItems=e:b.items=e,d.rest){let a=this.process(d.rest,{...c,path:[...c.path,"items"]});"draft-2020-12"===this.target?b.items=a:b.additionalItems=a}d.rest&&(b.items=this.process(d.rest,{...c,path:[...c.path,"items"]}));let{minimum:f,maximum:g}=a._zod.bag;"number"==typeof f&&(b.minItems=f),"number"==typeof g&&(b.maxItems=g);break}case"record":b.type="object",b.propertyNames=this.process(d.keyType,{...c,path:[...c.path,"propertyNames"]}),b.additionalProperties=this.process(d.valueType,{...c,path:[...c.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let a=$(d.entries);a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),b.enum=a;break}case"literal":{let a=[];for(let b of d.values)if(void 0===b){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof b)if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");else a.push(Number(b));else a.push(b);if(0===a.length);else if(1===a.length){let c=a[0];b.type=null===c?"null":typeof c,b.const=c}else a.every(a=>"number"==typeof a)&&(b.type="number"),a.every(a=>"string"==typeof a)&&(b.type="string"),a.every(a=>"boolean"==typeof a)&&(b.type="string"),a.every(a=>null===a)&&(b.type="null"),b.enum=a;break}case"file":{let c={type:"string",format:"binary",contentEncoding:"binary"},{minimum:d,maximum:e,mime:f}=a._zod.bag;void 0!==d&&(c.minLength=d),void 0!==e&&(c.maxLength=e),f?1===f.length?(c.contentMediaType=f[0],Object.assign(b,c)):b.anyOf=f.map(a=>({...c,contentMediaType:a})):Object.assign(b,c);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":b.anyOf=[this.process(d.innerType,c),{type:"null"}];break;case"nonoptional":case"promise":case"optional":this.process(d.innerType,c),f.ref=d.innerType;break;case"default":this.process(d.innerType,c),f.ref=d.innerType,b.default=JSON.parse(JSON.stringify(d.defaultValue));break;case"prefault":this.process(d.innerType,c),f.ref=d.innerType,"input"===this.io&&(b._prefault=JSON.parse(JSON.stringify(d.defaultValue)));break;case"catch":{let a;this.process(d.innerType,c),f.ref=d.innerType;try{a=d.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}b.default=a;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let c=a._zod.pattern;if(!c)throw Error("Pattern not found in template literal");b.type="string",b.pattern=c.source;break}case"pipe":{let a="input"===this.io?"transform"===d.in._zod.def.type?d.out:d.in:d.out;this.process(a,c),f.ref=a;break}case"readonly":this.process(d.innerType,c),f.ref=d.innerType,b.readOnly=!0;break;case"lazy":{let b=a._zod.innerType;this.process(b,c),f.ref=b;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let h=this.metadataRegistry.get(a);return h&&Object.assign(f.schema,h),"input"===this.io&&function a(b,c){let d=c??{seen:new Set};if(d.seen.has(b))return!1;d.seen.add(b);let e=b._zod.def;switch(e.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return a(e.element,d);case"object":for(let b in e.shape)if(a(e.shape[b],d))return!0;return!1;case"union":for(let b of e.options)if(a(b,d))return!0;return!1;case"intersection":return a(e.left,d)||a(e.right,d);case"tuple":for(let b of e.items)if(a(b,d))return!0;if(e.rest&&a(e.rest,d))return!0;return!1;case"record":case"map":return a(e.keyType,d)||a(e.valueType,d);case"set":return a(e.valueType,d);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return a(e.innerType,d);case"lazy":return a(e.getter(),d);case"transform":return!0;case"pipe":return a(e.in,d)||a(e.out,d)}throw Error(`Unknown schema type: ${e.type}`)}(a)&&(delete f.schema.examples,delete f.schema.default),"input"===this.io&&f.schema._prefault&&((c=f.schema).default??(c.default=f.schema._prefault)),delete f.schema._prefault,this.seen.get(a).schema}emit(a,b){let c={cycles:b?.cycles??"ref",reused:b?.reused??"inline",external:b?.external??void 0},d=this.seen.get(a);if(!d)throw Error("Unprocessed schema. This is a bug in Zod.");let e=a=>{let b="draft-2020-12"===this.target?"$defs":"definitions";if(c.external){let d=c.external.registry.get(a[0])?.id,e=c.external.uri??(a=>a);if(d)return{ref:e(d)};let f=a[1].defId??a[1].schema.id??`schema${this.counter++}`;return a[1].defId=f,{defId:f,ref:`${e("__shared")}#/${b}/${f}`}}if(a[1]===d)return{ref:"#"};let e=`#/${b}/`,f=a[1].schema.id??`__schema${this.counter++}`;return{defId:f,ref:e+f}},f=a=>{if(a[1].schema.$ref)return;let b=a[1],{ref:c,defId:d}=e(a);b.def={...b.schema},d&&(b.defId=d);let f=b.schema;for(let a in f)delete f[a];f.$ref=c};if("throw"===c.cycles)for(let a of this.seen.entries()){let b=a[1];if(b.cycle)throw Error(`Cycle detected: #/${b.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let b of this.seen.entries()){let d=b[1];if(a===b[0]){f(b);continue}if(c.external){let d=c.external.registry.get(b[0])?.id;if(a!==b[0]&&d){f(b);continue}}if(this.metadataRegistry.get(b[0])?.id||d.cycle||d.count>1&&"ref"===c.reused){f(b);continue}}let g=(a,b)=>{let c=this.seen.get(a),d=c.def??c.schema,e={...d};if(null===c.ref)return;let f=c.ref;if(c.ref=null,f){g(f,b);let a=this.seen.get(f).schema;a.$ref&&"draft-7"===b.target?(d.allOf=d.allOf??[],d.allOf.push(a)):(Object.assign(d,a),Object.assign(d,e))}c.isParent||this.override({zodSchema:a,jsonSchema:d,path:c.path??[]})};for(let a of[...this.seen.entries()].reverse())g(a[0],{target:this.target});let h={};if("draft-2020-12"===this.target?h.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?h.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),c.external?.uri){let b=c.external.registry.get(a)?.id;if(!b)throw Error("Schema is missing an `id` property");h.$id=c.external.uri(b)}Object.assign(h,d.def);let i=c.external?.defs??{};for(let a of this.seen.entries()){let b=a[1];b.def&&b.defId&&(i[b.defId]=b.def)}c.external||Object.keys(i).length>0&&("draft-2020-12"===this.target?h.$defs=i:h.definitions=i);try{return JSON.parse(JSON.stringify(h))}catch(a){throw Error("Error converting schema to JSON.")}}}function av(a,b,c){function d(c,d){var e;for(let f in Object.defineProperty(c,"_zod",{value:c._zod??{},enumerable:!1}),(e=c._zod).traits??(e.traits=new Set),c._zod.traits.add(a),b(c,d),g.prototype)f in c||Object.defineProperty(c,f,{value:g.prototype[f].bind(c)});c._zod.constr=g,c._zod.def=d}let e=c?.Parent??Object;class f extends e{}function g(a){var b;let e=c?.Parent?new f:this;for(let c of(d(e,a),(b=e._zod).deferred??(b.deferred=[]),e._zod.deferred))c();return e}return Object.defineProperty(f,"name",{value:a}),Object.defineProperty(g,"init",{value:d}),Object.defineProperty(g,Symbol.hasInstance,{value:b=>!!c?.Parent&&b instanceof c.Parent||b?._zod?.traits?.has(a)}),Object.defineProperty(g,"name",{value:a}),g}Object.freeze({status:"aborted"}),Symbol("zod_brand");class aw extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let ax={};function ay(a){return a&&Object.assign(ax,a),ax}let az=(a,b)=>{a.name="$ZodError",Object.defineProperty(a,"_zod",{value:a._zod,enumerable:!1}),Object.defineProperty(a,"issues",{value:b,enumerable:!1}),Object.defineProperty(a,"message",{get:()=>JSON.stringify(b,_,2),enumerable:!0}),Object.defineProperty(a,"toString",{value:()=>a.message,enumerable:!1})},aA=av("$ZodError",az),aB=av("$ZodError",az,{Parent:Error}),aC=a=>(b,c,d)=>{let e=d?{...d,async:!1}:{async:!1},f=b._zod.run({value:c,issues:[]},e);if(f instanceof Promise)throw new aw;return f.issues.length?{success:!1,error:new(a??aA)(f.issues.map(a=>ar(a,e,ay())))}:{success:!0,data:f.value}},aD=aC(aB),aE=a=>async(b,c,d)=>{let e=d?Object.assign(d,{async:!0}):{async:!0},f=b._zod.run({value:c,issues:[]},e);return f instanceof Promise&&(f=await f),f.issues.length?{success:!1,error:new a(f.issues.map(a=>ar(a,e,ay())))}:{success:!0,data:f.value}},aF=aE(aB),aG=(a,b)=>{aA.init(a,b),a.name="ZodError",Object.defineProperties(a,{format:{value:b=>(function(a,b){let c=b||function(a){return a.message},d={_errors:[]},e=a=>{for(let b of a.issues)if("invalid_union"===b.code&&b.errors.length)b.errors.map(a=>e({issues:a}));else if("invalid_key"===b.code)e({issues:b.issues});else if("invalid_element"===b.code)e({issues:b.issues});else if(0===b.path.length)d._errors.push(c(b));else{let a=d,e=0;for(;e<b.path.length;){let d=b.path[e];e===b.path.length-1?(a[d]=a[d]||{_errors:[]},a[d]._errors.push(c(b))):a[d]=a[d]||{_errors:[]},a=a[d],e++}}};return e(a),d})(a,b)},flatten:{value:b=>(function(a,b=a=>a.message){let c={},d=[];for(let e of a.issues)e.path.length>0?(c[e.path[0]]=c[e.path[0]]||[],c[e.path[0]].push(b(e))):d.push(b(e));return{formErrors:d,fieldErrors:c}})(a,b)},addIssue:{value:b=>a.issues.push(b)},addIssues:{value:b=>a.issues.push(...b)},isEmpty:{get:()=>0===a.issues.length}})};av("ZodError",aG);let aH=av("ZodError",aG,{Parent:Error}),aI=(a,b,c,d)=>{let e=c?Object.assign(c,{async:!1}):{async:!1},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise)throw new aw;if(f.issues.length){let a=new(d?.Err??aH)(f.issues.map(a=>ar(a,e,ay())));throw af(a,d?.callee),a}return f.value},aJ=async(a,b,c,d)=>{let e=c?Object.assign(c,{async:!0}):{async:!0},f=a._zod.run({value:b,issues:[]},e);if(f instanceof Promise&&(f=await f),f.issues.length){let a=new(d?.Err??aH)(f.issues.map(a=>ar(a,e,ay())));throw af(a,d?.callee),a}return f.value},aK=aC(aH),aL=aE(aH);!function(a){a.assertEqual=a=>{},a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(m||(m={})),(n||(n={})).mergeShapes=(a,b)=>({...a,...b});let aM=m.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),aN=a=>{switch(typeof a){case"undefined":return aM.undefined;case"string":return aM.string;case"number":return Number.isNaN(a)?aM.nan:aM.number;case"boolean":return aM.boolean;case"function":return aM.function;case"bigint":return aM.bigint;case"symbol":return aM.symbol;case"object":if(Array.isArray(a))return aM.array;if(null===a)return aM.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return aM.promise;if("undefined"!=typeof Map&&a instanceof Map)return aM.map;if("undefined"!=typeof Set&&a instanceof Set)return aM.set;if("undefined"!=typeof Date&&a instanceof Date)return aM.date;return aM.object;default:return aM.unknown}},aO=m.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class aP extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof aP))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,m.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}aP.create=a=>new aP(a);let aQ=(a,b)=>{let c;switch(a.code){case aO.invalid_type:c=a.received===aM.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case aO.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,m.jsonStringifyReplacer)}`;break;case aO.unrecognized_keys:c=`Unrecognized key(s) in object: ${m.joinValues(a.keys,", ")}`;break;case aO.invalid_union:c="Invalid input";break;case aO.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${m.joinValues(a.options)}`;break;case aO.invalid_enum_value:c=`Invalid enum value. Expected ${m.joinValues(a.options)}, received '${a.received}'`;break;case aO.invalid_arguments:c="Invalid function arguments";break;case aO.invalid_return_type:c="Invalid function return type";break;case aO.invalid_date:c="Invalid date";break;case aO.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:m.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case aO.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case aO.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case aO.custom:c="Invalid input";break;case aO.invalid_intersection_types:c="Intersection results could not be merged";break;case aO.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case aO.not_finite:c="Number must be finite";break;default:c=b.defaultError,m.assertNever(a)}return{message:c}};!function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:a?.message}(o||(o={}));let aR=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function aS(a,b){let c=aR({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,aQ,void 0].filter(a=>!!a)});a.common.issues.push(c)}class aT{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return aU;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return aT.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return aU;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let aU=Object.freeze({status:"aborted"}),aV=a=>({status:"dirty",value:a}),aW=a=>({status:"valid",value:a}),aX=a=>"undefined"!=typeof Promise&&a instanceof Promise;class aY{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let aZ=(a,b)=>{if("valid"===b.status)return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new aP(a.common.issues);return this._error=b,this._error}}};function a$(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class a_{get description(){return this._def.description}_getType(a){return aN(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:aN(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new aT,ctx:{common:a.parent.common,data:a.data,parsedType:aN(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(aX(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:aN(a)},d=this._parseSync({data:a,path:c.path,parent:c});return aZ(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:aN(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return"valid"===c.status?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>"valid"===a.status?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:aN(a)},d=this._parse({data:a,path:c.path,parent:c});return aZ(c,await (aX(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:aO.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new bK({schema:this,typeName:p.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return bL.create(this,this._def)}nullable(){return bM.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bt.create(this)}promise(){return bJ.create(this,this._def)}or(a){return bv.create([this,a],this._def)}and(a){return by.create(this,a,this._def)}transform(a){return new bK({...a$(this._def),schema:this,typeName:p.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new bN({...a$(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:p.ZodDefault})}brand(){return new bQ({typeName:p.ZodBranded,type:this,...a$(this._def)})}catch(a){return new bO({...a$(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:p.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return bR.create(this,a)}readonly(){return bS.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let a0=/^c[^\s-]{8,}$/i,a1=/^[0-9a-z]+$/,a2=/^[0-9A-HJKMNP-TV-Z]{26}$/i,a3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,a4=/^[a-z0-9_-]{21}$/i,a5=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,a6=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,a7=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,a8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,a9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ba=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,bb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,bc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,bd=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,be="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",bf=RegExp(`^${be}$`);function bg(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}class bh extends a_{_parse(a){var b,c,e,f;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==aM.string){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.string,received:b.parsedType}),aU}let h=new aT;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(aS(g=this._getOrReturnCtx(a,g),{code:aO.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(aS(g=this._getOrReturnCtx(a,g),{code:aO.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?aS(g,{code:aO.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&aS(g,{code:aO.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)a7.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"email",code:aO.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)d||(d=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),d.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:aO.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)a3.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:aO.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)a4.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:aO.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)a0.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:aO.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)a1.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:aO.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)a2.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:aO.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{aS(g=this._getOrReturnCtx(a,g),{validation:"url",code:aO.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"regex",code:aO.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?(function(a){let b=`${be}T${bg(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)})(i).test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?bf.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${bg(i)}$`).test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{code:aO.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?a6.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"duration",code:aO.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&a8.test(b)||("v6"===c||!c)&&ba.test(b))&&1&&(aS(g=this._getOrReturnCtx(a,g),{validation:"ip",code:aO.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!a5.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(aS(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:aO.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(e=a.data,!(("v4"===(f=i.version)||!f)&&a9.test(e)||("v6"===f||!f)&&bb.test(e))&&1&&(aS(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:aO.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?bc.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"base64",code:aO.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?bd.test(a.data)||(aS(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:aO.invalid_string,message:i.message}),h.dirty()):m.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:aO.invalid_string,...o.errToObj(c)})}_addCheck(a){return new bh({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...o.errToObj(a)})}url(a){return this._addCheck({kind:"url",...o.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...o.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...o.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...o.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...o.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...o.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...o.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...o.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...o.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...o.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...o.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...o.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...o.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...o.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...o.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...o.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...o.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...o.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...o.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...o.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...o.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...o.errToObj(b)})}nonempty(a){return this.min(1,o.errToObj(a))}trim(){return new bh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}bh.create=a=>new bh({checks:[],typeName:p.ZodString,coerce:a?.coerce??!1,...a$(a)});class bi extends a_{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==aM.number){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.number,received:b.parsedType}),aU}let c=new aT;for(let d of this._def.checks)"int"===d.kind?m.isInteger(a.data)||(aS(b=this._getOrReturnCtx(a,b),{code:aO.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(aS(b=this._getOrReturnCtx(a,b),{code:aO.not_finite,message:d.message}),c.dirty()):m.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,o.toString(b))}gt(a,b){return this.setLimit("min",a,!1,o.toString(b))}lte(a,b){return this.setLimit("max",a,!0,o.toString(b))}lt(a,b){return this.setLimit("max",a,!1,o.toString(b))}setLimit(a,b,c,d){return new bi({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:o.toString(d)}]})}_addCheck(a){return new bi({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:o.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:o.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:o.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:o.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:o.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:o.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:o.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:o.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:o.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&m.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}bi.create=a=>new bi({checks:[],typeName:p.ZodNumber,coerce:a?.coerce||!1,...a$(a)});class bj extends a_{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==aM.bigint)return this._getInvalidInput(a);let c=new aT;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):m.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.bigint,received:b.parsedType}),aU}gte(a,b){return this.setLimit("min",a,!0,o.toString(b))}gt(a,b){return this.setLimit("min",a,!1,o.toString(b))}lte(a,b){return this.setLimit("max",a,!0,o.toString(b))}lt(a,b){return this.setLimit("max",a,!1,o.toString(b))}setLimit(a,b,c,d){return new bj({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:o.toString(d)}]})}_addCheck(a){return new bj({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:o.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:o.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:o.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:o.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:o.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}bj.create=a=>new bj({checks:[],typeName:p.ZodBigInt,coerce:a?.coerce??!1,...a$(a)});class bk extends a_{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==aM.boolean){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.boolean,received:b.parsedType}),aU}return aW(a.data)}}bk.create=a=>new bk({typeName:p.ZodBoolean,coerce:a?.coerce||!1,...a$(a)});class bl extends a_{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==aM.date){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.date,received:b.parsedType}),aU}if(Number.isNaN(a.data.getTime()))return aS(this._getOrReturnCtx(a),{code:aO.invalid_date}),aU;let c=new aT;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(aS(b=this._getOrReturnCtx(a,b),{code:aO.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):m.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new bl({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:o.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:o.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}bl.create=a=>new bl({checks:[],coerce:a?.coerce||!1,typeName:p.ZodDate,...a$(a)});class bm extends a_{_parse(a){if(this._getType(a)!==aM.symbol){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.symbol,received:b.parsedType}),aU}return aW(a.data)}}bm.create=a=>new bm({typeName:p.ZodSymbol,...a$(a)});class bn extends a_{_parse(a){if(this._getType(a)!==aM.undefined){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.undefined,received:b.parsedType}),aU}return aW(a.data)}}bn.create=a=>new bn({typeName:p.ZodUndefined,...a$(a)});class bo extends a_{_parse(a){if(this._getType(a)!==aM.null){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.null,received:b.parsedType}),aU}return aW(a.data)}}bo.create=a=>new bo({typeName:p.ZodNull,...a$(a)});class bp extends a_{constructor(){super(...arguments),this._any=!0}_parse(a){return aW(a.data)}}bp.create=a=>new bp({typeName:p.ZodAny,...a$(a)});class bq extends a_{constructor(){super(...arguments),this._unknown=!0}_parse(a){return aW(a.data)}}bq.create=a=>new bq({typeName:p.ZodUnknown,...a$(a)});class br extends a_{_parse(a){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.never,received:b.parsedType}),aU}}br.create=a=>new br({typeName:p.ZodNever,...a$(a)});class bs extends a_{_parse(a){if(this._getType(a)!==aM.undefined){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.void,received:b.parsedType}),aU}return aW(a.data)}}bs.create=a=>new bs({typeName:p.ZodVoid,...a$(a)});class bt extends a_{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==aM.array)return aS(b,{code:aO.invalid_type,expected:aM.array,received:b.parsedType}),aU;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(aS(b,{code:a?aO.too_big:aO.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(aS(b,{code:aO.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(aS(b,{code:aO.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new aY(b,a,b.path,c)))).then(a=>aT.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new aY(b,a,b.path,c)));return aT.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new bt({...this._def,minLength:{value:a,message:o.toString(b)}})}max(a,b){return new bt({...this._def,maxLength:{value:a,message:o.toString(b)}})}length(a,b){return new bt({...this._def,exactLength:{value:a,message:o.toString(b)}})}nonempty(a){return this.min(1,a)}}bt.create=(a,b)=>new bt({type:a,minLength:null,maxLength:null,exactLength:null,typeName:p.ZodArray,...a$(b)});class bu extends a_{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=m.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==aM.object){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.object,received:b.parsedType}),aU}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof br&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new aY(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof br){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(aS(c,{code:aO.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new aY(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>aT.mergeObjectSync(b,a)):aT.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return o.errToObj,new bu({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:o.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new bu({...this._def,unknownKeys:"strip"})}passthrough(){return new bu({...this._def,unknownKeys:"passthrough"})}extend(a){return new bu({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new bu({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:p.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new bu({...this._def,catchall:a})}pick(a){let b={};for(let c of m.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new bu({...this._def,shape:()=>b})}omit(a){let b={};for(let c of m.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new bu({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof bu){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=bL.create(a(e))}return new bu({...b._def,shape:()=>c})}if(b instanceof bt)return new bt({...b._def,type:a(b.element)});if(b instanceof bL)return bL.create(a(b.unwrap()));if(b instanceof bM)return bM.create(a(b.unwrap()));if(b instanceof bz)return bz.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of m.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new bu({...this._def,shape:()=>b})}required(a){let b={};for(let c of m.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof bL;)a=a._def.innerType;b[c]=a}return new bu({...this._def,shape:()=>b})}keyof(){return bG(m.objectKeys(this.shape))}}bu.create=(a,b)=>new bu({shape:()=>a,unknownKeys:"strip",catchall:br.create(),typeName:p.ZodObject,...a$(b)}),bu.strictCreate=(a,b)=>new bu({shape:()=>a,unknownKeys:"strict",catchall:br.create(),typeName:p.ZodObject,...a$(b)}),bu.lazycreate=(a,b)=>new bu({shape:a,unknownKeys:"strip",catchall:br.create(),typeName:p.ZodObject,...a$(b)});class bv extends a_{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new aP(a.ctx.common.issues));return aS(b,{code:aO.invalid_union,unionErrors:c}),aU});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new aP(a));return aS(b,{code:aO.invalid_union,unionErrors:e}),aU}}get options(){return this._def.options}}bv.create=(a,b)=>new bv({options:a,typeName:p.ZodUnion,...a$(b)});let bw=a=>{if(a instanceof bE)return bw(a.schema);if(a instanceof bK)return bw(a.innerType());if(a instanceof bF)return[a.value];if(a instanceof bH)return a.options;if(a instanceof bI)return m.objectValues(a.enum);else if(a instanceof bN)return bw(a._def.innerType);else if(a instanceof bn)return[void 0];else if(a instanceof bo)return[null];else if(a instanceof bL)return[void 0,...bw(a.unwrap())];else if(a instanceof bM)return[null,...bw(a.unwrap())];else if(a instanceof bQ)return bw(a.unwrap());else if(a instanceof bS)return bw(a.unwrap());else if(a instanceof bO)return bw(a._def.innerType);else return[]};class bx extends a_{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==aM.object)return aS(b,{code:aO.invalid_type,expected:aM.object,received:b.parsedType}),aU;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(aS(b,{code:aO.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),aU)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=bw(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new bx({typeName:p.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...a$(c)})}}class by extends a_{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if("aborted"===a.status||"aborted"===d.status)return aU;let e=function a(b,c){let d=aN(b),e=aN(c);if(b===c)return{valid:!0,data:b};if(d===aM.object&&e===aM.object){let d=m.objectKeys(c),e=m.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===aM.array&&e===aM.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===aM.date&&e===aM.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?(("dirty"===a.status||"dirty"===d.status)&&b.dirty(),{status:b.value,value:e.data}):(aS(c,{code:aO.invalid_intersection_types}),aU)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}by.create=(a,b,c)=>new by({left:a,right:b,typeName:p.ZodIntersection,...a$(c)});class bz extends a_{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==aM.array)return aS(c,{code:aO.invalid_type,expected:aM.array,received:c.parsedType}),aU;if(c.data.length<this._def.items.length)return aS(c,{code:aO.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),aU;!this._def.rest&&c.data.length>this._def.items.length&&(aS(c,{code:aO.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new aY(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>aT.mergeArray(b,a)):aT.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new bz({...this._def,rest:a})}}bz.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new bz({items:a,typeName:p.ZodTuple,rest:null,...a$(b)})};class bA extends a_{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==aM.object)return aS(c,{code:aO.invalid_type,expected:aM.object,received:c.parsedType}),aU;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new aY(c,a,c.path,a)),value:f._parse(new aY(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?aT.mergeObjectAsync(b,d):aT.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new bA(b instanceof a_?{keyType:a,valueType:b,typeName:p.ZodRecord,...a$(c)}:{keyType:bh.create(),valueType:a,typeName:p.ZodRecord,...a$(b)})}}class bB extends a_{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==aM.map)return aS(c,{code:aO.invalid_type,expected:aM.map,received:c.parsedType}),aU;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new aY(c,a,c.path,[f,"key"])),value:e._parse(new aY(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return aU;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return aU;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}bB.create=(a,b,c)=>new bB({valueType:b,keyType:a,typeName:p.ZodMap,...a$(c)});class bC extends a_{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==aM.set)return aS(c,{code:aO.invalid_type,expected:aM.set,received:c.parsedType}),aU;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(aS(c,{code:aO.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(aS(c,{code:aO.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return aU;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new aY(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new bC({...this._def,minSize:{value:a,message:o.toString(b)}})}max(a,b){return new bC({...this._def,maxSize:{value:a,message:o.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}bC.create=(a,b)=>new bC({valueType:a,minSize:null,maxSize:null,typeName:p.ZodSet,...a$(b)});class bD extends a_{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==aM.function)return aS(b,{code:aO.invalid_type,expected:aM.function,received:b.parsedType}),aU;function c(a,c){return aR({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,aQ,aQ].filter(a=>!!a),issueData:{code:aO.invalid_arguments,argumentsError:c}})}function d(a,c){return aR({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,aQ,aQ].filter(a=>!!a),issueData:{code:aO.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof bJ){let a=this;return aW(async function(...b){let g=new aP([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return aW(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new aP([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new aP([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new bD({...this._def,args:bz.create(a).rest(bq.create())})}returns(a){return new bD({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new bD({args:a||bz.create([]).rest(bq.create()),returns:b||bq.create(),typeName:p.ZodFunction,...a$(c)})}}class bE extends a_{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}bE.create=(a,b)=>new bE({getter:a,typeName:p.ZodLazy,...a$(b)});class bF extends a_{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return aS(b,{received:b.data,code:aO.invalid_literal,expected:this._def.value}),aU}return{status:"valid",value:a.data}}get value(){return this._def.value}}function bG(a,b){return new bH({values:a,typeName:p.ZodEnum,...a$(b)})}bF.create=(a,b)=>new bF({value:a,typeName:p.ZodLiteral,...a$(b)});class bH extends a_{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return aS(b,{expected:m.joinValues(c),received:b.parsedType,code:aO.invalid_type}),aU}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return aS(b,{received:b.data,code:aO.invalid_enum_value,options:c}),aU}return aW(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return bH.create(a,{...this._def,...b})}exclude(a,b=this._def){return bH.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}bH.create=bG;class bI extends a_{_parse(a){let b=m.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==aM.string&&c.parsedType!==aM.number){let a=m.objectValues(b);return aS(c,{expected:m.joinValues(a),received:c.parsedType,code:aO.invalid_type}),aU}if(this._cache||(this._cache=new Set(m.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=m.objectValues(b);return aS(c,{received:c.data,code:aO.invalid_enum_value,options:a}),aU}return aW(a.data)}get enum(){return this._def.values}}bI.create=(a,b)=>new bI({values:a,typeName:p.ZodNativeEnum,...a$(b)});class bJ extends a_{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==aM.promise&&!1===b.common.async?(aS(b,{code:aO.invalid_type,expected:aM.promise,received:b.parsedType}),aU):aW((b.parsedType===aM.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}bJ.create=(a,b)=>new bJ({type:a,typeName:p.ZodPromise,...a$(b)});class bK extends a_{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===p.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{aS(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return aU;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?aU:"dirty"===d.status||"dirty"===b.value?aV(d.value):d});{if("aborted"===b.value)return aU;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?aU:"dirty"===d.status||"dirty"===b.value?aV(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?aU:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?aU:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>"valid"!==a.status?aU:Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})));else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if("valid"!==a.status)return aU;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}m.assertNever(d)}}bK.create=(a,b,c)=>new bK({schema:a,typeName:p.ZodEffects,effect:b,...a$(c)}),bK.createWithPreprocess=(a,b,c)=>new bK({schema:b,effect:{type:"preprocess",transform:a},typeName:p.ZodEffects,...a$(c)});class bL extends a_{_parse(a){return this._getType(a)===aM.undefined?aW(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}bL.create=(a,b)=>new bL({innerType:a,typeName:p.ZodOptional,...a$(b)});class bM extends a_{_parse(a){return this._getType(a)===aM.null?aW(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}bM.create=(a,b)=>new bM({innerType:a,typeName:p.ZodNullable,...a$(b)});class bN extends a_{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===aM.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}bN.create=(a,b)=>new bN({innerType:a,typeName:p.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...a$(b)});class bO extends a_{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return aX(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new aP(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new aP(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}bO.create=(a,b)=>new bO({innerType:a,typeName:p.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...a$(b)});class bP extends a_{_parse(a){if(this._getType(a)!==aM.nan){let b=this._getOrReturnCtx(a);return aS(b,{code:aO.invalid_type,expected:aM.nan,received:b.parsedType}),aU}return{status:"valid",value:a.data}}}bP.create=a=>new bP({typeName:p.ZodNaN,...a$(a)}),Symbol("zod_brand");class bQ extends a_{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class bR extends a_{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?aU:"dirty"===a.status?(b.dirty(),aV(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?aU:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new bR({in:a,out:b,typeName:p.ZodPipeline})}}class bS extends a_{_parse(a){let b=this._def.innerType._parse(a),c=a=>("valid"===a.status&&(a.value=Object.freeze(a.value)),a);return aX(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}bS.create=(a,b)=>new bS({innerType:a,typeName:p.ZodReadonly,...a$(b)}),bu.lazycreate,function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(p||(p={})),bh.create,bi.create,bP.create,bj.create,bk.create,bl.create,bm.create,bn.create,bo.create,bp.create,bq.create,br.create,bs.create,bt.create,bu.create,bu.strictCreate,bv.create,bx.create,by.create,bz.create,bA.create,bB.create,bC.create,bD.create,bE.create,bF.create,bH.create,bI.create,bJ.create,bK.create,bL.create,bM.create,bK.createWithPreprocess,bR.create;class bT extends Error{constructor(a,b){super(a),this.name="ParseError",this.type=b.type,this.field=b.field,this.value=b.value,this.line=b.line}}function bU(a){}class bV extends TransformStream{constructor({onError:a,onRetry:b,onComment:c}={}){let d;super({start(e){d=function(a){if("function"==typeof a)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:b=bU,onError:c=bU,onRetry:d=bU,onComment:e}=a,f="",g=!0,h,i="",j="";function k(a){if(""===a)return void(i.length>0&&b({id:h,event:j||void 0,data:i.endsWith(`
`)?i.slice(0,-1):i}),h=void 0,i="",j="");if(a.startsWith(":")){e&&e(a.slice(a.startsWith(": ")?2:1));return}let c=a.indexOf(":");if(-1!==c){let b=a.slice(0,c),d=" "===a[c+1]?2:1;l(b,a.slice(c+d),a);return}l(a,"",a)}function l(a,b,e){switch(a){case"event":j=b;break;case"data":i=`${i}${b}
`;break;case"id":h=b.includes("\0")?void 0:b;break;case"retry":/^\d+$/.test(b)?d(parseInt(b,10)):c(new bT(`Invalid \`retry\` value: "${b}"`,{type:"invalid-retry",value:b,line:e}));break;default:c(new bT(`Unknown field "${a.length>20?`${a.slice(0,20)}\u2026`:a}"`,{type:"unknown-field",field:a,value:b,line:e}))}}return{feed:function(a){let b=g?a.replace(/^\xEF\xBB\xBF/,""):a,[c,d]=function(a){let b=[],c="",d=0;for(;d<a.length;){let e=a.indexOf("\r",d),f=a.indexOf(`
`,d),g=-1;if(-1!==e&&-1!==f?g=Math.min(e,f):-1!==e?g=e===a.length-1?-1:e:-1!==f&&(g=f),-1===g){c=a.slice(d);break}{let c=a.slice(d,g);b.push(c),"\r"===a[(d=g+1)-1]&&a[d]===`
`&&d++}}return[b,c]}(`${f}${b}`);for(let a of c)k(a);f=d,g=!1},reset:function(a={}){f&&a.consume&&k(f),g=!0,h=void 0,i="",j="",f=""}}}({onEvent:a=>{e.enqueue(a)},onError(b){"terminate"===a?e.error(b):"function"==typeof a&&a(b)},onRetry:b,onComment:c})},transform(a){d.feed(a)}})}}var{btoa:bW,atob:bX}=globalThis,bY=Symbol.for("vercel.ai.error.AI_DownloadError"),bZ=({prefix:a,size:b=16,alphabet:c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:d="-"}={})=>{let e=()=>{let a=c.length,d=Array(b);for(let e=0;e<b;e++)d[e]=c[Math.random()*a|0];return d.join("")};if(null==a)return e;if(c.includes(d))throw new M({argument:"separator",message:`The separator "${d}" must not be part of the alphabet "${c}".`});return()=>`${a}${d}${e()}`},b$=bZ();function b_(a=globalThis){var b,c,d;return a.window?"runtime/browser":(null==(b=a.navigator)?void 0:b.userAgent)?`runtime/${a.navigator.userAgent.toLowerCase()}`:(null==(d=null==(c=a.process)?void 0:c.versions)?void 0:d.node)?`runtime/node.js/${a.process.version.substring(0)}`:a.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function b0(a){if(null==a)return{};let b={};if(a instanceof Headers)a.forEach((a,c)=>{b[c.toLowerCase()]=a});else for(let[c,d]of(Array.isArray(a)||(a=Object.entries(a)),a))null!=d&&(b[c.toLowerCase()]=d);return b}function b1(a,...b){let c=new Headers(b0(a)),d=c.get("user-agent")||"";return c.set("user-agent",[d,...b].filter(Boolean).join(" ")),Object.fromEntries(c.entries())}var b2=/"__proto__"\s*:/,b3=/"constructor"\s*:/;function b4(a){let b=JSON.parse(a);return null===b||"object"!=typeof b||!1===b2.test(a)&&!1===b3.test(a)?b:function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b)}function b5(a){if("object"===a.type||Array.isArray(a.type)&&a.type.includes("object")){a.additionalProperties=!1;let{properties:b}=a;if(null!=b)for(let a of Object.keys(b))b[a]=b6(b[a])}null!=a.items&&(a.items=Array.isArray(a.items)?a.items.map(b6):b6(a.items)),null!=a.anyOf&&(a.anyOf=a.anyOf.map(b6)),null!=a.allOf&&(a.allOf=a.allOf.map(b6)),null!=a.oneOf&&(a.oneOf=a.oneOf.map(b6));let{definitions:b}=a;if(null!=b)for(let a of Object.keys(b))b[a]=b6(b[a]);return a}function b6(a){return"boolean"==typeof a?a:b5(a)}var b7=Symbol("Let zodToJsonSchema decide on which parser to use"),b8={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function b9(a,b){return ck(a.type._def,b)}var ca=void 0,cb={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===ca&&(ca=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ca),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function cc(a,b){let c={type:"string"};if(a.checks)for(let d of a.checks)switch(d.kind){case"min":c.minLength="number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value;break;case"max":c.maxLength="number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value;break;case"email":switch(b.emailStrategy){case"format:email":cf(c,"email",d.message,b);break;case"format:idn-email":cf(c,"idn-email",d.message,b);break;case"pattern:zod":cg(c,cb.email,d.message,b)}break;case"url":cf(c,"uri",d.message,b);break;case"uuid":cf(c,"uuid",d.message,b);break;case"regex":cg(c,d.regex,d.message,b);break;case"cuid":cg(c,cb.cuid,d.message,b);break;case"cuid2":cg(c,cb.cuid2,d.message,b);break;case"startsWith":cg(c,RegExp(`^${cd(d.value,b)}`),d.message,b);break;case"endsWith":cg(c,RegExp(`${cd(d.value,b)}$`),d.message,b);break;case"datetime":cf(c,"date-time",d.message,b);break;case"date":cf(c,"date",d.message,b);break;case"time":cf(c,"time",d.message,b);break;case"duration":cf(c,"duration",d.message,b);break;case"length":c.minLength="number"==typeof c.minLength?Math.max(c.minLength,d.value):d.value,c.maxLength="number"==typeof c.maxLength?Math.min(c.maxLength,d.value):d.value;break;case"includes":cg(c,RegExp(cd(d.value,b)),d.message,b);break;case"ip":"v6"!==d.version&&cf(c,"ipv4",d.message,b),"v4"!==d.version&&cf(c,"ipv6",d.message,b);break;case"base64url":cg(c,cb.base64url,d.message,b);break;case"jwt":cg(c,cb.jwt,d.message,b);break;case"cidr":"v6"!==d.version&&cg(c,cb.ipv4Cidr,d.message,b),"v4"!==d.version&&cg(c,cb.ipv6Cidr,d.message,b);break;case"emoji":cg(c,cb.emoji(),d.message,b);break;case"ulid":cg(c,cb.ulid,d.message,b);break;case"base64":switch(b.base64Strategy){case"format:binary":cf(c,"binary",d.message,b);break;case"contentEncoding:base64":c.contentEncoding="base64";break;case"pattern:zod":cg(c,cb.base64,d.message,b)}break;case"nanoid":cg(c,cb.nanoid,d.message,b)}return c}function cd(a,b){return"escape"===b.patternStrategy?function(a){let b="";for(let c=0;c<a.length;c++)ce.has(a[c])||(b+="\\"),b+=a[c];return b}(a):a}var ce=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function cf(a,b,c,d){var e;a.format||(null==(e=a.anyOf)?void 0:e.some(a=>a.format))?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push({format:a.format}),delete a.format),a.anyOf.push({format:b,...c&&d.errorMessages&&{errorMessage:{format:c}}})):a.format=b}function cg(a,b,c,d){var e;a.pattern||(null==(e=a.allOf)?void 0:e.some(a=>a.pattern))?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push({pattern:a.pattern}),delete a.pattern),a.allOf.push({pattern:ch(b,d),...c&&d.errorMessages&&{errorMessage:{pattern:c}}})):a.pattern=ch(b,d)}function ch(a,b){var c;if(!b.applyRegexFlags||!a.flags)return a.source;let d={i:a.flags.includes("i"),m:a.flags.includes("m"),s:a.flags.includes("s")},e=d.i?a.source.toLowerCase():a.source,f="",g=!1,h=!1,i=!1;for(let a=0;a<e.length;a++){if(g){f+=e[a],g=!1;continue}if(d.i){if(h){if(e[a].match(/[a-z]/)){i?(f+=e[a],f+=`${e[a-2]}-${e[a]}`.toUpperCase(),i=!1):"-"===e[a+1]&&(null==(c=e[a+2])?void 0:c.match(/[a-z]/))?(f+=e[a],i=!0):f+=`${e[a]}${e[a].toUpperCase()}`;continue}}else if(e[a].match(/[a-z]/)){f+=`[${e[a]}${e[a].toUpperCase()}]`;continue}}if(d.m){if("^"===e[a]){f+=`(^|(?<=[\r
]))`;continue}else if("$"===e[a]){f+=`($|(?=[\r
]))`;continue}}if(d.s&&"."===e[a]){f+=h?`${e[a]}\r
`:`[${e[a]}\r
]`;continue}f+=e[a],"\\"===e[a]?g=!0:h&&"]"===e[a]?h=!1:h||"["!==e[a]||(h=!0)}try{new RegExp(f)}catch(c){return console.warn(`Could not convert regex pattern at ${b.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),a.source}return f}function ci(a,b){var c,d,e,f,g,h;let i={type:"object",additionalProperties:null!=(c=ck(a.valueType._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]}))?c:b.allowedAdditionalProperties};if((null==(d=a.keyType)?void 0:d._def.typeName)===p.ZodString&&(null==(e=a.keyType._def.checks)?void 0:e.length)){let{type:c,...d}=cc(a.keyType._def,b);return{...i,propertyNames:d}}if((null==(f=a.keyType)?void 0:f._def.typeName)===p.ZodEnum)return{...i,propertyNames:{enum:a.keyType._def.values}};if((null==(g=a.keyType)?void 0:g._def.typeName)===p.ZodBranded&&a.keyType._def.type._def.typeName===p.ZodString&&(null==(h=a.keyType._def.type._def.checks)?void 0:h.length)){let{type:c,...d}=b9(a.keyType._def,b);return{...i,propertyNames:d}}return i}var cj={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function ck(a,b,c=!1){var d;let e=b.seen.get(a);if(b.override){let f=null==(d=b.override)?void 0:d.call(b,a,b,e,c);if(f!==b7)return f}if(e&&!c){let a=cl(e,b);if(void 0!==a)return a}let f={def:a,path:b.currentPath,jsonSchema:void 0};b.seen.set(a,f);let g=((a,b,c)=>{switch(b){case p.ZodString:return cc(a,c);case p.ZodNumber:var d,e,f,g,h,i,j=a;let k={type:"number"};if(!j.checks)return k;for(let a of j.checks)switch(a.kind){case"int":k.type="integer";break;case"min":a.inclusive?k.minimum=a.value:k.exclusiveMinimum=a.value;break;case"max":a.inclusive?k.maximum=a.value:k.exclusiveMaximum=a.value;break;case"multipleOf":k.multipleOf=a.value}return k;case p.ZodObject:return function(a,b){let c={type:"object",properties:{}},d=[],e=a.shape();for(let a in e){let f=e[a];if(void 0===f||void 0===f._def)continue;let g=function(a){try{return a.isOptional()}catch(a){return!0}}(f),h=ck(f._def,{...b,currentPath:[...b.currentPath,"properties",a],propertyPath:[...b.currentPath,"properties",a]});void 0!==h&&(c.properties[a]=h,g||d.push(a))}d.length&&(c.required=d);let f=function(a,b){if("ZodNever"!==a.catchall._def.typeName)return ck(a.catchall._def,{...b,currentPath:[...b.currentPath,"additionalProperties"]});switch(a.unknownKeys){case"passthrough":return b.allowedAdditionalProperties;case"strict":return b.rejectedAdditionalProperties;case"strip":return"strict"===b.removeAdditionalStrategy?b.allowedAdditionalProperties:b.rejectedAdditionalProperties}}(a,b);return void 0!==f&&(c.additionalProperties=f),c}(a,c);case p.ZodBigInt:var l=a;let m={type:"integer",format:"int64"};if(!l.checks)return m;for(let a of l.checks)switch(a.kind){case"min":a.inclusive?m.minimum=a.value:m.exclusiveMinimum=a.value;break;case"max":a.inclusive?m.maximum=a.value:m.exclusiveMaximum=a.value;break;case"multipleOf":m.multipleOf=a.value}return m;case p.ZodBoolean:return{type:"boolean"};case p.ZodDate:return function a(b,c,d){let e=null!=d?d:c.dateStrategy;if(Array.isArray(e))return{anyOf:e.map((d,e)=>a(b,c,d))};switch(e){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":var f=b;let g={type:"integer",format:"unix-time"};for(let a of f.checks)switch(a.kind){case"min":g.minimum=a.value;break;case"max":g.maximum=a.value}return g}}(a,c);case p.ZodUndefined:return{not:{}};case p.ZodNull:return{type:"null"};case p.ZodArray:var n,o,q,r=a,s=c;let t={type:"array"};return(null==(n=r.type)?void 0:n._def)&&(null==(q=null==(o=r.type)?void 0:o._def)?void 0:q.typeName)!==p.ZodAny&&(t.items=ck(r.type._def,{...s,currentPath:[...s.currentPath,"items"]})),r.minLength&&(t.minItems=r.minLength.value),r.maxLength&&(t.maxItems=r.maxLength.value),r.exactLength&&(t.minItems=r.exactLength.value,t.maxItems=r.exactLength.value),t;case p.ZodUnion:case p.ZodDiscriminatedUnion:return function(a,b){let c=a.options instanceof Map?Array.from(a.options.values()):a.options;if(c.every(a=>a._def.typeName in cj&&(!a._def.checks||!a._def.checks.length))){let a=c.reduce((a,b)=>{let c=cj[b._def.typeName];return c&&!a.includes(c)?[...a,c]:a},[]);return{type:a.length>1?a:a[0]}}if(c.every(a=>"ZodLiteral"===a._def.typeName&&!a.description)){let a=c.reduce((a,b)=>{let c=typeof b._def.value;switch(c){case"string":case"number":case"boolean":return[...a,c];case"bigint":return[...a,"integer"];case"object":if(null===b._def.value)return[...a,"null"];default:return a}},[]);if(a.length===c.length){let b=a.filter((a,b,c)=>c.indexOf(a)===b);return{type:b.length>1?b:b[0],enum:c.reduce((a,b)=>a.includes(b._def.value)?a:[...a,b._def.value],[])}}}else if(c.every(a=>"ZodEnum"===a._def.typeName))return{type:"string",enum:c.reduce((a,b)=>[...a,...b._def.values.filter(b=>!a.includes(b))],[])};var d=a,e=b;let f=(d.options instanceof Map?Array.from(d.options.values()):d.options).map((a,b)=>ck(a._def,{...e,currentPath:[...e.currentPath,"anyOf",`${b}`]})).filter(a=>!!a&&(!e.strictUnions||"object"==typeof a&&Object.keys(a).length>0));return f.length?{anyOf:f}:void 0}(a,c);case p.ZodIntersection:var u=a,v=c;let w=[ck(u.left._def,{...v,currentPath:[...v.currentPath,"allOf","0"]}),ck(u.right._def,{...v,currentPath:[...v.currentPath,"allOf","1"]})].filter(a=>!!a),x=[];return w.forEach(a=>{if((!("type"in a)||"string"!==a.type)&&"allOf"in a)x.push(...a.allOf);else{let b=a;if("additionalProperties"in a&&!1===a.additionalProperties){let{additionalProperties:c,...d}=a;b=d}x.push(b)}}),x.length?{allOf:x}:void 0;case p.ZodTuple:return H=a,I=c,H.rest?{type:"array",minItems:H.items.length,items:H.items.map((a,b)=>ck(a._def,{...I,currentPath:[...I.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[]),additionalItems:ck(H.rest._def,{...I,currentPath:[...I.currentPath,"additionalItems"]})}:{type:"array",minItems:H.items.length,maxItems:H.items.length,items:H.items.map((a,b)=>ck(a._def,{...I,currentPath:[...I.currentPath,"items",`${b}`]})).reduce((a,b)=>void 0===b?a:[...a,b],[])};case p.ZodRecord:return ci(a,c);case p.ZodLiteral:var y=a;let z=typeof y.value;return"bigint"!==z&&"number"!==z&&"boolean"!==z&&"string"!==z?{type:Array.isArray(y.value)?"array":"object"}:{type:"bigint"===z?"integer":z,const:y.value};case p.ZodEnum:return{type:"string",enum:Array.from(a.values)};case p.ZodNativeEnum:var A=a;let B=A.values,C=Object.keys(A.values).filter(a=>"number"!=typeof B[B[a]]).map(a=>B[a]),D=Array.from(new Set(C.map(a=>typeof a)));return{type:1===D.length?"string"===D[0]?"string":"number":["string","number"],enum:C};case p.ZodNullable:var E=a,F=c;if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(E.innerType._def.typeName)&&(!E.innerType._def.checks||!E.innerType._def.checks.length))return{type:[cj[E.innerType._def.typeName],"null"]};let G=ck(E.innerType._def,{...F,currentPath:[...F.currentPath,"anyOf","0"]});return G&&{anyOf:[G,{type:"null"}]};case p.ZodOptional:var H,I,J,K=a,L=c;if(L.currentPath.toString()===(null==(J=L.propertyPath)?void 0:J.toString()))return ck(K.innerType._def,L);let M=ck(K.innerType._def,{...L,currentPath:[...L.currentPath,"anyOf","1"]});return M?{anyOf:[{not:{}},M]}:{};case p.ZodMap:return d=a,"record"===(e=c).mapStrategy?ci(d,e):{type:"array",maxItems:125,items:{type:"array",items:[ck(d.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},ck(d.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}};case p.ZodSet:var N=a,O=c;let P={type:"array",uniqueItems:!0,items:ck(N.valueType._def,{...O,currentPath:[...O.currentPath,"items"]})};return N.minSize&&(P.minItems=N.minSize.value),N.maxSize&&(P.maxItems=N.maxSize.value),P;case p.ZodLazy:return()=>a.getter()._def;case p.ZodPromise:return ck(a.type._def,c);case p.ZodNaN:case p.ZodNever:return{not:{}};case p.ZodEffects:return f=a,"input"===(g=c).effectStrategy?ck(f.schema._def,g):{};case p.ZodAny:case p.ZodUnknown:return{};case p.ZodDefault:return h=a,i=c,{...ck(h.innerType._def,i),default:h.defaultValue()};case p.ZodBranded:return b9(a,c);case p.ZodReadonly:case p.ZodCatch:return ck(a.innerType._def,c);case p.ZodPipeline:var Q=a,R=c;if("input"===R.pipeStrategy)return ck(Q.in._def,R);if("output"===R.pipeStrategy)return ck(Q.out._def,R);let S=ck(Q.in._def,{...R,currentPath:[...R.currentPath,"allOf","0"]}),T=ck(Q.out._def,{...R,currentPath:[...R.currentPath,"allOf",S?"1":"0"]});return{allOf:[S,T].filter(a=>void 0!==a)};case p.ZodFunction:case p.ZodVoid:case p.ZodSymbol:default:return}})(a,a.typeName,b),h="function"==typeof g?ck(g(),b):g;if(h&&cm(a,b,h),b.postProcess){let c=b.postProcess(h,a,b);return f.jsonSchema=h,c}return f.jsonSchema=h,h}var cl=(a,b)=>{switch(b.$refStrategy){case"root":return{$ref:a.path.join("/")};case"relative":return{$ref:((a,b)=>{let c=0;for(;c<a.length&&c<b.length&&a[c]===b[c];c++);return[(a.length-c).toString(),...b.slice(c)].join("/")})(b.currentPath,a.path)};case"none":case"seen":if(a.path.length<b.currentPath.length&&a.path.every((a,c)=>b.currentPath[c]===a))return console.warn(`Recursive reference detected at ${b.currentPath.join("/")}! Defaulting to any`),{};return"seen"===b.$refStrategy?{}:void 0}},cm=(a,b,c)=>(a.description&&(c.description=a.description),c),cn=Symbol.for("vercel.ai.schema");function co(a){let b;return()=>(null==b&&(b=a()),b)}function cp(a,{validate:b}={}){return{[cn]:!0,_type:void 0,get jsonSchema(){return"function"==typeof a&&(a=a()),a},validate:b}}function cq(a){var b;return null==a?cp({properties:{},additionalProperties:!1}):"object"==typeof a&&null!==a&&cn in a&&!0===a[cn]&&"jsonSchema"in a&&"validate"in a?a:"~standard"in a?"zod"===a["~standard"].vendor?cr(a):(b=a,cp(()=>b5(b["~standard"].jsonSchema.input({target:"draft-07"})),{validate:async a=>{let c=await b["~standard"].validate(a);return"value"in c?{success:!0,value:c.value}:{success:!1,error:new W({value:a,cause:c.issues})}}})):a()}function cr(a,b){var c,d;if("_zod"in a){let d=null!=(c=null==b?void 0:b.useReferences)&&c;return cp(()=>b5(function(a,b){if(a instanceof Y){let c=new au(b),d={};for(let b of a._idmap.entries()){let[a,d]=b;c.process(d)}let e={},f={registry:a,uri:b?.uri,defs:d};for(let d of a._idmap.entries()){let[a,g]=d;e[a]=c.emit(g,{...b,external:f})}return Object.keys(d).length>0&&(e.__shared={["draft-2020-12"===c.target?"$defs":"definitions"]:d}),{schemas:e}}let c=new au(b);return c.process(a),c.emit(a,b)}(a,{target:"draft-7",io:"input",reused:d?"ref":"inline"})),{validate:async b=>{let c=await aL(a,b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}let e=null!=(d=null==b?void 0:b.useReferences)&&d;return cp(()=>((a,b)=>{var c;let d=(a=>{let b,c="string"==typeof(b=a)?{...b8,name:b}:{...b8,...b},d=void 0!==c.name?[...c.basePath,c.definitionPath,c.name]:c.basePath;return{...c,currentPath:d,propertyPath:void 0,seen:new Map(Object.entries(c.definitions).map(([a,b])=>[b._def,{def:b._def,path:[...c.basePath,c.definitionPath,a],jsonSchema:void 0}]))}})(b),e="object"==typeof b&&b.definitions?Object.entries(b.definitions).reduce((a,[b,c])=>{var e;return{...a,[b]:null!=(e=ck(c._def,{...d,currentPath:[...d.basePath,d.definitionPath,b]},!0))?e:{}}},{}):void 0,f="string"==typeof b?b:(null==b?void 0:b.nameStrategy)==="title"||null==b?void 0:b.name,g=null!=(c=ck(a._def,void 0===f?d:{...d,currentPath:[...d.basePath,d.definitionPath,f]},!1))?c:{},h="object"==typeof b&&void 0!==b.name&&"title"===b.nameStrategy?b.name:void 0;void 0!==h&&(g.title=h);let i=void 0===f?e?{...g,[d.definitionPath]:e}:g:{$ref:[..."relative"===d.$refStrategy?[]:d.basePath,d.definitionPath,f].join("/"),[d.definitionPath]:{...e,[f]:g}};return i.$schema="http://json-schema.org/draft-07/schema#",i})(a,{$refStrategy:e?"root":"none"}),{validate:async b=>{let c=await a.safeParseAsync(b);return c.success?{success:!0,value:c.data}:{success:!1,error:c.error}}})}async function cs({value:a,schema:b,context:c}){let d=await ct({value:a,schema:b,context:c});if(!d.success)throw W.wrap({value:a,cause:d.error,context:c});return d.value}async function ct({value:a,schema:b,context:c}){let d=cq(b);try{if(null==d.validate)return{success:!0,value:a,rawValue:a};let b=await d.validate(a);if(b.success)return{success:!0,value:b.value,rawValue:a};return{success:!1,error:W.wrap({value:a,cause:b.error,context:c}),rawValue:a}}catch(b){return{success:!1,error:W.wrap({value:a,cause:b,context:c}),rawValue:a}}}async function cu({text:a,schema:b}){try{let c=function(a){let{stackTraceLimit:b}=Error;try{Error.stackTraceLimit=0}catch(b){return b4(a)}try{return b4(a)}finally{Error.stackTraceLimit=b}}(a);if(null==b)return{success:!0,value:c,rawValue:c};return await ct({value:c,schema:b})}catch(b){return{success:!1,error:R.isInstance(b)?b:new R({text:a,cause:b}),rawValue:void 0}}}async function cv(a){return"function"==typeof a&&(a=a()),Promise.resolve(a)}let cw=/^[cC][^\s-]{8,}$/,cx=/^[0-9a-z]+$/,cy=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,cz=/^[0-9a-vA-V]{20}$/,cA=/^[A-Za-z0-9]{27}$/,cB=/^[a-zA-Z0-9_-]{21}$/,cC=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,cD=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,cE=a=>a?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${a}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,cF=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,cG=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,cH=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,cI=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,cJ=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cK=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,cL=/^[A-Za-z0-9_-]*$/,cM=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,cN=/^\+(?:[0-9]){6,14}[0-9]$/,cO="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",cP=RegExp(`^${cO}$`);function cQ(a){let b="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof a.precision?-1===a.precision?`${b}`:0===a.precision?`${b}:[0-5]\\d`:`${b}:[0-5]\\d\\.\\d{${a.precision}}`:`${b}(?::[0-5]\\d(?:\\.\\d+)?)?`}let cR=/^\d+$/,cS=/^-?\d+(?:\.\d+)?/i,cT=/true|false/i,cU=/null/i,cV=/^[^A-Z]*$/,cW=/^[^a-z]*$/,cX=av("$ZodCheck",(a,b)=>{var c;a._zod??(a._zod={}),a._zod.def=b,(c=a._zod).onattach??(c.onattach=[])}),cY={number:"number",bigint:"bigint",object:"date"},cZ=av("$ZodCheckLessThan",(a,b)=>{cX.init(a,b);let c=cY[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.maximum:c.exclusiveMaximum)??1/0;b.value<d&&(b.inclusive?c.maximum=b.value:c.exclusiveMaximum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value<=b.value:d.value<b.value)||d.issues.push({origin:c,code:"too_big",maximum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),c$=av("$ZodCheckGreaterThan",(a,b)=>{cX.init(a,b);let c=cY[typeof b.value];a._zod.onattach.push(a=>{let c=a._zod.bag,d=(b.inclusive?c.minimum:c.exclusiveMinimum)??-1/0;b.value>d&&(b.inclusive?c.minimum=b.value:c.exclusiveMinimum=b.value)}),a._zod.check=d=>{(b.inclusive?d.value>=b.value:d.value>b.value)||d.issues.push({origin:c,code:"too_small",minimum:b.value,input:d.value,inclusive:b.inclusive,inst:a,continue:!b.abort})}}),c_=av("$ZodCheckMultipleOf",(a,b)=>{cX.init(a,b),a._zod.onattach.push(a=>{var c;(c=a._zod.bag).multipleOf??(c.multipleOf=b.value)}),a._zod.check=c=>{if(typeof c.value!=typeof b.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof c.value?c.value%b.value===BigInt(0):0===function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(c.value,b.value))||c.issues.push({origin:typeof c.value,code:"not_multiple_of",divisor:b.value,input:c.value,inst:a,continue:!b.abort})}}),c0=av("$ZodCheckNumberFormat",(a,b)=>{cX.init(a,b),b.format=b.format||"float64";let c=b.format?.includes("int"),d=c?"int":"number",[e,f]=an[b.format];a._zod.onattach.push(a=>{let d=a._zod.bag;d.format=b.format,d.minimum=e,d.maximum=f,c&&(d.pattern=cR)}),a._zod.check=g=>{let h=g.value;if(c){if(!Number.isInteger(h))return void g.issues.push({expected:d,format:b.format,code:"invalid_type",input:h,inst:a});if(!Number.isSafeInteger(h))return void(h>0?g.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}):g.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:a,origin:d,continue:!b.abort}))}h<e&&g.issues.push({origin:"number",input:h,code:"too_small",minimum:e,inclusive:!0,inst:a,continue:!b.abort}),h>f&&g.issues.push({origin:"number",input:h,code:"too_big",maximum:f,inst:a})}}),c1=av("$ZodCheckMaxLength",(a,b)=>{var c;cX.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.maximum??1/0;b.maximum<c&&(a._zod.bag.maximum=b.maximum)}),a._zod.check=c=>{let d=c.value;if(d.length<=b.maximum)return;let e=as(d);c.issues.push({origin:e,code:"too_big",maximum:b.maximum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),c2=av("$ZodCheckMinLength",(a,b)=>{var c;cX.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag.minimum??-1/0;b.minimum>c&&(a._zod.bag.minimum=b.minimum)}),a._zod.check=c=>{let d=c.value;if(d.length>=b.minimum)return;let e=as(d);c.issues.push({origin:e,code:"too_small",minimum:b.minimum,inclusive:!0,input:d,inst:a,continue:!b.abort})}}),c3=av("$ZodCheckLengthEquals",(a,b)=>{var c;cX.init(a,b),(c=a._zod.def).when??(c.when=a=>{let b=a.value;return null!=b&&void 0!==b.length}),a._zod.onattach.push(a=>{let c=a._zod.bag;c.minimum=b.length,c.maximum=b.length,c.length=b.length}),a._zod.check=c=>{let d=c.value,e=d.length;if(e===b.length)return;let f=as(d),g=e>b.length;c.issues.push({origin:f,...g?{code:"too_big",maximum:b.length}:{code:"too_small",minimum:b.length},inclusive:!0,exact:!0,input:c.value,inst:a,continue:!b.abort})}}),c4=av("$ZodCheckStringFormat",(a,b)=>{var c,d;cX.init(a,b),a._zod.onattach.push(a=>{let c=a._zod.bag;c.format=b.format,b.pattern&&(c.patterns??(c.patterns=new Set),c.patterns.add(b.pattern))}),b.pattern?(c=a._zod).check??(c.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:b.format,input:c.value,...b.pattern?{pattern:b.pattern.toString()}:{},inst:a,continue:!b.abort})}):(d=a._zod).check??(d.check=()=>{})}),c5=av("$ZodCheckRegex",(a,b)=>{c4.init(a,b),a._zod.check=c=>{b.pattern.lastIndex=0,b.pattern.test(c.value)||c.issues.push({origin:"string",code:"invalid_format",format:"regex",input:c.value,pattern:b.pattern.toString(),inst:a,continue:!b.abort})}}),c6=av("$ZodCheckLowerCase",(a,b)=>{b.pattern??(b.pattern=cV),c4.init(a,b)}),c7=av("$ZodCheckUpperCase",(a,b)=>{b.pattern??(b.pattern=cW),c4.init(a,b)}),c8=av("$ZodCheckIncludes",(a,b)=>{cX.init(a,b);let c=ak(b.includes),d=new RegExp("number"==typeof b.position?`^.{${b.position}}${c}`:c);b.pattern=d,a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(d)}),a._zod.check=c=>{c.value.includes(b.includes,b.position)||c.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:b.includes,input:c.value,inst:a,continue:!b.abort})}}),c9=av("$ZodCheckStartsWith",(a,b)=>{cX.init(a,b);let c=RegExp(`^${ak(b.prefix)}.*`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.startsWith(b.prefix)||c.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:b.prefix,input:c.value,inst:a,continue:!b.abort})}}),da=av("$ZodCheckEndsWith",(a,b)=>{cX.init(a,b);let c=RegExp(`.*${ak(b.suffix)}$`);b.pattern??(b.pattern=c),a._zod.onattach.push(a=>{let b=a._zod.bag;b.patterns??(b.patterns=new Set),b.patterns.add(c)}),a._zod.check=c=>{c.value.endsWith(b.suffix)||c.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:b.suffix,input:c.value,inst:a,continue:!b.abort})}}),db=av("$ZodCheckOverwrite",(a,b)=>{cX.init(a,b),a._zod.check=a=>{a.value=b.tx(a.value)}});class dc{constructor(a=[]){this.content=[],this.indent=0,this&&(this.args=a)}indented(a){this.indent+=1,a(this),this.indent-=1}write(a){if("function"==typeof a){a(this,{execution:"sync"}),a(this,{execution:"async"});return}let b=a.split("\n").filter(a=>a),c=Math.min(...b.map(a=>a.length-a.trimStart().length));for(let a of b.map(a=>a.slice(c)).map(a=>" ".repeat(2*this.indent)+a))this.content.push(a)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(a=>`  ${a}`)].join("\n"))}}let dd={major:4,minor:0,patch:0},de=av("$ZodType",(a,b)=>{var c;a??(a={}),a._zod.def=b,a._zod.bag=a._zod.bag||{},a._zod.version=dd;let d=[...a._zod.def.checks??[]];for(let b of(a._zod.traits.has("$ZodCheck")&&d.unshift(a),d))for(let c of b._zod.onattach)c(a);if(0===d.length)(c=a._zod).deferred??(c.deferred=[]),a._zod.deferred?.push(()=>{a._zod.run=a._zod.parse});else{let b=(a,b,c)=>{let d,e=ao(a);for(let f of b){if(f._zod.def.when){if(!f._zod.def.when(a))continue}else if(e)continue;let b=a.issues.length,g=f._zod.check(a);if(g instanceof Promise&&c?.async===!1)throw new aw;if(d||g instanceof Promise)d=(d??Promise.resolve()).then(async()=>{await g,a.issues.length!==b&&(e||(e=ao(a,b)))});else{if(a.issues.length===b)continue;e||(e=ao(a,b))}}return d?d.then(()=>a):a};a._zod.run=(c,e)=>{let f=a._zod.parse(c,e);if(f instanceof Promise){if(!1===e.async)throw new aw;return f.then(a=>b(a,d,e))}return b(f,d,e)}}a["~standard"]={validate:b=>{try{let c=aD(a,b);return c.success?{value:c.data}:{issues:c.error?.issues}}catch(c){return aF(a,b).then(a=>a.success?{value:a.data}:{issues:a.error?.issues})}},vendor:"zod",version:1}}),df=av("$ZodString",(a,b)=>{de.init(a,b),a._zod.pattern=[...a?._zod.bag?.patterns??[]].pop()??(a=>{let b=a?`[\\s\\S]{${a?.minimum??0},${a?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${b}$`)})(a._zod.bag),a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=String(c.value)}catch(a){}return"string"==typeof c.value||c.issues.push({expected:"string",code:"invalid_type",input:c.value,inst:a}),c}}),dg=av("$ZodStringFormat",(a,b)=>{c4.init(a,b),df.init(a,b)}),dh=av("$ZodGUID",(a,b)=>{b.pattern??(b.pattern=cD),dg.init(a,b)}),di=av("$ZodUUID",(a,b)=>{if(b.version){let a={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[b.version];if(void 0===a)throw Error(`Invalid UUID version: "${b.version}"`);b.pattern??(b.pattern=cE(a))}else b.pattern??(b.pattern=cE());dg.init(a,b)}),dj=av("$ZodEmail",(a,b)=>{b.pattern??(b.pattern=cF),dg.init(a,b)}),dk=av("$ZodURL",(a,b)=>{dg.init(a,b),a._zod.check=c=>{try{let d=c.value,e=new URL(d),f=e.href;b.hostname&&(b.hostname.lastIndex=0,b.hostname.test(e.hostname)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:cM.source,input:c.value,inst:a,continue:!b.abort})),b.protocol&&(b.protocol.lastIndex=0,b.protocol.test(e.protocol.endsWith(":")?e.protocol.slice(0,-1):e.protocol)||c.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:b.protocol.source,input:c.value,inst:a,continue:!b.abort})),!d.endsWith("/")&&f.endsWith("/")?c.value=f.slice(0,-1):c.value=f;return}catch(d){c.issues.push({code:"invalid_format",format:"url",input:c.value,inst:a,continue:!b.abort})}}}),dl=av("$ZodEmoji",(a,b)=>{b.pattern??(b.pattern=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),dg.init(a,b)}),dm=av("$ZodNanoID",(a,b)=>{b.pattern??(b.pattern=cB),dg.init(a,b)}),dn=av("$ZodCUID",(a,b)=>{b.pattern??(b.pattern=cw),dg.init(a,b)}),dp=av("$ZodCUID2",(a,b)=>{b.pattern??(b.pattern=cx),dg.init(a,b)}),dq=av("$ZodULID",(a,b)=>{b.pattern??(b.pattern=cy),dg.init(a,b)}),dr=av("$ZodXID",(a,b)=>{b.pattern??(b.pattern=cz),dg.init(a,b)}),ds=av("$ZodKSUID",(a,b)=>{b.pattern??(b.pattern=cA),dg.init(a,b)}),dt=av("$ZodISODateTime",(a,b)=>{b.pattern??(b.pattern=function(a){let b=cQ({precision:a.precision}),c=["Z"];a.local&&c.push(""),a.offset&&c.push("([+-]\\d{2}:\\d{2})");let d=`${b}(?:${c.join("|")})`;return RegExp(`^${cO}T(?:${d})$`)}(b)),dg.init(a,b)}),du=av("$ZodISODate",(a,b)=>{b.pattern??(b.pattern=cP),dg.init(a,b)}),dv=av("$ZodISOTime",(a,b)=>{b.pattern??(b.pattern=RegExp(`^${cQ(b)}$`)),dg.init(a,b)}),dw=av("$ZodISODuration",(a,b)=>{b.pattern??(b.pattern=cC),dg.init(a,b)}),dx=av("$ZodIPv4",(a,b)=>{b.pattern??(b.pattern=cG),dg.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv4"})}),dy=av("$ZodIPv6",(a,b)=>{b.pattern??(b.pattern=cH),dg.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.format="ipv6"}),a._zod.check=c=>{try{new URL(`http://[${c.value}]`)}catch{c.issues.push({code:"invalid_format",format:"ipv6",input:c.value,inst:a,continue:!b.abort})}}}),dz=av("$ZodCIDRv4",(a,b)=>{b.pattern??(b.pattern=cI),dg.init(a,b)}),dA=av("$ZodCIDRv6",(a,b)=>{b.pattern??(b.pattern=cJ),dg.init(a,b),a._zod.check=c=>{let[d,e]=c.value.split("/");try{if(!e)throw Error();let a=Number(e);if(`${a}`!==e||a<0||a>128)throw Error();new URL(`http://[${d}]`)}catch{c.issues.push({code:"invalid_format",format:"cidrv6",input:c.value,inst:a,continue:!b.abort})}}});function dB(a){if(""===a)return!0;if(a.length%4!=0)return!1;try{return atob(a),!0}catch{return!1}}let dC=av("$ZodBase64",(a,b)=>{b.pattern??(b.pattern=cK),dg.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),a._zod.check=c=>{dB(c.value)||c.issues.push({code:"invalid_format",format:"base64",input:c.value,inst:a,continue:!b.abort})}}),dD=av("$ZodBase64URL",(a,b)=>{b.pattern??(b.pattern=cL),dg.init(a,b),a._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),a._zod.check=c=>{!function(a){if(!cL.test(a))return!1;let b=a.replace(/[-_]/g,a=>"-"===a?"+":"/");return dB(b.padEnd(4*Math.ceil(b.length/4),"="))}(c.value)&&c.issues.push({code:"invalid_format",format:"base64url",input:c.value,inst:a,continue:!b.abort})}}),dE=av("$ZodE164",(a,b)=>{b.pattern??(b.pattern=cN),dg.init(a,b)}),dF=av("$ZodJWT",(a,b)=>{dg.init(a,b),a._zod.check=c=>{!function(a,b=null){try{let c=a.split(".");if(3!==c.length)return!1;let[d]=c;if(!d)return!1;let e=JSON.parse(atob(d));if("typ"in e&&e?.typ!=="JWT"||!e.alg||b&&(!("alg"in e)||e.alg!==b))return!1;return!0}catch{return!1}}(c.value,b.alg)&&c.issues.push({code:"invalid_format",format:"jwt",input:c.value,inst:a,continue:!b.abort})}}),dG=av("$ZodNumber",(a,b)=>{de.init(a,b),a._zod.pattern=a._zod.bag.pattern??cS,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=Number(c.value)}catch(a){}let e=c.value;if("number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e))return c;let f="number"==typeof e?Number.isNaN(e)?"NaN":Number.isFinite(e)?void 0:"Infinity":void 0;return c.issues.push({expected:"number",code:"invalid_type",input:e,inst:a,...f?{received:f}:{}}),c}}),dH=av("$ZodNumber",(a,b)=>{c0.init(a,b),dG.init(a,b)}),dI=av("$ZodBoolean",(a,b)=>{de.init(a,b),a._zod.pattern=cT,a._zod.parse=(c,d)=>{if(b.coerce)try{c.value=!!c.value}catch(a){}let e=c.value;return"boolean"==typeof e||c.issues.push({expected:"boolean",code:"invalid_type",input:e,inst:a}),c}}),dJ=av("$ZodNull",(a,b)=>{de.init(a,b),a._zod.pattern=cU,a._zod.values=new Set([null]),a._zod.parse=(b,c)=>{let d=b.value;return null===d||b.issues.push({expected:"null",code:"invalid_type",input:d,inst:a}),b}}),dK=av("$ZodUnknown",(a,b)=>{de.init(a,b),a._zod.parse=a=>a}),dL=av("$ZodNever",(a,b)=>{de.init(a,b),a._zod.parse=(b,c)=>(b.issues.push({expected:"never",code:"invalid_type",input:b.value,inst:a}),b)});function dM(a,b,c){a.issues.length&&b.issues.push(...ap(c,a.issues)),b.value[c]=a.value}let dN=av("$ZodArray",(a,b)=>{de.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!Array.isArray(e))return c.issues.push({expected:"array",code:"invalid_type",input:e,inst:a}),c;c.value=Array(e.length);let f=[];for(let a=0;a<e.length;a++){let g=e[a],h=b.element._zod.run({value:g,issues:[]},d);h instanceof Promise?f.push(h.then(b=>dM(b,c,a))):dM(h,c,a)}return f.length?Promise.all(f).then(()=>c):c}});function dO(a,b,c){a.issues.length&&b.issues.push(...ap(c,a.issues)),b.value[c]=a.value}function dP(a,b,c,d){a.issues.length?void 0===d[c]?c in d?b.value[c]=void 0:b.value[c]=a.value:b.issues.push(...ap(c,a.issues)):void 0===a.value?c in d&&(b.value[c]=void 0):b.value[c]=a.value}let dQ=av("$ZodObject",(a,b)=>{let c,d;de.init(a,b);let e=aa(()=>{let a=Object.keys(b.shape);for(let c of a)if(!(b.shape[c]instanceof de))throw Error(`Invalid element at key "${c}": expected a Zod schema`);let c=function(a){return Object.keys(a).filter(b=>"optional"===a[b]._zod.optin&&"optional"===a[b]._zod.optout)}(b.shape);return{shape:b.shape,keys:a,keySet:new Set(a),numKeys:a.length,optionalKeys:new Set(c)}});ac(a._zod,"propValues",()=>{let a=b.shape,c={};for(let b in a){let d=a[b]._zod;if(d.values)for(let a of(c[b]??(c[b]=new Set),d.values))c[b].add(a)}return c});let f=!ax.jitless,g=f&&ah.value,h=b.catchall;a._zod.parse=(i,j)=>{d??(d=e.value);let k=i.value;if(!ag(k))return i.issues.push({expected:"object",code:"invalid_type",input:k,inst:a}),i;let l=[];if(f&&g&&j?.async===!1&&!0!==j.jitless)c||(c=(a=>{let b=new dc(["shape","payload","ctx"]),c=e.value,d=a=>{let b=ae(a);return`shape[${b}]._zod.run({ value: input[${b}], issues: [] }, ctx)`};b.write("const input = payload.value;");let f=Object.create(null),g=0;for(let a of c.keys)f[a]=`key_${g++}`;for(let a of(b.write("const newResult = {}"),c.keys))if(c.optionalKeys.has(a)){let c=f[a];b.write(`const ${c} = ${d(a)};`);let e=ae(a);b.write(`
        if (${c}.issues.length) {
          if (input[${e}] === undefined) {
            if (${e} in input) {
              newResult[${e}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${c}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${e}, ...iss.path] : [${e}],
              }))
            );
          }
        } else if (${c}.value === undefined) {
          if (${e} in input) newResult[${e}] = undefined;
        } else {
          newResult[${e}] = ${c}.value;
        }
        `)}else{let c=f[a];b.write(`const ${c} = ${d(a)};`),b.write(`
          if (${c}.issues.length) payload.issues = payload.issues.concat(${c}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${ae(a)}, ...iss.path] : [${ae(a)}]
          })));`),b.write(`newResult[${ae(a)}] = ${c}.value`)}b.write("payload.value = newResult;"),b.write("return payload;");let h=b.compile();return(b,c)=>h(a,b,c)})(b.shape)),i=c(i,j);else{i.value={};let a=d.shape;for(let b of d.keys){let c=a[b],d=c._zod.run({value:k[b],issues:[]},j),e="optional"===c._zod.optin&&"optional"===c._zod.optout;d instanceof Promise?l.push(d.then(a=>e?dP(a,i,b,k):dO(a,i,b))):e?dP(d,i,b,k):dO(d,i,b)}}if(!h)return l.length?Promise.all(l).then(()=>i):i;let m=[],n=d.keySet,o=h._zod,p=o.def.type;for(let a of Object.keys(k)){if(n.has(a))continue;if("never"===p){m.push(a);continue}let b=o.run({value:k[a],issues:[]},j);b instanceof Promise?l.push(b.then(b=>dO(b,i,a))):dO(b,i,a)}return(m.length&&i.issues.push({code:"unrecognized_keys",keys:m,input:k,inst:a}),l.length)?Promise.all(l).then(()=>i):i}});function dR(a,b,c,d){for(let c of a)if(0===c.issues.length)return b.value=c.value,b;return b.issues.push({code:"invalid_union",input:b.value,inst:c,errors:a.map(a=>a.issues.map(a=>ar(a,d,ay())))}),b}let dS=av("$ZodUnion",(a,b)=>{de.init(a,b),ac(a._zod,"optin",()=>b.options.some(a=>"optional"===a._zod.optin)?"optional":void 0),ac(a._zod,"optout",()=>b.options.some(a=>"optional"===a._zod.optout)?"optional":void 0),ac(a._zod,"values",()=>{if(b.options.every(a=>a._zod.values))return new Set(b.options.flatMap(a=>Array.from(a._zod.values)))}),ac(a._zod,"pattern",()=>{if(b.options.every(a=>a._zod.pattern)){let a=b.options.map(a=>a._zod.pattern);return RegExp(`^(${a.map(a=>ab(a.source)).join("|")})$`)}}),a._zod.parse=(c,d)=>{let e=!1,f=[];for(let a of b.options){let b=a._zod.run({value:c.value,issues:[]},d);if(b instanceof Promise)f.push(b),e=!0;else{if(0===b.issues.length)return b;f.push(b)}}return e?Promise.all(f).then(b=>dR(b,c,a,d)):dR(f,c,a,d)}}),dT=av("$ZodDiscriminatedUnion",(a,b)=>{dS.init(a,b);let c=a._zod.parse;ac(a._zod,"propValues",()=>{let a={};for(let c of b.options){let d=c._zod.propValues;if(!d||0===Object.keys(d).length)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(c)}"`);for(let[b,c]of Object.entries(d))for(let d of(a[b]||(a[b]=new Set),c))a[b].add(d)}return a});let d=aa(()=>{let a=b.options,c=new Map;for(let d of a){let a=d._zod.propValues[b.discriminator];if(!a||0===a.size)throw Error(`Invalid discriminated union option at index "${b.options.indexOf(d)}"`);for(let b of a){if(c.has(b))throw Error(`Duplicate discriminator value "${String(b)}"`);c.set(b,d)}}return c});a._zod.parse=(e,f)=>{let g=e.value;if(!ag(g))return e.issues.push({code:"invalid_type",expected:"object",input:g,inst:a}),e;let h=d.value.get(g?.[b.discriminator]);return h?h._zod.run(e,f):b.unionFallback?c(e,f):(e.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:g,path:[b.discriminator],inst:a}),e)}}),dU=av("$ZodIntersection",(a,b)=>{de.init(a,b),a._zod.parse=(a,c)=>{let d=a.value,e=b.left._zod.run({value:d,issues:[]},c),f=b.right._zod.run({value:d,issues:[]},c);return e instanceof Promise||f instanceof Promise?Promise.all([e,f]).then(([b,c])=>dV(a,b,c)):dV(a,e,f)}});function dV(a,b,c){if(b.issues.length&&a.issues.push(...b.issues),c.issues.length&&a.issues.push(...c.issues),ao(a))return a;let d=function a(b,c){if(b===c||b instanceof Date&&c instanceof Date&&+b==+c)return{valid:!0,data:b};if(ai(b)&&ai(c)){let d=Object.keys(c),e=Object.keys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1,mergeErrorPath:[d,...e.mergeErrorPath]};f[d]=e.data}return{valid:!0,data:f}}if(Array.isArray(b)&&Array.isArray(c)){if(b.length!==c.length)return{valid:!1,mergeErrorPath:[]};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1,mergeErrorPath:[e,...f.mergeErrorPath]};d.push(f.data)}return{valid:!0,data:d}}return{valid:!1,mergeErrorPath:[]}}(b.value,c.value);if(!d.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(d.mergeErrorPath)}`);return a.value=d.data,a}let dW=av("$ZodRecord",(a,b)=>{de.init(a,b),a._zod.parse=(c,d)=>{let e=c.value;if(!ai(e))return c.issues.push({expected:"record",code:"invalid_type",input:e,inst:a}),c;let f=[];if(b.keyType._zod.values){let g,h=b.keyType._zod.values;for(let a of(c.value={},h))if("string"==typeof a||"number"==typeof a||"symbol"==typeof a){let g=b.valueType._zod.run({value:e[a],issues:[]},d);g instanceof Promise?f.push(g.then(b=>{b.issues.length&&c.issues.push(...ap(a,b.issues)),c.value[a]=b.value})):(g.issues.length&&c.issues.push(...ap(a,g.issues)),c.value[a]=g.value)}for(let a in e)h.has(a)||(g=g??[]).push(a);g&&g.length>0&&c.issues.push({code:"unrecognized_keys",input:e,inst:a,keys:g})}else for(let g of(c.value={},Reflect.ownKeys(e))){if("__proto__"===g)continue;let h=b.keyType._zod.run({value:g,issues:[]},d);if(h instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(h.issues.length){c.issues.push({origin:"record",code:"invalid_key",issues:h.issues.map(a=>ar(a,d,ay())),input:g,path:[g],inst:a}),c.value[h.value]=h.value;continue}let i=b.valueType._zod.run({value:e[g],issues:[]},d);i instanceof Promise?f.push(i.then(a=>{a.issues.length&&c.issues.push(...ap(g,a.issues)),c.value[h.value]=a.value})):(i.issues.length&&c.issues.push(...ap(g,i.issues)),c.value[h.value]=i.value)}return f.length?Promise.all(f).then(()=>c):c}}),dX=av("$ZodEnum",(a,b)=>{de.init(a,b);let c=$(b.entries);a._zod.values=new Set(c),a._zod.pattern=RegExp(`^(${c.filter(a=>aj.has(typeof a)).map(a=>"string"==typeof a?ak(a):a.toString()).join("|")})$`),a._zod.parse=(b,d)=>{let e=b.value;return a._zod.values.has(e)||b.issues.push({code:"invalid_value",values:c,input:e,inst:a}),b}}),dY=av("$ZodLiteral",(a,b)=>{de.init(a,b),a._zod.values=new Set(b.values),a._zod.pattern=RegExp(`^(${b.values.map(a=>"string"==typeof a?ak(a):a?a.toString():String(a)).join("|")})$`),a._zod.parse=(c,d)=>{let e=c.value;return a._zod.values.has(e)||c.issues.push({code:"invalid_value",values:b.values,input:e,inst:a}),c}}),dZ=av("$ZodTransform",(a,b)=>{de.init(a,b),a._zod.parse=(a,c)=>{let d=b.transform(a.value,a);if(c.async)return(d instanceof Promise?d:Promise.resolve(d)).then(b=>(a.value=b,a));if(d instanceof Promise)throw new aw;return a.value=d,a}}),d$=av("$ZodOptional",(a,b)=>{de.init(a,b),a._zod.optin="optional",a._zod.optout="optional",ac(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,void 0]):void 0),ac(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${ab(a.source)})?$`):void 0}),a._zod.parse=(a,c)=>"optional"===b.innerType._zod.optin?b.innerType._zod.run(a,c):void 0===a.value?a:b.innerType._zod.run(a,c)}),d_=av("$ZodNullable",(a,b)=>{de.init(a,b),ac(a._zod,"optin",()=>b.innerType._zod.optin),ac(a._zod,"optout",()=>b.innerType._zod.optout),ac(a._zod,"pattern",()=>{let a=b.innerType._zod.pattern;return a?RegExp(`^(${ab(a.source)}|null)$`):void 0}),ac(a._zod,"values",()=>b.innerType._zod.values?new Set([...b.innerType._zod.values,null]):void 0),a._zod.parse=(a,c)=>null===a.value?a:b.innerType._zod.run(a,c)}),d0=av("$ZodDefault",(a,b)=>{de.init(a,b),a._zod.optin="optional",ac(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{if(void 0===a.value)return a.value=b.defaultValue,a;let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(a=>d1(a,b)):d1(d,b)}});function d1(a,b){return void 0===a.value&&(a.value=b.defaultValue),a}let d2=av("$ZodPrefault",(a,b)=>{de.init(a,b),a._zod.optin="optional",ac(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>(void 0===a.value&&(a.value=b.defaultValue),b.innerType._zod.run(a,c))}),d3=av("$ZodNonOptional",(a,b)=>{de.init(a,b),ac(a._zod,"values",()=>{let a=b.innerType._zod.values;return a?new Set([...a].filter(a=>void 0!==a)):void 0}),a._zod.parse=(c,d)=>{let e=b.innerType._zod.run(c,d);return e instanceof Promise?e.then(b=>d4(b,a)):d4(e,a)}});function d4(a,b){return a.issues.length||void 0!==a.value||a.issues.push({code:"invalid_type",expected:"nonoptional",input:a.value,inst:b}),a}let d5=av("$ZodCatch",(a,b)=>{de.init(a,b),a._zod.optin="optional",ac(a._zod,"optout",()=>b.innerType._zod.optout),ac(a._zod,"values",()=>b.innerType._zod.values),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(d=>(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>ar(a,c,ay()))},input:a.value}),a.issues=[]),a)):(a.value=d.value,d.issues.length&&(a.value=b.catchValue({...a,error:{issues:d.issues.map(a=>ar(a,c,ay()))},input:a.value}),a.issues=[]),a)}}),d6=av("$ZodPipe",(a,b)=>{de.init(a,b),ac(a._zod,"values",()=>b.in._zod.values),ac(a._zod,"optin",()=>b.in._zod.optin),ac(a._zod,"optout",()=>b.out._zod.optout),a._zod.parse=(a,c)=>{let d=b.in._zod.run(a,c);return d instanceof Promise?d.then(a=>d7(a,b,c)):d7(d,b,c)}});function d7(a,b,c){return ao(a)?a:b.out._zod.run({value:a.value,issues:a.issues},c)}let d8=av("$ZodReadonly",(a,b)=>{de.init(a,b),ac(a._zod,"propValues",()=>b.innerType._zod.propValues),ac(a._zod,"values",()=>b.innerType._zod.values),ac(a._zod,"optin",()=>b.innerType._zod.optin),ac(a._zod,"optout",()=>b.innerType._zod.optout),a._zod.parse=(a,c)=>{let d=b.innerType._zod.run(a,c);return d instanceof Promise?d.then(d9):d9(d)}});function d9(a){return a.value=Object.freeze(a.value),a}let ea=av("$ZodLazy",(a,b)=>{de.init(a,b),ac(a._zod,"innerType",()=>b.getter()),ac(a._zod,"pattern",()=>a._zod.innerType._zod.pattern),ac(a._zod,"propValues",()=>a._zod.innerType._zod.propValues),ac(a._zod,"optin",()=>a._zod.innerType._zod.optin),ac(a._zod,"optout",()=>a._zod.innerType._zod.optout),a._zod.parse=(b,c)=>a._zod.innerType._zod.run(b,c)}),eb=av("$ZodCustom",(a,b)=>{cX.init(a,b),de.init(a,b),a._zod.parse=(a,b)=>a,a._zod.check=c=>{let d=c.value,e=b.fn(d);if(e instanceof Promise)return e.then(b=>ec(b,c,d,a));ec(e,c,d,a)}});function ec(a,b,c,d){if(!a){let a={code:"custom",input:c,inst:d,path:[...d._zod.def.path??[]],continue:!d._zod.def.abort};d._zod.def.params&&(a.params=d._zod.def.params),b.issues.push(at(a))}}function ed(a,b){return new a({type:"string",format:"guid",check:"string_format",abort:!1,...am(b)})}function ee(a,b){return new cZ({check:"less_than",...am(b),value:a,inclusive:!1})}function ef(a,b){return new cZ({check:"less_than",...am(b),value:a,inclusive:!0})}function eg(a,b){return new c$({check:"greater_than",...am(b),value:a,inclusive:!1})}function eh(a,b){return new c$({check:"greater_than",...am(b),value:a,inclusive:!0})}function ei(a,b){return new c_({check:"multiple_of",...am(b),value:a})}function ej(a,b){return new c1({check:"max_length",...am(b),maximum:a})}function ek(a,b){return new c2({check:"min_length",...am(b),minimum:a})}function el(a,b){return new c3({check:"length_equals",...am(b),length:a})}function em(a){return new db({check:"overwrite",tx:a})}let en=av("ZodISODateTime",(a,b)=>{dt.init(a,b),ev.init(a,b)}),eo=av("ZodISODate",(a,b)=>{du.init(a,b),ev.init(a,b)}),ep=av("ZodISOTime",(a,b)=>{dv.init(a,b),ev.init(a,b)}),eq=av("ZodISODuration",(a,b)=>{dw.init(a,b),ev.init(a,b)}),er=av("ZodType",(a,b)=>(de.init(a,b),a.def=b,Object.defineProperty(a,"_def",{value:b}),a.check=(...c)=>a.clone({...b,checks:[...b.checks??[],...c.map(a=>"function"==typeof a?{_zod:{check:a,def:{check:"custom"},onattach:[]}}:a)]}),a.clone=(b,c)=>al(a,b,c),a.brand=()=>a,a.register=(b,c)=>(b.add(a,c),a),a.parse=(b,c)=>aI(a,b,c,{callee:a.parse}),a.safeParse=(b,c)=>aK(a,b,c),a.parseAsync=async(b,c)=>aJ(a,b,c,{callee:a.parseAsync}),a.safeParseAsync=async(b,c)=>aL(a,b,c),a.spa=a.safeParseAsync,a.refine=(b,c)=>a.check(function(a,b={}){return new fp({type:"custom",check:"custom",fn:a,...am(b)})}(b,c)),a.superRefine=b=>a.check(function(a){let b=function(a){let b=new cX({check:"custom"});return b._zod.check=a,b}(c=>(c.addIssue=a=>{"string"==typeof a?c.issues.push(at(a,c.value,b._zod.def)):(a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=c.value),a.inst??(a.inst=b),a.continue??(a.continue=!b._zod.def.abort),c.issues.push(at(a)))},a(c.value,c)));return b}(b)),a.overwrite=b=>a.check(em(b)),a.optional=()=>fe(a),a.nullable=()=>fg(a),a.nullish=()=>fe(fg(a)),a.nonoptional=b=>new fj({type:"nonoptional",innerType:a,...am(b)}),a.array=()=>e$(a),a.or=b=>e3([a,b]),a.and=b=>new e5({type:"intersection",left:a,right:b}),a.transform=b=>fm(a,new fc({type:"transform",transform:b})),a.default=b=>(function(a,b){return new fh({type:"default",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.prefault=b=>(function(a,b){return new fi({type:"prefault",innerType:a,get defaultValue(){return"function"==typeof b?b():b}})})(a,b),a.catch=b=>(function(a,b){return new fk({type:"catch",innerType:a,catchValue:"function"==typeof b?b:()=>b})})(a,b),a.pipe=b=>fm(a,b),a.readonly=()=>new fn({type:"readonly",innerType:a}),a.describe=b=>{let c=a.clone();return Z.add(c,{description:b}),c},Object.defineProperty(a,"description",{get:()=>Z.get(a)?.description,configurable:!0}),a.meta=(...b)=>{if(0===b.length)return Z.get(a);let c=a.clone();return Z.add(c,b[0]),c},a.isOptional=()=>a.safeParse(void 0).success,a.isNullable=()=>a.safeParse(null).success,a)),es=av("_ZodString",(a,b)=>{df.init(a,b),er.init(a,b);let c=a._zod.bag;a.format=c.format??null,a.minLength=c.minimum??null,a.maxLength=c.maximum??null,a.regex=(...b)=>a.check(function(a,b){return new c5({check:"string_format",format:"regex",...am(b),pattern:a})}(...b)),a.includes=(...b)=>a.check(function(a,b){return new c8({check:"string_format",format:"includes",...am(b),includes:a})}(...b)),a.startsWith=(...b)=>a.check(function(a,b){return new c9({check:"string_format",format:"starts_with",...am(b),prefix:a})}(...b)),a.endsWith=(...b)=>a.check(function(a,b){return new da({check:"string_format",format:"ends_with",...am(b),suffix:a})}(...b)),a.min=(...b)=>a.check(ek(...b)),a.max=(...b)=>a.check(ej(...b)),a.length=(...b)=>a.check(el(...b)),a.nonempty=(...b)=>a.check(ek(1,...b)),a.lowercase=b=>a.check(new c6({check:"string_format",format:"lowercase",...am(b)})),a.uppercase=b=>a.check(new c7({check:"string_format",format:"uppercase",...am(b)})),a.trim=()=>a.check(em(a=>a.trim())),a.normalize=(...b)=>a.check(function(a){return em(b=>b.normalize(a))}(...b)),a.toLowerCase=()=>a.check(em(a=>a.toLowerCase())),a.toUpperCase=()=>a.check(em(a=>a.toUpperCase()))}),et=av("ZodString",(a,b)=>{df.init(a,b),es.init(a,b),a.email=b=>a.check(new ew({type:"string",format:"email",check:"string_format",abort:!1,...am(b)})),a.url=b=>a.check(new ez({type:"string",format:"url",check:"string_format",abort:!1,...am(b)})),a.jwt=b=>a.check(new eO({type:"string",format:"jwt",check:"string_format",abort:!1,...am(b)})),a.emoji=b=>a.check(new eA({type:"string",format:"emoji",check:"string_format",abort:!1,...am(b)})),a.guid=b=>a.check(ed(ex,b)),a.uuid=b=>a.check(new ey({type:"string",format:"uuid",check:"string_format",abort:!1,...am(b)})),a.uuidv4=b=>a.check(new ey({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...am(b)})),a.uuidv6=b=>a.check(new ey({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...am(b)})),a.uuidv7=b=>a.check(new ey({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...am(b)})),a.nanoid=b=>a.check(new eB({type:"string",format:"nanoid",check:"string_format",abort:!1,...am(b)})),a.guid=b=>a.check(ed(ex,b)),a.cuid=b=>a.check(new eC({type:"string",format:"cuid",check:"string_format",abort:!1,...am(b)})),a.cuid2=b=>a.check(new eD({type:"string",format:"cuid2",check:"string_format",abort:!1,...am(b)})),a.ulid=b=>a.check(new eE({type:"string",format:"ulid",check:"string_format",abort:!1,...am(b)})),a.base64=b=>a.check(new eL({type:"string",format:"base64",check:"string_format",abort:!1,...am(b)})),a.base64url=b=>a.check(new eM({type:"string",format:"base64url",check:"string_format",abort:!1,...am(b)})),a.xid=b=>a.check(new eF({type:"string",format:"xid",check:"string_format",abort:!1,...am(b)})),a.ksuid=b=>a.check(new eG({type:"string",format:"ksuid",check:"string_format",abort:!1,...am(b)})),a.ipv4=b=>a.check(new eH({type:"string",format:"ipv4",check:"string_format",abort:!1,...am(b)})),a.ipv6=b=>a.check(new eI({type:"string",format:"ipv6",check:"string_format",abort:!1,...am(b)})),a.cidrv4=b=>a.check(new eJ({type:"string",format:"cidrv4",check:"string_format",abort:!1,...am(b)})),a.cidrv6=b=>a.check(new eK({type:"string",format:"cidrv6",check:"string_format",abort:!1,...am(b)})),a.e164=b=>a.check(new eN({type:"string",format:"e164",check:"string_format",abort:!1,...am(b)})),a.datetime=b=>a.check(new en({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...am(b)})),a.date=b=>a.check(new eo({type:"string",format:"date",check:"string_format",...am(b)})),a.time=b=>a.check(new ep({type:"string",format:"time",check:"string_format",precision:null,...am(b)})),a.duration=b=>a.check(new eq({type:"string",format:"duration",check:"string_format",...am(b)}))});function eu(a){return new et({type:"string",...am(a)})}let ev=av("ZodStringFormat",(a,b)=>{dg.init(a,b),es.init(a,b)}),ew=av("ZodEmail",(a,b)=>{dj.init(a,b),ev.init(a,b)}),ex=av("ZodGUID",(a,b)=>{dh.init(a,b),ev.init(a,b)}),ey=av("ZodUUID",(a,b)=>{di.init(a,b),ev.init(a,b)}),ez=av("ZodURL",(a,b)=>{dk.init(a,b),ev.init(a,b)}),eA=av("ZodEmoji",(a,b)=>{dl.init(a,b),ev.init(a,b)}),eB=av("ZodNanoID",(a,b)=>{dm.init(a,b),ev.init(a,b)}),eC=av("ZodCUID",(a,b)=>{dn.init(a,b),ev.init(a,b)}),eD=av("ZodCUID2",(a,b)=>{dp.init(a,b),ev.init(a,b)}),eE=av("ZodULID",(a,b)=>{dq.init(a,b),ev.init(a,b)}),eF=av("ZodXID",(a,b)=>{dr.init(a,b),ev.init(a,b)}),eG=av("ZodKSUID",(a,b)=>{ds.init(a,b),ev.init(a,b)}),eH=av("ZodIPv4",(a,b)=>{dx.init(a,b),ev.init(a,b)}),eI=av("ZodIPv6",(a,b)=>{dy.init(a,b),ev.init(a,b)}),eJ=av("ZodCIDRv4",(a,b)=>{dz.init(a,b),ev.init(a,b)}),eK=av("ZodCIDRv6",(a,b)=>{dA.init(a,b),ev.init(a,b)}),eL=av("ZodBase64",(a,b)=>{dC.init(a,b),ev.init(a,b)}),eM=av("ZodBase64URL",(a,b)=>{dD.init(a,b),ev.init(a,b)}),eN=av("ZodE164",(a,b)=>{dE.init(a,b),ev.init(a,b)}),eO=av("ZodJWT",(a,b)=>{dF.init(a,b),ev.init(a,b)}),eP=av("ZodNumber",(a,b)=>{dG.init(a,b),er.init(a,b),a.gt=(b,c)=>a.check(eg(b,c)),a.gte=(b,c)=>a.check(eh(b,c)),a.min=(b,c)=>a.check(eh(b,c)),a.lt=(b,c)=>a.check(ee(b,c)),a.lte=(b,c)=>a.check(ef(b,c)),a.max=(b,c)=>a.check(ef(b,c)),a.int=b=>a.check(eR(b)),a.safe=b=>a.check(eR(b)),a.positive=b=>a.check(eg(0,b)),a.nonnegative=b=>a.check(eh(0,b)),a.negative=b=>a.check(ee(0,b)),a.nonpositive=b=>a.check(ef(0,b)),a.multipleOf=(b,c)=>a.check(ei(b,c)),a.step=(b,c)=>a.check(ei(b,c)),a.finite=()=>a;let c=a._zod.bag;a.minValue=Math.max(c.minimum??-1/0,c.exclusiveMinimum??-1/0)??null,a.maxValue=Math.min(c.maximum??1/0,c.exclusiveMaximum??1/0)??null,a.isInt=(c.format??"").includes("int")||Number.isSafeInteger(c.multipleOf??.5),a.isFinite=!0,a.format=c.format??null}),eQ=av("ZodNumberFormat",(a,b)=>{dH.init(a,b),eP.init(a,b)});function eR(a){return new eQ({type:"number",check:"number_format",abort:!1,format:"safeint",...am(a)})}let eS=av("ZodBoolean",(a,b)=>{dI.init(a,b),er.init(a,b)});function eT(a){return new eS({type:"boolean",...am(a)})}let eU=av("ZodNull",(a,b)=>{dJ.init(a,b),er.init(a,b)}),eV=av("ZodUnknown",(a,b)=>{dK.init(a,b),er.init(a,b)});function eW(){return new eV({type:"unknown"})}let eX=av("ZodNever",(a,b)=>{dL.init(a,b),er.init(a,b)});function eY(a){return new eX({type:"never",...am(a)})}let eZ=av("ZodArray",(a,b)=>{dN.init(a,b),er.init(a,b),a.element=b.element,a.min=(b,c)=>a.check(ek(b,c)),a.nonempty=b=>a.check(ek(1,b)),a.max=(b,c)=>a.check(ej(b,c)),a.length=(b,c)=>a.check(el(b,c)),a.unwrap=()=>a.element});function e$(a,b){return new eZ({type:"array",element:a,...am(b)})}let e_=av("ZodObject",(a,b)=>{dQ.init(a,b),er.init(a,b),ac(a,"shape",()=>b.shape),a.keyof=()=>e9(Object.keys(a._zod.def.shape)),a.catchall=b=>a.clone({...a._zod.def,catchall:b}),a.passthrough=()=>a.clone({...a._zod.def,catchall:eW()}),a.loose=()=>a.clone({...a._zod.def,catchall:eW()}),a.strict=()=>a.clone({...a._zod.def,catchall:eY()}),a.strip=()=>a.clone({...a._zod.def,catchall:void 0}),a.extend=b=>(function(a,b){if(!ai(b))throw Error("Invalid input to extend: expected a plain object");let c={...a._zod.def,get shape(){let c={...a._zod.def.shape,...b};return ad(this,"shape",c),c},checks:[]};return al(a,c)})(a,b),a.merge=b=>(function(a,b){return al(a,{...a._zod.def,get shape(){let c={...a._zod.def.shape,...b._zod.def.shape};return ad(this,"shape",c),c},catchall:b._zod.def.catchall,checks:[]})})(a,b),a.pick=b=>(function(a,b){let c={},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&(c[a]=d.shape[a])}return al(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.omit=b=>(function(a,b){let c={...a._zod.def.shape},d=a._zod.def;for(let a in b){if(!(a in d.shape))throw Error(`Unrecognized key: "${a}"`);b[a]&&delete c[a]}return al(a,{...a._zod.def,shape:c,checks:[]})})(a,b),a.partial=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in d))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=a?new a({type:"optional",innerType:d[b]}):d[b])}else for(let b in d)e[b]=a?new a({type:"optional",innerType:d[b]}):d[b];return al(b,{...b._zod.def,shape:e,checks:[]})})(fd,a,b[0]),a.required=(...b)=>(function(a,b,c){let d=b._zod.def.shape,e={...d};if(c)for(let b in c){if(!(b in e))throw Error(`Unrecognized key: "${b}"`);c[b]&&(e[b]=new a({type:"nonoptional",innerType:d[b]}))}else for(let b in d)e[b]=new a({type:"nonoptional",innerType:d[b]});return al(b,{...b._zod.def,shape:e,checks:[]})})(fj,a,b[0])});function e0(a,b){return new e_({type:"object",get shape(){return ad(this,"shape",{...a}),this.shape},...am(b)})}function e1(a,b){return new e_({type:"object",get shape(){return ad(this,"shape",{...a}),this.shape},catchall:eY(),...am(b)})}let e2=av("ZodUnion",(a,b)=>{dS.init(a,b),er.init(a,b),a.options=b.options});function e3(a,b){return new e2({type:"union",options:a,...am(b)})}let e4=av("ZodDiscriminatedUnion",(a,b)=>{e2.init(a,b),dT.init(a,b)}),e5=av("ZodIntersection",(a,b)=>{dU.init(a,b),er.init(a,b)}),e6=av("ZodRecord",(a,b)=>{dW.init(a,b),er.init(a,b),a.keyType=b.keyType,a.valueType=b.valueType});function e7(a,b,c){return new e6({type:"record",keyType:a,valueType:b,...am(c)})}let e8=av("ZodEnum",(a,b)=>{dX.init(a,b),er.init(a,b),a.enum=b.entries,a.options=Object.values(b.entries);let c=new Set(Object.keys(b.entries));a.extract=(a,d)=>{let e={};for(let d of a)if(c.has(d))e[d]=b.entries[d];else throw Error(`Key ${d} not found in enum`);return new e8({...b,checks:[],...am(d),entries:e})},a.exclude=(a,d)=>{let e={...b.entries};for(let b of a)if(c.has(b))delete e[b];else throw Error(`Key ${b} not found in enum`);return new e8({...b,checks:[],...am(d),entries:e})}});function e9(a,b){return new e8({type:"enum",entries:Array.isArray(a)?Object.fromEntries(a.map(a=>[a,a])):a,...am(b)})}let fa=av("ZodLiteral",(a,b)=>{dY.init(a,b),er.init(a,b),a.values=new Set(b.values),Object.defineProperty(a,"value",{get(){if(b.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return b.values[0]}})});function fb(a,b){return new fa({type:"literal",values:Array.isArray(a)?a:[a],...am(b)})}let fc=av("ZodTransform",(a,b)=>{dZ.init(a,b),er.init(a,b),a._zod.parse=(c,d)=>{c.addIssue=d=>{"string"==typeof d?c.issues.push(at(d,c.value,b)):(d.fatal&&(d.continue=!1),d.code??(d.code="custom"),d.input??(d.input=c.value),d.inst??(d.inst=a),d.continue??(d.continue=!0),c.issues.push(at(d)))};let e=b.transform(c.value,c);return e instanceof Promise?e.then(a=>(c.value=a,c)):(c.value=e,c)}}),fd=av("ZodOptional",(a,b)=>{d$.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType});function fe(a){return new fd({type:"optional",innerType:a})}let ff=av("ZodNullable",(a,b)=>{d_.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType});function fg(a){return new ff({type:"nullable",innerType:a})}let fh=av("ZodDefault",(a,b)=>{d0.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeDefault=a.unwrap}),fi=av("ZodPrefault",(a,b)=>{d2.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType}),fj=av("ZodNonOptional",(a,b)=>{d3.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType}),fk=av("ZodCatch",(a,b)=>{d5.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.innerType,a.removeCatch=a.unwrap}),fl=av("ZodPipe",(a,b)=>{d6.init(a,b),er.init(a,b),a.in=b.in,a.out=b.out});function fm(a,b){return new fl({type:"pipe",in:a,out:b})}let fn=av("ZodReadonly",(a,b)=>{d8.init(a,b),er.init(a,b)}),fo=av("ZodLazy",(a,b)=>{ea.init(a,b),er.init(a,b),a.unwrap=()=>a._zod.def.getter()}),fp=av("ZodCustom",(a,b)=>{eb.init(a,b),er.init(a,b)});function fq(a,b){let c=am(b);return c.abort??(c.abort=!0),new fp({type:"custom",check:"custom",fn:a??(()=>!0),...c})}function fr(a,b={error:`Input not instance of ${a.name}`}){let c=new fp({type:"custom",check:"custom",fn:b=>b instanceof a,abort:!0,...am(b)});return c._zod.bag.Class=a,c}var fs=Object.defineProperty,ft=(Symbol.for("vercel.ai.error.AI_InvalidArgumentError"),Symbol.for("vercel.ai.error.AI_InvalidStreamPartError"),Symbol.for("vercel.ai.error.AI_InvalidToolApprovalError"),Symbol.for("vercel.ai.error.AI_InvalidToolInputError"),Symbol.for("vercel.ai.error.AI_ToolCallNotFoundForApprovalError"),Symbol.for("vercel.ai.error.AI_MissingToolResultsError"),Symbol.for("vercel.ai.error.AI_NoImageGeneratedError"),"AI_NoObjectGeneratedError"),fu=`vercel.ai.error.${ft}`,fv=Symbol.for(fu),fw=class extends G{constructor({message:a="No object generated.",cause:b,text:c,response:d,usage:e,finishReason:f}){super({name:ft,message:a,cause:b}),this[q]=!0,this.text=c,this.response=d,this.usage=e,this.finishReason=f}static isInstance(a){return G.hasMarker(a,fu)}};q=fv,Symbol.for("vercel.ai.error.AI_NoOutputGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSpeechGeneratedError"),Symbol.for("vercel.ai.error.AI_NoTranscriptGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchToolError"),Symbol.for("vercel.ai.error.AI_ToolCallRepairError");var fx="AI_UIMessageStreamError",fy=`vercel.ai.error.${fx}`,fz=Symbol.for(fy),fA=class extends G{constructor({chunkType:a,chunkId:b,message:c}){super({name:fx,message:c}),this[r]=!0,this.chunkType=a,this.chunkId=b}static isInstance(a){return G.hasMarker(a,fy)}};r=fz,Symbol.for("vercel.ai.error.AI_InvalidDataContentError"),Symbol.for("vercel.ai.error.AI_InvalidMessageRoleError"),Symbol.for("vercel.ai.error.AI_MessageConversionError"),Symbol.for("vercel.ai.error.AI_RetryError");var fB="6.0.65",fC=e3([eu(),fr(Uint8Array),fr(ArrayBuffer),fq(a=>{var b,c;return null!=(c=null==(b=globalThis.Buffer)?void 0:b.isBuffer(a))&&c},{message:"Must be a Buffer"})]),fD=new fo({type:"lazy",getter:()=>e3([new eU({type:"null",...am(void 0)}),eu(),new eP({type:"number",checks:[],...am(void 0)}),eT(),e7(eu(),fD.optional()),e$(fD)])}),fE=e7(eu(),e7(eu(),fD.optional())),fF=e0({type:fb("text"),text:eu(),providerOptions:fE.optional()}),fG=e0({type:fb("image"),image:e3([fC,fr(URL)]),mediaType:eu().optional(),providerOptions:fE.optional()}),fH=e0({type:fb("file"),data:e3([fC,fr(URL)]),filename:eu().optional(),mediaType:eu(),providerOptions:fE.optional()}),fI=e0({type:fb("reasoning"),text:eu(),providerOptions:fE.optional()}),fJ=e0({type:fb("tool-call"),toolCallId:eu(),toolName:eu(),input:eW(),providerOptions:fE.optional(),providerExecuted:eT().optional()}),fK=new e4({type:"union",options:[e0({type:fb("text"),value:eu(),providerOptions:fE.optional()}),e0({type:fb("json"),value:fD,providerOptions:fE.optional()}),e0({type:fb("execution-denied"),reason:eu().optional(),providerOptions:fE.optional()}),e0({type:fb("error-text"),value:eu(),providerOptions:fE.optional()}),e0({type:fb("error-json"),value:fD,providerOptions:fE.optional()}),e0({type:fb("content"),value:e$(e3([e0({type:fb("text"),text:eu(),providerOptions:fE.optional()}),e0({type:fb("media"),data:eu(),mediaType:eu()}),e0({type:fb("file-data"),data:eu(),mediaType:eu(),filename:eu().optional(),providerOptions:fE.optional()}),e0({type:fb("file-url"),url:eu(),providerOptions:fE.optional()}),e0({type:fb("file-id"),fileId:e3([eu(),e7(eu(),eu())]),providerOptions:fE.optional()}),e0({type:fb("image-data"),data:eu(),mediaType:eu(),providerOptions:fE.optional()}),e0({type:fb("image-url"),url:eu(),providerOptions:fE.optional()}),e0({type:fb("image-file-id"),fileId:e3([eu(),e7(eu(),eu())]),providerOptions:fE.optional()}),e0({type:fb("custom"),providerOptions:fE.optional()})]))})],discriminator:"type",...am(void 0)}),fL=e0({type:fb("tool-result"),toolCallId:eu(),toolName:eu(),output:fK,providerOptions:fE.optional()}),fM=e0({type:fb("tool-approval-request"),approvalId:eu(),toolCallId:eu()}),fN=e0({type:fb("tool-approval-response"),approvalId:eu(),approved:eT(),reason:eu().optional()}),fO=e0({role:fb("system"),content:eu(),providerOptions:fE.optional()}),fP=e0({role:fb("user"),content:e3([eu(),e$(e3([fF,fG,fH]))]),providerOptions:fE.optional()}),fQ=e0({role:fb("assistant"),content:e3([eu(),e$(e3([fF,fH,fI,fJ,fL,fM]))]),providerOptions:fE.optional()}),fR=e0({role:fb("tool"),content:e$(e3([fL,fN])),providerOptions:fE.optional()});async function fS(a){if(void 0===a)return{value:void 0,state:"undefined-input"};let b=await cu({text:a});return b.success?{value:b.value,state:"successful-parse"}:(b=await cu({text:function(a){let b=["ROOT"],c=-1,d=null;function e(a,e,f){switch(a){case'"':c=e,b.pop(),b.push(f),b.push("INSIDE_STRING");break;case"f":case"t":case"n":c=e,d=e,b.pop(),b.push(f),b.push("INSIDE_LITERAL");break;case"-":b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=e,b.pop(),b.push(f),b.push("INSIDE_NUMBER");break;case"{":c=e,b.pop(),b.push(f),b.push("INSIDE_OBJECT_START");break;case"[":c=e,b.pop(),b.push(f),b.push("INSIDE_ARRAY_START")}}function f(a,d){switch(a){case",":b.pop(),b.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":c=d,b.pop()}}function g(a,d){switch(a){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=d,b.pop()}}for(let h=0;h<a.length;h++){let i=a[h];switch(b[b.length-1]){case"ROOT":e(i,h,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':b.pop(),b.push("INSIDE_OBJECT_KEY");break;case"}":c=h,b.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===i&&(b.pop(),b.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===i&&(b.pop(),b.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":e(i,h,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":f(i,h);break;case"INSIDE_STRING":switch(i){case'"':b.pop(),c=h;break;case"\\":b.push("INSIDE_STRING_ESCAPE");break;default:c=h}break;case"INSIDE_ARRAY_START":"]"===i?(c=h,b.pop()):(c=h,e(i,h,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":b.pop(),b.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":c=h,b.pop();break;default:c=h}break;case"INSIDE_ARRAY_AFTER_COMMA":e(i,h,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":b.pop(),c=h;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":c=h;break;case"e":case"E":case"-":case".":break;case",":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"}":b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]&&f(i,h);break;case"]":b.pop(),"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h);break;default:b.pop()}break;case"INSIDE_LITERAL":{let e=a.substring(d,h+1);"false".startsWith(e)||"true".startsWith(e)||"null".startsWith(e)?c=h:(b.pop(),"INSIDE_OBJECT_AFTER_VALUE"===b[b.length-1]?f(i,h):"INSIDE_ARRAY_AFTER_VALUE"===b[b.length-1]&&g(i,h))}}}let h=a.slice(0,c+1);for(let c=b.length-1;c>=0;c--)switch(b[c]){case"INSIDE_STRING":h+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":h+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":h+="]";break;case"INSIDE_LITERAL":{let b=a.substring(d,a.length);"true".startsWith(b)?h+="true".slice(b.length):"false".startsWith(b)?h+="false".slice(b.length):"null".startsWith(b)&&(h+="null".slice(b.length))}}return h}(a)})).success?{value:b.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}e3([fO,fP,fQ,fR]),((a,b)=>{for(var c in b)fs(a,c,{get:b[c],enumerable:!0})})({},{array:()=>fV,choice:()=>fW,json:()=>fX,object:()=>fU,text:()=>fT});var fT=()=>({name:"text",responseFormat:Promise.resolve({type:"text"}),parseCompleteOutput:async({text:a})=>a,parsePartialOutput:async({text:a})=>({partial:a}),createElementStreamTransform(){}}),fU=({schema:a,name:b,description:c})=>{let d=cq(a);return{name:"object",responseFormat:cv(d.jsonSchema).then(a=>({type:"json",schema:a,...null!=b&&{name:b},...null!=c&&{description:c}})),async parseCompleteOutput({text:a},b){let c=await cu({text:a});if(!c.success)throw new fw({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});let e=await ct({value:c.value,schema:d});if(!e.success)throw new fw({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});return e.value},async parsePartialOutput({text:a}){let b=await fS(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:b.value}}},createElementStreamTransform(){}}},fV=({element:a,name:b,description:c})=>{let d=cq(a);return{name:"array",responseFormat:cv(d.jsonSchema).then(a=>{let{$schema:d,...e}=a;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:e}},required:["elements"],additionalProperties:!1},...null!=b&&{name:b},...null!=c&&{description:c}}}),async parseCompleteOutput({text:a},b){let c=await cu({text:a});if(!c.success)throw new fw({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});let e=c.value;if(null==e||"object"!=typeof e||!("elements"in e)||!Array.isArray(e.elements))throw new fw({message:"No object generated: response did not match schema.",cause:new W({value:e,cause:"response must be an object with an elements array"}),text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});for(let c of e.elements){let e=await ct({value:c,schema:d});if(!e.success)throw new fw({message:"No object generated: response did not match schema.",cause:e.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason})}return e.elements},async parsePartialOutput({text:a}){let b=await fS(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let a=b.value;if(null==a||"object"!=typeof a||!("elements"in a)||!Array.isArray(a.elements))return;let c="repaired-parse"===b.state&&a.elements.length>0?a.elements.slice(0,-1):a.elements,e=[];for(let a of c){let b=await ct({value:a,schema:d});b.success&&e.push(b.value)}return{partial:e}}}},createElementStreamTransform(){let a=0;return new TransformStream({transform({partialOutput:b},c){if(null!=b)for(;a<b.length;a++)c.enqueue(b[a])}})}}},fW=({options:a,name:b,description:c})=>({name:"choice",responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:a}},required:["result"],additionalProperties:!1},...null!=b&&{name:b},...null!=c&&{description:c}}),async parseCompleteOutput({text:b},c){let d=await cu({text:b});if(!d.success)throw new fw({message:"No object generated: could not parse the response.",cause:d.error,text:b,response:c.response,usage:c.usage,finishReason:c.finishReason});let e=d.value;if(null==e||"object"!=typeof e||!("result"in e)||"string"!=typeof e.result||!a.includes(e.result))throw new fw({message:"No object generated: response did not match schema.",cause:new W({value:e,cause:"response must be an object that contains a choice value."}),text:b,response:c.response,usage:c.usage,finishReason:c.finishReason});return e.result},async parsePartialOutput({text:b}){let c=await fS(b);switch(c.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{let b=c.value;if(null==b||"object"!=typeof b||!("result"in b)||"string"!=typeof b.result)return;let d=a.filter(a=>a.startsWith(b.result));if("successful-parse"===c.state)return d.includes(b.result)?{partial:b.result}:void 0;return 1===d.length?{partial:d[0]}:void 0}}},createElementStreamTransform(){}}),fX=({name:a,description:b}={})=>({name:"json",responseFormat:Promise.resolve({type:"json",...null!=a&&{name:a},...null!=b&&{description:b}}),async parseCompleteOutput({text:a},b){let c=await cu({text:a});if(!c.success)throw new fw({message:"No object generated: could not parse the response.",cause:c.error,text:a,response:b.response,usage:b.usage,finishReason:b.finishReason});return c.value},async parsePartialOutput({text:a}){let b=await fS(a);switch(b.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return void 0===b.value?void 0:{partial:b.value}}},createElementStreamTransform(){}});bZ({prefix:"aitxt",size:24}),TransformStream;var fY=co(()=>cr(e3([e1({type:fb("text-start"),id:eu(),providerMetadata:fE.optional()}),e1({type:fb("text-delta"),id:eu(),delta:eu(),providerMetadata:fE.optional()}),e1({type:fb("text-end"),id:eu(),providerMetadata:fE.optional()}),e1({type:fb("error"),errorText:eu()}),e1({type:fb("tool-input-start"),toolCallId:eu(),toolName:eu(),providerExecuted:eT().optional(),providerMetadata:fE.optional(),dynamic:eT().optional(),title:eu().optional()}),e1({type:fb("tool-input-delta"),toolCallId:eu(),inputTextDelta:eu()}),e1({type:fb("tool-input-available"),toolCallId:eu(),toolName:eu(),input:eW(),providerExecuted:eT().optional(),providerMetadata:fE.optional(),dynamic:eT().optional(),title:eu().optional()}),e1({type:fb("tool-input-error"),toolCallId:eu(),toolName:eu(),input:eW(),providerExecuted:eT().optional(),providerMetadata:fE.optional(),dynamic:eT().optional(),errorText:eu(),title:eu().optional()}),e1({type:fb("tool-approval-request"),approvalId:eu(),toolCallId:eu()}),e1({type:fb("tool-output-available"),toolCallId:eu(),output:eW(),providerExecuted:eT().optional(),dynamic:eT().optional(),preliminary:eT().optional()}),e1({type:fb("tool-output-error"),toolCallId:eu(),errorText:eu(),providerExecuted:eT().optional(),dynamic:eT().optional()}),e1({type:fb("tool-output-denied"),toolCallId:eu()}),e1({type:fb("reasoning-start"),id:eu(),providerMetadata:fE.optional()}),e1({type:fb("reasoning-delta"),id:eu(),delta:eu(),providerMetadata:fE.optional()}),e1({type:fb("reasoning-end"),id:eu(),providerMetadata:fE.optional()}),e1({type:fb("source-url"),sourceId:eu(),url:eu(),title:eu().optional(),providerMetadata:fE.optional()}),e1({type:fb("source-document"),sourceId:eu(),mediaType:eu(),title:eu(),filename:eu().optional(),providerMetadata:fE.optional()}),e1({type:fb("file"),url:eu(),mediaType:eu(),providerMetadata:fE.optional()}),e1({type:fq(a=>"string"==typeof a&&a.startsWith("data-"),{message:'Type must start with "data-"'}),id:eu().optional(),data:eW(),transient:eT().optional()}),e1({type:fb("start-step")}),e1({type:fb("finish-step")}),e1({type:fb("start"),messageId:eu().optional(),messageMetadata:eW().optional()}),e1({type:fb("finish"),finishReason:e9(["stop","length","content-filter","tool-calls","error","other"]).optional(),messageMetadata:eW().optional()}),e1({type:fb("abort"),reason:eu().optional()}),e1({type:fb("message-metadata"),messageMetadata:eW()})])));function fZ(a){return a.type.startsWith("tool-")}function f$(a){return fZ(a)||"dynamic-tool"===a.type}function f_(a){return a.type.split("-").slice(1).join("-")}async function f0({stream:a,onError:b}){let c=a.getReader();try{for(;;){let{done:a}=await c.read();if(a)break}}catch(a){null==b||b(a)}finally{c.releaseLock()}}bZ({prefix:"aitxt",size:24}),co(()=>cr(e$(e0({id:eu(),role:e9(["system","user","assistant"]),metadata:eW().optional(),parts:e$(e3([e0({type:fb("text"),text:eu(),state:e9(["streaming","done"]).optional(),providerMetadata:fE.optional()}),e0({type:fb("reasoning"),text:eu(),state:e9(["streaming","done"]).optional(),providerMetadata:fE.optional()}),e0({type:fb("source-url"),sourceId:eu(),url:eu(),title:eu().optional(),providerMetadata:fE.optional()}),e0({type:fb("source-document"),sourceId:eu(),mediaType:eu(),title:eu(),filename:eu().optional(),providerMetadata:fE.optional()}),e0({type:fb("file"),mediaType:eu(),filename:eu().optional(),url:eu(),providerMetadata:fE.optional()}),e0({type:fb("step-start")}),e0({type:eu().startsWith("data-"),id:eu().optional(),data:eW()}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("input-streaming"),input:eW().optional(),providerExecuted:eT().optional(),callProviderMetadata:fE.optional(),output:eY().optional(),errorText:eY().optional(),approval:eY().optional()}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("input-available"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:eY().optional()}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("approval-requested"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:eY().optional(),reason:eY().optional()})}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("approval-responded"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:eT(),reason:eu().optional()})}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("output-available"),input:eW(),providerExecuted:eT().optional(),output:eW(),errorText:eY().optional(),callProviderMetadata:fE.optional(),preliminary:eT().optional(),approval:e0({id:eu(),approved:fb(!0),reason:eu().optional()}).optional()}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("output-error"),input:eW(),rawInput:eW().optional(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eu(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:fb(!0),reason:eu().optional()}).optional()}),e0({type:fb("dynamic-tool"),toolName:eu(),toolCallId:eu(),state:fb("output-denied"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:fb(!1),reason:eu().optional()})}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("input-streaming"),providerExecuted:eT().optional(),callProviderMetadata:fE.optional(),input:eW().optional(),output:eY().optional(),errorText:eY().optional(),approval:eY().optional()}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("input-available"),providerExecuted:eT().optional(),input:eW(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:eY().optional()}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("approval-requested"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:eY().optional(),reason:eY().optional()})}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("approval-responded"),input:eW(),providerExecuted:eT().optional(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:eT(),reason:eu().optional()})}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("output-available"),providerExecuted:eT().optional(),input:eW(),output:eW(),errorText:eY().optional(),callProviderMetadata:fE.optional(),preliminary:eT().optional(),approval:e0({id:eu(),approved:fb(!0),reason:eu().optional()}).optional()}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("output-error"),providerExecuted:eT().optional(),input:eW(),rawInput:eW().optional(),output:eY().optional(),errorText:eu(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:fb(!0),reason:eu().optional()}).optional()}),e0({type:eu().startsWith("tool-"),toolCallId:eu(),state:fb("output-denied"),providerExecuted:eT().optional(),input:eW(),output:eY().optional(),errorText:eY().optional(),callProviderMetadata:fE.optional(),approval:e0({id:eu(),approved:fb(!1),reason:eu().optional()})})])).nonempty("Message must contain at least one part")})).nonempty("Messages array must not be empty"))),bZ({prefix:"aiobj",size:24});var f1=class{constructor(){this.queue=[],this.isProcessing=!1}async processQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.queue.length>0;)await this.queue[0](),this.queue.shift();this.isProcessing=!1}}async run(a){return new Promise((b,c)=>{this.queue.push(async()=>{try{await a(),b()}catch(a){c(a)}}),this.processQueue()})}};async function f2(a){if(null==a)return[];if(!globalThis.FileList||!(a instanceof globalThis.FileList))throw Error("FileList is not supported in the current environment");return Promise.all(Array.from(a).map(async a=>{let{name:b,type:c}=a;return{type:"file",mediaType:c,filename:b,url:await new Promise((b,c)=>{let d=new FileReader;d.onload=a=>{var c;b(null==(c=a.target)?void 0:c.result)},d.onerror=a=>c(a),d.readAsDataURL(a)})}}))}bZ({prefix:"aiobj",size:24}),Symbol.for("vercel.ai.error.AI_NoSuchProviderError");var f3=class{constructor({api:a="/api/chat",credentials:b,headers:c,body:d,fetch:e,prepareSendMessagesRequest:f,prepareReconnectToStreamRequest:g}){this.api=a,this.credentials=b,this.headers=c,this.body=d,this.fetch=e,this.prepareSendMessagesRequest=f,this.prepareReconnectToStreamRequest=g}async sendMessages({abortSignal:a,...b}){var c,d,e,f,g;let h=await cv(this.body),i=await cv(this.headers),j=await cv(this.credentials),k={...b0(i),...b0(b.headers)},l=await (null==(c=this.prepareSendMessagesRequest)?void 0:c.call(this,{api:this.api,id:b.chatId,messages:b.messages,body:{...h,...b.body},headers:k,credentials:j,requestMetadata:b.metadata,trigger:b.trigger,messageId:b.messageId})),m=null!=(d=null==l?void 0:l.api)?d:this.api,n=(null==l?void 0:l.headers)!==void 0?b0(l.headers):k,o=(null==l?void 0:l.body)!==void 0?l.body:{...h,...b.body,id:b.chatId,messages:b.messages,trigger:b.trigger,messageId:b.messageId},p=null!=(e=null==l?void 0:l.credentials)?e:j,q=null!=(f=this.fetch)?f:globalThis.fetch,r=await q(m,{method:"POST",headers:b1({"Content-Type":"application/json",...n},`ai-sdk/${fB}`,b_()),body:JSON.stringify(o),credentials:p,signal:a});if(!r.ok)throw Error(null!=(g=await r.text())?g:"Failed to fetch the chat response.");if(!r.body)throw Error("The response body is empty.");return this.processResponseStream(r.body)}async reconnectToStream(a){var b,c,d,e,f;let g=await cv(this.body),h=await cv(this.headers),i=await cv(this.credentials),j={...b0(h),...b0(a.headers)},k=await (null==(b=this.prepareReconnectToStreamRequest)?void 0:b.call(this,{api:this.api,id:a.chatId,body:{...g,...a.body},headers:j,credentials:i,requestMetadata:a.metadata})),l=null!=(c=null==k?void 0:k.api)?c:`${this.api}/${a.chatId}/stream`,m=(null==k?void 0:k.headers)!==void 0?b0(k.headers):j,n=null!=(d=null==k?void 0:k.credentials)?d:i,o=null!=(e=this.fetch)?e:globalThis.fetch,p=await o(l,{method:"GET",headers:b1(m,`ai-sdk/${fB}`,b_()),credentials:n});if(204===p.status)return null;if(!p.ok)throw Error(null!=(f=await p.text())?f:"Failed to fetch the chat response.");if(!p.body)throw Error("The response body is empty.");return this.processResponseStream(p.body)}},f4=class extends f3{constructor(a={}){super(a)}processResponseStream(a){return(function({stream:a,schema:b}){return a.pipeThrough(new TextDecoderStream).pipeThrough(new bV).pipeThrough(new TransformStream({async transform({data:a},c){"[DONE]"!==a&&c.enqueue(await cu({text:a,schema:b}))}}))})({stream:a,schema:fY}).pipeThrough(new TransformStream({async transform(a,b){if(!a.success)throw a.error;b.enqueue(a.value)}}))}},f5=class{constructor({generateId:a=b$,id:b=a(),transport:c=new f4,messageMetadataSchema:d,dataPartSchemas:e,state:f,onError:g,onToolCall:h,onFinish:i,onData:j,sendAutomaticallyWhen:k}){this.activeResponse=void 0,this.jobExecutor=new f1,this.sendMessage=async(a,b)=>{var c,d,e,f;let g;if(null==a)return void await this.makeRequest({trigger:"submit-message",messageId:null==(c=this.lastMessage)?void 0:c.id,...b});if(g="text"in a||"files"in a?{parts:[...Array.isArray(a.files)?a.files:await f2(a.files),..."text"in a&&null!=a.text?[{type:"text",text:a.text}]:[]]}:a,null!=a.messageId){let b=this.state.messages.findIndex(b=>b.id===a.messageId);if(-1===b)throw Error(`message with id ${a.messageId} not found`);if("user"!==this.state.messages[b].role)throw Error(`message with id ${a.messageId} is not a user message`);this.state.messages=this.state.messages.slice(0,b+1),this.state.replaceMessage(b,{...g,id:a.messageId,role:null!=(d=g.role)?d:"user",metadata:a.metadata})}else this.state.pushMessage({...g,id:null!=(e=g.id)?e:this.generateId(),role:null!=(f=g.role)?f:"user",metadata:a.metadata});await this.makeRequest({trigger:"submit-message",messageId:a.messageId,...b})},this.regenerate=async({messageId:a,...b}={})=>{let c=null==a?this.state.messages.length-1:this.state.messages.findIndex(b=>b.id===a);if(-1===c)throw Error(`message ${a} not found`);this.state.messages=this.state.messages.slice(0,"assistant"===this.messages[c].role?c:c+1),await this.makeRequest({trigger:"regenerate-message",messageId:a,...b})},this.resumeStream=async(a={})=>{await this.makeRequest({trigger:"resume-stream",...a})},this.clearError=()=>{"error"===this.status&&(this.state.error=void 0,this.setStatus({status:"ready"}))},this.addToolApprovalResponse=async({id:a,approved:b,reason:c})=>this.jobExecutor.run(async()=>{let d=this.state.messages,e=d[d.length-1],f=d=>f$(d)&&"approval-requested"===d.state&&d.approval.id===a?{...d,state:"approval-responded",approval:{id:a,approved:b,reason:c}}:d;this.state.replaceMessage(d.length-1,{...e,parts:e.parts.map(f)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(f)),"streaming"!==this.status&&"submitted"!==this.status&&this.sendAutomaticallyWhen&&this.shouldSendAutomatically().then(a=>{var b;a&&this.makeRequest({trigger:"submit-message",messageId:null==(b=this.lastMessage)?void 0:b.id})})}),this.addToolOutput=async({state:a="output-available",tool:b,toolCallId:c,output:d,errorText:e})=>this.jobExecutor.run(async()=>{let b=this.state.messages,f=b[b.length-1],g=b=>f$(b)&&b.toolCallId===c?{...b,state:a,output:d,errorText:e}:b;this.state.replaceMessage(b.length-1,{...f,parts:f.parts.map(g)}),this.activeResponse&&(this.activeResponse.state.message.parts=this.activeResponse.state.message.parts.map(g)),"streaming"!==this.status&&"submitted"!==this.status&&this.sendAutomaticallyWhen&&this.shouldSendAutomatically().then(a=>{var b;a&&this.makeRequest({trigger:"submit-message",messageId:null==(b=this.lastMessage)?void 0:b.id})})}),this.addToolResult=this.addToolOutput,this.stop=async()=>{var a;("streaming"===this.status||"submitted"===this.status)&&(null==(a=this.activeResponse)?void 0:a.abortController)&&this.activeResponse.abortController.abort()},this.id=b,this.transport=c,this.generateId=a,this.messageMetadataSchema=d,this.dataPartSchemas=e,this.state=f,this.onError=g,this.onToolCall=h,this.onFinish=i,this.onData=j,this.sendAutomaticallyWhen=k}get status(){return this.state.status}setStatus({status:a,error:b}){this.status!==a&&(this.state.status=a,this.state.error=b)}get error(){return this.state.error}get messages(){return this.state.messages}get lastMessage(){return this.state.messages[this.state.messages.length-1]}set messages(a){this.state.messages=a}async shouldSendAutomatically(){if(!this.sendAutomaticallyWhen)return!1;let a=this.sendAutomaticallyWhen({messages:this.state.messages});return a&&"object"==typeof a&&"then"in a?await a:a}async makeRequest({trigger:a,metadata:b,headers:c,body:d,messageId:e}){var f,g,h;this.setStatus({status:"submitted",error:void 0});let i=this.lastMessage,j=!1,k=!1,l=!1;try{let f,g={state:function({lastMessage:a,messageId:b}){return{message:(null==a?void 0:a.role)==="assistant"?a:{id:b,metadata:void 0,role:"assistant",parts:[]},activeTextParts:{},activeReasoningParts:{},partialToolCalls:{}}}({lastMessage:this.state.snapshot(i),messageId:this.generateId()}),abortController:new AbortController};if(g.abortController.signal.addEventListener("abort",()=>{j=!0}),this.activeResponse=g,"resume-stream"===a){let a=await this.transport.reconnectToStream({chatId:this.id,metadata:b,headers:c,body:d});if(null==a)return void this.setStatus({status:"ready"});f=a}else f=await this.transport.sendMessages({chatId:this.id,messages:this.state.messages,abortSignal:g.abortController.signal,metadata:b,headers:c,body:d,trigger:a,messageId:e});let h=a=>this.jobExecutor.run(()=>a({state:g.state,write:()=>{var a;this.setStatus({status:"streaming"}),g.state.message.id===(null==(a=this.lastMessage)?void 0:a.id)?this.state.replaceMessage(this.state.messages.length-1,g.state.message):this.state.pushMessage(g.state.message)}}));await f0({stream:function({stream:a,messageMetadataSchema:b,dataPartSchemas:c,runUpdateMessageJob:d,onError:e,onToolCall:f,onData:g}){return a.pipeThrough(new TransformStream({async transform(a,h){await d(async({state:d,write:i})=>{var j,k,l,m;function n(a){let b=d.message.parts.filter(f$).find(b=>b.toolCallId===a);if(null==b)throw new fA({chunkType:"tool-invocation",chunkId:a,message:`No tool invocation found for tool call ID "${a}".`});return b}function o(a){var b;let c=d.message.parts.find(b=>fZ(b)&&b.toolCallId===a.toolCallId);null!=c?(c.state=a.state,c.input=a.input,c.output=a.output,c.errorText=a.errorText,c.rawInput=a.rawInput,c.preliminary=a.preliminary,void 0!==a.title&&(c.title=a.title),c.providerExecuted=null!=(b=a.providerExecuted)?b:c.providerExecuted,null!=a.providerMetadata&&(c.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:`tool-${a.toolName}`,toolCallId:a.toolCallId,state:a.state,title:a.title,input:a.input,output:a.output,rawInput:a.rawInput,errorText:a.errorText,providerExecuted:a.providerExecuted,preliminary:a.preliminary,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}function p(a){var b,c;let e=d.message.parts.find(b=>"dynamic-tool"===b.type&&b.toolCallId===a.toolCallId);null!=e?(e.state=a.state,e.toolName=a.toolName,e.input=a.input,e.output=a.output,e.errorText=a.errorText,e.rawInput=null!=(b=a.rawInput)?b:e.rawInput,e.preliminary=a.preliminary,void 0!==a.title&&(e.title=a.title),e.providerExecuted=null!=(c=a.providerExecuted)?c:e.providerExecuted,null!=a.providerMetadata&&(e.callProviderMetadata=a.providerMetadata)):d.message.parts.push({type:"dynamic-tool",toolName:a.toolName,toolCallId:a.toolCallId,state:a.state,input:a.input,output:a.output,errorText:a.errorText,preliminary:a.preliminary,providerExecuted:a.providerExecuted,title:a.title,...null!=a.providerMetadata?{callProviderMetadata:a.providerMetadata}:{}})}async function q(a){if(null!=a){let c=null!=d.message.metadata?function a(b,c){if(void 0===b&&void 0===c)return;if(void 0===b)return c;if(void 0===c)return b;let d={...b};for(let e in c)if(Object.prototype.hasOwnProperty.call(c,e)){let f=c[e];if(void 0===f)continue;let g=e in b?b[e]:void 0,h=null!==f&&"object"==typeof f&&!Array.isArray(f)&&!(f instanceof Date)&&!(f instanceof RegExp),i=null!=g&&"object"==typeof g&&!Array.isArray(g)&&!(g instanceof Date)&&!(g instanceof RegExp);h&&i?d[e]=a(g,f):d[e]=f}return d}(d.message.metadata,a):a;null!=b&&await cs({value:c,schema:b,context:{field:"message.metadata",entityId:d.message.id}}),d.message.metadata=c}}switch(a.type){case"text-start":{let b={type:"text",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeTextParts[a.id]=b,d.message.parts.push(b),i();break}case"text-delta":{let b=d.activeTextParts[a.id];if(null==b)throw new fA({chunkType:"text-delta",chunkId:a.id,message:`Received text-delta for missing text part with ID "${a.id}". Ensure a "text-start" chunk is sent before any "text-delta" chunks.`});b.text+=a.delta,b.providerMetadata=null!=(j=a.providerMetadata)?j:b.providerMetadata,i();break}case"text-end":{let b=d.activeTextParts[a.id];if(null==b)throw new fA({chunkType:"text-end",chunkId:a.id,message:`Received text-end for missing text part with ID "${a.id}". Ensure a "text-start" chunk is sent before any "text-end" chunks.`});b.state="done",b.providerMetadata=null!=(k=a.providerMetadata)?k:b.providerMetadata,delete d.activeTextParts[a.id],i();break}case"reasoning-start":{let b={type:"reasoning",text:"",providerMetadata:a.providerMetadata,state:"streaming"};d.activeReasoningParts[a.id]=b,d.message.parts.push(b),i();break}case"reasoning-delta":{let b=d.activeReasoningParts[a.id];if(null==b)throw new fA({chunkType:"reasoning-delta",chunkId:a.id,message:`Received reasoning-delta for missing reasoning part with ID "${a.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-delta" chunks.`});b.text+=a.delta,b.providerMetadata=null!=(l=a.providerMetadata)?l:b.providerMetadata,i();break}case"reasoning-end":{let b=d.activeReasoningParts[a.id];if(null==b)throw new fA({chunkType:"reasoning-end",chunkId:a.id,message:`Received reasoning-end for missing reasoning part with ID "${a.id}". Ensure a "reasoning-start" chunk is sent before any "reasoning-end" chunks.`});b.providerMetadata=null!=(m=a.providerMetadata)?m:b.providerMetadata,b.state="done",delete d.activeReasoningParts[a.id],i();break}case"file":d.message.parts.push({type:"file",mediaType:a.mediaType,url:a.url}),i();break;case"source-url":d.message.parts.push({type:"source-url",sourceId:a.sourceId,url:a.url,title:a.title,providerMetadata:a.providerMetadata}),i();break;case"source-document":d.message.parts.push({type:"source-document",sourceId:a.sourceId,mediaType:a.mediaType,title:a.title,filename:a.filename,providerMetadata:a.providerMetadata}),i();break;case"tool-input-start":{let b=d.message.parts.filter(fZ);d.partialToolCalls[a.toolCallId]={text:"",toolName:a.toolName,index:b.length,dynamic:a.dynamic,title:a.title},a.dynamic?p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0,providerExecuted:a.providerExecuted,title:a.title,providerMetadata:a.providerMetadata}):o({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-streaming",input:void 0,providerExecuted:a.providerExecuted,title:a.title,providerMetadata:a.providerMetadata}),i();break}case"tool-input-delta":{let b=d.partialToolCalls[a.toolCallId];if(null==b)throw new fA({chunkType:"tool-input-delta",chunkId:a.toolCallId,message:`Received tool-input-delta for missing tool call with ID "${a.toolCallId}". Ensure a "tool-input-start" chunk is sent before any "tool-input-delta" chunks.`});b.text+=a.inputTextDelta;let{value:c}=await fS(b.text);b.dynamic?p({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c,title:b.title}):o({toolCallId:a.toolCallId,toolName:b.toolName,state:"input-streaming",input:c,title:b.title}),i();break}case"tool-input-available":a.dynamic?p({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,title:a.title}):o({toolCallId:a.toolCallId,toolName:a.toolName,state:"input-available",input:a.input,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata,title:a.title}),i(),f&&!a.providerExecuted&&await f({toolCall:a});break;case"tool-input-error":a.dynamic?p({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:a.input,errorText:a.errorText,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}):o({toolCallId:a.toolCallId,toolName:a.toolName,state:"output-error",input:void 0,rawInput:a.input,errorText:a.errorText,providerExecuted:a.providerExecuted,providerMetadata:a.providerMetadata}),i();break;case"tool-approval-request":{let b=n(a.toolCallId);b.state="approval-requested",b.approval={id:a.approvalId},i();break}case"tool-output-denied":n(a.toolCallId).state="output-denied",i();break;case"tool-output-available":{let b=n(a.toolCallId);"dynamic-tool"===b.type?p({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-available",input:b.input,output:a.output,preliminary:a.preliminary,providerExecuted:a.providerExecuted,title:b.title}):o({toolCallId:a.toolCallId,toolName:f_(b),state:"output-available",input:b.input,output:a.output,providerExecuted:a.providerExecuted,preliminary:a.preliminary,title:b.title}),i();break}case"tool-output-error":{let b=n(a.toolCallId);"dynamic-tool"===b.type?p({toolCallId:a.toolCallId,toolName:b.toolName,state:"output-error",input:b.input,errorText:a.errorText,providerExecuted:a.providerExecuted,title:b.title}):o({toolCallId:a.toolCallId,toolName:f_(b),state:"output-error",input:b.input,rawInput:b.rawInput,errorText:a.errorText,providerExecuted:a.providerExecuted,title:b.title}),i();break}case"start-step":d.message.parts.push({type:"step-start"});break;case"finish-step":d.activeTextParts={},d.activeReasoningParts={};break;case"start":null!=a.messageId&&(d.message.id=a.messageId),await q(a.messageMetadata),(null!=a.messageId||null!=a.messageMetadata)&&i();break;case"finish":null!=a.finishReason&&(d.finishReason=a.finishReason),await q(a.messageMetadata),null!=a.messageMetadata&&i();break;case"message-metadata":await q(a.messageMetadata),null!=a.messageMetadata&&i();break;case"error":null==e||e(Error(a.errorText));break;default:if(a.type.startsWith("data-")){if((null==c?void 0:c[a.type])!=null){let b=d.message.parts.findIndex(b=>"id"in b&&"data"in b&&b.id===a.id&&b.type===a.type),e=b>=0?b:d.message.parts.length;await cs({value:a.data,schema:c[a.type],context:{field:`message.parts[${e}].data`,entityName:a.type,entityId:a.id}})}if(a.transient){null==g||g(a);break}let b=null!=a.id?d.message.parts.find(b=>a.type===b.type&&a.id===b.id):void 0;null!=b?b.data=a.data:d.message.parts.push(a),null==g||g(a),i()}}h.enqueue(a)})}}))}({stream:f,onToolCall:this.onToolCall,onData:this.onData,messageMetadataSchema:this.messageMetadataSchema,dataPartSchemas:this.dataPartSchemas,runUpdateMessageJob:h,onError:a=>{throw a}}),onError:a=>{throw a}}),this.setStatus({status:"ready"})}catch(a){if(j||"AbortError"===a.name)return j=!0,this.setStatus({status:"ready"}),null;l=!0,a instanceof TypeError&&(a.message.toLowerCase().includes("fetch")||a.message.toLowerCase().includes("network"))&&(k=!0),this.onError&&a instanceof Error&&this.onError(a),this.setStatus({status:"error",error:a})}finally{try{null==(g=this.onFinish)||g.call(this,{message:this.activeResponse.state.message,messages:this.state.messages,isAbort:j,isDisconnect:k,isError:l,finishReason:null==(f=this.activeResponse)?void 0:f.state.finishReason})}catch(a){console.error(a)}this.activeResponse=void 0}!l&&await this.shouldSendAutomatically()&&await this.makeRequest({trigger:"submit-message",messageId:null==(h=this.lastMessage)?void 0:h.id,metadata:b,headers:c,body:d})}},f6=c(68224),f7=(a,b,c)=>{if(!b.has(a))throw TypeError("Cannot "+c)},f8=(a,b,c)=>(f7(a,b,"read from private field"),c?c.call(a):b.get(a)),f9=(a,b,c)=>{if(b.has(a))throw TypeError("Cannot add the same private member more than once");b instanceof WeakSet?b.add(a):b.set(a,c)},ga=(a,b,c,d)=>(f7(a,b,"write to private field"),d?d.call(a,c):b.set(a,c),c),gb=class{constructor(a=[]){f9(this,s,void 0),f9(this,t,"ready"),f9(this,u,void 0),f9(this,v,new Set),f9(this,w,new Set),f9(this,x,new Set),this.pushMessage=a=>{ga(this,s,f8(this,s).concat(a)),f8(this,y).call(this)},this.popMessage=()=>{ga(this,s,f8(this,s).slice(0,-1)),f8(this,y).call(this)},this.replaceMessage=(a,b)=>{ga(this,s,[...f8(this,s).slice(0,a),this.snapshot(b),...f8(this,s).slice(a+1)]),f8(this,y).call(this)},this.snapshot=a=>structuredClone(a),this["~registerMessagesCallback"]=(a,b)=>{let c=b?function(a,b){return null!=b?f6(a,b):a}(a,b):a;return f8(this,v).add(c),()=>{f8(this,v).delete(c)}},this["~registerStatusCallback"]=a=>(f8(this,w).add(a),()=>{f8(this,w).delete(a)}),this["~registerErrorCallback"]=a=>(f8(this,x).add(a),()=>{f8(this,x).delete(a)}),f9(this,y,()=>{f8(this,v).forEach(a=>a())}),f9(this,z,()=>{f8(this,w).forEach(a=>a())}),f9(this,A,()=>{f8(this,x).forEach(a=>a())}),ga(this,s,a)}get status(){return f8(this,t)}set status(a){ga(this,t,a),f8(this,z).call(this)}get error(){return f8(this,u)}set error(a){ga(this,u,a),f8(this,A).call(this)}get messages(){return f8(this,s)}set messages(a){ga(this,s,[...a]),f8(this,y).call(this)}};s=new WeakMap,t=new WeakMap,u=new WeakMap,v=new WeakMap,w=new WeakMap,x=new WeakMap,y=new WeakMap,z=new WeakMap,A=new WeakMap;var gc=class extends f5{constructor({messages:a,...b}){let c=new gb(a);super({...b,state:c}),f9(this,B,void 0),this["~registerMessagesCallback"]=(a,b)=>f8(this,B)["~registerMessagesCallback"](a,b),this["~registerStatusCallback"]=a=>f8(this,B)["~registerStatusCallback"](a),this["~registerErrorCallback"]=a=>f8(this,B)["~registerErrorCallback"](a),ga(this,B,c)}};function gd({endpoint:a,orgId:b}){let{messages:c,input:d,handleInputChange:e,handleSubmit:f,isLoading:g}=function({experimental_throttle:a,resume:b=!1,...c}={}){let d=(0,D.useRef)("chat"in c?{}:{onToolCall:c.onToolCall,onData:c.onData,onFinish:c.onFinish,onError:c.onError,sendAutomaticallyWhen:c.sendAutomaticallyWhen});"chat"in c||(d.current={onToolCall:c.onToolCall,onData:c.onData,onFinish:c.onFinish,onError:c.onError,sendAutomaticallyWhen:c.sendAutomaticallyWhen});let e={...c,onToolCall:a=>{var b,c;return null==(c=(b=d.current).onToolCall)?void 0:c.call(b,a)},onData:a=>{var b,c;return null==(c=(b=d.current).onData)?void 0:c.call(b,a)},onFinish:a=>{var b,c;return null==(c=(b=d.current).onFinish)?void 0:c.call(b,a)},onError:a=>{var b,c;return null==(c=(b=d.current).onError)?void 0:c.call(b,a)},sendAutomaticallyWhen:a=>{var b,c,e;return null!=(e=null==(c=(b=d.current).sendAutomaticallyWhen)?void 0:c.call(b,a))&&e}},f=(0,D.useRef)("chat"in c?c.chat:new gc(e));("chat"in c&&c.chat!==f.current||"id"in c&&f.current.id!==c.id)&&(f.current="chat"in c?c.chat:new gc(e));let g=(0,D.useCallback)(b=>f.current["~registerMessagesCallback"](b,a),[a,f.current.id]),h=(0,D.useSyncExternalStore)(g,()=>f.current.messages,()=>f.current.messages),i=(0,D.useSyncExternalStore)(f.current["~registerStatusCallback"],()=>f.current.status,()=>f.current.status),j=(0,D.useSyncExternalStore)(f.current["~registerErrorCallback"],()=>f.current.error,()=>f.current.error),k=(0,D.useCallback)(a=>{"function"==typeof a&&(a=a(f.current.messages)),f.current.messages=a},[f]);return(0,D.useEffect)(()=>{b&&f.current.resumeStream()},[b,f]),{id:f.current.id,messages:h,setMessages:k,sendMessage:f.current.sendMessage,regenerate:f.current.regenerate,clearError:f.current.clearError,stop:f.current.stop,error:j,resumeStream:f.current.resumeStream,status:i,addToolResult:f.current.addToolOutput,addToolOutput:f.current.addToolOutput,addToolApprovalResponse:f.current.addToolApprovalResponse}}({api:a,body:{orgId:b}}),h=(0,D.useRef)(null);return(0,C.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,C.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",ref:h,children:[0===c.length&&(0,C.jsxs)("div",{className:"text-center text-gray-400 mt-20 text-sm",children:[(0,C.jsx)("p",{children:"Connected to Stack Troubleshoot."}),(0,C.jsx)("p",{children:"Analyzing Neon + Workers + Telnyx checks..."}),(0,C.jsx)("p",{className:"mt-2 text-xs",children:'Try: "Fix my DB connection" or "Why did the last call fail?"'})]}),c.map(a=>(0,C.jsx)("div",{className:`flex ${"user"===a.role?"justify-end":"justify-start"}`,children:(0,C.jsx)("div",{className:`max-w-[85%] rounded-lg p-3 text-sm whitespace-pre-wrap ${"user"===a.role?"bg-blue-600 text-white":"bg-white border border-gray-200 text-gray-800 shadow-sm"}`,children:"assistant"===a.role?(0,C.jsx)("code",{className:"font-mono text-xs block bg-gray-50 p-2 rounded border border-gray-100 mt-1",children:a.content}):a.content})},a.id)),g&&(0,C.jsx)("div",{className:"flex justify-start",children:(0,C.jsx)("div",{className:"bg-gray-100 rounded-lg p-2 text-xs text-gray-500 animate-pulse",children:"Analyzing stack..."})})]}),(0,C.jsx)("div",{className:"p-3 bg-white border-t border-gray-200",children:(0,C.jsxs)("form",{onSubmit:f,className:"flex gap-2",children:[(0,C.jsx)("input",{className:"flex-1 p-2 border border-gray-300 rounded text-sm focus:outline-none focus:border-blue-500",value:d,onChange:e,placeholder:"Describe the error..."}),(0,C.jsx)("button",{type:"submit",disabled:g||!d.trim(),className:"bg-[#0f172a] text-white px-4 py-2 rounded text-sm font-medium hover:bg-opacity-90 disabled:opacity-50",children:"Send"})]})})]})}function ge(){let[a,b]=(0,D.useState)(!1);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"fixed bottom-4 right-4 z-50",children:(0,C.jsx)("button",{onClick:()=>b(!a),className:"bg-navy-900 text-white p-3 rounded-full shadow-lg hover:bg-navy-800 transition-colors border border-navy-700",style:{backgroundColor:"#0f172a"},"aria-label":"Toggle Stack Troubleshoot Bot",children:(0,C.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,C.jsx)("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})})}),a&&(0,C.jsxs)("div",{className:"fixed bottom-20 right-4 z-50 w-[400px] h-[600px] bg-white rounded-lg shadow-lg border border-gray-200 overflow-hidden flex flex-col",children:[(0,C.jsxs)("div",{className:"bg-[#0f172a] text-white p-3 flex justify-between items-center",children:[(0,C.jsx)("h3",{className:"font-semibold text-sm",children:"Stack Troubleshoot Bot"}),(0,C.jsx)("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-white",children:(0,C.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,C.jsx)("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),(0,C.jsx)("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),(0,C.jsx)("div",{className:"flex-1 overflow-hidden relative",children:(0,C.jsx)(gd,{endpoint:"/api/chat/troubleshoot-stream",orgId:"default"})})]})]})}B=new WeakMap},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../webpack-runtime.js");b.C(a);var c=b.X(0,[4996,4680,6802,1093,8298,943,1742,6084,367,7613,6980,1587],()=>b(b.s=40348));module.exports=c})();