"use strict";exports.id=2218,exports.ids=[2218],exports.modules={44248:(a,b,c)=>{var d=Object.create,e=Object.defineProperty,f=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,h=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,j=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let h of g(b))i.call(a,h)||h===c||e(a,h,{get:()=>b[h],enumerable:!(d=f(b,h))||d.enumerable});return a},k=(a,b,c)=>(c=null!=a?d(h(a)):{},j(!b&&a&&a.__esModule?c:e(c,"default",{value:a,enumerable:!0}),a)),l={};((a,b)=>{for(var c in b)e(a,c,{get:b[c],enumerable:!0})})(l,{isValidAccessToken:()=>s,readAuthConfig:()=>q,writeAuthConfig:()=>r}),a.exports=j(e({},"__esModule",{value:!0}),l);var m=k(c(29021)),n=k(c(33873)),o=c(87871);function p(){let a=(0,o.getVercelDataDir)();if(!a)throw Error(`Unable to find Vercel CLI data directory. Your platform: ${process.platform}. Supported: darwin, linux, win32.`);return n.join(a,"auth.json")}function q(){try{let a=p();if(!m.existsSync(a))return null;let b=m.readFileSync(a,"utf8");if(!b)return null;return JSON.parse(b)}catch(a){return null}}function r(a){let b=p(),c=n.dirname(b);m.existsSync(c)||m.mkdirSync(c,{mode:504,recursive:!0}),m.writeFileSync(b,JSON.stringify(a,null,2),{mode:384})}function s(a){if(!a.token)return!1;if("number"!=typeof a.expiresAt)return!0;let b=Math.floor(Date.now()/1e3);return a.expiresAt>=b}},57183:(a,b,c)=>{var d=Object.create,e=Object.defineProperty,f=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,h=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,j=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let h of g(b))i.call(a,h)||h===c||e(a,h,{get:()=>b[h],enumerable:!(d=f(b,h))||d.enumerable});return a},k=(a,b,c)=>(c=null!=a?d(h(a)):{},j(!b&&a&&a.__esModule?c:e(c,"default",{value:a,enumerable:!0}),a)),l={};((a,b)=>{for(var c in b)e(a,c,{get:b[c],enumerable:!0})})(l,{findRootDir:()=>q,getUserDataDir:()=>r}),a.exports=j(e({},"__esModule",{value:!0}),l);var m=k(c(33873)),n=k(c(29021)),o=k(c(21820)),p=c(1881);function q(){try{let a=process.cwd();for(;a!==m.default.dirname(a);){let b=m.default.join(a,".vercel");if(n.default.existsSync(b))return a;a=m.default.dirname(a)}}catch(a){throw new p.VercelOidcTokenError("Token refresh only supported in node server environments")}return null}function r(){if(process.env.XDG_DATA_HOME)return process.env.XDG_DATA_HOME;switch(o.default.platform()){case"darwin":return m.default.join(o.default.homedir(),"Library/Application Support");case"linux":return m.default.join(o.default.homedir(),".local/share");case"win32":if(process.env.LOCALAPPDATA)return process.env.LOCALAPPDATA;return null;default:return null}}},87871:(a,b,c)=>{var d=Object.create,e=Object.defineProperty,f=Object.getOwnPropertyDescriptor,g=Object.getOwnPropertyNames,h=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty,j=(a,b,c,d)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let h of g(b))i.call(a,h)||h===c||e(a,h,{get:()=>b[h],enumerable:!(d=f(b,h))||d.enumerable});return a},k=(a,b,c)=>(c=null!=a?d(h(a)):{},j(!b&&a&&a.__esModule?c:e(c,"default",{value:a,enumerable:!0}),a)),l={};((a,b)=>{for(var c in b)e(a,c,{get:b[c],enumerable:!0})})(l,{assertVercelOidcTokenResponse:()=>v,findProjectInfo:()=>w,getTokenPayload:()=>z,getVercelCliToken:()=>t,getVercelDataDir:()=>s,getVercelOidcToken:()=>u,isExpired:()=>A,loadToken:()=>y,saveToken:()=>x}),a.exports=j(e({},"__esModule",{value:!0}),l);var m=k(c(33873)),n=k(c(29021)),o=c(1881),p=c(57183),q=c(44248),r=c(89812);function s(){let a=(0,p.getUserDataDir)();return a?m.join(a,"com.vercel.cli"):null}async function t(){let a=(0,q.readAuthConfig)();if(!a)return null;if((0,q.isValidAccessToken)(a))return a.token||null;if(!a.refreshToken)return(0,q.writeAuthConfig)({}),null;try{let b=await (0,r.refreshTokenRequest)({refresh_token:a.refreshToken}),[c,d]=await (0,r.processTokenResponse)(b);if(c||!d)return(0,q.writeAuthConfig)({}),null;let e={token:d.access_token,expiresAt:Math.floor(Date.now()/1e3)+d.expires_in};return d.refresh_token&&(e.refreshToken=d.refresh_token),(0,q.writeAuthConfig)(e),e.token??null}catch(a){return(0,q.writeAuthConfig)({}),null}}async function u(a,b,c){let d=`https://api.vercel.com/v1/projects/${b}/token?source=vercel-oidc-refresh${c?`&teamId=${c}`:""}`,e=await fetch(d,{method:"POST",headers:{Authorization:`Bearer ${a}`}});if(!e.ok)throw new o.VercelOidcTokenError(`Failed to refresh OIDC token: ${e.statusText}`);let f=await e.json();return v(f),f}function v(a){if(!a||"object"!=typeof a)throw TypeError("Vercel OIDC token is malformed. Expected an object. Please run `vc env pull` and try again");if(!("token"in a)||"string"!=typeof a.token)throw TypeError("Vercel OIDC token is malformed. Expected a string-valued token property. Please run `vc env pull` and try again")}function w(){let a=(0,p.findRootDir)();if(!a)throw new o.VercelOidcTokenError("Unable to find project root directory. Have you linked your project with `vc link?`");let b=m.join(a,".vercel","project.json");if(!n.existsSync(b))throw new o.VercelOidcTokenError("project.json not found, have you linked your project with `vc link?`");let c=JSON.parse(n.readFileSync(b,"utf8"));if("string"!=typeof c.projectId&&"string"!=typeof c.orgId)throw TypeError("Expected a string-valued projectId property. Try running `vc link` to re-link your project.");return{projectId:c.projectId,teamId:c.orgId}}function x(a,b){let c=(0,p.getUserDataDir)();if(!c)throw new o.VercelOidcTokenError("Unable to find user data directory. Please reach out to Vercel support.");let d=m.join(c,"com.vercel.token",`${b}.json`),e=JSON.stringify(a);n.mkdirSync(m.dirname(d),{mode:504,recursive:!0}),n.writeFileSync(d,e),n.chmodSync(d,432)}function y(a){let b=(0,p.getUserDataDir)();if(!b)throw new o.VercelOidcTokenError("Unable to find user data directory. Please reach out to Vercel support.");let c=m.join(b,"com.vercel.token",`${a}.json`);if(!n.existsSync(c))return null;let d=JSON.parse(n.readFileSync(c,"utf8"));return v(d),d}function z(a){let b=a.split(".");if(3!==b.length)throw new o.VercelOidcTokenError("Invalid token. Please run `vc env pull` and try again");let c=b[1].replace(/-/g,"+").replace(/_/g,"/"),d=c.padEnd(c.length+(4-c.length%4)%4,"=");return JSON.parse(Buffer.from(d,"base64").toString("utf8"))}function A(a){return 1e3*a.exp<Date.now()}},89812:(a,b,c)=>{var d=Object.defineProperty,e=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,g=Object.prototype.hasOwnProperty,h={};((a,b)=>{for(var c in b)d(a,c,{get:b[c],enumerable:!0})})(h,{processTokenResponse:()=>n,refreshTokenRequest:()=>m}),a.exports=((a,b,c,h)=>{if(b&&"object"==typeof b||"function"==typeof b)for(let c of f(b))g.call(a,c)||void 0===c||d(a,c,{get:()=>b[c],enumerable:!(h=e(b,c))||h.enumerable});return a})(d({},"__esModule",{value:!0}),h);var i=c(21820);let j=`@vercel/oidc node-${process.version} ${(0,i.platform)()} (${(0,i.arch)()}) ${(0,i.hostname)()}`,k=null;async function l(){if(k)return k;let a=await fetch("https://vercel.com/.well-known/openid-configuration",{headers:{"user-agent":j}});if(!a.ok)throw Error("Failed to discover OAuth endpoints");let b=await a.json();if(!b||"string"!=typeof b.token_endpoint)throw Error("Invalid OAuth discovery response");let c=b.token_endpoint;return k=c,c}async function m(a){let b=await l();return await fetch(b,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","user-agent":j},body:new URLSearchParams({client_id:"cl_HYyOPBNtFMfHhaUn9L4QPfTZz6TP47bp",grant_type:"refresh_token",...a})})}async function n(a){let b=await a.json();return a.ok?"object"!=typeof b||null===b?[Error("Invalid token response")]:"string"!=typeof b.access_token?[Error("Missing access_token in response")]:"Bearer"!==b.token_type?[Error("Invalid token_type in response")]:"number"!=typeof b.expires_in?[Error("Missing expires_in in response")]:[null,b]:[Error("object"==typeof b&&b&&"error"in b?String(b.error):"Token refresh failed")]}}};