(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5022],{5038:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>j});var a=t(95155),s=t(12115),l=t(36489),n=t(76806),i=t(97003),d=t(67812),o=t(83209),c=t(96633),m=t(25016),x=t(35299),h=t(6191),p=t(89715),u=t(39867),f=t(2479);function j(){var e,r;let{data:t}=(0,l.useSession)(),[j,g]=(0,s.useState)([]),[y,N]=(0,s.useState)(!0),[b,v]=(0,s.useState)(!1),[w,A]=(0,s.useState)(null),[_,R]=(0,s.useState)(null),k=null==t||null==(e=t.user)?void 0:e.id;(0,s.useEffect)(()=>{k&&C()},[k]),(0,s.useEffect)(()=>{_&&F()},[_]);let C=async()=>{try{let e=await fetch("/api/users/".concat(k,"/organization"),{credentials:"include"});if(!e.ok)throw Error("Failed to fetch organization");let r=await e.json();R(r.organization_id)}catch(e){f.v.error("Error fetching organization",e,{userId:k}),A("Failed to load organization")}},F=async()=>{try{N(!0),A(null);let e=await fetch("/api/reports",{credentials:"include"});if(!e.ok)throw Error("Failed to fetch reports");let r=await e.json();g(r.reports||[])}catch(e){f.v.error("Error fetching reports",e),A("Failed to load reports")}finally{N(!1)}},S=async()=>{try{if(v(!0),A(null),!(await fetch("/api/reports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:"Call Volume Report - ".concat(new Date().toLocaleDateString()),report_type:"call_volume",filters:{date_range:{start:new Date(Date.now()-2592e6).toISOString(),end:new Date().toISOString()}},metrics:["total_calls","successful_calls","avg_duration"],file_format:"json"}),credentials:"include"})).ok)throw Error("Failed to generate report");await F()}catch(e){f.v.error("Error generating report",e),A("Failed to generate report")}finally{v(!1)}};return t&&k?(0,a.jsx)(n.AppShell,{organizationName:void 0,userEmail:(null==t||null==(r=t.user)?void 0:r.email)||void 0,children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Report Builder"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Generate custom reports and analytics"})]}),(0,a.jsx)(i.$,{onClick:S,disabled:b,children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Generate Report"]})})]}),w&&(0,a.jsx)("div",{className:"mb-6 rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:w}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Generated Reports"}),(0,a.jsx)(o.BT,{children:"View and download your generated reports"})]}),(0,a.jsx)(o.Wu,{children:y?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)(x.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):0===j.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(p.A,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("p",{className:"mt-4 text-sm font-medium",children:"No reports yet"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Generate your first report to get started"}),(0,a.jsxs)(i.$,{onClick:S,disabled:b,className:"mt-4",children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Generate Report"]})]}):(0,a.jsx)("div",{className:"rounded-lg border",children:(0,a.jsxs)(c.XI,{children:[(0,a.jsx)(c.A0,{children:(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nd,{children:"Report Name"}),(0,a.jsx)(c.nd,{children:"Format"}),(0,a.jsx)(c.nd,{children:"Status"}),(0,a.jsx)(c.nd,{children:"Generated"}),(0,a.jsx)(c.nd,{children:"Duration"}),(0,a.jsx)(c.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(c.BF,{children:j.map(e=>(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nA,{className:"font-medium",children:e.name}),(0,a.jsx)(c.nA,{children:(0,a.jsx)(d.E,{variant:"secondary",className:"uppercase",children:e.file_format})}),(0,a.jsx)(c.nA,{children:(e=>{let r={generating:{label:"Generating",variant:"default"},completed:{label:"Completed",variant:"success"},failed:{label:"Failed",variant:"error"}}[e];return(0,a.jsx)(d.E,{variant:r.variant,children:r.label})})(e.status)}),(0,a.jsx)(c.nA,{children:(0,m.Yq)(e.generated_at)}),(0,a.jsx)(c.nA,{children:e.generation_duration_ms?"".concat((e.generation_duration_ms/1e3).toFixed(2),"s"):"-"}),(0,a.jsx)(c.nA,{className:"text-right",children:"completed"===e.status&&(0,a.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>{var r,t;return r=e.id,t=e.file_format,void window.open("/api/reports/".concat(r,"/export?format=").concat(t),"_blank")},children:[(0,a.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Download"]})})]},e.id))})]})})})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Please sign in to access reports."})]})})}},6191:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8827:(e,r,t)=>{Promise.resolve().then(t.bind(t,5038))},35299:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},39867:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(71847).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},83209:(e,r,t)=>{"use strict";t.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>m});var a=t(95155),s=t(12115),l=t(25016);function n(e){let{children:r,className:t="",header:s,footer:n,padding:i="md",...d}=e;return(0,a.jsxs)("div",{className:(0,l.cn)("bg-white border border-gray-200 rounded-md",t),...d,children:[s&&(0,a.jsx)("div",{className:"px-4 py-3 border-b border-gray-200",children:s}),(0,a.jsx)("div",{className:{none:"",sm:"p-3",md:"p-4",lg:"p-6"}[i],children:r}),n&&(0,a.jsx)("div",{className:"px-4 py-3 border-t border-gray-200 bg-gray-50",children:n})]})}let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});d.displayName="CardTitle";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,l.cn)("text-sm text-gray-500",t),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,l.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent";let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,l.cn)("flex items-center p-6 pt-0",t),...s})});m.displayName="CardFooter"},96633:(e,r,t)=>{"use strict";t.d(r,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>n,nA:()=>m,nd:()=>c});var a=t(95155),s=t(12115),l=t(25016);let n=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,l.cn)("w-full caption-bottom text-sm",t),...s})})});n.displayName="Table";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,l.cn)("[&_tr]:border-b",t),...s})});i.displayName="TableHeader";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,l.cn)("[&_tr:last-child]:border-0",t),...s})});d.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,l.cn)("border-t bg-gray-50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,l.cn)("border-b transition-colors hover:bg-gray-50 data-[state=selected]:bg-gray-100",t),...s})});o.displayName="TableRow";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:r,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0",t),...s})});c.displayName="TableHead";let m=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:r,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});m.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,l.cn)("mt-4 text-sm text-gray-500",t),...s})}).displayName="TableCaption"}},e=>{e.O(0,[2619,5239,6964,7627,1887,9871,8441,1255,7358],()=>e(e.s=8827)),_N_E=e.O()}]);