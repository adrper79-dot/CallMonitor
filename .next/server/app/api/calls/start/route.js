/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/calls/start/route";
exports.ids = ["app/api/calls/start/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?f4ce":
/*!****************************!*\
  !*** nodemailer (ignored) ***!
  \****************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcalls%2Fstart%2Froute&page=%2Fapi%2Fcalls%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcalls%2Fstart%2Froute.ts&appDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcalls%2Fstart%2Froute&page=%2Fapi%2Fcalls%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcalls%2Fstart%2Froute.ts&appDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Ultimate_Warrior_My_project_gemini_project_app_api_calls_start_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/calls/start/route.ts */ \"(rsc)/./app/api/calls/start/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/calls/start/route\",\n        pathname: \"/api/calls/start\",\n        filename: \"route\",\n        bundlePath: \"app/api/calls/start/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Ultimate Warrior\\\\My project\\\\gemini-project\\\\app\\\\api\\\\calls\\\\start\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Ultimate_Warrior_My_project_gemini_project_app_api_calls_start_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/calls/start/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjYWxscyUyRnN0YXJ0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjYWxscyUyRnN0YXJ0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY2FsbHMlMkZzdGFydCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNVbHRpbWF0ZSUyMFdhcnJpb3IlNUNNeSUyMHByb2plY3QlNUNnZW1pbmktcHJvamVjdCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDVWx0aW1hdGUlMjBXYXJyaW9yJTVDTXklMjBwcm9qZWN0JTVDZ2VtaW5pLXByb2plY3QmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3lDO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VtaW5pLXByb2plY3QvP2ViY2YiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcVWx0aW1hdGUgV2FycmlvclxcXFxNeSBwcm9qZWN0XFxcXGdlbWluaS1wcm9qZWN0XFxcXGFwcFxcXFxhcGlcXFxcY2FsbHNcXFxcc3RhcnRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NhbGxzL3N0YXJ0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY2FsbHMvc3RhcnRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NhbGxzL3N0YXJ0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcVWx0aW1hdGUgV2FycmlvclxcXFxNeSBwcm9qZWN0XFxcXGdlbWluaS1wcm9qZWN0XFxcXGFwcFxcXFxhcGlcXFxcY2FsbHNcXFxcc3RhcnRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NhbGxzL3N0YXJ0L3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcalls%2Fstart%2Froute&page=%2Fapi%2Fcalls%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcalls%2Fstart%2Froute.ts&appDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/actions/calls/startCall.ts":
/*!****************************************!*\
  !*** ./app/actions/calls/startCall.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ startCall)\n/* harmony export */ });\n/* harmony import */ var private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! private-next-rsc-server-reference */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/server-reference.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! private-next-rsc-action-encryption */ \"(rsc)/./node_modules/next/dist/server/app-render/encryption.js\");\n/* harmony import */ var private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(private_next_rsc_action_encryption__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var _lib_supabaseAdmin__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/supabaseAdmin */ \"(rsc)/./lib/supabaseAdmin.ts\");\n/* harmony import */ var _startCallHandler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./startCallHandler */ \"(rsc)/./app/actions/calls/startCallHandler.ts\");\n/* harmony import */ var private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! private-next-rsc-action-validate */ \"(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-loader/action-validate.js\");\n/* __next_internal_action_entry_do_not_use__ {\"d4533a0e5e6dc8871a6ba8b2c7b2c43d67863f55\":\"default\"} */ \n\n\n\n\nconst StartCallSchema = zod__WEBPACK_IMPORTED_MODULE_4__.object({\n    organization_id: zod__WEBPACK_IMPORTED_MODULE_4__.string().uuid(),\n    from_number: zod__WEBPACK_IMPORTED_MODULE_4__.string().optional(),\n    phone_number: zod__WEBPACK_IMPORTED_MODULE_4__.string().regex(/^\\+?[1-9]\\d{1,14}$/),\n    flow_type: zod__WEBPACK_IMPORTED_MODULE_4__[\"enum\"]([\n        \"bridge\",\n        \"outbound\"\n    ]).optional(),\n    modulations: zod__WEBPACK_IMPORTED_MODULE_4__.object({\n        record: zod__WEBPACK_IMPORTED_MODULE_4__.boolean(),\n        transcribe: zod__WEBPACK_IMPORTED_MODULE_4__.boolean(),\n        translate: zod__WEBPACK_IMPORTED_MODULE_4__.boolean().optional(),\n        survey: zod__WEBPACK_IMPORTED_MODULE_4__.boolean().optional()\n    }),\n    actor_id: zod__WEBPACK_IMPORTED_MODULE_4__.string().nullish()\n});\nasync function startCall(input) {\n    try {\n        const parsed = StartCallSchema.parse(input);\n        const res = await (0,_startCallHandler__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(parsed, {\n            supabaseAdmin: _lib_supabaseAdmin__WEBPACK_IMPORTED_MODULE_2__[\"default\"],\n            env: process.env\n        });\n        return res;\n    } catch (e) {\n        if (e?.errors) {\n            return {\n                success: false,\n                error: {\n                    id: \"validation\",\n                    code: \"CALL_START_INVALID_INPUT\",\n                    message: \"Invalid input\",\n                    severity: \"MEDIUM\"\n                }\n            };\n        }\n        return {\n            success: false,\n            error: {\n                id: \"unexpected\",\n                code: \"CALL_START_UNEXPECTED\",\n                message: e?.message ?? \"Unexpected error\",\n                severity: \"CRITICAL\"\n            }\n        };\n    }\n}\n\n(0,private_next_rsc_action_validate__WEBPACK_IMPORTED_MODULE_5__.ensureServerEntryExports)([\n    startCall\n]);\n(0,private_next_rsc_server_reference__WEBPACK_IMPORTED_MODULE_0__.registerServerReference)(\"d4533a0e5e6dc8871a6ba8b2c7b2c43d67863f55\", startCall);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYWN0aW9ucy9jYWxscy9zdGFydENhbGwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUV1QjtBQUN3QjtBQUVzQztBQUVyRixNQUFNRyxrQkFBa0JILHVDQUFRLENBQUM7SUFDL0JLLGlCQUFpQkwsdUNBQVEsR0FBR08sSUFBSTtJQUNoQ0MsYUFBYVIsdUNBQVEsR0FBR1MsUUFBUTtJQUNoQ0MsY0FBY1YsdUNBQVEsR0FBR1csS0FBSyxDQUFDO0lBQy9CQyxXQUFXWix3Q0FBTSxDQUFDO1FBQUM7UUFBUztLQUFXLEVBQUVTLFFBQVE7SUFDakRLLGFBQWFkLHVDQUFRLENBQUM7UUFBRWUsUUFBUWYsd0NBQVM7UUFBSWlCLFlBQVlqQix3Q0FBUztRQUFJa0IsV0FBV2xCLHdDQUFTLEdBQUdTLFFBQVE7UUFBSVUsUUFBUW5CLHdDQUFTLEdBQUdTLFFBQVE7SUFBRztJQUN4SVcsVUFBVXBCLHVDQUFRLEdBQUdxQixPQUFPO0FBQzlCO0FBSWUsZUFBZUMsVUFBVUMsS0FBcUI7SUFDM0QsSUFBSTtRQUNGLE1BQU1DLFNBQVNyQixnQkFBZ0JzQixLQUFLLENBQUNGO1FBQ3JDLE1BQU1HLE1BQU0sTUFBTXhCLDZEQUFnQkEsQ0FBQ3NCLFFBQXdCO1lBQUV2QixhQUFhQSw0REFBQUE7WUFBRTBCLEtBQUtDLFFBQVFELEdBQUc7UUFBQztRQUM3RixPQUFPRDtJQUNULEVBQUUsT0FBT0csR0FBUTtRQUNmLElBQUlBLEdBQUdDLFFBQVE7WUFDYixPQUFPO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO29CQUFFQyxJQUFJO29CQUFjQyxNQUFNO29CQUE0QkMsU0FBUztvQkFBaUJDLFVBQVU7Z0JBQVM7WUFBRTtRQUN2STtRQUNBLE9BQU87WUFBRUwsU0FBUztZQUFPQyxPQUFPO2dCQUFFQyxJQUFJO2dCQUFjQyxNQUFNO2dCQUF5QkMsU0FBU04sR0FBR00sV0FBVztnQkFBb0JDLFVBQVU7WUFBVztRQUFFO0lBQ3ZKO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW1pbmktcHJvamVjdC8uL2FwcC9hY3Rpb25zL2NhbGxzL3N0YXJ0Q2FsbC50cz84MDExIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHNlcnZlclwiXHJcblxyXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJ1xyXG5pbXBvcnQgc3VwYWJhc2VBZG1pbiBmcm9tICdAL2xpYi9zdXBhYmFzZUFkbWluJ1xyXG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoL25leHQnXHJcbmltcG9ydCBzdGFydENhbGxIYW5kbGVyLCB7IFN0YXJ0Q2FsbElucHV0IGFzIEhhbmRsZXJJbnB1dCB9IGZyb20gJy4vc3RhcnRDYWxsSGFuZGxlcidcclxuXHJcbmNvbnN0IFN0YXJ0Q2FsbFNjaGVtYSA9IHoub2JqZWN0KHtcclxuICBvcmdhbml6YXRpb25faWQ6IHouc3RyaW5nKCkudXVpZCgpLFxyXG4gIGZyb21fbnVtYmVyOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXHJcbiAgcGhvbmVfbnVtYmVyOiB6LnN0cmluZygpLnJlZ2V4KC9eXFwrP1sxLTldXFxkezEsMTR9JC8pLFxyXG4gIGZsb3dfdHlwZTogei5lbnVtKFsnYnJpZGdlJywnb3V0Ym91bmQnXSkub3B0aW9uYWwoKSxcclxuICBtb2R1bGF0aW9uczogei5vYmplY3QoeyByZWNvcmQ6IHouYm9vbGVhbigpLCB0cmFuc2NyaWJlOiB6LmJvb2xlYW4oKSwgdHJhbnNsYXRlOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpLCBzdXJ2ZXk6IHouYm9vbGVhbigpLm9wdGlvbmFsKCkgfSksXHJcbiAgYWN0b3JfaWQ6IHouc3RyaW5nKCkubnVsbGlzaCgpXHJcbn0pXHJcblxyXG5leHBvcnQgdHlwZSBTdGFydENhbGxJbnB1dCA9IEhhbmRsZXJJbnB1dFxyXG5cclxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gc3RhcnRDYWxsKGlucHV0OiBTdGFydENhbGxJbnB1dCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwYXJzZWQgPSBTdGFydENhbGxTY2hlbWEucGFyc2UoaW5wdXQpXHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBzdGFydENhbGxIYW5kbGVyKHBhcnNlZCBhcyBIYW5kbGVySW5wdXQsIHsgc3VwYWJhc2VBZG1pbiwgZW52OiBwcm9jZXNzLmVudiB9KVxyXG4gICAgcmV0dXJuIHJlc1xyXG4gIH0gY2F0Y2ggKGU6IGFueSkge1xyXG4gICAgaWYgKGU/LmVycm9ycykge1xyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHsgaWQ6ICd2YWxpZGF0aW9uJywgY29kZTogJ0NBTExfU1RBUlRfSU5WQUxJRF9JTlBVVCcsIG1lc3NhZ2U6ICdJbnZhbGlkIGlucHV0Jywgc2V2ZXJpdHk6ICdNRURJVU0nIH0gfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGlkOiAndW5leHBlY3RlZCcsIGNvZGU6ICdDQUxMX1NUQVJUX1VORVhQRUNURUQnLCBtZXNzYWdlOiBlPy5tZXNzYWdlID8/ICdVbmV4cGVjdGVkIGVycm9yJywgc2V2ZXJpdHk6ICdDUklUSUNBTCcgfSB9XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJ6Iiwic3VwYWJhc2VBZG1pbiIsInN0YXJ0Q2FsbEhhbmRsZXIiLCJTdGFydENhbGxTY2hlbWEiLCJvYmplY3QiLCJvcmdhbml6YXRpb25faWQiLCJzdHJpbmciLCJ1dWlkIiwiZnJvbV9udW1iZXIiLCJvcHRpb25hbCIsInBob25lX251bWJlciIsInJlZ2V4IiwiZmxvd190eXBlIiwiZW51bSIsIm1vZHVsYXRpb25zIiwicmVjb3JkIiwiYm9vbGVhbiIsInRyYW5zY3JpYmUiLCJ0cmFuc2xhdGUiLCJzdXJ2ZXkiLCJhY3Rvcl9pZCIsIm51bGxpc2giLCJzdGFydENhbGwiLCJpbnB1dCIsInBhcnNlZCIsInBhcnNlIiwicmVzIiwiZW52IiwicHJvY2VzcyIsImUiLCJlcnJvcnMiLCJzdWNjZXNzIiwiZXJyb3IiLCJpZCIsImNvZGUiLCJtZXNzYWdlIiwic2V2ZXJpdHkiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/actions/calls/startCall.ts\n");

/***/ }),

/***/ "(rsc)/./app/actions/calls/startCallHandler.ts":
/*!***********************************************!*\
  !*** ./app/actions/calls/startCallHandler.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ startCallHandler)\n/* harmony export */ });\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _types_app_error__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/types/app-error */ \"(rsc)/./types/app-error.ts\");\n/* harmony import */ var _lib_env_validation__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/env-validation */ \"(rsc)/./lib/env-validation.ts\");\n\n\n\nconst E164_REGEX = /^\\+?[1-9]\\d{1,14}$/;\nasync function startCallHandler(input, deps) {\n    const { supabaseAdmin, signalwireCall, env = process.env } = deps;\n    let capturedActorId = null;\n    let capturedSystemCpidId = null;\n    let callId = null;\n    // track organization_id here so audit helpers and catch blocks\n    // always reference the effective organization (after overrides)\n    let organization_id = input.organization_id;\n    async function writeAuditError(resource, resourceId, payload) {\n        try {\n            await supabaseAdmin.from(\"audit_logs\").insert({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                organization_id,\n                user_id: capturedActorId,\n                system_id: capturedSystemCpidId,\n                resource_type: resource,\n                resource_id: resourceId,\n                action: \"error\",\n                before: null,\n                after: payload,\n                created_at: new Date().toISOString()\n            });\n        } catch (e) {\n            // best-effort\n            // eslint-disable-next-line no-console\n            console.error(\"failed to write audit error\", e);\n        }\n    }\n    // helper to place a single SignalWire call (returns sid)\n    const placeSignalWireCall = async (toNumber, useLiveTranslation = false)=>{\n        // eslint-disable-next-line no-console\n        console.log(\"placeSignalWireCall: ENTERED function\", {\n            toNumber: toNumber ? \"[REDACTED]\" : null,\n            useLiveTranslation,\n            callId\n        });\n        const swProject = env.SIGNALWIRE_PROJECT_ID;\n        const swToken = env.SIGNALWIRE_TOKEN;\n        const swNumber = env.SIGNALWIRE_NUMBER;\n        const rawSpace = String(env.SIGNALWIRE_SPACE || \"\");\n        const swSpace = rawSpace.replace(/^https?:\\/\\//, \"\").replace(/\\/$/, \"\").replace(/\\.signalwire\\.com$/i, \"\").trim();\n        // eslint-disable-next-line no-console\n        console.log(\"placeSignalWireCall: extracted config\", {\n            hasProject: !!swProject,\n            hasToken: !!swToken,\n            hasSpace: !!swSpace,\n            hasNumber: !!swNumber,\n            rawSpace: rawSpace ? rawSpace.substring(0, 20) + \"...\" : null,\n            extractedSpace: swSpace || null\n        });\n        if (!(swProject && swToken && swSpace && swNumber)) {\n            // Build detailed error message showing what's missing\n            const missing = [];\n            if (!swProject) missing.push(\"SIGNALWIRE_PROJECT_ID\");\n            if (!swToken) missing.push(\"SIGNALWIRE_TOKEN\");\n            if (!swSpace) missing.push(\"SIGNALWIRE_SPACE\");\n            if (!swNumber) missing.push(\"SIGNALWIRE_NUMBER\");\n            if (env.NODE_ENV === \"production\") {\n                const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"SIGNALWIRE_CONFIG_MISSING\",\n                    message: `SignalWire credentials missing: ${missing.join(\", \")}`,\n                    user_message: \"System configuration error - please contact support\",\n                    severity: \"CRITICAL\",\n                    retriable: false\n                });\n                await writeAuditError(\"systems\", null, e.toJSON());\n                // eslint-disable-next-line no-console\n                console.error(\"❌ CRITICAL: SignalWire config missing:\", missing.join(\", \"));\n                throw e;\n            }\n            // mock SID in non-production\n            // eslint-disable-next-line no-console\n            console.warn(\"⚠️ SignalWire config incomplete (using mock):\", missing.join(\", \"));\n            return `mock-${(0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])()}`;\n        }\n        const auth = Buffer.from(`${swProject}:${swToken}`).toString(\"base64\");\n        const params = new URLSearchParams();\n        params.append(\"From\", swNumber);\n        params.append(\"To\", toNumber);\n        // Route to SWML endpoint for live translation, LaML for regular calls\n        if (useLiveTranslation && callId) {\n            params.append(\"Url\", `${env.NEXT_PUBLIC_APP_URL}/api/voice/swml/outbound?callId=${encodeURIComponent(callId)}`);\n            // eslint-disable-next-line no-console\n            console.log(\"startCallHandler: routing to SWML endpoint for live translation\", {\n                callId\n            });\n        } else {\n            params.append(\"Url\", `${env.NEXT_PUBLIC_APP_URL}/api/voice/laml/outbound`);\n        }\n        params.append(\"StatusCallback\", `${env.NEXT_PUBLIC_APP_URL}/api/webhooks/signalwire`);\n        const swEndpoint = `https://${swSpace}.signalwire.com/api/laml/2010-04-01/Accounts/${swProject}/Calls.json`;\n        // eslint-disable-next-line no-console\n        console.log(\"startCallHandler: sending SignalWire POST\", {\n            endpoint: swEndpoint,\n            to: toNumber,\n            from: swNumber\n        });\n        const controller = new AbortController();\n        const timeout = setTimeout(()=>controller.abort(), 10000);\n        let swRes;\n        try {\n            swRes = await fetch(swEndpoint, {\n                method: \"POST\",\n                headers: {\n                    \"Authorization\": `Basic ${auth}`,\n                    \"Content-Type\": \"application/x-www-form-urlencoded\"\n                },\n                body: params,\n                signal: controller.signal\n            });\n        } catch (fetchErr) {\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: SignalWire fetch error\", {\n                error: fetchErr?.message ?? String(fetchErr)\n            });\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"SIGNALWIRE_FETCH_FAILED\",\n                message: \"Failed to reach SignalWire\",\n                user_message: \"Failed to place call via carrier\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: fetchErr?.message ?? String(fetchErr)\n                }\n            });\n            await writeAuditError(\"calls\", callId, e.toJSON());\n            throw e;\n        } finally{\n            clearTimeout(timeout);\n        }\n        if (!swRes.ok) {\n            const text = await swRes.text();\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: SignalWire POST failed\", {\n                status: swRes.status,\n                body: text\n            });\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"SIGNALWIRE_API_ERROR\",\n                message: `SignalWire Error: ${swRes.status}`,\n                user_message: \"Failed to place call via carrier\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    provider_error: text\n                }\n            });\n            await writeAuditError(\"calls\", callId, e.toJSON());\n            throw e;\n        }\n        const swData = await swRes.json();\n        // eslint-disable-next-line no-console\n        console.log(\"startCallHandler: SignalWire responded\", {\n            sid: swData?.sid ? \"[REDACTED]\" : null\n        });\n        return swData?.sid ?? null;\n    };\n    try {\n        let { from_number, phone_number, flow_type, modulations } = input;\n        organization_id = input.organization_id;\n        // lightweight tracing for debugging call placement (avoid logging secrets)\n        // Logs: organization and phone to help trace attempts in runtime logs\n        // DO NOT log credentials or provider tokens\n        // eslint-disable-next-line no-console\n        console.log(\"startCallHandler: initiating call\", {\n            organization_id,\n            from_number,\n            phone_number,\n            flow_type,\n            modulations\n        });\n        // actor/session lookup\n        // Note: Session lookup removed - actorId must be provided in input or handled by caller\n        let actorId = input.actor_id ?? null;\n        capturedActorId = actorId;\n        if (!actorId) {\n            // allow a developer/testing fallback actor in non-production using the\n            // provided UUID to exercise flows without a real session.\n            if (env.NODE_ENV !== \"production\") {\n                actorId = \"28d68e05-ab20-40ee-b935-b19e8927ae68\";\n                capturedActorId = actorId;\n                // eslint-disable-next-line no-console\n                console.warn(\"startCallHandler: using dev fallback actorId\", {\n                    actorId\n                });\n            } else {\n                const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"AUTH_REQUIRED\",\n                    message: \"Unauthenticated\",\n                    user_message: \"Authentication required\",\n                    severity: \"HIGH\",\n                    retriable: false\n                });\n                await writeAuditError(\"organizations\", null, err.toJSON());\n                throw err;\n            }\n        }\n        // basic org id guard\n        if (!/^[0-9a-fA-F-]{36}$/.test(organization_id)) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_INVALID_ORG\",\n                message: \"Invalid organization id\",\n                user_message: \"Invalid organization identifier\",\n                severity: \"MEDIUM\",\n                retriable: false\n            });\n            await writeAuditError(\"organizations\", null, err.toJSON());\n            throw err;\n        }\n        // organization lookup\n        const { data: orgRows, error: orgErr } = await supabaseAdmin.from(\"organizations\").select(\"id,plan,tool_id\").eq(\"id\", organization_id).limit(1);\n        if (orgErr) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_DB_ORG_LOOKUP\",\n                message: \"Organization lookup failed\",\n                user_message: \"Unable to verify organization.\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: orgErr.message\n                }\n            });\n            await writeAuditError(\"organizations\", null, err.toJSON());\n            throw err;\n        }\n        const org = orgRows?.[0];\n        if (!org) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_ORG_NOT_FOUND\",\n                message: \"Organization not found\",\n                user_message: \"Organization not found.\",\n                severity: \"HIGH\",\n                retriable: false\n            });\n            await writeAuditError(\"organizations\", null, err.toJSON());\n            throw err;\n        }\n        if (org.plan === \"free\") {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_PLAN_LIMIT_EXCEEDED\",\n                message: \"Plan does not permit outbound calls\",\n                user_message: \"Your plan does not allow outbound calls. Please upgrade.\",\n                severity: \"HIGH\",\n                retriable: false\n            });\n            await writeAuditError(\"organizations\", org.id, err.toJSON());\n            throw err;\n        }\n        // membership check\n        const { data: membershipRows, error: membershipErr } = await supabaseAdmin.from(\"org_members\").select(\"id,role\").eq(\"organization_id\", organization_id).eq(\"user_id\", actorId).limit(1);\n        if (membershipErr) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"AUTH_MEMBERSHIP_LOOKUP_FAILED\",\n                message: \"Membership lookup failed\",\n                user_message: \"Unable to verify membership\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: membershipErr.message\n                }\n            });\n            await writeAuditError(\"org_members\", null, err.toJSON());\n            throw err;\n        }\n        // enforce canonical modulations from voice_configs (do NOT allow client override)\n        // default to conservative (all false) when no config present\n        let effectiveModulations = {\n            record: false,\n            transcribe: false,\n            translate: false\n        };\n        try {\n            const { data: vcRows, error: vcErr } = await supabaseAdmin.from(\"voice_configs\").select(\"record,transcribe,translate,translate_from,translate_to,survey,synthetic_caller\").eq(\"organization_id\", organization_id).limit(1);\n            if (!vcErr && vcRows && vcRows[0]) {\n                const cfg = vcRows[0];\n                effectiveModulations.record = !!cfg.record;\n                effectiveModulations.transcribe = !!cfg.transcribe;\n                effectiveModulations.translate = !!cfg.translate;\n                effectiveModulations.survey = !!cfg.survey;\n                effectiveModulations.synthetic_caller = !!cfg.synthetic_caller;\n                if (typeof cfg.translate_from === \"string\") effectiveModulations.translate_from = cfg.translate_from;\n                if (typeof cfg.translate_to === \"string\") effectiveModulations.translate_to = cfg.translate_to;\n            }\n        } catch (e) {\n        // best-effort: if voice_configs absent or lookup fails, keep conservative defaults\n        }\n        if (!membershipRows || membershipRows.length === 0) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"AUTH_ORG_MISMATCH\",\n                message: \"Actor not authorized for organization\",\n                user_message: \"Not authorized for this organization\",\n                severity: \"HIGH\",\n                retriable: false\n            });\n            await writeAuditError(\"org_members\", null, err.toJSON());\n            throw err;\n        }\n        // phone validation\n        if (!E164_REGEX.test(phone_number)) {\n            const err = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_INVALID_PHONE\",\n                message: \"Invalid phone number format\",\n                user_message: \"The phone number provided is invalid. Please verify and try again.\",\n                severity: \"MEDIUM\",\n                retriable: false\n            });\n            await writeAuditError(\"calls\", null, err.toJSON());\n            throw err;\n        }\n        // systems lookup\n        const { data: systemsRows, error: systemsErr } = await supabaseAdmin.from(\"systems\").select(\"id,key\").in(\"key\", [\n            \"system-cpid\",\n            \"system-ai\"\n        ]);\n        if (systemsErr) {\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_SYS_LOOKUP_FAILED\",\n                message: \"System lookup failed\",\n                user_message: \"Service error\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: systemsErr.message\n                }\n            });\n            await writeAuditError(\"systems\", null, e.toJSON());\n            throw e;\n        }\n        const systemMap = {};\n        (systemsRows || []).forEach((s)=>{\n            systemMap[s.key] = s.id;\n        });\n        const systemCpidId = systemMap[\"system-cpid\"] ?? null;\n        const systemAiId = systemMap[\"system-ai\"] ?? null;\n        capturedSystemCpidId = systemCpidId;\n        if (!systemCpidId) {\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_SYS_MISSING\",\n                message: \"Control system not registered\",\n                user_message: \"Service misconfiguration\",\n                severity: \"HIGH\",\n                retriable: false\n            });\n            await writeAuditError(\"systems\", null, e.toJSON());\n            throw e;\n        }\n        // insert calls row\n        callId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n        const callRow = {\n            id: callId,\n            organization_id,\n            system_id: systemCpidId,\n            status: \"pending\",\n            started_at: null,\n            ended_at: null,\n            created_by: actorId\n        };\n        const { error: insertErr } = await supabaseAdmin.from(\"calls\").insert(callRow);\n        if (insertErr) {\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: failed to insert call row\", {\n                callId,\n                error: insertErr?.message\n            });\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_DB_INSERT\",\n                message: \"Failed to create call record\",\n                user_message: \"We encountered a system error while starting your call. Please try again.\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: insertErr.message\n                }\n            });\n            await writeAuditError(\"calls\", callId, e.toJSON());\n            throw e;\n        }\n        // execute SignalWire (via injected caller if available)\n        let call_sid = null;\n        if (signalwireCall) {\n            // eslint-disable-next-line no-console\n            console.log(\"startCallHandler: using injected signalwireCall to place outbound call\");\n            if (flow_type === \"bridge\" && from_number && E164_REGEX.test(from_number)) {\n                // place two legs: agent leg then destination leg\n                const sidA = await signalwireCall({\n                    from: String(env.SIGNALWIRE_NUMBER || \"\"),\n                    to: from_number,\n                    url: String(env.NEXT_PUBLIC_APP_URL) + \"/api/voice/laml/outbound\",\n                    statusCallback: String(env.NEXT_PUBLIC_APP_URL) + \"/api/webhooks/signalwire\"\n                });\n                const sidB = await signalwireCall({\n                    from: String(env.SIGNALWIRE_NUMBER || \"\"),\n                    to: phone_number,\n                    url: String(env.NEXT_PUBLIC_APP_URL) + \"/api/voice/laml/outbound\",\n                    statusCallback: String(env.NEXT_PUBLIC_APP_URL) + \"/api/webhooks/signalwire\"\n                });\n                call_sid = sidB.call_sid;\n                // eslint-disable-next-line no-console\n                console.log(\"startCallHandler: injected signalwireCall bridge created\", {\n                    a: sidA.call_sid ? \"[REDACTED]\" : null,\n                    b: sidB.call_sid ? \"[REDACTED]\" : null\n                });\n            } else {\n                const sw = await signalwireCall({\n                    from: String(env.SIGNALWIRE_NUMBER || \"\"),\n                    to: phone_number,\n                    url: String(env.NEXT_PUBLIC_APP_URL) + \"/api/voice/laml/outbound\",\n                    statusCallback: String(env.NEXT_PUBLIC_APP_URL) + \"/api/webhooks/signalwire\"\n                });\n                call_sid = sw.call_sid;\n                // eslint-disable-next-line no-console\n                console.log(\"startCallHandler: injected signalwireCall returned\", {\n                    call_sid: call_sid ? \"[REDACTED]\" : null\n                });\n            }\n        } else {\n            // no injected caller: use shared helper which handles config and mocks\n            // Check if live translation should be enabled (Business plan + feature flag + translate enabled)\n            const plan = String(org.plan ?? \"\").toLowerCase();\n            const isBusinessPlan = [\n                \"business\",\n                \"enterprise\"\n            ].includes(plan);\n            const isFeatureFlagEnabled = (0,_lib_env_validation__WEBPACK_IMPORTED_MODULE_1__.isLiveTranslationPreviewEnabled)();\n            const shouldUseLiveTranslation = isBusinessPlan && isFeatureFlagEnabled && effectiveModulations.translate === true && !!effectiveModulations.translate_from && !!effectiveModulations.translate_to;\n            // eslint-disable-next-line no-console\n            console.log(\"startCallHandler: about to place SignalWire call\", {\n                flow_type,\n                has_from_number: !!from_number,\n                from_number_valid: from_number ? E164_REGEX.test(from_number) : false,\n                shouldUseLiveTranslation,\n                plan,\n                isBusinessPlan,\n                isFeatureFlagEnabled\n            });\n            if (flow_type === \"bridge\" && from_number && E164_REGEX.test(from_number)) {\n                // Bridge calls don't support live translation (complexity)\n                const sidA = await placeSignalWireCall(from_number, false);\n                const sidB = await placeSignalWireCall(phone_number, false);\n                call_sid = sidB;\n                // eslint-disable-next-line no-console\n                console.log(\"startCallHandler: signalwire bridge created\", {\n                    a: sidA ? \"[REDACTED]\" : null,\n                    b: sidB ? \"[REDACTED]\" : null\n                });\n            } else {\n                call_sid = await placeSignalWireCall(phone_number, shouldUseLiveTranslation);\n                // eslint-disable-next-line no-console\n                console.log(\"startCallHandler: signalwire call placed\", {\n                    call_sid: call_sid ? \"[REDACTED]\" : null,\n                    liveTranslation: shouldUseLiveTranslation\n                });\n            }\n        }\n        // update persisted call status only (do NOT write call_sid per TOOL_TABLE_ALIGNMENT)\n        const { error: updateErr } = await supabaseAdmin.from(\"calls\").update({\n            status: \"in-progress\"\n        }).eq(\"id\", callId);\n        if (updateErr) {\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: failed to update call status\", {\n                callId,\n                error: updateErr?.message\n            });\n            await writeAuditError(\"calls\", callId, {\n                message: \"Failed to save call_sid\",\n                error: updateErr.message\n            });\n        }\n        // enqueue ai run if requested (driven by voice_configs, not client input)\n        if (effectiveModulations.transcribe) {\n            if (!systemAiId) {\n                await writeAuditError(\"systems\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"CALL_START_AI_SYSTEM_MISSING\",\n                    message: \"AI system not registered\",\n                    user_message: \"Transcription unavailable right now.\",\n                    severity: \"MEDIUM\",\n                    retriable: true\n                }).toJSON());\n            } else {\n                const aiId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n                const aiRow = {\n                    id: aiId,\n                    call_id: callId,\n                    system_id: systemAiId,\n                    model: \"assemblyai-v1\",\n                    status: \"queued\"\n                };\n                try {\n                    const { error: aiErr } = await supabaseAdmin.from(\"ai_runs\").insert(aiRow);\n                    if (aiErr) {\n                        // eslint-disable-next-line no-console\n                        console.error(\"startCallHandler: failed to insert ai_run\", {\n                            callId,\n                            error: aiErr?.message\n                        });\n                        await writeAuditError(\"ai_runs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                            code: \"AI_TRANSC_INSERT_FAILED\",\n                            message: \"Failed to enqueue transcription\",\n                            user_message: \"Transcription could not be started. The call will continue without transcription.\",\n                            severity: \"MEDIUM\",\n                            retriable: true,\n                            details: {\n                                cause: aiErr.message\n                            }\n                        }).toJSON());\n                    }\n                } catch (e) {\n                    await writeAuditError(\"ai_runs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                        code: \"AI_TRANSC_INSERT_FAILED\",\n                        message: \"Failed to enqueue transcription\",\n                        user_message: \"Transcription could not be started. The call will continue without transcription.\",\n                        severity: \"MEDIUM\",\n                        retriable: true,\n                        details: {\n                            cause: e.message\n                        }\n                    }).toJSON());\n                }\n            }\n        }\n        // enqueue translation run if requested (driven by voice_configs)\n        if (effectiveModulations.translate) {\n            // require languages to be present; if missing, record an audit and skip enqueuing\n            const fromLang = effectiveModulations.translate_from ?? null;\n            const toLang = effectiveModulations.translate_to ?? null;\n            if (!fromLang || !toLang) {\n                await writeAuditError(\"ai_runs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"AI_TRANSL_LANG_MISSING\",\n                    message: \"Translation configured but language codes missing\",\n                    user_message: \"Translation configuration incomplete; skipping translation.\",\n                    severity: \"MEDIUM\",\n                    retriable: false\n                }).toJSON());\n            } else if (!systemAiId) {\n                await writeAuditError(\"systems\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"CALL_START_AI_SYSTEM_MISSING\",\n                    message: \"AI system not registered\",\n                    user_message: \"Translation unavailable right now.\",\n                    severity: \"MEDIUM\",\n                    retriable: true\n                }).toJSON());\n            } else {\n                const aiId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n                const aiRow = {\n                    id: aiId,\n                    call_id: callId,\n                    system_id: systemAiId,\n                    model: \"assemblyai-translation-v1\",\n                    status: \"queued\",\n                    meta: {\n                        translate_from: fromLang,\n                        translate_to: toLang\n                    }\n                };\n                try {\n                    const { error: aiErr } = await supabaseAdmin.from(\"ai_runs\").insert(aiRow);\n                    if (aiErr) {\n                        // eslint-disable-next-line no-console\n                        console.error(\"startCallHandler: failed to insert ai_run (translation)\", {\n                            callId,\n                            error: aiErr?.message\n                        });\n                        await writeAuditError(\"ai_runs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                            code: \"AI_TRANSL_INSERT_FAILED\",\n                            message: \"Failed to enqueue translation\",\n                            user_message: \"Translation could not be started. The call will continue without translation.\",\n                            severity: \"MEDIUM\",\n                            retriable: true,\n                            details: {\n                                cause: aiErr.message\n                            }\n                        }).toJSON());\n                    }\n                } catch (e) {\n                    await writeAuditError(\"ai_runs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                        code: \"AI_TRANSL_INSERT_FAILED\",\n                        message: \"Failed to enqueue translation\",\n                        user_message: \"Translation could not be started. The call will continue without translation.\",\n                        severity: \"MEDIUM\",\n                        retriable: true,\n                        details: {\n                            cause: e.message\n                        }\n                    }).toJSON());\n                }\n            }\n        }\n        // recording intent audit (driven by voice_configs)\n        if (effectiveModulations.record) {\n            const orgToolId = org?.tool_id ?? null;\n            if (!orgToolId) {\n                await writeAuditError(\"calls\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                    code: \"RECORDING_TOOL_NOT_FOUND\",\n                    message: \"No recording tool available for organization\",\n                    user_message: \"No recording tool available for your organization\",\n                    severity: \"MEDIUM\",\n                    retriable: false\n                }).toJSON());\n            } else {\n                try {\n                    await supabaseAdmin.from(\"audit_logs\").insert({\n                        id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                        organization_id,\n                        user_id: capturedActorId,\n                        system_id: capturedSystemCpidId,\n                        resource_type: \"calls\",\n                        resource_id: callId,\n                        action: \"intent:recording_requested\",\n                        before: null,\n                        after: {\n                            tool_id: orgToolId,\n                            requested_at: new Date().toISOString()\n                        },\n                        created_at: new Date().toISOString()\n                    });\n                } catch (e) {}\n            }\n        }\n        // fetch canonical call\n        const { data: persistedCall, error: fetchCallErr } = await supabaseAdmin.from(\"calls\").select(\"*\").eq(\"id\", callId).limit(1);\n        if (fetchCallErr || !persistedCall?.[0]) {\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: failed to fetch persisted call\", {\n                callId,\n                error: fetchCallErr?.message\n            });\n            const e = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"CALL_START_FETCH_PERSISTED_FAILED\",\n                message: \"Failed to read back persisted call\",\n                user_message: \"We started the call but could not verify its record. Please contact support.\",\n                severity: \"HIGH\",\n                retriable: true,\n                details: {\n                    cause: fetchCallErr?.message\n                }\n            });\n            await writeAuditError(\"calls\", callId, e.toJSON());\n            throw e;\n        }\n        const canonicalCall = persistedCall[0];\n        try {\n            await supabaseAdmin.from(\"audit_logs\").insert({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                organization_id,\n                user_id: capturedActorId,\n                system_id: capturedSystemCpidId,\n                resource_type: \"calls\",\n                resource_id: callId,\n                action: \"create\",\n                before: null,\n                after: {\n                    ...canonicalCall,\n                    config: effectiveModulations,\n                    call_sid\n                },\n                created_at: new Date().toISOString()\n            });\n        } catch (auditErr) {\n            // eslint-disable-next-line no-console\n            console.error(\"startCallHandler: failed to insert audit log\", {\n                callId,\n                error: auditErr?.message\n            });\n            await writeAuditError(\"audit_logs\", callId, new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n                code: \"AUDIT_LOG_INSERT_FAILED\",\n                message: \"Failed to write audit log\",\n                user_message: \"Call started but an internal audit log could not be saved.\",\n                severity: \"MEDIUM\",\n                retriable: true,\n                details: {\n                    cause: auditErr.message\n                }\n            }).toJSON());\n        }\n        // eslint-disable-next-line no-console\n        console.log(\"startCallHandler: call flow completed\", {\n            callId\n        });\n        return {\n            success: true,\n            call_id: callId\n        };\n    } catch (err) {\n        if (err instanceof _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError) {\n            const payload = err.toJSON();\n            try {\n                await supabaseAdmin.from(\"audit_logs\").insert({\n                    id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                    organization_id,\n                    user_id: capturedActorId ?? null,\n                    system_id: capturedSystemCpidId ?? null,\n                    resource_type: \"calls\",\n                    resource_id: callId ?? null,\n                    action: \"error\",\n                    before: null,\n                    after: payload,\n                    created_at: new Date().toISOString()\n                });\n            } catch (e) {}\n            return {\n                success: false,\n                error: {\n                    id: payload.id,\n                    code: payload.code,\n                    message: payload.user_message ?? payload.message,\n                    severity: payload.severity\n                }\n            };\n        }\n        // log the unexpected error for debugging\n        // eslint-disable-next-line no-console\n        console.error(\"startCallHandler unexpected error\", err);\n        const unexpected = new _types_app_error__WEBPACK_IMPORTED_MODULE_0__.AppError({\n            code: \"CALL_START_UNEXPECTED\",\n            message: err?.message ?? \"Unexpected error\",\n            user_message: \"An unexpected error occurred while starting the call.\",\n            severity: \"CRITICAL\",\n            retriable: true,\n            details: {\n                stack: err?.stack\n            }\n        });\n        const payload = unexpected.toJSON();\n        try {\n            await supabaseAdmin.from(\"audit_logs\").insert({\n                id: (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(),\n                organization_id,\n                user_id: null,\n                system_id: null,\n                resource_type: \"calls\",\n                resource_id: null,\n                action: \"error\",\n                before: null,\n                after: payload,\n                created_at: new Date().toISOString()\n            });\n        } catch (e) {}\n        return {\n            success: false,\n            error: {\n                id: payload.id,\n                code: payload.code,\n                message: payload.user_message ?? payload.message,\n                severity: payload.severity\n            }\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYWN0aW9ucy9jYWxscy9zdGFydENhbGxIYW5kbGVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBbUM7QUFDUztBQUMwQjtBQUV0RSxNQUFNSSxhQUFhO0FBNEJKLGVBQWVDLGlCQUFpQkMsS0FBcUIsRUFBRUMsSUFBbUI7SUFDdkYsTUFBTSxFQUFFQyxhQUFhLEVBQUVDLGNBQWMsRUFBRUMsTUFBTUMsUUFBUUQsR0FBRyxFQUFFLEdBQUdIO0lBQzdELElBQUlLLGtCQUFpQztJQUNyQyxJQUFJQyx1QkFBc0M7SUFDMUMsSUFBSUMsU0FBd0I7SUFDNUIsK0RBQStEO0lBQy9ELGdFQUFnRTtJQUNoRSxJQUFJQyxrQkFBMEJULE1BQU1TLGVBQWU7SUFFbkQsZUFBZUMsZ0JBQWdCQyxRQUFnQixFQUFFQyxVQUF5QixFQUFFQyxPQUFZO1FBQ3RGLElBQUk7WUFDRixNQUFNWCxjQUFjWSxJQUFJLENBQUMsY0FBY0MsTUFBTSxDQUFDO2dCQUM1Q0MsSUFBSXJCLGdEQUFNQTtnQkFDVmM7Z0JBQ0FRLFNBQVNYO2dCQUNUWSxXQUFXWDtnQkFDWFksZUFBZVI7Z0JBQ2ZTLGFBQWFSO2dCQUNiUyxRQUFRO2dCQUNSQyxRQUFRO2dCQUNSQyxPQUFPVjtnQkFDUFcsWUFBWSxJQUFJQyxPQUFPQyxXQUFXO1lBQ3BDO1FBQ0YsRUFBRSxPQUFPQyxHQUFHO1lBQ1YsY0FBYztZQUNkLHNDQUFzQztZQUN0Q0MsUUFBUUMsS0FBSyxDQUFDLCtCQUErQkY7UUFDL0M7SUFDRjtJQUVBLHlEQUF5RDtJQUN6RCxNQUFNRyxzQkFBc0IsT0FBT0MsVUFBa0JDLHFCQUE4QixLQUFLO1FBQ3RGLHNDQUFzQztRQUN0Q0osUUFBUUssR0FBRyxDQUFDLHlDQUF5QztZQUFFRixVQUFVQSxXQUFXLGVBQWU7WUFBTUM7WUFBb0J4QjtRQUFPO1FBRTVILE1BQU0wQixZQUFZOUIsSUFBSStCLHFCQUFxQjtRQUMzQyxNQUFNQyxVQUFVaEMsSUFBSWlDLGdCQUFnQjtRQUNwQyxNQUFNQyxXQUFXbEMsSUFBSW1DLGlCQUFpQjtRQUN0QyxNQUFNQyxXQUFXQyxPQUFPckMsSUFBSXNDLGdCQUFnQixJQUFJO1FBQ2hELE1BQU1DLFVBQVVILFNBQVNJLE9BQU8sQ0FBQyxnQkFBZ0IsSUFBSUEsT0FBTyxDQUFDLE9BQU8sSUFBSUEsT0FBTyxDQUFDLHVCQUF1QixJQUFJQyxJQUFJO1FBRS9HLHNDQUFzQztRQUN0Q2pCLFFBQVFLLEdBQUcsQ0FBQyx5Q0FBeUM7WUFDbkRhLFlBQVksQ0FBQyxDQUFDWjtZQUNkYSxVQUFVLENBQUMsQ0FBQ1g7WUFDWlksVUFBVSxDQUFDLENBQUNMO1lBQ1pNLFdBQVcsQ0FBQyxDQUFDWDtZQUNiRSxVQUFVQSxXQUFXQSxTQUFTVSxTQUFTLENBQUMsR0FBRyxNQUFNLFFBQVE7WUFDekRDLGdCQUFnQlIsV0FBVztRQUM3QjtRQUVBLElBQUksQ0FBRVQsQ0FBQUEsYUFBYUUsV0FBV08sV0FBV0wsUUFBTyxHQUFJO1lBQ2xELHNEQUFzRDtZQUN0RCxNQUFNYyxVQUFVLEVBQUU7WUFDbEIsSUFBSSxDQUFDbEIsV0FBV2tCLFFBQVFDLElBQUksQ0FBQztZQUM3QixJQUFJLENBQUNqQixTQUFTZ0IsUUFBUUMsSUFBSSxDQUFDO1lBQzNCLElBQUksQ0FBQ1YsU0FBU1MsUUFBUUMsSUFBSSxDQUFDO1lBQzNCLElBQUksQ0FBQ2YsVUFBVWMsUUFBUUMsSUFBSSxDQUFDO1lBRTVCLElBQUlqRCxJQUFJa0QsUUFBUSxLQUFLLGNBQWM7Z0JBQ2pDLE1BQU0zQixJQUFJLElBQUkvQixzREFBUUEsQ0FBQztvQkFDckIyRCxNQUFNO29CQUNOQyxTQUFTLENBQUMsZ0NBQWdDLEVBQUVKLFFBQVFLLElBQUksQ0FBQyxNQUFNLENBQUM7b0JBQ2hFQyxjQUFjO29CQUNkQyxVQUFVO29CQUNWQyxXQUFXO2dCQUNiO2dCQUNBLE1BQU1sRCxnQkFBZ0IsV0FBVyxNQUFNaUIsRUFBRWtDLE1BQU07Z0JBQy9DLHNDQUFzQztnQkFDdENqQyxRQUFRQyxLQUFLLENBQUMsMENBQTBDdUIsUUFBUUssSUFBSSxDQUFDO2dCQUNyRSxNQUFNOUI7WUFDUjtZQUNBLDZCQUE2QjtZQUM3QixzQ0FBc0M7WUFDdENDLFFBQVFrQyxJQUFJLENBQUMsaURBQWlEVixRQUFRSyxJQUFJLENBQUM7WUFDM0UsT0FBTyxDQUFDLEtBQUssRUFBRTlELGdEQUFNQSxHQUFHLENBQUM7UUFDM0I7UUFFQSxNQUFNb0UsT0FBT0MsT0FBT2xELElBQUksQ0FBQyxDQUFDLEVBQUVvQixVQUFVLENBQUMsRUFBRUUsUUFBUSxDQUFDLEVBQUU2QixRQUFRLENBQUM7UUFDN0QsTUFBTUMsU0FBUyxJQUFJQztRQUNuQkQsT0FBT0UsTUFBTSxDQUFDLFFBQVE5QjtRQUN0QjRCLE9BQU9FLE1BQU0sQ0FBQyxNQUFNckM7UUFFcEIsc0VBQXNFO1FBQ3RFLElBQUlDLHNCQUFzQnhCLFFBQVE7WUFDaEMwRCxPQUFPRSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUVoRSxJQUFJaUUsbUJBQW1CLENBQUMsZ0NBQWdDLEVBQUVDLG1CQUFtQjlELFFBQVEsQ0FBQztZQUM5RyxzQ0FBc0M7WUFDdENvQixRQUFRSyxHQUFHLENBQUMsbUVBQW1FO2dCQUFFekI7WUFBTztRQUMxRixPQUFPO1lBQ0wwRCxPQUFPRSxNQUFNLENBQUMsT0FBTyxDQUFDLEVBQUVoRSxJQUFJaUUsbUJBQW1CLENBQUMsd0JBQXdCLENBQUM7UUFDM0U7UUFDQUgsT0FBT0UsTUFBTSxDQUFDLGtCQUFrQixDQUFDLEVBQUVoRSxJQUFJaUUsbUJBQW1CLENBQUMsd0JBQXdCLENBQUM7UUFFcEYsTUFBTUUsYUFBYSxDQUFDLFFBQVEsRUFBRTVCLFFBQVEsNkNBQTZDLEVBQUVULFVBQVUsV0FBVyxDQUFDO1FBQzNHLHNDQUFzQztRQUN0Q04sUUFBUUssR0FBRyxDQUFDLDZDQUE2QztZQUFFdUMsVUFBVUQ7WUFBWUUsSUFBSTFDO1lBQVVqQixNQUFNd0I7UUFBUztRQUU5RyxNQUFNb0MsYUFBYSxJQUFJQztRQUN2QixNQUFNQyxVQUFVQyxXQUFXLElBQU1ILFdBQVdJLEtBQUssSUFBSTtRQUNyRCxJQUFJQztRQUNKLElBQUk7WUFDRkEsUUFBUSxNQUFNQyxNQUFNVCxZQUFZO2dCQUM5QlUsUUFBUTtnQkFDUkMsU0FBUztvQkFBRSxpQkFBaUIsQ0FBQyxNQUFNLEVBQUVuQixLQUFLLENBQUM7b0JBQUUsZ0JBQWdCO2dCQUFvQztnQkFDakdvQixNQUFNakI7Z0JBQ05rQixRQUFRVixXQUFXVSxNQUFNO1lBQzNCO1FBQ0YsRUFBRSxPQUFPQyxVQUFlO1lBQ3RCLHNDQUFzQztZQUN0Q3pELFFBQVFDLEtBQUssQ0FBQyw0Q0FBNEM7Z0JBQUVBLE9BQU93RCxVQUFVN0IsV0FBV2YsT0FBTzRDO1lBQVU7WUFDekcsTUFBTTFELElBQUksSUFBSS9CLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBMkJDLFNBQVM7Z0JBQThCRSxjQUFjO2dCQUFvQ0MsVUFBVTtnQkFBUUMsV0FBVztnQkFBTTBCLFNBQVM7b0JBQUVDLE9BQU9GLFVBQVU3QixXQUFXZixPQUFPNEM7Z0JBQVU7WUFBRTtZQUNoUCxNQUFNM0UsZ0JBQWdCLFNBQVNGLFFBQVFtQixFQUFFa0MsTUFBTTtZQUMvQyxNQUFNbEM7UUFDUixTQUFVO1lBQ1I2RCxhQUFhWjtRQUNmO1FBRUEsSUFBSSxDQUFDRyxNQUFNVSxFQUFFLEVBQUU7WUFDYixNQUFNQyxPQUFPLE1BQU1YLE1BQU1XLElBQUk7WUFDN0Isc0NBQXNDO1lBQ3RDOUQsUUFBUUMsS0FBSyxDQUFDLDRDQUE0QztnQkFBRThELFFBQVFaLE1BQU1ZLE1BQU07Z0JBQUVSLE1BQU1PO1lBQUs7WUFDN0YsTUFBTS9ELElBQUksSUFBSS9CLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBd0JDLFNBQVMsQ0FBQyxrQkFBa0IsRUFBRXVCLE1BQU1ZLE1BQU0sQ0FBQyxDQUFDO2dCQUFFakMsY0FBYztnQkFBb0NDLFVBQVU7Z0JBQVFDLFdBQVc7Z0JBQU0wQixTQUFTO29CQUFFTSxnQkFBZ0JGO2dCQUFLO1lBQUU7WUFDNU4sTUFBTWhGLGdCQUFnQixTQUFTRixRQUFRbUIsRUFBRWtDLE1BQU07WUFDL0MsTUFBTWxDO1FBQ1I7UUFFQSxNQUFNa0UsU0FBUyxNQUFNZCxNQUFNZSxJQUFJO1FBQy9CLHNDQUFzQztRQUN0Q2xFLFFBQVFLLEdBQUcsQ0FBQywwQ0FBMEM7WUFBRThELEtBQUtGLFFBQVFFLE1BQU0sZUFBZTtRQUFLO1FBQy9GLE9BQU9GLFFBQVFFLE9BQU87SUFDeEI7SUFFQSxJQUFJO1FBQ0YsSUFBSSxFQUFFQyxXQUFXLEVBQUVDLFlBQVksRUFBRUMsU0FBUyxFQUFFQyxXQUFXLEVBQUUsR0FBR25HO1FBQzVEUyxrQkFBa0JULE1BQU1TLGVBQWU7UUFFdkMsMkVBQTJFO1FBQzNFLHNFQUFzRTtRQUN0RSw0Q0FBNEM7UUFDNUMsc0NBQXNDO1FBQ3RDbUIsUUFBUUssR0FBRyxDQUFDLHFDQUFxQztZQUFFeEI7WUFBaUJ1RjtZQUFhQztZQUFjQztZQUFXQztRQUFZO1FBRXRILHVCQUF1QjtRQUN2Qix3RkFBd0Y7UUFDeEYsSUFBSUMsVUFBVSxNQUFlQyxRQUFRLElBQUk7UUFDekMvRixrQkFBa0I4RjtRQUNsQixJQUFJLENBQUNBLFNBQVM7WUFDWix1RUFBdUU7WUFDdkUsMERBQTBEO1lBQzFELElBQUloRyxJQUFJa0QsUUFBUSxLQUFLLGNBQWM7Z0JBQ2pDOEMsVUFBVTtnQkFDVjlGLGtCQUFrQjhGO2dCQUNsQixzQ0FBc0M7Z0JBQ3RDeEUsUUFBUWtDLElBQUksQ0FBQyxnREFBZ0Q7b0JBQUVzQztnQkFBUTtZQUN6RSxPQUFPO2dCQUNMLE1BQU1FLE1BQU0sSUFBSTFHLHNEQUFRQSxDQUFDO29CQUFFMkQsTUFBTTtvQkFBaUJDLFNBQVM7b0JBQW1CRSxjQUFjO29CQUEyQkMsVUFBVTtvQkFBUUMsV0FBVztnQkFBTTtnQkFDMUosTUFBTWxELGdCQUFnQixpQkFBaUIsTUFBTTRGLElBQUl6QyxNQUFNO2dCQUN2RCxNQUFNeUM7WUFDUjtRQUNGO1FBRUEscUJBQXFCO1FBQ3JCLElBQUksQ0FBQyxxQkFBcUJDLElBQUksQ0FBQzlGLGtCQUFrQjtZQUMvQyxNQUFNNkYsTUFBTSxJQUFJMUcsc0RBQVFBLENBQUM7Z0JBQUUyRCxNQUFNO2dCQUEwQkMsU0FBUztnQkFBMkJFLGNBQWM7Z0JBQW1DQyxVQUFVO2dCQUFVQyxXQUFXO1lBQU07WUFDckwsTUFBTWxELGdCQUFnQixpQkFBaUIsTUFBTTRGLElBQUl6QyxNQUFNO1lBQ3ZELE1BQU15QztRQUNSO1FBRUEsc0JBQXNCO1FBQ3RCLE1BQU0sRUFBRUUsTUFBTUMsT0FBTyxFQUFFNUUsT0FBTzZFLE1BQU0sRUFBRSxHQUFHLE1BQU14RyxjQUM1Q1ksSUFBSSxDQUFDLGlCQUNMNkYsTUFBTSxDQUFDLG1CQUNQQyxFQUFFLENBQUMsTUFBTW5HLGlCQUNUb0csS0FBSyxDQUFDO1FBRVQsSUFBSUgsUUFBUTtZQUNWLE1BQU1KLE1BQU0sSUFBSTFHLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBNEJDLFNBQVM7Z0JBQThCRSxjQUFjO2dCQUFrQ0MsVUFBVTtnQkFBUUMsV0FBVztnQkFBTTBCLFNBQVM7b0JBQUVDLE9BQU9tQixPQUFPbEQsT0FBTztnQkFBQztZQUFFO1lBQzFOLE1BQU05QyxnQkFBZ0IsaUJBQWlCLE1BQU00RixJQUFJekMsTUFBTTtZQUN2RCxNQUFNeUM7UUFDUjtRQUVBLE1BQU1RLE1BQU1MLFNBQVMsQ0FBQyxFQUFFO1FBQ3hCLElBQUksQ0FBQ0ssS0FBSztZQUNSLE1BQU1SLE1BQU0sSUFBSTFHLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBNEJDLFNBQVM7Z0JBQTBCRSxjQUFjO2dCQUEyQkMsVUFBVTtnQkFBUUMsV0FBVztZQUFNO1lBQzVLLE1BQU1sRCxnQkFBZ0IsaUJBQWlCLE1BQU00RixJQUFJekMsTUFBTTtZQUN2RCxNQUFNeUM7UUFDUjtRQUVBLElBQUlRLElBQUlDLElBQUksS0FBSyxRQUFRO1lBQ3ZCLE1BQU1ULE1BQU0sSUFBSTFHLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBa0NDLFNBQVM7Z0JBQXVDRSxjQUFjO2dCQUE0REMsVUFBVTtnQkFBUUMsV0FBVztZQUFNO1lBQ2hPLE1BQU1sRCxnQkFBZ0IsaUJBQWlCb0csSUFBSTlGLEVBQUUsRUFBRXNGLElBQUl6QyxNQUFNO1lBQ3pELE1BQU15QztRQUNSO1FBRUEsbUJBQW1CO1FBQ25CLE1BQU0sRUFBRUUsTUFBTVEsY0FBYyxFQUFFbkYsT0FBT29GLGFBQWEsRUFBRSxHQUFHLE1BQU0vRyxjQUMxRFksSUFBSSxDQUFDLGVBQ0w2RixNQUFNLENBQUMsV0FDUEMsRUFBRSxDQUFDLG1CQUFtQm5HLGlCQUN0Qm1HLEVBQUUsQ0FBQyxXQUFXUixTQUNkUyxLQUFLLENBQUM7UUFFVCxJQUFJSSxlQUFlO1lBQ2pCLE1BQU1YLE1BQU0sSUFBSTFHLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBaUNDLFNBQVM7Z0JBQTRCRSxjQUFjO2dCQUErQkMsVUFBVTtnQkFBUUMsV0FBVztnQkFBTTBCLFNBQVM7b0JBQUVDLE9BQU8wQixjQUFjekQsT0FBTztnQkFBQztZQUFFO1lBQ2pPLE1BQU05QyxnQkFBZ0IsZUFBZSxNQUFNNEYsSUFBSXpDLE1BQU07WUFDckQsTUFBTXlDO1FBQ1I7UUFFQSxrRkFBa0Y7UUFDbEYsNkRBQTZEO1FBQzdELElBQUlZLHVCQUF1RztZQUFFQyxRQUFRO1lBQU9DLFlBQVk7WUFBT0MsV0FBVztRQUFNO1FBQ2hLLElBQUk7WUFDRixNQUFNLEVBQUViLE1BQU1jLE1BQU0sRUFBRXpGLE9BQU8wRixLQUFLLEVBQUUsR0FBRyxNQUFNckgsY0FBY1ksSUFBSSxDQUFDLGlCQUFpQjZGLE1BQU0sQ0FBQyxtRkFBbUZDLEVBQUUsQ0FBQyxtQkFBbUJuRyxpQkFBaUJvRyxLQUFLLENBQUM7WUFDeE4sSUFBSSxDQUFDVSxTQUFTRCxVQUFVQSxNQUFNLENBQUMsRUFBRSxFQUFFO2dCQUNqQyxNQUFNRSxNQUFXRixNQUFNLENBQUMsRUFBRTtnQkFDMUJKLHFCQUFxQkMsTUFBTSxHQUFHLENBQUMsQ0FBQ0ssSUFBSUwsTUFBTTtnQkFDMUNELHFCQUFxQkUsVUFBVSxHQUFHLENBQUMsQ0FBQ0ksSUFBSUosVUFBVTtnQkFDbERGLHFCQUFxQkcsU0FBUyxHQUFHLENBQUMsQ0FBQ0csSUFBSUgsU0FBUztnQkFDaERILHFCQUFxQk8sTUFBTSxHQUFHLENBQUMsQ0FBQ0QsSUFBSUMsTUFBTTtnQkFDMUNQLHFCQUFxQlEsZ0JBQWdCLEdBQUcsQ0FBQyxDQUFDRixJQUFJRSxnQkFBZ0I7Z0JBQzlELElBQUksT0FBT0YsSUFBSUcsY0FBYyxLQUFLLFVBQVVULHFCQUFxQlMsY0FBYyxHQUFHSCxJQUFJRyxjQUFjO2dCQUNwRyxJQUFJLE9BQU9ILElBQUlJLFlBQVksS0FBSyxVQUFVVixxQkFBcUJVLFlBQVksR0FBR0osSUFBSUksWUFBWTtZQUNoRztRQUNGLEVBQUUsT0FBT2pHLEdBQUc7UUFDVixtRkFBbUY7UUFDckY7UUFFQSxJQUFJLENBQUNxRixrQkFBa0JBLGVBQWVhLE1BQU0sS0FBSyxHQUFHO1lBQ2xELE1BQU12QixNQUFNLElBQUkxRyxzREFBUUEsQ0FBQztnQkFBRTJELE1BQU07Z0JBQXFCQyxTQUFTO2dCQUF5Q0UsY0FBYztnQkFBd0NDLFVBQVU7Z0JBQVFDLFdBQVc7WUFBTTtZQUNqTSxNQUFNbEQsZ0JBQWdCLGVBQWUsTUFBTTRGLElBQUl6QyxNQUFNO1lBQ3JELE1BQU15QztRQUNSO1FBRUEsbUJBQW1CO1FBQ25CLElBQUksQ0FBQ3hHLFdBQVd5RyxJQUFJLENBQUNOLGVBQWU7WUFDbEMsTUFBTUssTUFBTSxJQUFJMUcsc0RBQVFBLENBQUM7Z0JBQUUyRCxNQUFNO2dCQUE0QkMsU0FBUztnQkFBK0JFLGNBQWM7Z0JBQXNFQyxVQUFVO2dCQUFVQyxXQUFXO1lBQU07WUFDOU4sTUFBTWxELGdCQUFnQixTQUFTLE1BQU00RixJQUFJekMsTUFBTTtZQUMvQyxNQUFNeUM7UUFDUjtRQUVBLGlCQUFpQjtRQUNqQixNQUFNLEVBQUVFLE1BQU1zQixXQUFXLEVBQUVqRyxPQUFPa0csVUFBVSxFQUFFLEdBQUcsTUFBTTdILGNBQ3BEWSxJQUFJLENBQUMsV0FDTDZGLE1BQU0sQ0FBQyxVQUNQcUIsRUFBRSxDQUFDLE9BQU87WUFBQztZQUFlO1NBQVk7UUFFekMsSUFBSUQsWUFBWTtZQUNkLE1BQU1wRyxJQUFJLElBQUkvQixzREFBUUEsQ0FBQztnQkFBRTJELE1BQU07Z0JBQWdDQyxTQUFTO2dCQUF3QkUsY0FBYztnQkFBaUJDLFVBQVU7Z0JBQVFDLFdBQVc7Z0JBQU0wQixTQUFTO29CQUFFQyxPQUFPd0MsV0FBV3ZFLE9BQU87Z0JBQUM7WUFBRTtZQUN6TSxNQUFNOUMsZ0JBQWdCLFdBQVcsTUFBTWlCLEVBQUVrQyxNQUFNO1lBQy9DLE1BQU1sQztRQUNSO1FBRUEsTUFBTXNHLFlBQW9DLENBQUM7UUFDekNILENBQUFBLGVBQWUsRUFBRSxFQUFFSSxPQUFPLENBQUMsQ0FBQ0M7WUFBYUYsU0FBUyxDQUFDRSxFQUFFQyxHQUFHLENBQUMsR0FBR0QsRUFBRW5ILEVBQUU7UUFBQztRQUNuRSxNQUFNcUgsZUFBZUosU0FBUyxDQUFDLGNBQWMsSUFBSTtRQUNqRCxNQUFNSyxhQUFhTCxTQUFTLENBQUMsWUFBWSxJQUFJO1FBQzdDMUgsdUJBQXVCOEg7UUFDdkIsSUFBSSxDQUFDQSxjQUFjO1lBQ2pCLE1BQU0xRyxJQUFJLElBQUkvQixzREFBUUEsQ0FBQztnQkFBRTJELE1BQU07Z0JBQTBCQyxTQUFTO2dCQUFpQ0UsY0FBYTtnQkFBNEJDLFVBQVM7Z0JBQVFDLFdBQVU7WUFBTTtZQUM3SyxNQUFNbEQsZ0JBQWdCLFdBQVcsTUFBTWlCLEVBQUVrQyxNQUFNO1lBQy9DLE1BQU1sQztRQUNSO1FBRUEsbUJBQW1CO1FBQ25CbkIsU0FBU2IsZ0RBQU1BO1FBQ2YsTUFBTTRJLFVBQVU7WUFDZHZILElBQUlSO1lBQ0pDO1lBQ0FTLFdBQVdtSDtZQUNYMUMsUUFBUTtZQUNSNkMsWUFBWTtZQUNaQyxVQUFVO1lBQ1ZDLFlBQVl0QztRQUNkO1FBRUEsTUFBTSxFQUFFdkUsT0FBTzhHLFNBQVMsRUFBRSxHQUFHLE1BQU16SSxjQUFjWSxJQUFJLENBQUMsU0FBU0MsTUFBTSxDQUFDd0g7UUFDdEUsSUFBSUksV0FBVztZQUNiLHNDQUFzQztZQUN0Qy9HLFFBQVFDLEtBQUssQ0FBQywrQ0FBK0M7Z0JBQUVyQjtnQkFBUXFCLE9BQU84RyxXQUFXbkY7WUFBUTtZQUNqRyxNQUFNN0IsSUFBSSxJQUFJL0Isc0RBQVFBLENBQUM7Z0JBQUUyRCxNQUFNO2dCQUF3QkMsU0FBUztnQkFBZ0NFLGNBQWM7Z0JBQTZFQyxVQUFVO2dCQUFRQyxXQUFXO2dCQUFNMEIsU0FBUztvQkFBRUMsT0FBT29ELFVBQVVuRixPQUFPO2dCQUFDO1lBQUU7WUFDcFEsTUFBTTlDLGdCQUFnQixTQUFTRixRQUFRbUIsRUFBRWtDLE1BQU07WUFDL0MsTUFBTWxDO1FBQ1I7UUFJQSx3REFBd0Q7UUFDeEQsSUFBSWlILFdBQTBCO1FBQzlCLElBQUl6SSxnQkFBZ0I7WUFDbEIsc0NBQXNDO1lBQ3RDeUIsUUFBUUssR0FBRyxDQUFDO1lBQ1osSUFBSWlFLGNBQWMsWUFBWUYsZUFBZWxHLFdBQVd5RyxJQUFJLENBQUNQLGNBQWM7Z0JBQ3pFLGlEQUFpRDtnQkFDakQsTUFBTTZDLE9BQU8sTUFBTTFJLGVBQWU7b0JBQUVXLE1BQU0yQixPQUFPckMsSUFBSW1DLGlCQUFpQixJQUFJO29CQUFLa0MsSUFBSXVCO29CQUFhOEMsS0FBS3JHLE9BQU9yQyxJQUFJaUUsbUJBQW1CLElBQUk7b0JBQTRCMEUsZ0JBQWdCdEcsT0FBT3JDLElBQUlpRSxtQkFBbUIsSUFBSTtnQkFBMkI7Z0JBQ2hQLE1BQU0yRSxPQUFPLE1BQU03SSxlQUFlO29CQUFFVyxNQUFNMkIsT0FBT3JDLElBQUltQyxpQkFBaUIsSUFBSTtvQkFBS2tDLElBQUl3QjtvQkFBYzZDLEtBQUtyRyxPQUFPckMsSUFBSWlFLG1CQUFtQixJQUFJO29CQUE0QjBFLGdCQUFnQnRHLE9BQU9yQyxJQUFJaUUsbUJBQW1CLElBQUk7Z0JBQTJCO2dCQUNqUHVFLFdBQVdJLEtBQUtKLFFBQVE7Z0JBQ3hCLHNDQUFzQztnQkFDdENoSCxRQUFRSyxHQUFHLENBQUMsNERBQTREO29CQUFFZ0gsR0FBR0osS0FBS0QsUUFBUSxHQUFHLGVBQWU7b0JBQU1NLEdBQUdGLEtBQUtKLFFBQVEsR0FBRyxlQUFlO2dCQUFLO1lBQzNKLE9BQU87Z0JBQ0wsTUFBTU8sS0FBSyxNQUFNaEosZUFBZTtvQkFBRVcsTUFBTTJCLE9BQU9yQyxJQUFJbUMsaUJBQWlCLElBQUk7b0JBQUtrQyxJQUFJd0I7b0JBQWM2QyxLQUFLckcsT0FBT3JDLElBQUlpRSxtQkFBbUIsSUFBSTtvQkFBNEIwRSxnQkFBZ0J0RyxPQUFPckMsSUFBSWlFLG1CQUFtQixJQUFJO2dCQUEyQjtnQkFDL091RSxXQUFXTyxHQUFHUCxRQUFRO2dCQUN0QixzQ0FBc0M7Z0JBQ3RDaEgsUUFBUUssR0FBRyxDQUFDLHNEQUFzRDtvQkFBRTJHLFVBQVVBLFdBQVcsZUFBZTtnQkFBSztZQUMvRztRQUNGLE9BQU87WUFDTCx1RUFBdUU7WUFDdkUsaUdBQWlHO1lBQ2pHLE1BQU03QixPQUFPdEUsT0FBT3FFLElBQUlDLElBQUksSUFBSSxJQUFJcUMsV0FBVztZQUMvQyxNQUFNQyxpQkFBaUI7Z0JBQUM7Z0JBQVk7YUFBYSxDQUFDQyxRQUFRLENBQUN2QztZQUMzRCxNQUFNd0MsdUJBQXVCMUosb0ZBQStCQTtZQUM1RCxNQUFNMkosMkJBQTJCSCxrQkFBa0JFLHdCQUF3QnJDLHFCQUFxQkcsU0FBUyxLQUFLLFFBQVEsQ0FBQyxDQUFDSCxxQkFBcUJTLGNBQWMsSUFBSSxDQUFDLENBQUNULHFCQUFxQlUsWUFBWTtZQUVsTSxzQ0FBc0M7WUFDdENoRyxRQUFRSyxHQUFHLENBQUMsb0RBQW9EO2dCQUM5RGlFO2dCQUNBdUQsaUJBQWlCLENBQUMsQ0FBQ3pEO2dCQUNuQjBELG1CQUFtQjFELGNBQWNsRyxXQUFXeUcsSUFBSSxDQUFDUCxlQUFlO2dCQUNoRXdEO2dCQUNBekM7Z0JBQ0FzQztnQkFDQUU7WUFDRjtZQUVBLElBQUlyRCxjQUFjLFlBQVlGLGVBQWVsRyxXQUFXeUcsSUFBSSxDQUFDUCxjQUFjO2dCQUN6RSwyREFBMkQ7Z0JBQzNELE1BQU02QyxPQUFPLE1BQU0vRyxvQkFBb0JrRSxhQUFhO2dCQUNwRCxNQUFNZ0QsT0FBTyxNQUFNbEgsb0JBQW9CbUUsY0FBYztnQkFDckQyQyxXQUFXSTtnQkFDWCxzQ0FBc0M7Z0JBQ3RDcEgsUUFBUUssR0FBRyxDQUFDLCtDQUErQztvQkFBRWdILEdBQUdKLE9BQU8sZUFBZTtvQkFBTUssR0FBR0YsT0FBTyxlQUFlO2dCQUFLO1lBQzVILE9BQU87Z0JBQ0xKLFdBQVcsTUFBTTlHLG9CQUFvQm1FLGNBQWN1RDtnQkFDbkQsc0NBQXNDO2dCQUN0QzVILFFBQVFLLEdBQUcsQ0FBQyw0Q0FBNEM7b0JBQUUyRyxVQUFVQSxXQUFXLGVBQWU7b0JBQU1lLGlCQUFpQkg7Z0JBQXlCO1lBQ2hKO1FBQ0Y7UUFFQSxxRkFBcUY7UUFDckYsTUFBTSxFQUFFM0gsT0FBTytILFNBQVMsRUFBRSxHQUFHLE1BQU0xSixjQUFjWSxJQUFJLENBQUMsU0FBUytJLE1BQU0sQ0FBQztZQUFFbEUsUUFBUTtRQUFjLEdBQUdpQixFQUFFLENBQUMsTUFBTXBHO1FBQzFHLElBQUlvSixXQUFXO1lBQ2Isc0NBQXNDO1lBQ3RDaEksUUFBUUMsS0FBSyxDQUFDLGtEQUFrRDtnQkFBRXJCO2dCQUFRcUIsT0FBTytILFdBQVdwRztZQUFRO1lBQ3BHLE1BQU05QyxnQkFBZ0IsU0FBU0YsUUFBUTtnQkFBRWdELFNBQVM7Z0JBQTJCM0IsT0FBTytILFVBQVVwRyxPQUFPO1lBQUM7UUFDeEc7UUFFQSwwRUFBMEU7UUFDMUUsSUFBSTBELHFCQUFxQkUsVUFBVSxFQUFFO1lBQ25DLElBQUksQ0FBQ2tCLFlBQVk7Z0JBQ2YsTUFBTTVILGdCQUFnQixXQUFXRixRQUFRLElBQUlaLHNEQUFRQSxDQUFDO29CQUFFMkQsTUFBTTtvQkFBZ0NDLFNBQVM7b0JBQTRCRSxjQUFjO29CQUF3Q0MsVUFBVTtvQkFBVUMsV0FBVztnQkFBSyxHQUFHQyxNQUFNO1lBQ3hPLE9BQU87Z0JBQ0wsTUFBTWlHLE9BQU9uSyxnREFBTUE7Z0JBQ25CLE1BQU1vSyxRQUFRO29CQUFFL0ksSUFBSThJO29CQUFNRSxTQUFTeEo7b0JBQVFVLFdBQVdvSDtvQkFBWTJCLE9BQU87b0JBQWlCdEUsUUFBUTtnQkFBUztnQkFDM0csSUFBSTtvQkFDRixNQUFNLEVBQUU5RCxPQUFPcUksS0FBSyxFQUFFLEdBQUcsTUFBTWhLLGNBQWNZLElBQUksQ0FBQyxXQUFXQyxNQUFNLENBQUNnSjtvQkFDcEUsSUFBSUcsT0FBTzt3QkFDVCxzQ0FBc0M7d0JBQ3RDdEksUUFBUUMsS0FBSyxDQUFDLDZDQUE2Qzs0QkFBRXJCOzRCQUFRcUIsT0FBT3FJLE9BQU8xRzt3QkFBUTt3QkFDM0YsTUFBTTlDLGdCQUFnQixXQUFXRixRQUFRLElBQUlaLHNEQUFRQSxDQUFDOzRCQUFFMkQsTUFBTTs0QkFBMkJDLFNBQVM7NEJBQW1DRSxjQUFjOzRCQUFxRkMsVUFBVTs0QkFBVUMsV0FBVzs0QkFBTTBCLFNBQVM7Z0NBQUVDLE9BQU8yRSxNQUFNMUcsT0FBTzs0QkFBQzt3QkFBRSxHQUFHSyxNQUFNO29CQUMxVDtnQkFDRixFQUFFLE9BQU9sQyxHQUFHO29CQUNWLE1BQU1qQixnQkFBZ0IsV0FBV0YsUUFBUSxJQUFJWixzREFBUUEsQ0FBQzt3QkFBRTJELE1BQU07d0JBQTJCQyxTQUFTO3dCQUFtQ0UsY0FBYzt3QkFBcUZDLFVBQVU7d0JBQVVDLFdBQVc7d0JBQU0wQixTQUFTOzRCQUFFQyxPQUFPLEVBQVcvQixPQUFPO3dCQUFDO29CQUFFLEdBQUdLLE1BQU07Z0JBQy9UO1lBQ0Y7UUFDRjtRQUNBLGlFQUFpRTtRQUNqRSxJQUFJcUQscUJBQXFCRyxTQUFTLEVBQUU7WUFDbEMsa0ZBQWtGO1lBQ2xGLE1BQU04QyxXQUFXakQscUJBQXFCUyxjQUFjLElBQUk7WUFDeEQsTUFBTXlDLFNBQVNsRCxxQkFBcUJVLFlBQVksSUFBSTtZQUNwRCxJQUFJLENBQUN1QyxZQUFZLENBQUNDLFFBQVE7Z0JBQ3hCLE1BQU0xSixnQkFBZ0IsV0FBV0YsUUFBUSxJQUFJWixzREFBUUEsQ0FBQztvQkFBRTJELE1BQU07b0JBQTBCQyxTQUFTO29CQUFxREUsY0FBYztvQkFBK0RDLFVBQVU7b0JBQVVDLFdBQVc7Z0JBQU0sR0FBR0MsTUFBTTtZQUNuUixPQUFPLElBQUksQ0FBQ3lFLFlBQVk7Z0JBQ3RCLE1BQU01SCxnQkFBZ0IsV0FBV0YsUUFBUSxJQUFJWixzREFBUUEsQ0FBQztvQkFBRTJELE1BQU07b0JBQWdDQyxTQUFTO29CQUE0QkUsY0FBYztvQkFBc0NDLFVBQVU7b0JBQVVDLFdBQVc7Z0JBQUssR0FBR0MsTUFBTTtZQUN0TyxPQUFPO2dCQUNMLE1BQU1pRyxPQUFPbkssZ0RBQU1BO2dCQUNuQixNQUFNb0ssUUFBUTtvQkFBRS9JLElBQUk4STtvQkFBTUUsU0FBU3hKO29CQUFRVSxXQUFXb0g7b0JBQVkyQixPQUFPO29CQUE2QnRFLFFBQVE7b0JBQVUwRSxNQUFNO3dCQUFFMUMsZ0JBQWdCd0M7d0JBQVV2QyxjQUFjd0M7b0JBQU87Z0JBQUU7Z0JBQ2pMLElBQUk7b0JBQ0YsTUFBTSxFQUFFdkksT0FBT3FJLEtBQUssRUFBRSxHQUFHLE1BQU1oSyxjQUFjWSxJQUFJLENBQUMsV0FBV0MsTUFBTSxDQUFDZ0o7b0JBQ3BFLElBQUlHLE9BQU87d0JBQ1Qsc0NBQXNDO3dCQUN0Q3RJLFFBQVFDLEtBQUssQ0FBQywyREFBMkQ7NEJBQUVyQjs0QkFBUXFCLE9BQU9xSSxPQUFPMUc7d0JBQVE7d0JBQ3pHLE1BQU05QyxnQkFBZ0IsV0FBV0YsUUFBUSxJQUFJWixzREFBUUEsQ0FBQzs0QkFBRTJELE1BQU07NEJBQTJCQyxTQUFTOzRCQUFpQ0UsY0FBYzs0QkFBaUZDLFVBQVU7NEJBQVVDLFdBQVc7NEJBQU0wQixTQUFTO2dDQUFFQyxPQUFPMkUsTUFBTTFHLE9BQU87NEJBQUM7d0JBQUUsR0FBR0ssTUFBTTtvQkFDcFQ7Z0JBQ0YsRUFBRSxPQUFPbEMsR0FBRztvQkFDVixNQUFNakIsZ0JBQWdCLFdBQVdGLFFBQVEsSUFBSVosc0RBQVFBLENBQUM7d0JBQUUyRCxNQUFNO3dCQUEyQkMsU0FBUzt3QkFBaUNFLGNBQWM7d0JBQWlGQyxVQUFVO3dCQUFVQyxXQUFXO3dCQUFNMEIsU0FBUzs0QkFBRUMsT0FBTyxFQUFXL0IsT0FBTzt3QkFBQztvQkFBRSxHQUFHSyxNQUFNO2dCQUN6VDtZQUNGO1FBQ0Y7UUFFQSxtREFBbUQ7UUFDbkQsSUFBSXFELHFCQUFxQkMsTUFBTSxFQUFFO1lBQy9CLE1BQU1tRCxZQUFZeEQsS0FBS3lELFdBQVc7WUFDbEMsSUFBSSxDQUFDRCxXQUFXO2dCQUNkLE1BQU01SixnQkFBZ0IsU0FBU0YsUUFBUSxJQUFJWixzREFBUUEsQ0FBQztvQkFBRTJELE1BQU07b0JBQTRCQyxTQUFTO29CQUFnREUsY0FBYztvQkFBcURDLFVBQVU7b0JBQVVDLFdBQVc7Z0JBQU0sR0FBR0MsTUFBTTtZQUNwUSxPQUFPO2dCQUNMLElBQUk7b0JBQ0YsTUFBTTNELGNBQWNZLElBQUksQ0FBQyxjQUFjQyxNQUFNLENBQUM7d0JBQUVDLElBQUlyQixnREFBTUE7d0JBQUljO3dCQUFpQlEsU0FBU1g7d0JBQWlCWSxXQUFXWDt3QkFBc0JZLGVBQWU7d0JBQVNDLGFBQWFaO3dCQUFRYSxRQUFRO3dCQUE4QkMsUUFBUTt3QkFBTUMsT0FBTzs0QkFBRWdKLFNBQVNEOzRCQUFXRSxjQUFjLElBQUkvSSxPQUFPQyxXQUFXO3dCQUFHO3dCQUFHRixZQUFZLElBQUlDLE9BQU9DLFdBQVc7b0JBQUc7Z0JBQ3pWLEVBQUUsT0FBT0MsR0FBRyxDQUFFO1lBQ2hCO1FBQ0Y7UUFFQSx1QkFBdUI7UUFDdkIsTUFBTSxFQUFFNkUsTUFBTWlFLGFBQWEsRUFBRTVJLE9BQU82SSxZQUFZLEVBQUUsR0FBRyxNQUFNeEssY0FBY1ksSUFBSSxDQUFDLFNBQVM2RixNQUFNLENBQUMsS0FBS0MsRUFBRSxDQUFDLE1BQU1wRyxRQUFRcUcsS0FBSyxDQUFDO1FBQzFILElBQUk2RCxnQkFBZ0IsQ0FBQ0QsZUFBZSxDQUFDLEVBQUUsRUFBRTtZQUN2QyxzQ0FBc0M7WUFDdEM3SSxRQUFRQyxLQUFLLENBQUMsb0RBQW9EO2dCQUFFckI7Z0JBQVFxQixPQUFPNkksY0FBY2xIO1lBQVE7WUFDekcsTUFBTTdCLElBQUksSUFBSS9CLHNEQUFRQSxDQUFDO2dCQUFFMkQsTUFBTTtnQkFBcUNDLFNBQVM7Z0JBQXNDRSxjQUFjO2dCQUFnRkMsVUFBVTtnQkFBUUMsV0FBVztnQkFBTTBCLFNBQVM7b0JBQUVDLE9BQU9tRixjQUFjbEg7Z0JBQVE7WUFBRTtZQUM5UixNQUFNOUMsZ0JBQWdCLFNBQVNGLFFBQVFtQixFQUFFa0MsTUFBTTtZQUMvQyxNQUFNbEM7UUFDUjtRQUVBLE1BQU1nSixnQkFBZ0JGLGFBQWEsQ0FBQyxFQUFFO1FBQ3RDLElBQUk7WUFDRixNQUFNdkssY0FBY1ksSUFBSSxDQUFDLGNBQWNDLE1BQU0sQ0FBQztnQkFBRUMsSUFBSXJCLGdEQUFNQTtnQkFBSWM7Z0JBQWlCUSxTQUFTWDtnQkFBaUJZLFdBQVdYO2dCQUFzQlksZUFBZTtnQkFBU0MsYUFBYVo7Z0JBQVFhLFFBQVE7Z0JBQVVDLFFBQVE7Z0JBQU1DLE9BQU87b0JBQUUsR0FBR29KLGFBQWE7b0JBQUVDLFFBQVExRDtvQkFBc0IwQjtnQkFBUztnQkFBR3BILFlBQVksSUFBSUMsT0FBT0MsV0FBVztZQUFHO1FBQ25VLEVBQUUsT0FBT21KLFVBQVU7WUFDakIsc0NBQXNDO1lBQ3RDakosUUFBUUMsS0FBSyxDQUFDLGdEQUFnRDtnQkFBRXJCO2dCQUFRcUIsT0FBUWdKLFVBQWtCckg7WUFBUTtZQUMxRyxNQUFNOUMsZ0JBQWdCLGNBQWNGLFFBQVEsSUFBSVosc0RBQVFBLENBQUM7Z0JBQUUyRCxNQUFNO2dCQUEyQkMsU0FBUztnQkFBNkJFLGNBQWM7Z0JBQThEQyxVQUFVO2dCQUFVQyxXQUFXO2dCQUFNMEIsU0FBUztvQkFBRUMsT0FBTyxTQUFrQi9CLE9BQU87Z0JBQUM7WUFBRSxHQUFHSyxNQUFNO1FBQzVTO1FBRUEsc0NBQXNDO1FBQ3RDakMsUUFBUUssR0FBRyxDQUFDLHlDQUF5QztZQUFFekI7UUFBTztRQUM5RCxPQUFPO1lBQUVzSyxTQUFTO1lBQU1kLFNBQVN4SjtRQUFPO0lBQzFDLEVBQUUsT0FBTzhGLEtBQVU7UUFDakIsSUFBSUEsZUFBZTFHLHNEQUFRQSxFQUFFO1lBQzNCLE1BQU1pQixVQUFVeUYsSUFBSXpDLE1BQU07WUFDMUIsSUFBSTtnQkFBRSxNQUFNM0QsY0FBY1ksSUFBSSxDQUFDLGNBQWNDLE1BQU0sQ0FBQztvQkFBRUMsSUFBSXJCLGdEQUFNQTtvQkFBSWM7b0JBQWlCUSxTQUFTWCxtQkFBbUI7b0JBQU1ZLFdBQVdYLHdCQUF3QjtvQkFBTVksZUFBZTtvQkFBU0MsYUFBYVosVUFBVTtvQkFBTWEsUUFBUTtvQkFBU0MsUUFBUTtvQkFBTUMsT0FBT1Y7b0JBQVNXLFlBQVksSUFBSUMsT0FBT0MsV0FBVztnQkFBRztZQUFHLEVBQUUsT0FBT0MsR0FBRyxDQUFFO1lBQzFULE9BQU87Z0JBQUVtSixTQUFTO2dCQUFPakosT0FBTztvQkFBRWIsSUFBSUgsUUFBUUcsRUFBRTtvQkFBRXVDLE1BQU0xQyxRQUFRMEMsSUFBSTtvQkFBRUMsU0FBUzNDLFFBQVE2QyxZQUFZLElBQUk3QyxRQUFRMkMsT0FBTztvQkFBRUcsVUFBVTlDLFFBQVE4QyxRQUFRO2dCQUFDO1lBQUU7UUFDdko7UUFDQSx5Q0FBeUM7UUFDekMsc0NBQXNDO1FBQ3RDL0IsUUFBUUMsS0FBSyxDQUFDLHFDQUFxQ3lFO1FBQ25ELE1BQU15RSxhQUFhLElBQUluTCxzREFBUUEsQ0FBQztZQUFFMkQsTUFBTTtZQUF5QkMsU0FBUzhDLEtBQUs5QyxXQUFXO1lBQW9CRSxjQUFjO1lBQXlEQyxVQUFVO1lBQVlDLFdBQVc7WUFBTTBCLFNBQVM7Z0JBQUUwRixPQUFPMUUsS0FBSzBFO1lBQU07UUFBRTtRQUMzUCxNQUFNbkssVUFBVWtLLFdBQVdsSCxNQUFNO1FBQ2pDLElBQUk7WUFBRSxNQUFNM0QsY0FBY1ksSUFBSSxDQUFDLGNBQWNDLE1BQU0sQ0FBQztnQkFBRUMsSUFBSXJCLGdEQUFNQTtnQkFBSWM7Z0JBQWlCUSxTQUFTO2dCQUFNQyxXQUFXO2dCQUFNQyxlQUFlO2dCQUFTQyxhQUFhO2dCQUFNQyxRQUFRO2dCQUFTQyxRQUFRO2dCQUFNQyxPQUFPVjtnQkFBU1csWUFBWSxJQUFJQyxPQUFPQyxXQUFXO1lBQUc7UUFBRyxFQUFFLE9BQU9DLEdBQUcsQ0FBRTtRQUNyUSxPQUFPO1lBQUVtSixTQUFTO1lBQU9qSixPQUFPO2dCQUFFYixJQUFJSCxRQUFRRyxFQUFFO2dCQUFFdUMsTUFBTTFDLFFBQVEwQyxJQUFJO2dCQUFFQyxTQUFTM0MsUUFBUTZDLFlBQVksSUFBSTdDLFFBQVEyQyxPQUFPO2dCQUFFRyxVQUFVOUMsUUFBUThDLFFBQVE7WUFBQztRQUFFO0lBQ3ZKO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW1pbmktcHJvamVjdC8uL2FwcC9hY3Rpb25zL2NhbGxzL3N0YXJ0Q2FsbEhhbmRsZXIudHM/MmI4MSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJ1xyXG5pbXBvcnQgeyBBcHBFcnJvciB9IGZyb20gJ0AvdHlwZXMvYXBwLWVycm9yJ1xyXG5pbXBvcnQgeyBpc0xpdmVUcmFuc2xhdGlvblByZXZpZXdFbmFibGVkIH0gZnJvbSAnQC9saWIvZW52LXZhbGlkYXRpb24nXHJcblxyXG5jb25zdCBFMTY0X1JFR0VYID0gL15cXCs/WzEtOV1cXGR7MSwxNH0kL1xyXG5cclxuZXhwb3J0IHR5cGUgTW9kdWxhdGlvbnMgPSB7XHJcbiAgcmVjb3JkOiBib29sZWFuXHJcbiAgdHJhbnNjcmliZTogYm9vbGVhblxyXG4gIHRyYW5zbGF0ZT86IGJvb2xlYW5cclxuICBzdXJ2ZXk/OiBib29sZWFuXHJcbiAgc3ludGhldGljX2NhbGxlcj86IGJvb2xlYW5cclxufVxyXG5cclxuZXhwb3J0IHR5cGUgU3RhcnRDYWxsSW5wdXQgPSB7XHJcbiAgb3JnYW5pemF0aW9uX2lkOiBzdHJpbmdcclxuICBmcm9tX251bWJlcj86IHN0cmluZ1xyXG4gIHBob25lX251bWJlcjogc3RyaW5nXHJcbiAgZmxvd190eXBlPzogJ2JyaWRnZScgfCAnb3V0Ym91bmQnXHJcbiAgbW9kdWxhdGlvbnM6IE1vZHVsYXRpb25zXHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIFN0YXJ0Q2FsbERlcHMgPSB7XHJcbiAgc3VwYWJhc2VBZG1pbjogYW55XHJcbiAgc2lnbmFsd2lyZUNhbGw/OiAocGFyYW1zOiB7IGZyb206IHN0cmluZzsgdG86IHN0cmluZzsgdXJsOiBzdHJpbmc7IHN0YXR1c0NhbGxiYWNrOiBzdHJpbmcgfSkgPT4gUHJvbWlzZTx7IGNhbGxfc2lkOiBzdHJpbmcgfT5cclxuICBlbnY/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+XHJcbn1cclxuXHJcbnR5cGUgQXBpUmVzcG9uc2VTdWNjZXNzID0geyBzdWNjZXNzOiB0cnVlOyBjYWxsX2lkOiBzdHJpbmcgfVxyXG50eXBlIEFwaVJlc3BvbnNlRXJyb3IgPSB7IHN1Y2Nlc3M6IGZhbHNlOyBlcnJvcjogYW55IH1cclxudHlwZSBBcGlSZXNwb25zZSA9IEFwaVJlc3BvbnNlU3VjY2VzcyB8IEFwaVJlc3BvbnNlRXJyb3JcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0Q2FsbEhhbmRsZXIoaW5wdXQ6IFN0YXJ0Q2FsbElucHV0LCBkZXBzOiBTdGFydENhbGxEZXBzKTogUHJvbWlzZTxBcGlSZXNwb25zZT4ge1xyXG4gIGNvbnN0IHsgc3VwYWJhc2VBZG1pbiwgc2lnbmFsd2lyZUNhbGwsIGVudiA9IHByb2Nlc3MuZW52IH0gPSBkZXBzXHJcbiAgbGV0IGNhcHR1cmVkQWN0b3JJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcclxuICBsZXQgY2FwdHVyZWRTeXN0ZW1DcGlkSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsXHJcbiAgbGV0IGNhbGxJZDogc3RyaW5nIHwgbnVsbCA9IG51bGxcclxuICAvLyB0cmFjayBvcmdhbml6YXRpb25faWQgaGVyZSBzbyBhdWRpdCBoZWxwZXJzIGFuZCBjYXRjaCBibG9ja3NcclxuICAvLyBhbHdheXMgcmVmZXJlbmNlIHRoZSBlZmZlY3RpdmUgb3JnYW5pemF0aW9uIChhZnRlciBvdmVycmlkZXMpXHJcbiAgbGV0IG9yZ2FuaXphdGlvbl9pZDogc3RyaW5nID0gaW5wdXQub3JnYW5pemF0aW9uX2lkXHJcblxyXG4gIGFzeW5jIGZ1bmN0aW9uIHdyaXRlQXVkaXRFcnJvcihyZXNvdXJjZTogc3RyaW5nLCByZXNvdXJjZUlkOiBzdHJpbmcgfCBudWxsLCBwYXlsb2FkOiBhbnkpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHN1cGFiYXNlQWRtaW4uZnJvbSgnYXVkaXRfbG9ncycpLmluc2VydCh7XHJcbiAgICAgICAgaWQ6IHV1aWR2NCgpLFxyXG4gICAgICAgIG9yZ2FuaXphdGlvbl9pZCxcclxuICAgICAgICB1c2VyX2lkOiBjYXB0dXJlZEFjdG9ySWQsXHJcbiAgICAgICAgc3lzdGVtX2lkOiBjYXB0dXJlZFN5c3RlbUNwaWRJZCxcclxuICAgICAgICByZXNvdXJjZV90eXBlOiByZXNvdXJjZSxcclxuICAgICAgICByZXNvdXJjZV9pZDogcmVzb3VyY2VJZCxcclxuICAgICAgICBhY3Rpb246ICdlcnJvcicsXHJcbiAgICAgICAgYmVmb3JlOiBudWxsLFxyXG4gICAgICAgIGFmdGVyOiBwYXlsb2FkLFxyXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9KVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAvLyBiZXN0LWVmZm9ydFxyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdmYWlsZWQgdG8gd3JpdGUgYXVkaXQgZXJyb3InLCBlKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gaGVscGVyIHRvIHBsYWNlIGEgc2luZ2xlIFNpZ25hbFdpcmUgY2FsbCAocmV0dXJucyBzaWQpXHJcbiAgY29uc3QgcGxhY2VTaWduYWxXaXJlQ2FsbCA9IGFzeW5jICh0b051bWJlcjogc3RyaW5nLCB1c2VMaXZlVHJhbnNsYXRpb246IGJvb2xlYW4gPSBmYWxzZSkgPT4ge1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUubG9nKCdwbGFjZVNpZ25hbFdpcmVDYWxsOiBFTlRFUkVEIGZ1bmN0aW9uJywgeyB0b051bWJlcjogdG9OdW1iZXIgPyAnW1JFREFDVEVEXScgOiBudWxsLCB1c2VMaXZlVHJhbnNsYXRpb24sIGNhbGxJZCB9KVxyXG4gICAgXHJcbiAgICBjb25zdCBzd1Byb2plY3QgPSBlbnYuU0lHTkFMV0lSRV9QUk9KRUNUX0lEXHJcbiAgICBjb25zdCBzd1Rva2VuID0gZW52LlNJR05BTFdJUkVfVE9LRU5cclxuICAgIGNvbnN0IHN3TnVtYmVyID0gZW52LlNJR05BTFdJUkVfTlVNQkVSXHJcbiAgICBjb25zdCByYXdTcGFjZSA9IFN0cmluZyhlbnYuU0lHTkFMV0lSRV9TUEFDRSB8fCAnJylcclxuICAgIGNvbnN0IHN3U3BhY2UgPSByYXdTcGFjZS5yZXBsYWNlKC9eaHR0cHM/OlxcL1xcLy8sICcnKS5yZXBsYWNlKC9cXC8kLywgJycpLnJlcGxhY2UoL1xcLnNpZ25hbHdpcmVcXC5jb20kL2ksICcnKS50cmltKClcclxuXHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgY29uc29sZS5sb2coJ3BsYWNlU2lnbmFsV2lyZUNhbGw6IGV4dHJhY3RlZCBjb25maWcnLCB7IFxyXG4gICAgICBoYXNQcm9qZWN0OiAhIXN3UHJvamVjdCwgXHJcbiAgICAgIGhhc1Rva2VuOiAhIXN3VG9rZW4sIFxyXG4gICAgICBoYXNTcGFjZTogISFzd1NwYWNlLCBcclxuICAgICAgaGFzTnVtYmVyOiAhIXN3TnVtYmVyLFxyXG4gICAgICByYXdTcGFjZTogcmF3U3BhY2UgPyByYXdTcGFjZS5zdWJzdHJpbmcoMCwgMjApICsgJy4uLicgOiBudWxsLFxyXG4gICAgICBleHRyYWN0ZWRTcGFjZTogc3dTcGFjZSB8fCBudWxsXHJcbiAgICB9KVxyXG5cclxuICAgIGlmICghKHN3UHJvamVjdCAmJiBzd1Rva2VuICYmIHN3U3BhY2UgJiYgc3dOdW1iZXIpKSB7XHJcbiAgICAgIC8vIEJ1aWxkIGRldGFpbGVkIGVycm9yIG1lc3NhZ2Ugc2hvd2luZyB3aGF0J3MgbWlzc2luZ1xyXG4gICAgICBjb25zdCBtaXNzaW5nID0gW11cclxuICAgICAgaWYgKCFzd1Byb2plY3QpIG1pc3NpbmcucHVzaCgnU0lHTkFMV0lSRV9QUk9KRUNUX0lEJylcclxuICAgICAgaWYgKCFzd1Rva2VuKSBtaXNzaW5nLnB1c2goJ1NJR05BTFdJUkVfVE9LRU4nKVxyXG4gICAgICBpZiAoIXN3U3BhY2UpIG1pc3NpbmcucHVzaCgnU0lHTkFMV0lSRV9TUEFDRScpXHJcbiAgICAgIGlmICghc3dOdW1iZXIpIG1pc3NpbmcucHVzaCgnU0lHTkFMV0lSRV9OVU1CRVInKVxyXG4gICAgICBcclxuICAgICAgaWYgKGVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICAgICAgY29uc3QgZSA9IG5ldyBBcHBFcnJvcih7IFxyXG4gICAgICAgICAgY29kZTogJ1NJR05BTFdJUkVfQ09ORklHX01JU1NJTkcnLCBcclxuICAgICAgICAgIG1lc3NhZ2U6IGBTaWduYWxXaXJlIGNyZWRlbnRpYWxzIG1pc3Npbmc6ICR7bWlzc2luZy5qb2luKCcsICcpfWAsIFxyXG4gICAgICAgICAgdXNlcl9tZXNzYWdlOiAnU3lzdGVtIGNvbmZpZ3VyYXRpb24gZXJyb3IgLSBwbGVhc2UgY29udGFjdCBzdXBwb3J0JywgXHJcbiAgICAgICAgICBzZXZlcml0eTogJ0NSSVRJQ0FMJywgXHJcbiAgICAgICAgICByZXRyaWFibGU6IGZhbHNlIFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgYXdhaXQgd3JpdGVBdWRpdEVycm9yKCdzeXN0ZW1zJywgbnVsbCwgZS50b0pTT04oKSlcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDUklUSUNBTDogU2lnbmFsV2lyZSBjb25maWcgbWlzc2luZzonLCBtaXNzaW5nLmpvaW4oJywgJykpXHJcbiAgICAgICAgdGhyb3cgZVxyXG4gICAgICB9XHJcbiAgICAgIC8vIG1vY2sgU0lEIGluIG5vbi1wcm9kdWN0aW9uXHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUud2Fybign4pqg77iPIFNpZ25hbFdpcmUgY29uZmlnIGluY29tcGxldGUgKHVzaW5nIG1vY2spOicsIG1pc3Npbmcuam9pbignLCAnKSlcclxuICAgICAgcmV0dXJuIGBtb2NrLSR7dXVpZHY0KCl9YFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGF1dGggPSBCdWZmZXIuZnJvbShgJHtzd1Byb2plY3R9OiR7c3dUb2tlbn1gKS50b1N0cmluZygnYmFzZTY0JylcclxuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKVxyXG4gICAgcGFyYW1zLmFwcGVuZCgnRnJvbScsIHN3TnVtYmVyKVxyXG4gICAgcGFyYW1zLmFwcGVuZCgnVG8nLCB0b051bWJlcilcclxuICAgIFxyXG4gICAgLy8gUm91dGUgdG8gU1dNTCBlbmRwb2ludCBmb3IgbGl2ZSB0cmFuc2xhdGlvbiwgTGFNTCBmb3IgcmVndWxhciBjYWxsc1xyXG4gICAgaWYgKHVzZUxpdmVUcmFuc2xhdGlvbiAmJiBjYWxsSWQpIHtcclxuICAgICAgcGFyYW1zLmFwcGVuZCgnVXJsJywgYCR7ZW52Lk5FWFRfUFVCTElDX0FQUF9VUkx9L2FwaS92b2ljZS9zd21sL291dGJvdW5kP2NhbGxJZD0ke2VuY29kZVVSSUNvbXBvbmVudChjYWxsSWQpfWApXHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUubG9nKCdzdGFydENhbGxIYW5kbGVyOiByb3V0aW5nIHRvIFNXTUwgZW5kcG9pbnQgZm9yIGxpdmUgdHJhbnNsYXRpb24nLCB7IGNhbGxJZCB9KVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcGFyYW1zLmFwcGVuZCgnVXJsJywgYCR7ZW52Lk5FWFRfUFVCTElDX0FQUF9VUkx9L2FwaS92b2ljZS9sYW1sL291dGJvdW5kYClcclxuICAgIH1cclxuICAgIHBhcmFtcy5hcHBlbmQoJ1N0YXR1c0NhbGxiYWNrJywgYCR7ZW52Lk5FWFRfUFVCTElDX0FQUF9VUkx9L2FwaS93ZWJob29rcy9zaWduYWx3aXJlYClcclxuXHJcbiAgICBjb25zdCBzd0VuZHBvaW50ID0gYGh0dHBzOi8vJHtzd1NwYWNlfS5zaWduYWx3aXJlLmNvbS9hcGkvbGFtbC8yMDEwLTA0LTAxL0FjY291bnRzLyR7c3dQcm9qZWN0fS9DYWxscy5qc29uYFxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUubG9nKCdzdGFydENhbGxIYW5kbGVyOiBzZW5kaW5nIFNpZ25hbFdpcmUgUE9TVCcsIHsgZW5kcG9pbnQ6IHN3RW5kcG9pbnQsIHRvOiB0b051bWJlciwgZnJvbTogc3dOdW1iZXIgfSlcclxuXHJcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpXHJcbiAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIDEwMDAwKVxyXG4gICAgbGV0IHN3UmVzXHJcbiAgICB0cnkge1xyXG4gICAgICBzd1JlcyA9IGF3YWl0IGZldGNoKHN3RW5kcG9pbnQsIHtcclxuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICBoZWFkZXJzOiB7ICdBdXRob3JpemF0aW9uJzogYEJhc2ljICR7YXV0aH1gLCAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgfSxcclxuICAgICAgICBib2R5OiBwYXJhbXMsXHJcbiAgICAgICAgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbFxyXG4gICAgICB9KVxyXG4gICAgfSBjYXRjaCAoZmV0Y2hFcnI6IGFueSkge1xyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdzdGFydENhbGxIYW5kbGVyOiBTaWduYWxXaXJlIGZldGNoIGVycm9yJywgeyBlcnJvcjogZmV0Y2hFcnI/Lm1lc3NhZ2UgPz8gU3RyaW5nKGZldGNoRXJyKSB9KVxyXG4gICAgICBjb25zdCBlID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ1NJR05BTFdJUkVfRkVUQ0hfRkFJTEVEJywgbWVzc2FnZTogJ0ZhaWxlZCB0byByZWFjaCBTaWduYWxXaXJlJywgdXNlcl9tZXNzYWdlOiAnRmFpbGVkIHRvIHBsYWNlIGNhbGwgdmlhIGNhcnJpZXInLCBzZXZlcml0eTogJ0hJR0gnLCByZXRyaWFibGU6IHRydWUsIGRldGFpbHM6IHsgY2F1c2U6IGZldGNoRXJyPy5tZXNzYWdlID8/IFN0cmluZyhmZXRjaEVycikgfSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2NhbGxzJywgY2FsbElkLCBlLnRvSlNPTigpKVxyXG4gICAgICB0aHJvdyBlXHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBjbGVhclRpbWVvdXQodGltZW91dClcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXN3UmVzLm9rKSB7XHJcbiAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCBzd1Jlcy50ZXh0KClcclxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgICAgY29uc29sZS5lcnJvcignc3RhcnRDYWxsSGFuZGxlcjogU2lnbmFsV2lyZSBQT1NUIGZhaWxlZCcsIHsgc3RhdHVzOiBzd1Jlcy5zdGF0dXMsIGJvZHk6IHRleHQgfSlcclxuICAgICAgY29uc3QgZSA9IG5ldyBBcHBFcnJvcih7IGNvZGU6ICdTSUdOQUxXSVJFX0FQSV9FUlJPUicsIG1lc3NhZ2U6IGBTaWduYWxXaXJlIEVycm9yOiAke3N3UmVzLnN0YXR1c31gLCB1c2VyX21lc3NhZ2U6ICdGYWlsZWQgdG8gcGxhY2UgY2FsbCB2aWEgY2FycmllcicsIHNldmVyaXR5OiAnSElHSCcsIHJldHJpYWJsZTogdHJ1ZSwgZGV0YWlsczogeyBwcm92aWRlcl9lcnJvcjogdGV4dCB9IH0pXHJcbiAgICAgIGF3YWl0IHdyaXRlQXVkaXRFcnJvcignY2FsbHMnLCBjYWxsSWQsIGUudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzd0RhdGEgPSBhd2FpdCBzd1Jlcy5qc29uKClcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICBjb25zb2xlLmxvZygnc3RhcnRDYWxsSGFuZGxlcjogU2lnbmFsV2lyZSByZXNwb25kZWQnLCB7IHNpZDogc3dEYXRhPy5zaWQgPyAnW1JFREFDVEVEXScgOiBudWxsIH0pXHJcbiAgICByZXR1cm4gc3dEYXRhPy5zaWQgPz8gbnVsbFxyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGxldCB7IGZyb21fbnVtYmVyLCBwaG9uZV9udW1iZXIsIGZsb3dfdHlwZSwgbW9kdWxhdGlvbnMgfSA9IGlucHV0XHJcbiAgICBvcmdhbml6YXRpb25faWQgPSBpbnB1dC5vcmdhbml6YXRpb25faWRcclxuICAgIFxyXG4gICAgLy8gbGlnaHR3ZWlnaHQgdHJhY2luZyBmb3IgZGVidWdnaW5nIGNhbGwgcGxhY2VtZW50IChhdm9pZCBsb2dnaW5nIHNlY3JldHMpXHJcbiAgICAvLyBMb2dzOiBvcmdhbml6YXRpb24gYW5kIHBob25lIHRvIGhlbHAgdHJhY2UgYXR0ZW1wdHMgaW4gcnVudGltZSBsb2dzXHJcbiAgICAvLyBETyBOT1QgbG9nIGNyZWRlbnRpYWxzIG9yIHByb3ZpZGVyIHRva2Vuc1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUubG9nKCdzdGFydENhbGxIYW5kbGVyOiBpbml0aWF0aW5nIGNhbGwnLCB7IG9yZ2FuaXphdGlvbl9pZCwgZnJvbV9udW1iZXIsIHBob25lX251bWJlciwgZmxvd190eXBlLCBtb2R1bGF0aW9ucyB9KVxyXG5cclxuICAgIC8vIGFjdG9yL3Nlc3Npb24gbG9va3VwXHJcbiAgICAvLyBOb3RlOiBTZXNzaW9uIGxvb2t1cCByZW1vdmVkIC0gYWN0b3JJZCBtdXN0IGJlIHByb3ZpZGVkIGluIGlucHV0IG9yIGhhbmRsZWQgYnkgY2FsbGVyXHJcbiAgICBsZXQgYWN0b3JJZCA9IChpbnB1dCBhcyBhbnkpLmFjdG9yX2lkID8/IG51bGxcclxuICAgIGNhcHR1cmVkQWN0b3JJZCA9IGFjdG9ySWRcclxuICAgIGlmICghYWN0b3JJZCkge1xyXG4gICAgICAvLyBhbGxvdyBhIGRldmVsb3Blci90ZXN0aW5nIGZhbGxiYWNrIGFjdG9yIGluIG5vbi1wcm9kdWN0aW9uIHVzaW5nIHRoZVxyXG4gICAgICAvLyBwcm92aWRlZCBVVUlEIHRvIGV4ZXJjaXNlIGZsb3dzIHdpdGhvdXQgYSByZWFsIHNlc3Npb24uXHJcbiAgICAgIGlmIChlbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xyXG4gICAgICAgIGFjdG9ySWQgPSAnMjhkNjhlMDUtYWIyMC00MGVlLWI5MzUtYjE5ZTg5MjdhZTY4J1xyXG4gICAgICAgIGNhcHR1cmVkQWN0b3JJZCA9IGFjdG9ySWRcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICAgIGNvbnNvbGUud2Fybignc3RhcnRDYWxsSGFuZGxlcjogdXNpbmcgZGV2IGZhbGxiYWNrIGFjdG9ySWQnLCB7IGFjdG9ySWQgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBlcnIgPSBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQVVUSF9SRVFVSVJFRCcsIG1lc3NhZ2U6ICdVbmF1dGhlbnRpY2F0ZWQnLCB1c2VyX21lc3NhZ2U6ICdBdXRoZW50aWNhdGlvbiByZXF1aXJlZCcsIHNldmVyaXR5OiAnSElHSCcsIHJldHJpYWJsZTogZmFsc2UgfSlcclxuICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ2FuaXphdGlvbnMnLCBudWxsLCBlcnIudG9KU09OKCkpXHJcbiAgICAgICAgdGhyb3cgZXJyXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBiYXNpYyBvcmcgaWQgZ3VhcmRcclxuICAgIGlmICghL15bMC05YS1mQS1GLV17MzZ9JC8udGVzdChvcmdhbml6YXRpb25faWQpKSB7XHJcbiAgICAgIGNvbnN0IGVyciA9IG5ldyBBcHBFcnJvcih7IGNvZGU6ICdDQUxMX1NUQVJUX0lOVkFMSURfT1JHJywgbWVzc2FnZTogJ0ludmFsaWQgb3JnYW5pemF0aW9uIGlkJywgdXNlcl9tZXNzYWdlOiAnSW52YWxpZCBvcmdhbml6YXRpb24gaWRlbnRpZmllcicsIHNldmVyaXR5OiAnTUVESVVNJywgcmV0cmlhYmxlOiBmYWxzZSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ2FuaXphdGlvbnMnLCBudWxsLCBlcnIudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVyclxyXG4gICAgfVxyXG5cclxuICAgIC8vIG9yZ2FuaXphdGlvbiBsb29rdXBcclxuICAgIGNvbnN0IHsgZGF0YTogb3JnUm93cywgZXJyb3I6IG9yZ0VyciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAuZnJvbSgnb3JnYW5pemF0aW9ucycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLHBsYW4sdG9vbF9pZCcpXHJcbiAgICAgIC5lcSgnaWQnLCBvcmdhbml6YXRpb25faWQpXHJcbiAgICAgIC5saW1pdCgxKVxyXG5cclxuICAgIGlmIChvcmdFcnIpIHtcclxuICAgICAgY29uc3QgZXJyID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfREJfT1JHX0xPT0tVUCcsIG1lc3NhZ2U6ICdPcmdhbml6YXRpb24gbG9va3VwIGZhaWxlZCcsIHVzZXJfbWVzc2FnZTogJ1VuYWJsZSB0byB2ZXJpZnkgb3JnYW5pemF0aW9uLicsIHNldmVyaXR5OiAnSElHSCcsIHJldHJpYWJsZTogdHJ1ZSwgZGV0YWlsczogeyBjYXVzZTogb3JnRXJyLm1lc3NhZ2UgfSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ2FuaXphdGlvbnMnLCBudWxsLCBlcnIudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVyclxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG9yZyA9IG9yZ1Jvd3M/LlswXVxyXG4gICAgaWYgKCFvcmcpIHtcclxuICAgICAgY29uc3QgZXJyID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfT1JHX05PVF9GT1VORCcsIG1lc3NhZ2U6ICdPcmdhbml6YXRpb24gbm90IGZvdW5kJywgdXNlcl9tZXNzYWdlOiAnT3JnYW5pemF0aW9uIG5vdCBmb3VuZC4nLCBzZXZlcml0eTogJ0hJR0gnLCByZXRyaWFibGU6IGZhbHNlIH0pXHJcbiAgICAgIGF3YWl0IHdyaXRlQXVkaXRFcnJvcignb3JnYW5pemF0aW9ucycsIG51bGwsIGVyci50b0pTT04oKSlcclxuICAgICAgdGhyb3cgZXJyXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG9yZy5wbGFuID09PSAnZnJlZScpIHtcclxuICAgICAgY29uc3QgZXJyID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfUExBTl9MSU1JVF9FWENFRURFRCcsIG1lc3NhZ2U6ICdQbGFuIGRvZXMgbm90IHBlcm1pdCBvdXRib3VuZCBjYWxscycsIHVzZXJfbWVzc2FnZTogJ1lvdXIgcGxhbiBkb2VzIG5vdCBhbGxvdyBvdXRib3VuZCBjYWxscy4gUGxlYXNlIHVwZ3JhZGUuJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiBmYWxzZSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ2FuaXphdGlvbnMnLCBvcmcuaWQsIGVyci50b0pTT04oKSlcclxuICAgICAgdGhyb3cgZXJyXHJcbiAgICB9XHJcblxyXG4gICAgLy8gbWVtYmVyc2hpcCBjaGVja1xyXG4gICAgY29uc3QgeyBkYXRhOiBtZW1iZXJzaGlwUm93cywgZXJyb3I6IG1lbWJlcnNoaXBFcnIgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cclxuICAgICAgLmZyb20oJ29yZ19tZW1iZXJzJylcclxuICAgICAgLnNlbGVjdCgnaWQscm9sZScpXHJcbiAgICAgIC5lcSgnb3JnYW5pemF0aW9uX2lkJywgb3JnYW5pemF0aW9uX2lkKVxyXG4gICAgICAuZXEoJ3VzZXJfaWQnLCBhY3RvcklkKVxyXG4gICAgICAubGltaXQoMSlcclxuXHJcbiAgICBpZiAobWVtYmVyc2hpcEVycikge1xyXG4gICAgICBjb25zdCBlcnIgPSBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQVVUSF9NRU1CRVJTSElQX0xPT0tVUF9GQUlMRUQnLCBtZXNzYWdlOiAnTWVtYmVyc2hpcCBsb29rdXAgZmFpbGVkJywgdXNlcl9tZXNzYWdlOiAnVW5hYmxlIHRvIHZlcmlmeSBtZW1iZXJzaGlwJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiBtZW1iZXJzaGlwRXJyLm1lc3NhZ2UgfSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ19tZW1iZXJzJywgbnVsbCwgZXJyLnRvSlNPTigpKVxyXG4gICAgICB0aHJvdyBlcnJcclxuICAgIH1cclxuXHJcbiAgICAvLyBlbmZvcmNlIGNhbm9uaWNhbCBtb2R1bGF0aW9ucyBmcm9tIHZvaWNlX2NvbmZpZ3MgKGRvIE5PVCBhbGxvdyBjbGllbnQgb3ZlcnJpZGUpXHJcbiAgICAvLyBkZWZhdWx0IHRvIGNvbnNlcnZhdGl2ZSAoYWxsIGZhbHNlKSB3aGVuIG5vIGNvbmZpZyBwcmVzZW50XHJcbiAgICBsZXQgZWZmZWN0aXZlTW9kdWxhdGlvbnM6IE1vZHVsYXRpb25zICYgeyB0cmFuc2xhdGVfZnJvbT86IHN0cmluZyB8IG51bGw7IHRyYW5zbGF0ZV90bz86IHN0cmluZyB8IG51bGwgfSA9IHsgcmVjb3JkOiBmYWxzZSwgdHJhbnNjcmliZTogZmFsc2UsIHRyYW5zbGF0ZTogZmFsc2UgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBkYXRhOiB2Y1Jvd3MsIGVycm9yOiB2Y0VyciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKCd2b2ljZV9jb25maWdzJykuc2VsZWN0KCdyZWNvcmQsdHJhbnNjcmliZSx0cmFuc2xhdGUsdHJhbnNsYXRlX2Zyb20sdHJhbnNsYXRlX3RvLHN1cnZleSxzeW50aGV0aWNfY2FsbGVyJykuZXEoJ29yZ2FuaXphdGlvbl9pZCcsIG9yZ2FuaXphdGlvbl9pZCkubGltaXQoMSlcclxuICAgICAgaWYgKCF2Y0VyciAmJiB2Y1Jvd3MgJiYgdmNSb3dzWzBdKSB7XHJcbiAgICAgICAgY29uc3QgY2ZnOiBhbnkgPSB2Y1Jvd3NbMF1cclxuICAgICAgICBlZmZlY3RpdmVNb2R1bGF0aW9ucy5yZWNvcmQgPSAhIWNmZy5yZWNvcmRcclxuICAgICAgICBlZmZlY3RpdmVNb2R1bGF0aW9ucy50cmFuc2NyaWJlID0gISFjZmcudHJhbnNjcmliZVxyXG4gICAgICAgIGVmZmVjdGl2ZU1vZHVsYXRpb25zLnRyYW5zbGF0ZSA9ICEhY2ZnLnRyYW5zbGF0ZVxyXG4gICAgICAgIGVmZmVjdGl2ZU1vZHVsYXRpb25zLnN1cnZleSA9ICEhY2ZnLnN1cnZleVxyXG4gICAgICAgIGVmZmVjdGl2ZU1vZHVsYXRpb25zLnN5bnRoZXRpY19jYWxsZXIgPSAhIWNmZy5zeW50aGV0aWNfY2FsbGVyXHJcbiAgICAgICAgaWYgKHR5cGVvZiBjZmcudHJhbnNsYXRlX2Zyb20gPT09ICdzdHJpbmcnKSBlZmZlY3RpdmVNb2R1bGF0aW9ucy50cmFuc2xhdGVfZnJvbSA9IGNmZy50cmFuc2xhdGVfZnJvbVxyXG4gICAgICAgIGlmICh0eXBlb2YgY2ZnLnRyYW5zbGF0ZV90byA9PT0gJ3N0cmluZycpIGVmZmVjdGl2ZU1vZHVsYXRpb25zLnRyYW5zbGF0ZV90byA9IGNmZy50cmFuc2xhdGVfdG9cclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAvLyBiZXN0LWVmZm9ydDogaWYgdm9pY2VfY29uZmlncyBhYnNlbnQgb3IgbG9va3VwIGZhaWxzLCBrZWVwIGNvbnNlcnZhdGl2ZSBkZWZhdWx0c1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghbWVtYmVyc2hpcFJvd3MgfHwgbWVtYmVyc2hpcFJvd3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnN0IGVyciA9IG5ldyBBcHBFcnJvcih7IGNvZGU6ICdBVVRIX09SR19NSVNNQVRDSCcsIG1lc3NhZ2U6ICdBY3RvciBub3QgYXV0aG9yaXplZCBmb3Igb3JnYW5pemF0aW9uJywgdXNlcl9tZXNzYWdlOiAnTm90IGF1dGhvcml6ZWQgZm9yIHRoaXMgb3JnYW5pemF0aW9uJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiBmYWxzZSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ29yZ19tZW1iZXJzJywgbnVsbCwgZXJyLnRvSlNPTigpKVxyXG4gICAgICB0aHJvdyBlcnJcclxuICAgIH1cclxuXHJcbiAgICAvLyBwaG9uZSB2YWxpZGF0aW9uXHJcbiAgICBpZiAoIUUxNjRfUkVHRVgudGVzdChwaG9uZV9udW1iZXIpKSB7XHJcbiAgICAgIGNvbnN0IGVyciA9IG5ldyBBcHBFcnJvcih7IGNvZGU6ICdDQUxMX1NUQVJUX0lOVkFMSURfUEhPTkUnLCBtZXNzYWdlOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgZm9ybWF0JywgdXNlcl9tZXNzYWdlOiAnVGhlIHBob25lIG51bWJlciBwcm92aWRlZCBpcyBpbnZhbGlkLiBQbGVhc2UgdmVyaWZ5IGFuZCB0cnkgYWdhaW4uJywgc2V2ZXJpdHk6ICdNRURJVU0nLCByZXRyaWFibGU6IGZhbHNlIH0pXHJcbiAgICAgIGF3YWl0IHdyaXRlQXVkaXRFcnJvcignY2FsbHMnLCBudWxsLCBlcnIudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVyclxyXG4gICAgfVxyXG5cclxuICAgIC8vIHN5c3RlbXMgbG9va3VwXHJcbiAgICBjb25zdCB7IGRhdGE6IHN5c3RlbXNSb3dzLCBlcnJvcjogc3lzdGVtc0VyciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAuZnJvbSgnc3lzdGVtcycpXHJcbiAgICAgIC5zZWxlY3QoJ2lkLGtleScpXHJcbiAgICAgIC5pbigna2V5JywgWydzeXN0ZW0tY3BpZCcsICdzeXN0ZW0tYWknXSlcclxuXHJcbiAgICBpZiAoc3lzdGVtc0Vycikge1xyXG4gICAgICBjb25zdCBlID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfU1lTX0xPT0tVUF9GQUlMRUQnLCBtZXNzYWdlOiAnU3lzdGVtIGxvb2t1cCBmYWlsZWQnLCB1c2VyX21lc3NhZ2U6ICdTZXJ2aWNlIGVycm9yJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiBzeXN0ZW1zRXJyLm1lc3NhZ2UgfSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ3N5c3RlbXMnLCBudWxsLCBlLnRvSlNPTigpKVxyXG4gICAgICB0aHJvdyBlXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3lzdGVtTWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge31cclxuICAgIDsoc3lzdGVtc1Jvd3MgfHwgW10pLmZvckVhY2goKHM6IGFueSkgPT4geyBzeXN0ZW1NYXBbcy5rZXldID0gcy5pZCB9KVxyXG4gICAgY29uc3Qgc3lzdGVtQ3BpZElkID0gc3lzdGVtTWFwWydzeXN0ZW0tY3BpZCddID8/IG51bGxcclxuICAgIGNvbnN0IHN5c3RlbUFpSWQgPSBzeXN0ZW1NYXBbJ3N5c3RlbS1haSddID8/IG51bGxcclxuICAgIGNhcHR1cmVkU3lzdGVtQ3BpZElkID0gc3lzdGVtQ3BpZElkXHJcbiAgICBpZiAoIXN5c3RlbUNwaWRJZCkge1xyXG4gICAgICBjb25zdCBlID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfU1lTX01JU1NJTkcnLCBtZXNzYWdlOiAnQ29udHJvbCBzeXN0ZW0gbm90IHJlZ2lzdGVyZWQnLCB1c2VyX21lc3NhZ2U6J1NlcnZpY2UgbWlzY29uZmlndXJhdGlvbicsIHNldmVyaXR5OidISUdIJywgcmV0cmlhYmxlOmZhbHNlIH0pXHJcbiAgICAgIGF3YWl0IHdyaXRlQXVkaXRFcnJvcignc3lzdGVtcycsIG51bGwsIGUudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVcclxuICAgIH1cclxuXHJcbiAgICAvLyBpbnNlcnQgY2FsbHMgcm93XHJcbiAgICBjYWxsSWQgPSB1dWlkdjQoKVxyXG4gICAgY29uc3QgY2FsbFJvdyA9IHtcclxuICAgICAgaWQ6IGNhbGxJZCxcclxuICAgICAgb3JnYW5pemF0aW9uX2lkLFxyXG4gICAgICBzeXN0ZW1faWQ6IHN5c3RlbUNwaWRJZCxcclxuICAgICAgc3RhdHVzOiAncGVuZGluZycsXHJcbiAgICAgIHN0YXJ0ZWRfYXQ6IG51bGwsXHJcbiAgICAgIGVuZGVkX2F0OiBudWxsLFxyXG4gICAgICBjcmVhdGVkX2J5OiBhY3RvcklkXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBlcnJvcjogaW5zZXJ0RXJyIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2NhbGxzJykuaW5zZXJ0KGNhbGxSb3cpXHJcbiAgICBpZiAoaW5zZXJ0RXJyKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3N0YXJ0Q2FsbEhhbmRsZXI6IGZhaWxlZCB0byBpbnNlcnQgY2FsbCByb3cnLCB7IGNhbGxJZCwgZXJyb3I6IGluc2VydEVycj8ubWVzc2FnZSB9KVxyXG4gICAgICBjb25zdCBlID0gbmV3IEFwcEVycm9yKHsgY29kZTogJ0NBTExfU1RBUlRfREJfSU5TRVJUJywgbWVzc2FnZTogJ0ZhaWxlZCB0byBjcmVhdGUgY2FsbCByZWNvcmQnLCB1c2VyX21lc3NhZ2U6ICdXZSBlbmNvdW50ZXJlZCBhIHN5c3RlbSBlcnJvciB3aGlsZSBzdGFydGluZyB5b3VyIGNhbGwuIFBsZWFzZSB0cnkgYWdhaW4uJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiBpbnNlcnRFcnIubWVzc2FnZSB9IH0pXHJcbiAgICAgIGF3YWl0IHdyaXRlQXVkaXRFcnJvcignY2FsbHMnLCBjYWxsSWQsIGUudG9KU09OKCkpXHJcbiAgICAgIHRocm93IGVcclxuICAgIH1cclxuXHJcbiAgICBcclxuXHJcbiAgICAvLyBleGVjdXRlIFNpZ25hbFdpcmUgKHZpYSBpbmplY3RlZCBjYWxsZXIgaWYgYXZhaWxhYmxlKVxyXG4gICAgbGV0IGNhbGxfc2lkOiBzdHJpbmcgfCBudWxsID0gbnVsbFxyXG4gICAgaWYgKHNpZ25hbHdpcmVDYWxsKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUubG9nKCdzdGFydENhbGxIYW5kbGVyOiB1c2luZyBpbmplY3RlZCBzaWduYWx3aXJlQ2FsbCB0byBwbGFjZSBvdXRib3VuZCBjYWxsJylcclxuICAgICAgaWYgKGZsb3dfdHlwZSA9PT0gJ2JyaWRnZScgJiYgZnJvbV9udW1iZXIgJiYgRTE2NF9SRUdFWC50ZXN0KGZyb21fbnVtYmVyKSkge1xyXG4gICAgICAgIC8vIHBsYWNlIHR3byBsZWdzOiBhZ2VudCBsZWcgdGhlbiBkZXN0aW5hdGlvbiBsZWdcclxuICAgICAgICBjb25zdCBzaWRBID0gYXdhaXQgc2lnbmFsd2lyZUNhbGwoeyBmcm9tOiBTdHJpbmcoZW52LlNJR05BTFdJUkVfTlVNQkVSIHx8ICcnKSwgdG86IGZyb21fbnVtYmVyLCB1cmw6IFN0cmluZyhlbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCkgKyAnL2FwaS92b2ljZS9sYW1sL291dGJvdW5kJywgc3RhdHVzQ2FsbGJhY2s6IFN0cmluZyhlbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCkgKyAnL2FwaS93ZWJob29rcy9zaWduYWx3aXJlJyB9KVxyXG4gICAgICAgIGNvbnN0IHNpZEIgPSBhd2FpdCBzaWduYWx3aXJlQ2FsbCh7IGZyb206IFN0cmluZyhlbnYuU0lHTkFMV0lSRV9OVU1CRVIgfHwgJycpLCB0bzogcGhvbmVfbnVtYmVyLCB1cmw6IFN0cmluZyhlbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCkgKyAnL2FwaS92b2ljZS9sYW1sL291dGJvdW5kJywgc3RhdHVzQ2FsbGJhY2s6IFN0cmluZyhlbnYuTkVYVF9QVUJMSUNfQVBQX1VSTCkgKyAnL2FwaS93ZWJob29rcy9zaWduYWx3aXJlJyB9KVxyXG4gICAgICAgIGNhbGxfc2lkID0gc2lkQi5jYWxsX3NpZFxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgICAgY29uc29sZS5sb2coJ3N0YXJ0Q2FsbEhhbmRsZXI6IGluamVjdGVkIHNpZ25hbHdpcmVDYWxsIGJyaWRnZSBjcmVhdGVkJywgeyBhOiBzaWRBLmNhbGxfc2lkID8gJ1tSRURBQ1RFRF0nIDogbnVsbCwgYjogc2lkQi5jYWxsX3NpZCA/ICdbUkVEQUNURURdJyA6IG51bGwgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBzdyA9IGF3YWl0IHNpZ25hbHdpcmVDYWxsKHsgZnJvbTogU3RyaW5nKGVudi5TSUdOQUxXSVJFX05VTUJFUiB8fCAnJyksIHRvOiBwaG9uZV9udW1iZXIsIHVybDogU3RyaW5nKGVudi5ORVhUX1BVQkxJQ19BUFBfVVJMKSArICcvYXBpL3ZvaWNlL2xhbWwvb3V0Ym91bmQnLCBzdGF0dXNDYWxsYmFjazogU3RyaW5nKGVudi5ORVhUX1BVQkxJQ19BUFBfVVJMKSArICcvYXBpL3dlYmhvb2tzL3NpZ25hbHdpcmUnIH0pXHJcbiAgICAgICAgY2FsbF9zaWQgPSBzdy5jYWxsX3NpZFxyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgICAgY29uc29sZS5sb2coJ3N0YXJ0Q2FsbEhhbmRsZXI6IGluamVjdGVkIHNpZ25hbHdpcmVDYWxsIHJldHVybmVkJywgeyBjYWxsX3NpZDogY2FsbF9zaWQgPyAnW1JFREFDVEVEXScgOiBudWxsIH0pXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIG5vIGluamVjdGVkIGNhbGxlcjogdXNlIHNoYXJlZCBoZWxwZXIgd2hpY2ggaGFuZGxlcyBjb25maWcgYW5kIG1vY2tzXHJcbiAgICAgIC8vIENoZWNrIGlmIGxpdmUgdHJhbnNsYXRpb24gc2hvdWxkIGJlIGVuYWJsZWQgKEJ1c2luZXNzIHBsYW4gKyBmZWF0dXJlIGZsYWcgKyB0cmFuc2xhdGUgZW5hYmxlZClcclxuICAgICAgY29uc3QgcGxhbiA9IFN0cmluZyhvcmcucGxhbiA/PyAnJykudG9Mb3dlckNhc2UoKVxyXG4gICAgICBjb25zdCBpc0J1c2luZXNzUGxhbiA9IFsnYnVzaW5lc3MnLCAnZW50ZXJwcmlzZSddLmluY2x1ZGVzKHBsYW4pXHJcbiAgICAgIGNvbnN0IGlzRmVhdHVyZUZsYWdFbmFibGVkID0gaXNMaXZlVHJhbnNsYXRpb25QcmV2aWV3RW5hYmxlZCgpXHJcbiAgICAgIGNvbnN0IHNob3VsZFVzZUxpdmVUcmFuc2xhdGlvbiA9IGlzQnVzaW5lc3NQbGFuICYmIGlzRmVhdHVyZUZsYWdFbmFibGVkICYmIGVmZmVjdGl2ZU1vZHVsYXRpb25zLnRyYW5zbGF0ZSA9PT0gdHJ1ZSAmJiAhIWVmZmVjdGl2ZU1vZHVsYXRpb25zLnRyYW5zbGF0ZV9mcm9tICYmICEhZWZmZWN0aXZlTW9kdWxhdGlvbnMudHJhbnNsYXRlX3RvXHJcbiAgICAgIFxyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLmxvZygnc3RhcnRDYWxsSGFuZGxlcjogYWJvdXQgdG8gcGxhY2UgU2lnbmFsV2lyZSBjYWxsJywgeyBcclxuICAgICAgICBmbG93X3R5cGUsIFxyXG4gICAgICAgIGhhc19mcm9tX251bWJlcjogISFmcm9tX251bWJlciwgXHJcbiAgICAgICAgZnJvbV9udW1iZXJfdmFsaWQ6IGZyb21fbnVtYmVyID8gRTE2NF9SRUdFWC50ZXN0KGZyb21fbnVtYmVyKSA6IGZhbHNlLFxyXG4gICAgICAgIHNob3VsZFVzZUxpdmVUcmFuc2xhdGlvbixcclxuICAgICAgICBwbGFuLFxyXG4gICAgICAgIGlzQnVzaW5lc3NQbGFuLFxyXG4gICAgICAgIGlzRmVhdHVyZUZsYWdFbmFibGVkXHJcbiAgICAgIH0pXHJcbiAgICAgIFxyXG4gICAgICBpZiAoZmxvd190eXBlID09PSAnYnJpZGdlJyAmJiBmcm9tX251bWJlciAmJiBFMTY0X1JFR0VYLnRlc3QoZnJvbV9udW1iZXIpKSB7XHJcbiAgICAgICAgLy8gQnJpZGdlIGNhbGxzIGRvbid0IHN1cHBvcnQgbGl2ZSB0cmFuc2xhdGlvbiAoY29tcGxleGl0eSlcclxuICAgICAgICBjb25zdCBzaWRBID0gYXdhaXQgcGxhY2VTaWduYWxXaXJlQ2FsbChmcm9tX251bWJlciwgZmFsc2UpXHJcbiAgICAgICAgY29uc3Qgc2lkQiA9IGF3YWl0IHBsYWNlU2lnbmFsV2lyZUNhbGwocGhvbmVfbnVtYmVyLCBmYWxzZSlcclxuICAgICAgICBjYWxsX3NpZCA9IHNpZEJcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzdGFydENhbGxIYW5kbGVyOiBzaWduYWx3aXJlIGJyaWRnZSBjcmVhdGVkJywgeyBhOiBzaWRBID8gJ1tSRURBQ1RFRF0nIDogbnVsbCwgYjogc2lkQiA/ICdbUkVEQUNURURdJyA6IG51bGwgfSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjYWxsX3NpZCA9IGF3YWl0IHBsYWNlU2lnbmFsV2lyZUNhbGwocGhvbmVfbnVtYmVyLCBzaG91bGRVc2VMaXZlVHJhbnNsYXRpb24pXHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgICAgICBjb25zb2xlLmxvZygnc3RhcnRDYWxsSGFuZGxlcjogc2lnbmFsd2lyZSBjYWxsIHBsYWNlZCcsIHsgY2FsbF9zaWQ6IGNhbGxfc2lkID8gJ1tSRURBQ1RFRF0nIDogbnVsbCwgbGl2ZVRyYW5zbGF0aW9uOiBzaG91bGRVc2VMaXZlVHJhbnNsYXRpb24gfSlcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIHVwZGF0ZSBwZXJzaXN0ZWQgY2FsbCBzdGF0dXMgb25seSAoZG8gTk9UIHdyaXRlIGNhbGxfc2lkIHBlciBUT09MX1RBQkxFX0FMSUdOTUVOVClcclxuICAgIGNvbnN0IHsgZXJyb3I6IHVwZGF0ZUVyciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKCdjYWxscycpLnVwZGF0ZSh7IHN0YXR1czogJ2luLXByb2dyZXNzJyB9KS5lcSgnaWQnLCBjYWxsSWQpXHJcbiAgICBpZiAodXBkYXRlRXJyKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3N0YXJ0Q2FsbEhhbmRsZXI6IGZhaWxlZCB0byB1cGRhdGUgY2FsbCBzdGF0dXMnLCB7IGNhbGxJZCwgZXJyb3I6IHVwZGF0ZUVycj8ubWVzc2FnZSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2NhbGxzJywgY2FsbElkLCB7IG1lc3NhZ2U6ICdGYWlsZWQgdG8gc2F2ZSBjYWxsX3NpZCcsIGVycm9yOiB1cGRhdGVFcnIubWVzc2FnZSB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGVucXVldWUgYWkgcnVuIGlmIHJlcXVlc3RlZCAoZHJpdmVuIGJ5IHZvaWNlX2NvbmZpZ3MsIG5vdCBjbGllbnQgaW5wdXQpXHJcbiAgICBpZiAoZWZmZWN0aXZlTW9kdWxhdGlvbnMudHJhbnNjcmliZSkge1xyXG4gICAgICBpZiAoIXN5c3RlbUFpSWQpIHtcclxuICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ3N5c3RlbXMnLCBjYWxsSWQsIG5ldyBBcHBFcnJvcih7IGNvZGU6ICdDQUxMX1NUQVJUX0FJX1NZU1RFTV9NSVNTSU5HJywgbWVzc2FnZTogJ0FJIHN5c3RlbSBub3QgcmVnaXN0ZXJlZCcsIHVzZXJfbWVzc2FnZTogJ1RyYW5zY3JpcHRpb24gdW5hdmFpbGFibGUgcmlnaHQgbm93LicsIHNldmVyaXR5OiAnTUVESVVNJywgcmV0cmlhYmxlOiB0cnVlIH0pLnRvSlNPTigpKVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGFpSWQgPSB1dWlkdjQoKVxyXG4gICAgICAgIGNvbnN0IGFpUm93ID0geyBpZDogYWlJZCwgY2FsbF9pZDogY2FsbElkLCBzeXN0ZW1faWQ6IHN5c3RlbUFpSWQsIG1vZGVsOiAnYXNzZW1ibHlhaS12MScsIHN0YXR1czogJ3F1ZXVlZCcgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCB7IGVycm9yOiBhaUVyciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKCdhaV9ydW5zJykuaW5zZXJ0KGFpUm93KVxyXG4gICAgICAgICAgaWYgKGFpRXJyKSB7XHJcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3N0YXJ0Q2FsbEhhbmRsZXI6IGZhaWxlZCB0byBpbnNlcnQgYWlfcnVuJywgeyBjYWxsSWQsIGVycm9yOiBhaUVycj8ubWVzc2FnZSB9KVxyXG4gICAgICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2FpX3J1bnMnLCBjYWxsSWQsIG5ldyBBcHBFcnJvcih7IGNvZGU6ICdBSV9UUkFOU0NfSU5TRVJUX0ZBSUxFRCcsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZW5xdWV1ZSB0cmFuc2NyaXB0aW9uJywgdXNlcl9tZXNzYWdlOiAnVHJhbnNjcmlwdGlvbiBjb3VsZCBub3QgYmUgc3RhcnRlZC4gVGhlIGNhbGwgd2lsbCBjb250aW51ZSB3aXRob3V0IHRyYW5zY3JpcHRpb24uJywgc2V2ZXJpdHk6ICdNRURJVU0nLCByZXRyaWFibGU6IHRydWUsIGRldGFpbHM6IHsgY2F1c2U6IGFpRXJyLm1lc3NhZ2UgfSB9KS50b0pTT04oKSlcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2FpX3J1bnMnLCBjYWxsSWQsIG5ldyBBcHBFcnJvcih7IGNvZGU6ICdBSV9UUkFOU0NfSU5TRVJUX0ZBSUxFRCcsIG1lc3NhZ2U6ICdGYWlsZWQgdG8gZW5xdWV1ZSB0cmFuc2NyaXB0aW9uJywgdXNlcl9tZXNzYWdlOiAnVHJhbnNjcmlwdGlvbiBjb3VsZCBub3QgYmUgc3RhcnRlZC4gVGhlIGNhbGwgd2lsbCBjb250aW51ZSB3aXRob3V0IHRyYW5zY3JpcHRpb24uJywgc2V2ZXJpdHk6ICdNRURJVU0nLCByZXRyaWFibGU6IHRydWUsIGRldGFpbHM6IHsgY2F1c2U6IChlIGFzIGFueSkubWVzc2FnZSB9IH0pLnRvSlNPTigpKVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gZW5xdWV1ZSB0cmFuc2xhdGlvbiBydW4gaWYgcmVxdWVzdGVkIChkcml2ZW4gYnkgdm9pY2VfY29uZmlncylcclxuICAgIGlmIChlZmZlY3RpdmVNb2R1bGF0aW9ucy50cmFuc2xhdGUpIHtcclxuICAgICAgLy8gcmVxdWlyZSBsYW5ndWFnZXMgdG8gYmUgcHJlc2VudDsgaWYgbWlzc2luZywgcmVjb3JkIGFuIGF1ZGl0IGFuZCBza2lwIGVucXVldWluZ1xyXG4gICAgICBjb25zdCBmcm9tTGFuZyA9IGVmZmVjdGl2ZU1vZHVsYXRpb25zLnRyYW5zbGF0ZV9mcm9tID8/IG51bGxcclxuICAgICAgY29uc3QgdG9MYW5nID0gZWZmZWN0aXZlTW9kdWxhdGlvbnMudHJhbnNsYXRlX3RvID8/IG51bGxcclxuICAgICAgaWYgKCFmcm9tTGFuZyB8fCAhdG9MYW5nKSB7XHJcbiAgICAgICAgYXdhaXQgd3JpdGVBdWRpdEVycm9yKCdhaV9ydW5zJywgY2FsbElkLCBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQUlfVFJBTlNMX0xBTkdfTUlTU0lORycsIG1lc3NhZ2U6ICdUcmFuc2xhdGlvbiBjb25maWd1cmVkIGJ1dCBsYW5ndWFnZSBjb2RlcyBtaXNzaW5nJywgdXNlcl9tZXNzYWdlOiAnVHJhbnNsYXRpb24gY29uZmlndXJhdGlvbiBpbmNvbXBsZXRlOyBza2lwcGluZyB0cmFuc2xhdGlvbi4nLCBzZXZlcml0eTogJ01FRElVTScsIHJldHJpYWJsZTogZmFsc2UgfSkudG9KU09OKCkpXHJcbiAgICAgIH0gZWxzZSBpZiAoIXN5c3RlbUFpSWQpIHtcclxuICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ3N5c3RlbXMnLCBjYWxsSWQsIG5ldyBBcHBFcnJvcih7IGNvZGU6ICdDQUxMX1NUQVJUX0FJX1NZU1RFTV9NSVNTSU5HJywgbWVzc2FnZTogJ0FJIHN5c3RlbSBub3QgcmVnaXN0ZXJlZCcsIHVzZXJfbWVzc2FnZTogJ1RyYW5zbGF0aW9uIHVuYXZhaWxhYmxlIHJpZ2h0IG5vdy4nLCBzZXZlcml0eTogJ01FRElVTScsIHJldHJpYWJsZTogdHJ1ZSB9KS50b0pTT04oKSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBhaUlkID0gdXVpZHY0KClcclxuICAgICAgICBjb25zdCBhaVJvdyA9IHsgaWQ6IGFpSWQsIGNhbGxfaWQ6IGNhbGxJZCwgc3lzdGVtX2lkOiBzeXN0ZW1BaUlkLCBtb2RlbDogJ2Fzc2VtYmx5YWktdHJhbnNsYXRpb24tdjEnLCBzdGF0dXM6ICdxdWV1ZWQnLCBtZXRhOiB7IHRyYW5zbGF0ZV9mcm9tOiBmcm9tTGFuZywgdHJhbnNsYXRlX3RvOiB0b0xhbmcgfSB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGNvbnN0IHsgZXJyb3I6IGFpRXJyIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2FpX3J1bnMnKS5pbnNlcnQoYWlSb3cpXHJcbiAgICAgICAgICBpZiAoYWlFcnIpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignc3RhcnRDYWxsSGFuZGxlcjogZmFpbGVkIHRvIGluc2VydCBhaV9ydW4gKHRyYW5zbGF0aW9uKScsIHsgY2FsbElkLCBlcnJvcjogYWlFcnI/Lm1lc3NhZ2UgfSlcclxuICAgICAgICAgICAgYXdhaXQgd3JpdGVBdWRpdEVycm9yKCdhaV9ydW5zJywgY2FsbElkLCBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQUlfVFJBTlNMX0lOU0VSVF9GQUlMRUQnLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGVucXVldWUgdHJhbnNsYXRpb24nLCB1c2VyX21lc3NhZ2U6ICdUcmFuc2xhdGlvbiBjb3VsZCBub3QgYmUgc3RhcnRlZC4gVGhlIGNhbGwgd2lsbCBjb250aW51ZSB3aXRob3V0IHRyYW5zbGF0aW9uLicsIHNldmVyaXR5OiAnTUVESVVNJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiBhaUVyci5tZXNzYWdlIH0gfSkudG9KU09OKCkpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgYXdhaXQgd3JpdGVBdWRpdEVycm9yKCdhaV9ydW5zJywgY2FsbElkLCBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQUlfVFJBTlNMX0lOU0VSVF9GQUlMRUQnLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGVucXVldWUgdHJhbnNsYXRpb24nLCB1c2VyX21lc3NhZ2U6ICdUcmFuc2xhdGlvbiBjb3VsZCBub3QgYmUgc3RhcnRlZC4gVGhlIGNhbGwgd2lsbCBjb250aW51ZSB3aXRob3V0IHRyYW5zbGF0aW9uLicsIHNldmVyaXR5OiAnTUVESVVNJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiAoZSBhcyBhbnkpLm1lc3NhZ2UgfSB9KS50b0pTT04oKSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyByZWNvcmRpbmcgaW50ZW50IGF1ZGl0IChkcml2ZW4gYnkgdm9pY2VfY29uZmlncylcclxuICAgIGlmIChlZmZlY3RpdmVNb2R1bGF0aW9ucy5yZWNvcmQpIHtcclxuICAgICAgY29uc3Qgb3JnVG9vbElkID0gb3JnPy50b29sX2lkID8/IG51bGxcclxuICAgICAgaWYgKCFvcmdUb29sSWQpIHtcclxuICAgICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2NhbGxzJywgY2FsbElkLCBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnUkVDT1JESU5HX1RPT0xfTk9UX0ZPVU5EJywgbWVzc2FnZTogJ05vIHJlY29yZGluZyB0b29sIGF2YWlsYWJsZSBmb3Igb3JnYW5pemF0aW9uJywgdXNlcl9tZXNzYWdlOiAnTm8gcmVjb3JkaW5nIHRvb2wgYXZhaWxhYmxlIGZvciB5b3VyIG9yZ2FuaXphdGlvbicsIHNldmVyaXR5OiAnTUVESVVNJywgcmV0cmlhYmxlOiBmYWxzZSB9KS50b0pTT04oKSlcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgYXdhaXQgc3VwYWJhc2VBZG1pbi5mcm9tKCdhdWRpdF9sb2dzJykuaW5zZXJ0KHsgaWQ6IHV1aWR2NCgpLCBvcmdhbml6YXRpb25faWQsIHVzZXJfaWQ6IGNhcHR1cmVkQWN0b3JJZCwgc3lzdGVtX2lkOiBjYXB0dXJlZFN5c3RlbUNwaWRJZCwgcmVzb3VyY2VfdHlwZTogJ2NhbGxzJywgcmVzb3VyY2VfaWQ6IGNhbGxJZCwgYWN0aW9uOiAnaW50ZW50OnJlY29yZGluZ19yZXF1ZXN0ZWQnLCBiZWZvcmU6IG51bGwsIGFmdGVyOiB7IHRvb2xfaWQ6IG9yZ1Rvb2xJZCwgcmVxdWVzdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSwgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pXHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBmZXRjaCBjYW5vbmljYWwgY2FsbFxyXG4gICAgY29uc3QgeyBkYXRhOiBwZXJzaXN0ZWRDYWxsLCBlcnJvcjogZmV0Y2hDYWxsRXJyIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2NhbGxzJykuc2VsZWN0KCcqJykuZXEoJ2lkJywgY2FsbElkKS5saW1pdCgxKVxyXG4gICAgaWYgKGZldGNoQ2FsbEVyciB8fCAhcGVyc2lzdGVkQ2FsbD8uWzBdKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ3N0YXJ0Q2FsbEhhbmRsZXI6IGZhaWxlZCB0byBmZXRjaCBwZXJzaXN0ZWQgY2FsbCcsIHsgY2FsbElkLCBlcnJvcjogZmV0Y2hDYWxsRXJyPy5tZXNzYWdlIH0pXHJcbiAgICAgIGNvbnN0IGUgPSBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQ0FMTF9TVEFSVF9GRVRDSF9QRVJTSVNURURfRkFJTEVEJywgbWVzc2FnZTogJ0ZhaWxlZCB0byByZWFkIGJhY2sgcGVyc2lzdGVkIGNhbGwnLCB1c2VyX21lc3NhZ2U6ICdXZSBzdGFydGVkIHRoZSBjYWxsIGJ1dCBjb3VsZCBub3QgdmVyaWZ5IGl0cyByZWNvcmQuIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuJywgc2V2ZXJpdHk6ICdISUdIJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IGNhdXNlOiBmZXRjaENhbGxFcnI/Lm1lc3NhZ2UgfSB9KVxyXG4gICAgICBhd2FpdCB3cml0ZUF1ZGl0RXJyb3IoJ2NhbGxzJywgY2FsbElkLCBlLnRvSlNPTigpKVxyXG4gICAgICB0aHJvdyBlXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgY2Fub25pY2FsQ2FsbCA9IHBlcnNpc3RlZENhbGxbMF1cclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IHN1cGFiYXNlQWRtaW4uZnJvbSgnYXVkaXRfbG9ncycpLmluc2VydCh7IGlkOiB1dWlkdjQoKSwgb3JnYW5pemF0aW9uX2lkLCB1c2VyX2lkOiBjYXB0dXJlZEFjdG9ySWQsIHN5c3RlbV9pZDogY2FwdHVyZWRTeXN0ZW1DcGlkSWQsIHJlc291cmNlX3R5cGU6ICdjYWxscycsIHJlc291cmNlX2lkOiBjYWxsSWQsIGFjdGlvbjogJ2NyZWF0ZScsIGJlZm9yZTogbnVsbCwgYWZ0ZXI6IHsgLi4uY2Fub25pY2FsQ2FsbCwgY29uZmlnOiBlZmZlY3RpdmVNb2R1bGF0aW9ucywgY2FsbF9zaWQgfSwgY3JlYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpIH0pXHJcbiAgICB9IGNhdGNoIChhdWRpdEVycikge1xyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdzdGFydENhbGxIYW5kbGVyOiBmYWlsZWQgdG8gaW5zZXJ0IGF1ZGl0IGxvZycsIHsgY2FsbElkLCBlcnJvcjogKGF1ZGl0RXJyIGFzIGFueSk/Lm1lc3NhZ2UgfSlcclxuICAgICAgYXdhaXQgd3JpdGVBdWRpdEVycm9yKCdhdWRpdF9sb2dzJywgY2FsbElkLCBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQVVESVRfTE9HX0lOU0VSVF9GQUlMRUQnLCBtZXNzYWdlOiAnRmFpbGVkIHRvIHdyaXRlIGF1ZGl0IGxvZycsIHVzZXJfbWVzc2FnZTogJ0NhbGwgc3RhcnRlZCBidXQgYW4gaW50ZXJuYWwgYXVkaXQgbG9nIGNvdWxkIG5vdCBiZSBzYXZlZC4nLCBzZXZlcml0eTogJ01FRElVTScsIHJldHJpYWJsZTogdHJ1ZSwgZGV0YWlsczogeyBjYXVzZTogKGF1ZGl0RXJyIGFzIGFueSkubWVzc2FnZSB9IH0pLnRvSlNPTigpKVxyXG4gICAgfVxyXG5cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICBjb25zb2xlLmxvZygnc3RhcnRDYWxsSGFuZGxlcjogY2FsbCBmbG93IGNvbXBsZXRlZCcsIHsgY2FsbElkIH0pXHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBjYWxsX2lkOiBjYWxsSWQgfVxyXG4gIH0gY2F0Y2ggKGVycjogYW55KSB7XHJcbiAgICBpZiAoZXJyIGluc3RhbmNlb2YgQXBwRXJyb3IpIHtcclxuICAgICAgY29uc3QgcGF5bG9hZCA9IGVyci50b0pTT04oKVxyXG4gICAgICB0cnkgeyBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2F1ZGl0X2xvZ3MnKS5pbnNlcnQoeyBpZDogdXVpZHY0KCksIG9yZ2FuaXphdGlvbl9pZCwgdXNlcl9pZDogY2FwdHVyZWRBY3RvcklkID8/IG51bGwsIHN5c3RlbV9pZDogY2FwdHVyZWRTeXN0ZW1DcGlkSWQgPz8gbnVsbCwgcmVzb3VyY2VfdHlwZTogJ2NhbGxzJywgcmVzb3VyY2VfaWQ6IGNhbGxJZCA/PyBudWxsLCBhY3Rpb246ICdlcnJvcicsIGJlZm9yZTogbnVsbCwgYWZ0ZXI6IHBheWxvYWQsIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSB9KSB9IGNhdGNoIChlKSB7IH1cclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGlkOiBwYXlsb2FkLmlkLCBjb2RlOiBwYXlsb2FkLmNvZGUsIG1lc3NhZ2U6IHBheWxvYWQudXNlcl9tZXNzYWdlID8/IHBheWxvYWQubWVzc2FnZSwgc2V2ZXJpdHk6IHBheWxvYWQuc2V2ZXJpdHkgfSB9XHJcbiAgICB9XHJcbiAgICAvLyBsb2cgdGhlIHVuZXhwZWN0ZWQgZXJyb3IgZm9yIGRlYnVnZ2luZ1xyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUuZXJyb3IoJ3N0YXJ0Q2FsbEhhbmRsZXIgdW5leHBlY3RlZCBlcnJvcicsIGVycilcclxuICAgIGNvbnN0IHVuZXhwZWN0ZWQgPSBuZXcgQXBwRXJyb3IoeyBjb2RlOiAnQ0FMTF9TVEFSVF9VTkVYUEVDVEVEJywgbWVzc2FnZTogZXJyPy5tZXNzYWdlID8/ICdVbmV4cGVjdGVkIGVycm9yJywgdXNlcl9tZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZCB3aGlsZSBzdGFydGluZyB0aGUgY2FsbC4nLCBzZXZlcml0eTogJ0NSSVRJQ0FMJywgcmV0cmlhYmxlOiB0cnVlLCBkZXRhaWxzOiB7IHN0YWNrOiBlcnI/LnN0YWNrIH0gfSlcclxuICAgIGNvbnN0IHBheWxvYWQgPSB1bmV4cGVjdGVkLnRvSlNPTigpXHJcbiAgICB0cnkgeyBhd2FpdCBzdXBhYmFzZUFkbWluLmZyb20oJ2F1ZGl0X2xvZ3MnKS5pbnNlcnQoeyBpZDogdXVpZHY0KCksIG9yZ2FuaXphdGlvbl9pZCwgdXNlcl9pZDogbnVsbCwgc3lzdGVtX2lkOiBudWxsLCByZXNvdXJjZV90eXBlOiAnY2FsbHMnLCByZXNvdXJjZV9pZDogbnVsbCwgYWN0aW9uOiAnZXJyb3InLCBiZWZvcmU6IG51bGwsIGFmdGVyOiBwYXlsb2FkLCBjcmVhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkgfSkgfSBjYXRjaCAoZSkgeyB9XHJcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IHsgaWQ6IHBheWxvYWQuaWQsIGNvZGU6IHBheWxvYWQuY29kZSwgbWVzc2FnZTogcGF5bG9hZC51c2VyX21lc3NhZ2UgPz8gcGF5bG9hZC5tZXNzYWdlLCBzZXZlcml0eTogcGF5bG9hZC5zZXZlcml0eSB9IH1cclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbInY0IiwidXVpZHY0IiwiQXBwRXJyb3IiLCJpc0xpdmVUcmFuc2xhdGlvblByZXZpZXdFbmFibGVkIiwiRTE2NF9SRUdFWCIsInN0YXJ0Q2FsbEhhbmRsZXIiLCJpbnB1dCIsImRlcHMiLCJzdXBhYmFzZUFkbWluIiwic2lnbmFsd2lyZUNhbGwiLCJlbnYiLCJwcm9jZXNzIiwiY2FwdHVyZWRBY3RvcklkIiwiY2FwdHVyZWRTeXN0ZW1DcGlkSWQiLCJjYWxsSWQiLCJvcmdhbml6YXRpb25faWQiLCJ3cml0ZUF1ZGl0RXJyb3IiLCJyZXNvdXJjZSIsInJlc291cmNlSWQiLCJwYXlsb2FkIiwiZnJvbSIsImluc2VydCIsImlkIiwidXNlcl9pZCIsInN5c3RlbV9pZCIsInJlc291cmNlX3R5cGUiLCJyZXNvdXJjZV9pZCIsImFjdGlvbiIsImJlZm9yZSIsImFmdGVyIiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImUiLCJjb25zb2xlIiwiZXJyb3IiLCJwbGFjZVNpZ25hbFdpcmVDYWxsIiwidG9OdW1iZXIiLCJ1c2VMaXZlVHJhbnNsYXRpb24iLCJsb2ciLCJzd1Byb2plY3QiLCJTSUdOQUxXSVJFX1BST0pFQ1RfSUQiLCJzd1Rva2VuIiwiU0lHTkFMV0lSRV9UT0tFTiIsInN3TnVtYmVyIiwiU0lHTkFMV0lSRV9OVU1CRVIiLCJyYXdTcGFjZSIsIlN0cmluZyIsIlNJR05BTFdJUkVfU1BBQ0UiLCJzd1NwYWNlIiwicmVwbGFjZSIsInRyaW0iLCJoYXNQcm9qZWN0IiwiaGFzVG9rZW4iLCJoYXNTcGFjZSIsImhhc051bWJlciIsInN1YnN0cmluZyIsImV4dHJhY3RlZFNwYWNlIiwibWlzc2luZyIsInB1c2giLCJOT0RFX0VOViIsImNvZGUiLCJtZXNzYWdlIiwiam9pbiIsInVzZXJfbWVzc2FnZSIsInNldmVyaXR5IiwicmV0cmlhYmxlIiwidG9KU09OIiwid2FybiIsImF1dGgiLCJCdWZmZXIiLCJ0b1N0cmluZyIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImFwcGVuZCIsIk5FWFRfUFVCTElDX0FQUF9VUkwiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzd0VuZHBvaW50IiwiZW5kcG9pbnQiLCJ0byIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJ0aW1lb3V0Iiwic2V0VGltZW91dCIsImFib3J0Iiwic3dSZXMiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic2lnbmFsIiwiZmV0Y2hFcnIiLCJkZXRhaWxzIiwiY2F1c2UiLCJjbGVhclRpbWVvdXQiLCJvayIsInRleHQiLCJzdGF0dXMiLCJwcm92aWRlcl9lcnJvciIsInN3RGF0YSIsImpzb24iLCJzaWQiLCJmcm9tX251bWJlciIsInBob25lX251bWJlciIsImZsb3dfdHlwZSIsIm1vZHVsYXRpb25zIiwiYWN0b3JJZCIsImFjdG9yX2lkIiwiZXJyIiwidGVzdCIsImRhdGEiLCJvcmdSb3dzIiwib3JnRXJyIiwic2VsZWN0IiwiZXEiLCJsaW1pdCIsIm9yZyIsInBsYW4iLCJtZW1iZXJzaGlwUm93cyIsIm1lbWJlcnNoaXBFcnIiLCJlZmZlY3RpdmVNb2R1bGF0aW9ucyIsInJlY29yZCIsInRyYW5zY3JpYmUiLCJ0cmFuc2xhdGUiLCJ2Y1Jvd3MiLCJ2Y0VyciIsImNmZyIsInN1cnZleSIsInN5bnRoZXRpY19jYWxsZXIiLCJ0cmFuc2xhdGVfZnJvbSIsInRyYW5zbGF0ZV90byIsImxlbmd0aCIsInN5c3RlbXNSb3dzIiwic3lzdGVtc0VyciIsImluIiwic3lzdGVtTWFwIiwiZm9yRWFjaCIsInMiLCJrZXkiLCJzeXN0ZW1DcGlkSWQiLCJzeXN0ZW1BaUlkIiwiY2FsbFJvdyIsInN0YXJ0ZWRfYXQiLCJlbmRlZF9hdCIsImNyZWF0ZWRfYnkiLCJpbnNlcnRFcnIiLCJjYWxsX3NpZCIsInNpZEEiLCJ1cmwiLCJzdGF0dXNDYWxsYmFjayIsInNpZEIiLCJhIiwiYiIsInN3IiwidG9Mb3dlckNhc2UiLCJpc0J1c2luZXNzUGxhbiIsImluY2x1ZGVzIiwiaXNGZWF0dXJlRmxhZ0VuYWJsZWQiLCJzaG91bGRVc2VMaXZlVHJhbnNsYXRpb24iLCJoYXNfZnJvbV9udW1iZXIiLCJmcm9tX251bWJlcl92YWxpZCIsImxpdmVUcmFuc2xhdGlvbiIsInVwZGF0ZUVyciIsInVwZGF0ZSIsImFpSWQiLCJhaVJvdyIsImNhbGxfaWQiLCJtb2RlbCIsImFpRXJyIiwiZnJvbUxhbmciLCJ0b0xhbmciLCJtZXRhIiwib3JnVG9vbElkIiwidG9vbF9pZCIsInJlcXVlc3RlZF9hdCIsInBlcnNpc3RlZENhbGwiLCJmZXRjaENhbGxFcnIiLCJjYW5vbmljYWxDYWxsIiwiY29uZmlnIiwiYXVkaXRFcnIiLCJzdWNjZXNzIiwidW5leHBlY3RlZCIsInN0YWNrIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/actions/calls/startCallHandler.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.ts":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler),\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_email__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/email */ \"(rsc)/./node_modules/next-auth/providers/email.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n/* harmony import */ var _next_auth_supabase_adapter__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @next-auth/supabase-adapter */ \"(rsc)/./node_modules/@next-auth/supabase-adapter/dist/index.js\");\n\n\n\n\n\n\nasync function sendViaResend(to, html) {\n    const apiKey = process.env.RESEND_API_KEY;\n    if (!apiKey) throw new Error(\"RESEND_API_KEY not configured\");\n    const res = await fetch(\"https://api.resend.com/emails\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${apiKey}`\n        },\n        body: JSON.stringify({\n            from: process.env.EMAIL_FROM || `no-reply@${process.env.NEXTAUTH_URL?.replace(/^https?:\\/\\//, \"\")}`,\n            to: [\n                to\n            ],\n            subject: \"Your sign-in link\",\n            html\n        })\n    });\n    if (!res.ok) throw new Error(`Resend API error: ${res.status} ${await res.text()}`);\n}\n// Lazily configure Supabase adapter (avoid failing at build-time when env missing)\nlet adapter = undefined;\ntry {\n    // Support both SUPABASE_URL and NEXT_PUBLIC_SUPABASE_URL for compatibility\n    const supabaseUrl = process.env.SUPABASE_URL || \"https://fiijrhpjpebevfavzlhu.supabase.co\";\n    if (supabaseUrl && process.env.SUPABASE_SERVICE_ROLE_KEY) {\n        const supabaseForAdapter = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_5__.createClient)(String(supabaseUrl), String(process.env.SUPABASE_SERVICE_ROLE_KEY));\n        adapter = (0,_next_auth_supabase_adapter__WEBPACK_IMPORTED_MODULE_4__.SupabaseAdapter)(supabaseForAdapter);\n    }\n} catch (e) {\n    // runtime diagnostic: whether Email provider is enabled (no secrets logged)\n    // eslint-disable-next-line no-console\n    console.info(`[next-auth] Email provider ${adapter ? \"registered\" : \"not registered\"}; adapterPresent=${Boolean(adapter)}`);\n    // don't throw during build; runtime will surface adapter issues\n    // eslint-disable-next-line no-console\n    console.error(\"Failed to initialize Supabase adapter for NextAuth\", e);\n}\nconst providers = [];\n// Always include credentials provider\nproviders.push((0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n    name: \"Credentials\",\n    credentials: {\n        username: {\n            label: \"Username or Email\",\n            type: \"text\"\n        },\n        password: {\n            label: \"Password\",\n            type: \"password\"\n        }\n    },\n    async authorize (credentials) {\n        if (!credentials || !credentials.username || !credentials.password) return null;\n        // Rate limiting by username (lowercased). This prevents brute-force attempts.\n        const key = String(credentials.username).toLowerCase();\n        // Initialize limiter store on first use\n        if (!global.__loginRateLimiter) global.__loginRateLimiter = new Map();\n        const limiter = global.__loginRateLimiter;\n        const MAX_ATTEMPTS = 5;\n        const WINDOW_MS = 15 * 60 * 1000 // 15 minutes\n        ;\n        const BLOCK_MS = 15 * 60 * 1000 // 15 minutes\n        ;\n        function now() {\n            return Date.now();\n        }\n        const entry = limiter.get(key) || {\n            attempts: [],\n            blockedUntil: 0\n        };\n        // purge old attempts\n        entry.attempts = entry.attempts.filter((t)=>t > now() - WINDOW_MS);\n        if (entry.blockedUntil && entry.blockedUntil > now()) {\n            // temporarily blocked\n            return null;\n        }\n        // Support both SUPABASE_URL and NEXT_PUBLIC_SUPABASE_URL for compatibility\n        const supabaseUrl = process.env.SUPABASE_URL || \"https://fiijrhpjpebevfavzlhu.supabase.co\";\n        const serviceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n        if (!supabaseUrl || !serviceKey) throw new Error(\"Supabase not configured for credentials login\");\n        // resolve username -> email when a non-email identifier is provided\n        function looksLikeEmail(v) {\n            return /^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$/.test(v);\n        }\n        let identifier = String(credentials.username);\n        let emailToUse = null;\n        if (looksLikeEmail(identifier)) {\n            emailToUse = identifier;\n        } else {\n            // attempt to resolve username in `users` table to an email\n            try {\n                const sup = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_5__.createClient)(supabaseUrl, serviceKey);\n                // search common columns: username or email\n                const { data: found, error: findErr } = await sup.from(\"users\").select(\"email,username\").or(`username.eq.${identifier},email.eq.${identifier}`).limit(1);\n                if (!findErr && Array.isArray(found) && found.length) {\n                    emailToUse = found[0].email ?? null;\n                }\n            } catch (e) {\n            // ignore lookup errors and continue to fail below\n            }\n        }\n        if (!emailToUse) {\n            // record failed attempt\n            entry.attempts.push(now());\n            if (entry.attempts.length >= MAX_ATTEMPTS) {\n                entry.blockedUntil = now() + BLOCK_MS;\n            }\n            limiter.set(key, entry);\n            return null;\n        }\n        // For password-based auth, use the ANON key, not service role key\n        // Service role key bypasses RLS and is for admin operations only\n        // Password auth needs anon key to work with Supabase Auth's user sessions\n        const anonKey = \"sb_publishable_lRUy5ZWTCzCNPTuOP9K9Rg_Nh-nEClF\";\n        if (!anonKey) throw new Error(\"NEXT_PUBLIC_SUPABASE_ANON_KEY not configured for password login\");\n        const endpoint = `${supabaseUrl.replace(/\\/$/, \"\")}/auth/v1/token?grant_type=password`;\n        const res = await fetch(endpoint, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"apikey\": anonKey,\n                \"Authorization\": `Bearer ${anonKey}` // Also in Authorization header\n            },\n            body: JSON.stringify({\n                email: emailToUse,\n                password: credentials.password\n            })\n        });\n        if (!res.ok) {\n            // record failed attempt\n            entry.attempts.push(now());\n            if (entry.attempts.length >= MAX_ATTEMPTS) {\n                entry.blockedUntil = now() + BLOCK_MS;\n            }\n            limiter.set(key, entry);\n            return null;\n        }\n        const data = await res.json();\n        const user = data?.user ?? null;\n        if (!user) {\n            entry.attempts.push(now());\n            if (entry.attempts.length >= MAX_ATTEMPTS) entry.blockedUntil = now() + BLOCK_MS;\n            limiter.set(key, entry);\n            return null;\n        }\n        // success: clear attempts\n        limiter.delete(key);\n        return {\n            id: user.id,\n            name: user.email,\n            email: user.email\n        };\n    }\n}));\n// Only include Email provider if adapter is present (NextAuth requires adapter for Email)\nif (adapter) {\n    providers.push((0,next_auth_providers_email__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n        // Implement custom sender via Resend HTTP API (no SDK required)\n        async sendVerificationRequest ({ identifier: email, url }) {\n            const html = `<p>Sign in to the app with this link:</p><p><a href=\"${url}\">${url}</a></p>`;\n            await sendViaResend(email, html);\n        },\n        server: undefined\n    }));\n}\n// Add Google OAuth provider if credentials are configured\nif (process.env.GOOGLE_CLIENT_ID && process.env.GOOGLE_CLIENT_SECRET) {\n    providers.push((0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_3__[\"default\"])({\n        clientId: process.env.GOOGLE_CLIENT_ID,\n        clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n        // Allow users to sign up with Google\n        allowDangerousEmailAccountLinking: false\n    }));\n}\nconst authOptions = {\n    ...adapter ? {\n        adapter\n    } : {},\n    providers,\n    secret: process.env.NEXTAUTH_SECRET,\n    // Use default session strategy (JWT) unless adapter is configured\n    callbacks: {\n        async jwt ({ token, user }) {\n            // Add user ID to the token when user signs in\n            if (user) {\n                token.id = user.id;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            // Add user ID to the session from the token\n            if (session?.user && token?.id) {\n                session.user.id = token.id;\n            }\n            return session;\n        }\n    }\n};\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQWdDO0FBQ3FCO0FBQ1k7QUFDVjtBQUNIO0FBQ1M7QUFFN0QsZUFBZU0sY0FBY0MsRUFBVSxFQUFFQyxJQUFZO0lBQ25ELE1BQU1DLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ0MsY0FBYztJQUN6QyxJQUFJLENBQUNILFFBQVEsTUFBTSxJQUFJSSxNQUFNO0lBQzdCLE1BQU1DLE1BQU0sTUFBTUMsTUFBTSxpQ0FBaUM7UUFDdkRDLFFBQVE7UUFDUkMsU0FBUztZQUFFLGdCQUFnQjtZQUFvQkMsZUFBZSxDQUFDLE9BQU8sRUFBRVQsT0FBTyxDQUFDO1FBQUM7UUFDakZVLE1BQU1DLEtBQUtDLFNBQVMsQ0FBQztZQUNuQkMsTUFBTVosUUFBUUMsR0FBRyxDQUFDWSxVQUFVLElBQUksQ0FBQyxTQUFTLEVBQUViLFFBQVFDLEdBQUcsQ0FBQ2EsWUFBWSxFQUFFQyxRQUFRLGdCQUFnQixJQUFJLENBQUM7WUFDbkdsQixJQUFJO2dCQUFDQTthQUFHO1lBQ1JtQixTQUFTO1lBQ1RsQjtRQUNGO0lBQ0Y7SUFDQSxJQUFJLENBQUNNLElBQUlhLEVBQUUsRUFBRSxNQUFNLElBQUlkLE1BQU0sQ0FBQyxrQkFBa0IsRUFBRUMsSUFBSWMsTUFBTSxDQUFDLENBQUMsRUFBRSxNQUFNZCxJQUFJZSxJQUFJLEdBQUcsQ0FBQztBQUNwRjtBQUVBLG1GQUFtRjtBQUNuRixJQUFJQyxVQUFlQztBQUNuQixJQUFJO0lBQ0YsMkVBQTJFO0lBQzNFLE1BQU1DLGNBQWN0QixRQUFRQyxHQUFHLENBQUNzQixZQUFZLElBQUl2QiwwQ0FBb0M7SUFDcEYsSUFBSXNCLGVBQWV0QixRQUFRQyxHQUFHLENBQUN3Qix5QkFBeUIsRUFBRTtRQUN4RCxNQUFNQyxxQkFBcUJoQyxtRUFBWUEsQ0FBQ2lDLE9BQU9MLGNBQWNLLE9BQU8zQixRQUFRQyxHQUFHLENBQUN3Qix5QkFBeUI7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V0FBVztRQUNULE1BQU1DLEtBQUksRUFBRUMsS0FBSyxFQUFFaEIsSUFBSSxFQUFFO1lBQ3ZCLDhDQUE4QztZQUM5QyxJQUFJQSxNQUFNO2dCQUNSZ0IsTUFBTWQsRUFBRSxHQUFHRixLQUFLRSxFQUFFO1lBQ3BCO1lBQ0EsT0FBT2M7UUFDVDtRQUNBLE1BQU1DLFNBQVEsRUFBRUEsT0FBTyxFQUFFRCxLQUFLLEVBQUU7WUFDOUIsNENBQTRDO1lBQzVDLElBQUlDLFNBQVNqQixRQUFRZ0IsT0FBT2QsSUFBSTtnQkFDN0JlLFFBQVFqQixJQUFJLENBQVNFLEVBQUUsR0FBR2MsTUFBTWQsRUFBRTtZQUNyQztZQUNBLE9BQU9lO1FBQ1Q7SUFDRjtBQUNGLEVBQUM7QUFFRCxNQUFNQyxVQUFVN0csZ0RBQVFBLENBQUNzRztBQUVpQiIsInNvdXJjZXMiOlsid2VicGFjazovL2dlbWluaS1wcm9qZWN0Ly4vYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHM/YzhhNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgTmV4dEF1dGggZnJvbSBcIm5leHQtYXV0aFwiXHJcbmltcG9ydCBFbWFpbFByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2VtYWlsXCJcclxuaW1wb3J0IENyZWRlbnRpYWxzUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHNcIlxyXG5pbXBvcnQgR29vZ2xlUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvZ29vZ2xlXCJcclxuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3N1cGFiYXNlLWpzJ1xyXG5pbXBvcnQgeyBTdXBhYmFzZUFkYXB0ZXIgfSBmcm9tICdAbmV4dC1hdXRoL3N1cGFiYXNlLWFkYXB0ZXInXHJcblxyXG5hc3luYyBmdW5jdGlvbiBzZW5kVmlhUmVzZW5kKHRvOiBzdHJpbmcsIGh0bWw6IHN0cmluZykge1xyXG4gIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LlJFU0VORF9BUElfS0VZXHJcbiAgaWYgKCFhcGlLZXkpIHRocm93IG5ldyBFcnJvcignUkVTRU5EX0FQSV9LRVkgbm90IGNvbmZpZ3VyZWQnKVxyXG4gIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5yZXNlbmQuY29tL2VtYWlscycsIHtcclxuICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7YXBpS2V5fWAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgZnJvbTogcHJvY2Vzcy5lbnYuRU1BSUxfRlJPTSB8fCBgbm8tcmVwbHlAJHtwcm9jZXNzLmVudi5ORVhUQVVUSF9VUkw/LnJlcGxhY2UoL15odHRwcz86XFwvXFwvLywgJycpfWAsXHJcbiAgICAgIHRvOiBbdG9dLFxyXG4gICAgICBzdWJqZWN0OiAnWW91ciBzaWduLWluIGxpbmsnLFxyXG4gICAgICBodG1sLFxyXG4gICAgfSksXHJcbiAgfSlcclxuICBpZiAoIXJlcy5vaykgdGhyb3cgbmV3IEVycm9yKGBSZXNlbmQgQVBJIGVycm9yOiAke3Jlcy5zdGF0dXN9ICR7YXdhaXQgcmVzLnRleHQoKX1gKVxyXG59XHJcblxyXG4vLyBMYXppbHkgY29uZmlndXJlIFN1cGFiYXNlIGFkYXB0ZXIgKGF2b2lkIGZhaWxpbmcgYXQgYnVpbGQtdGltZSB3aGVuIGVudiBtaXNzaW5nKVxyXG5sZXQgYWRhcHRlcjogYW55ID0gdW5kZWZpbmVkXHJcbnRyeSB7XHJcbiAgLy8gU3VwcG9ydCBib3RoIFNVUEFCQVNFX1VSTCBhbmQgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGZvciBjb21wYXRpYmlsaXR5XHJcbiAgY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMXHJcbiAgaWYgKHN1cGFiYXNlVXJsICYmIHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkpIHtcclxuICAgIGNvbnN0IHN1cGFiYXNlRm9yQWRhcHRlciA9IGNyZWF0ZUNsaWVudChTdHJpbmcoc3VwYWJhc2VVcmwpLCBTdHJpbmcocHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSkpXHJcbiAgICBhZGFwdGVyID0gU3VwYWJhc2VBZGFwdGVyKHN1cGFiYXNlRm9yQWRhcHRlciBhcyBhbnkpXHJcbiAgfVxyXG59IGNhdGNoIChlKSB7XHJcblxyXG4gICAgLy8gcnVudGltZSBkaWFnbm9zdGljOiB3aGV0aGVyIEVtYWlsIHByb3ZpZGVyIGlzIGVuYWJsZWQgKG5vIHNlY3JldHMgbG9nZ2VkKVxyXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgIGNvbnNvbGUuaW5mbyhgW25leHQtYXV0aF0gRW1haWwgcHJvdmlkZXIgJHthZGFwdGVyID8gJ3JlZ2lzdGVyZWQnIDogJ25vdCByZWdpc3RlcmVkJ307IGFkYXB0ZXJQcmVzZW50PSR7Qm9vbGVhbihhZGFwdGVyKX1gKVxyXG4gIC8vIGRvbid0IHRocm93IGR1cmluZyBidWlsZDsgcnVudGltZSB3aWxsIHN1cmZhY2UgYWRhcHRlciBpc3N1ZXNcclxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIFN1cGFiYXNlIGFkYXB0ZXIgZm9yIE5leHRBdXRoJywgZSlcclxufVxyXG5cclxuY29uc3QgcHJvdmlkZXJzOiBhbnlbXSA9IFtdXHJcbi8vIEFsd2F5cyBpbmNsdWRlIGNyZWRlbnRpYWxzIHByb3ZpZGVyXHJcbnByb3ZpZGVycy5wdXNoKENyZWRlbnRpYWxzUHJvdmlkZXIoe1xyXG4gIG5hbWU6ICdDcmVkZW50aWFscycsXHJcbiAgY3JlZGVudGlhbHM6IHtcclxuICAgIHVzZXJuYW1lOiB7IGxhYmVsOiAnVXNlcm5hbWUgb3IgRW1haWwnLCB0eXBlOiAndGV4dCcgfSxcclxuICAgIHBhc3N3b3JkOiB7IGxhYmVsOiAnUGFzc3dvcmQnLCB0eXBlOiAncGFzc3dvcmQnIH1cclxuICB9LFxyXG4gIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xyXG4gICAgaWYgKCFjcmVkZW50aWFscyB8fCAhY3JlZGVudGlhbHMudXNlcm5hbWUgfHwgIWNyZWRlbnRpYWxzLnBhc3N3b3JkKSByZXR1cm4gbnVsbFxyXG4gICAgLy8gUmF0ZSBsaW1pdGluZyBieSB1c2VybmFtZSAobG93ZXJjYXNlZCkuIFRoaXMgcHJldmVudHMgYnJ1dGUtZm9yY2UgYXR0ZW1wdHMuXHJcbiAgICBjb25zdCBrZXkgPSBTdHJpbmcoY3JlZGVudGlhbHMudXNlcm5hbWUpLnRvTG93ZXJDYXNlKClcclxuICAgIC8vIEluaXRpYWxpemUgbGltaXRlciBzdG9yZSBvbiBmaXJzdCB1c2VcclxuICAgIGlmICghKGdsb2JhbCBhcyBhbnkpLl9fbG9naW5SYXRlTGltaXRlcikgKGdsb2JhbCBhcyBhbnkpLl9fbG9naW5SYXRlTGltaXRlciA9IG5ldyBNYXAoKVxyXG4gICAgY29uc3QgbGltaXRlcjogTWFwPHN0cmluZywgYW55PiA9IChnbG9iYWwgYXMgYW55KS5fX2xvZ2luUmF0ZUxpbWl0ZXJcclxuICAgIGNvbnN0IE1BWF9BVFRFTVBUUyA9IDVcclxuICAgIGNvbnN0IFdJTkRPV19NUyA9IDE1ICogNjAgKiAxMDAwIC8vIDE1IG1pbnV0ZXNcclxuICAgIGNvbnN0IEJMT0NLX01TID0gMTUgKiA2MCAqIDEwMDAgLy8gMTUgbWludXRlc1xyXG5cclxuICAgIGZ1bmN0aW9uIG5vdygpIHsgcmV0dXJuIERhdGUubm93KCkgfVxyXG5cclxuICAgIGNvbnN0IGVudHJ5ID0gbGltaXRlci5nZXQoa2V5KSB8fCB7IGF0dGVtcHRzOiBbXSBhcyBudW1iZXJbXSwgYmxvY2tlZFVudGlsOiAwIH1cclxuICAgIC8vIHB1cmdlIG9sZCBhdHRlbXB0c1xyXG4gICAgZW50cnkuYXR0ZW1wdHMgPSBlbnRyeS5hdHRlbXB0cy5maWx0ZXIoKHQ6IG51bWJlcikgPT4gdCA+IG5vdygpIC0gV0lORE9XX01TKVxyXG4gICAgaWYgKGVudHJ5LmJsb2NrZWRVbnRpbCAmJiBlbnRyeS5ibG9ja2VkVW50aWwgPiBub3coKSkge1xyXG4gICAgICAvLyB0ZW1wb3JhcmlseSBibG9ja2VkXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3VwcG9ydCBib3RoIFNVUEFCQVNFX1VSTCBhbmQgTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIGZvciBjb21wYXRpYmlsaXR5XHJcbiAgICBjb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1VSTCB8fCBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkxcclxuICAgIGNvbnN0IHNlcnZpY2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZXHJcbiAgICBpZiAoIXN1cGFiYXNlVXJsIHx8ICFzZXJ2aWNlS2V5KSB0aHJvdyBuZXcgRXJyb3IoJ1N1cGFiYXNlIG5vdCBjb25maWd1cmVkIGZvciBjcmVkZW50aWFscyBsb2dpbicpXHJcblxyXG4gICAgLy8gcmVzb2x2ZSB1c2VybmFtZSAtPiBlbWFpbCB3aGVuIGEgbm9uLWVtYWlsIGlkZW50aWZpZXIgaXMgcHJvdmlkZWRcclxuICAgIGZ1bmN0aW9uIGxvb2tzTGlrZUVtYWlsKHY6IHN0cmluZykgeyByZXR1cm4gL15bXkBcXHNdK0BbXkBcXHNdK1xcLlteQFxcc10rJC8udGVzdCh2KSB9XHJcbiAgICBsZXQgaWRlbnRpZmllciA9IFN0cmluZyhjcmVkZW50aWFscy51c2VybmFtZSlcclxuICAgIGxldCBlbWFpbFRvVXNlOiBzdHJpbmcgfCBudWxsID0gbnVsbFxyXG4gICAgaWYgKGxvb2tzTGlrZUVtYWlsKGlkZW50aWZpZXIpKSB7XHJcbiAgICAgIGVtYWlsVG9Vc2UgPSBpZGVudGlmaWVyXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBhdHRlbXB0IHRvIHJlc29sdmUgdXNlcm5hbWUgaW4gYHVzZXJzYCB0YWJsZSB0byBhbiBlbWFpbFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHN1cCA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc2VydmljZUtleSlcclxuICAgICAgICAvLyBzZWFyY2ggY29tbW9uIGNvbHVtbnM6IHVzZXJuYW1lIG9yIGVtYWlsXHJcbiAgICAgICAgY29uc3QgeyBkYXRhOiBmb3VuZCwgZXJyb3I6IGZpbmRFcnIgfSA9IGF3YWl0IHN1cC5mcm9tKCd1c2VycycpLnNlbGVjdCgnZW1haWwsdXNlcm5hbWUnKS5vcihgdXNlcm5hbWUuZXEuJHtpZGVudGlmaWVyfSxlbWFpbC5lcS4ke2lkZW50aWZpZXJ9YCkubGltaXQoMSlcclxuICAgICAgICBpZiAoIWZpbmRFcnIgJiYgQXJyYXkuaXNBcnJheShmb3VuZCkgJiYgZm91bmQubGVuZ3RoKSB7XHJcbiAgICAgICAgICBlbWFpbFRvVXNlID0gKGZvdW5kWzBdIGFzIGFueSkuZW1haWwgPz8gbnVsbFxyXG4gICAgICAgIH1cclxuICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIC8vIGlnbm9yZSBsb29rdXAgZXJyb3JzIGFuZCBjb250aW51ZSB0byBmYWlsIGJlbG93XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoIWVtYWlsVG9Vc2UpIHtcclxuICAgICAgLy8gcmVjb3JkIGZhaWxlZCBhdHRlbXB0XHJcbiAgICAgIGVudHJ5LmF0dGVtcHRzLnB1c2gobm93KCkpXHJcbiAgICAgIGlmIChlbnRyeS5hdHRlbXB0cy5sZW5ndGggPj0gTUFYX0FUVEVNUFRTKSB7XHJcbiAgICAgICAgZW50cnkuYmxvY2tlZFVudGlsID0gbm93KCkgKyBCTE9DS19NU1xyXG4gICAgICB9XHJcbiAgICAgIGxpbWl0ZXIuc2V0KGtleSwgZW50cnkpXHJcbiAgICAgIHJldHVybiBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8gRm9yIHBhc3N3b3JkLWJhc2VkIGF1dGgsIHVzZSB0aGUgQU5PTiBrZXksIG5vdCBzZXJ2aWNlIHJvbGUga2V5XHJcbiAgICAvLyBTZXJ2aWNlIHJvbGUga2V5IGJ5cGFzc2VzIFJMUyBhbmQgaXMgZm9yIGFkbWluIG9wZXJhdGlvbnMgb25seVxyXG4gICAgLy8gUGFzc3dvcmQgYXV0aCBuZWVkcyBhbm9uIGtleSB0byB3b3JrIHdpdGggU3VwYWJhc2UgQXV0aCdzIHVzZXIgc2Vzc2lvbnNcclxuICAgIGNvbnN0IGFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWVxyXG4gICAgaWYgKCFhbm9uS2V5KSB0aHJvdyBuZXcgRXJyb3IoJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIG5vdCBjb25maWd1cmVkIGZvciBwYXNzd29yZCBsb2dpbicpXHJcblxyXG4gICAgY29uc3QgZW5kcG9pbnQgPSBgJHtzdXBhYmFzZVVybC5yZXBsYWNlKC9cXC8kLywgJycpfS9hdXRoL3YxL3Rva2VuP2dyYW50X3R5cGU9cGFzc3dvcmRgXHJcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChlbmRwb2ludCwge1xyXG4gICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgaGVhZGVyczogeyBcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLCBcclxuICAgICAgICAnYXBpa2V5JzogYW5vbktleSwgIC8vIFVzZSBhbm9uIGtleSBmb3IgcGFzc3dvcmQgYXV0aFxyXG4gICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke2Fub25LZXl9YCAgLy8gQWxzbyBpbiBBdXRob3JpemF0aW9uIGhlYWRlclxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGVtYWlsOiBlbWFpbFRvVXNlLCBwYXNzd29yZDogY3JlZGVudGlhbHMucGFzc3dvcmQgfSlcclxuICAgIH0pXHJcbiAgICBpZiAoIXJlcy5vaykge1xyXG4gICAgICAvLyByZWNvcmQgZmFpbGVkIGF0dGVtcHRcclxuICAgICAgZW50cnkuYXR0ZW1wdHMucHVzaChub3coKSlcclxuICAgICAgaWYgKGVudHJ5LmF0dGVtcHRzLmxlbmd0aCA+PSBNQVhfQVRURU1QVFMpIHtcclxuICAgICAgICBlbnRyeS5ibG9ja2VkVW50aWwgPSBub3coKSArIEJMT0NLX01TXHJcbiAgICAgIH1cclxuICAgICAgbGltaXRlci5zZXQoa2V5LCBlbnRyeSlcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXMuanNvbigpXHJcbiAgICBjb25zdCB1c2VyID0gZGF0YT8udXNlciA/PyBudWxsXHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgZW50cnkuYXR0ZW1wdHMucHVzaChub3coKSlcclxuICAgICAgaWYgKGVudHJ5LmF0dGVtcHRzLmxlbmd0aCA+PSBNQVhfQVRURU1QVFMpIGVudHJ5LmJsb2NrZWRVbnRpbCA9IG5vdygpICsgQkxPQ0tfTVNcclxuICAgICAgbGltaXRlci5zZXQoa2V5LCBlbnRyeSlcclxuICAgICAgcmV0dXJuIG51bGxcclxuICAgIH1cclxuICAgIC8vIHN1Y2Nlc3M6IGNsZWFyIGF0dGVtcHRzXHJcbiAgICBsaW1pdGVyLmRlbGV0ZShrZXkpXHJcbiAgICByZXR1cm4geyBpZDogdXNlci5pZCwgbmFtZTogdXNlci5lbWFpbCwgZW1haWw6IHVzZXIuZW1haWwgfVxyXG4gIH1cclxufSkpXHJcblxyXG4vLyBPbmx5IGluY2x1ZGUgRW1haWwgcHJvdmlkZXIgaWYgYWRhcHRlciBpcyBwcmVzZW50IChOZXh0QXV0aCByZXF1aXJlcyBhZGFwdGVyIGZvciBFbWFpbClcclxuaWYgKGFkYXB0ZXIpIHtcclxuICBwcm92aWRlcnMucHVzaChFbWFpbFByb3ZpZGVyKHtcclxuICAgIC8vIEltcGxlbWVudCBjdXN0b20gc2VuZGVyIHZpYSBSZXNlbmQgSFRUUCBBUEkgKG5vIFNESyByZXF1aXJlZClcclxuICAgIGFzeW5jIHNlbmRWZXJpZmljYXRpb25SZXF1ZXN0KHsgaWRlbnRpZmllcjogZW1haWwsIHVybCB9KSB7XHJcbiAgICAgIGNvbnN0IGh0bWwgPSBgPHA+U2lnbiBpbiB0byB0aGUgYXBwIHdpdGggdGhpcyBsaW5rOjwvcD48cD48YSBocmVmPVwiJHt1cmx9XCI+JHt1cmx9PC9hPjwvcD5gXHJcbiAgICAgIGF3YWl0IHNlbmRWaWFSZXNlbmQoZW1haWwsIGh0bWwpXHJcbiAgICB9LFxyXG4gICAgc2VydmVyOiB1bmRlZmluZWQsXHJcbiAgfSkpXHJcbn1cclxuXHJcbi8vIEFkZCBHb29nbGUgT0F1dGggcHJvdmlkZXIgaWYgY3JlZGVudGlhbHMgYXJlIGNvbmZpZ3VyZWRcclxuaWYgKHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQgJiYgcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQpIHtcclxuICBwcm92aWRlcnMucHVzaChHb29nbGVQcm92aWRlcih7XHJcbiAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCxcclxuICAgIGNsaWVudFNlY3JldDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVQsXHJcbiAgICAvLyBBbGxvdyB1c2VycyB0byBzaWduIHVwIHdpdGggR29vZ2xlXHJcbiAgICBhbGxvd0Rhbmdlcm91c0VtYWlsQWNjb3VudExpbmtpbmc6IGZhbHNlLCAvLyBTZXQgdG8gdHJ1ZSBpZiB5b3Ugd2FudCB0byBhbGxvdyBsaW5raW5nIGV4aXN0aW5nIGFjY291bnRzXHJcbiAgfSkpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9ucyA9IHtcclxuICAuLi4oYWRhcHRlciA/IHsgYWRhcHRlciB9IDoge30pLFxyXG4gIHByb3ZpZGVycyxcclxuICBzZWNyZXQ6IHByb2Nlc3MuZW52Lk5FWFRBVVRIX1NFQ1JFVCxcclxuICAvLyBVc2UgZGVmYXVsdCBzZXNzaW9uIHN0cmF0ZWd5IChKV1QpIHVubGVzcyBhZGFwdGVyIGlzIGNvbmZpZ3VyZWRcclxuICBjYWxsYmFja3M6IHtcclxuICAgIGFzeW5jIGp3dCh7IHRva2VuLCB1c2VyIH0pIHtcclxuICAgICAgLy8gQWRkIHVzZXIgSUQgdG8gdGhlIHRva2VuIHdoZW4gdXNlciBzaWducyBpblxyXG4gICAgICBpZiAodXNlcikge1xyXG4gICAgICAgIHRva2VuLmlkID0gdXNlci5pZFxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0b2tlblxyXG4gICAgfSxcclxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XHJcbiAgICAgIC8vIEFkZCB1c2VyIElEIHRvIHRoZSBzZXNzaW9uIGZyb20gdGhlIHRva2VuXHJcbiAgICAgIGlmIChzZXNzaW9uPy51c2VyICYmIHRva2VuPy5pZCkge1xyXG4gICAgICAgIChzZXNzaW9uLnVzZXIgYXMgYW55KS5pZCA9IHRva2VuLmlkXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHNlc3Npb25cclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmNvbnN0IGhhbmRsZXIgPSBOZXh0QXV0aChhdXRoT3B0aW9ucyBhcyBhbnkpXHJcblxyXG5leHBvcnQgeyBoYW5kbGVyIGFzIEdFVCwgaGFuZGxlciBhcyBQT1NUIH1cclxuIl0sIm5hbWVzIjpbIk5leHRBdXRoIiwiRW1haWxQcm92aWRlciIsIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJHb29nbGVQcm92aWRlciIsImNyZWF0ZUNsaWVudCIsIlN1cGFiYXNlQWRhcHRlciIsInNlbmRWaWFSZXNlbmQiLCJ0byIsImh0bWwiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiUkVTRU5EX0FQSV9LRVkiLCJFcnJvciIsInJlcyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImZyb20iLCJFTUFJTF9GUk9NIiwiTkVYVEFVVEhfVVJMIiwicmVwbGFjZSIsInN1YmplY3QiLCJvayIsInN0YXR1cyIsInRleHQiLCJhZGFwdGVyIiwidW5kZWZpbmVkIiwic3VwYWJhc2VVcmwiLCJTVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwic3VwYWJhc2VGb3JBZGFwdGVyIiwiU3RyaW5nIiwiZSIsImNvbnNvbGUiLCJpbmZvIiwiQm9vbGVhbiIsImVycm9yIiwicHJvdmlkZXJzIiwicHVzaCIsIm5hbWUiLCJjcmVkZW50aWFscyIsInVzZXJuYW1lIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJhdXRob3JpemUiLCJrZXkiLCJ0b0xvd2VyQ2FzZSIsImdsb2JhbCIsIl9fbG9naW5SYXRlTGltaXRlciIsIk1hcCIsImxpbWl0ZXIiLCJNQVhfQVRURU1QVFMiLCJXSU5ET1dfTVMiLCJCTE9DS19NUyIsIm5vdyIsIkRhdGUiLCJlbnRyeSIsImdldCIsImF0dGVtcHRzIiwiYmxvY2tlZFVudGlsIiwiZmlsdGVyIiwidCIsInNlcnZpY2VLZXkiLCJsb29rc0xpa2VFbWFpbCIsInYiLCJ0ZXN0IiwiaWRlbnRpZmllciIsImVtYWlsVG9Vc2UiLCJzdXAiLCJkYXRhIiwiZm91bmQiLCJmaW5kRXJyIiwic2VsZWN0Iiwib3IiLCJsaW1pdCIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImVtYWlsIiwic2V0IiwiYW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiZW5kcG9pbnQiLCJqc29uIiwidXNlciIsImRlbGV0ZSIsImlkIiwic2VuZFZlcmlmaWNhdGlvblJlcXVlc3QiLCJ1cmwiLCJzZXJ2ZXIiLCJHT09HTEVfQ0xJRU5UX0lEIiwiR09PR0xFX0NMSUVOVF9TRUNSRVQiLCJjbGllbnRJZCIsImNsaWVudFNlY3JldCIsImFsbG93RGFuZ2Vyb3VzRW1haWxBY2NvdW50TGlua2luZyIsImF1dGhPcHRpb25zIiwic2VjcmV0IiwiTkVYVEFVVEhfU0VDUkVUIiwiY2FsbGJhY2tzIiwiand0IiwidG9rZW4iLCJzZXNzaW9uIiwiaGFuZGxlciIsIkdFVCIsIlBPU1QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/calls/start/route.ts":
/*!**************************************!*\
  !*** ./app/api/calls/start/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _actions_calls_startCall__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../actions/calls/startCall */ \"(rsc)/./app/actions/calls/startCall.ts\");\n/* harmony import */ var next_auth_next__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/next */ \"(rsc)/./node_modules/next-auth/next/index.js\");\n/* harmony import */ var _auth_nextauth_route__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../auth/[...nextauth]/route */ \"(rsc)/./app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\nfunction isE164(n) {\n    return /^\\+?[1-9]\\d{1,14}$/.test(n);\n}\nasync function POST(req) {\n    try {\n        const contentType = String(req.headers.get(\"content-type\") || \"\");\n        let body = null;\n        // Try to parse JSON, but be tolerant: fall back to form-encoded parsing\n        if (contentType.includes(\"application/json\")) {\n            try {\n                body = await req.json();\n            } catch (jsonErr) {\n                const txt = await req.text();\n                try {\n                    body = JSON.parse(txt);\n                } catch (e) {\n                    // final fallback: attempt to parse as URLSearchParams\n                    const params = new URLSearchParams(txt);\n                    if (Array.from(params.keys()).length > 0) body = Object.fromEntries(Array.from(params.entries()));\n                    else throw jsonErr;\n                }\n            }\n        } else if (contentType.includes(\"application/x-www-form-urlencoded\")) {\n            const txt = await req.text();\n            body = Object.fromEntries(Array.from(new URLSearchParams(txt).entries()));\n        } else {\n            // unknown content type: attempt JSON then form parsing\n            try {\n                body = await req.json();\n            } catch  {\n                const txt = await req.text();\n                body = Object.fromEntries(Array.from(new URLSearchParams(txt).entries()));\n            }\n        }\n        // normalize modulations (allow JSON string or object)\n        if (body && typeof body.modulations === \"string\") {\n            try {\n                body.modulations = JSON.parse(body.modulations);\n            } catch  {}\n        }\n        const { organization_id, from_number, phone_number, flow_type, modulations } = body || {};\n        if (!organization_id) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    id: \"invalid_input\",\n                    code: \"INVALID_INPUT\",\n                    message: \"organization_id required\",\n                    severity: \"MEDIUM\"\n                }\n            });\n        }\n        if (!isE164(phone_number)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: {\n                    id: \"invalid_phone\",\n                    code: \"INVALID_PHONE\",\n                    message: \"phone_number must be E.164\",\n                    severity: \"MEDIUM\"\n                }\n            });\n        }\n        // Get actor_id from session\n        const session = await (0,next_auth_next__WEBPACK_IMPORTED_MODULE_2__.getServerSession)(_auth_nextauth_route__WEBPACK_IMPORTED_MODULE_3__.authOptions).catch(()=>null);\n        const actorId = session?.user?.id ?? null;\n        // Log for debugging\n        console.log(\"startCall route: session check\", {\n            hasSession: !!session,\n            hasUser: !!session?.user,\n            hasId: !!session?.user?.id,\n            actorId: actorId ? \"[REDACTED]\" : null,\n            nodeEnv: \"development\"\n        });\n        // TEMPORARY: Always use fallback actor if session is missing (for debugging)\n        // TODO: Remove this once session management is working properly\n        const effectiveActorId = actorId || \"28d68e05-ab20-40ee-b935-b19e8927ae68\";\n        // Delegate to server action which performs DB/audit and SignalWire call\n        const result = await (0,_actions_calls_startCall__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n            organization_id,\n            from_number,\n            phone_number,\n            flow_type,\n            modulations,\n            actor_id: effectiveActorId\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result);\n    } catch (err) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: {\n                id: \"route_error\",\n                code: \"ROUTE_ERROR\",\n                message: String(err?.message ?? err),\n                severity: \"HIGH\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBU0EsVUFBVSxlQUFlO1lBQ2xDTyxTQWhFTjtRQWlFSTtRQUVBLDZFQUE2RTtRQUM3RSxnRUFBZ0U7UUFDaEUsTUFBTUMsbUJBQW1CUixXQUFXO1FBRXBDLHdFQUF3RTtRQUN4RSxNQUFNUyxTQUFTLE1BQU1wRCxvRUFBU0EsQ0FBQztZQUM3QitCO1lBQ0FDO1lBQ0FDO1lBQ0FDO1lBQ0FKO1lBQ0F1QixVQUFVRjtRQUNaO1FBQ0EsT0FBT3BELHFEQUFZQSxDQUFDZSxJQUFJLENBQUNzQztJQUMzQixFQUFFLE9BQU9FLEtBQVU7UUFDakIsT0FBT3ZELHFEQUFZQSxDQUFDZSxJQUFJLENBQUM7WUFBRXFCLFNBQVM7WUFBT0MsT0FBTztnQkFBRUMsSUFBSTtnQkFBZUMsTUFBTTtnQkFBZUMsU0FBUzlCLE9BQU82QyxLQUFLZixXQUFXZTtnQkFBTWQsVUFBVTtZQUFPO1FBQUU7SUFDdko7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2dlbWluaS1wcm9qZWN0Ly4vYXBwL2FwaS9jYWxscy9zdGFydC9yb3V0ZS50cz80MzUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgc3RhcnRDYWxsIGZyb20gJy4uLy4uLy4uL2FjdGlvbnMvY2FsbHMvc3RhcnRDYWxsJ1xyXG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoL25leHQnXHJcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnLi4vLi4vYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlJ1xyXG5cclxuZnVuY3Rpb24gaXNFMTY0KG46IHN0cmluZykge1xyXG4gIHJldHVybiAvXlxcKz9bMS05XVxcZHsxLDE0fSQvLnRlc3QobilcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gU3RyaW5nKHJlcS5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgfHwgJycpXHJcbiAgICBsZXQgYm9keTogYW55ID0gbnVsbFxyXG4gICAgLy8gVHJ5IHRvIHBhcnNlIEpTT04sIGJ1dCBiZSB0b2xlcmFudDogZmFsbCBiYWNrIHRvIGZvcm0tZW5jb2RlZCBwYXJzaW5nXHJcbiAgICBpZiAoY29udGVudFR5cGUuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGJvZHkgPSBhd2FpdCByZXEuanNvbigpXHJcbiAgICAgIH0gY2F0Y2ggKGpzb25FcnIpIHtcclxuICAgICAgICBjb25zdCB0eHQgPSBhd2FpdCByZXEudGV4dCgpXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGJvZHkgPSBKU09OLnBhcnNlKHR4dClcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAvLyBmaW5hbCBmYWxsYmFjazogYXR0ZW1wdCB0byBwYXJzZSBhcyBVUkxTZWFyY2hQYXJhbXNcclxuICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXModHh0KVxyXG4gICAgICAgICAgaWYgKEFycmF5LmZyb20ocGFyYW1zLmtleXMoKSkubGVuZ3RoID4gMCkgYm9keSA9IE9iamVjdC5mcm9tRW50cmllcyhBcnJheS5mcm9tKHBhcmFtcy5lbnRyaWVzKCkpKVxyXG4gICAgICAgICAgZWxzZSB0aHJvdyBqc29uRXJyXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgaWYgKGNvbnRlbnRUeXBlLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKSkge1xyXG4gICAgICBjb25zdCB0eHQgPSBhd2FpdCByZXEudGV4dCgpXHJcbiAgICAgIGJvZHkgPSBPYmplY3QuZnJvbUVudHJpZXMoQXJyYXkuZnJvbShuZXcgVVJMU2VhcmNoUGFyYW1zKHR4dCkuZW50cmllcygpKSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIHVua25vd24gY29udGVudCB0eXBlOiBhdHRlbXB0IEpTT04gdGhlbiBmb3JtIHBhcnNpbmdcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBib2R5ID0gYXdhaXQgcmVxLmpzb24oKVxyXG4gICAgICB9IGNhdGNoIHtcclxuICAgICAgICBjb25zdCB0eHQgPSBhd2FpdCByZXEudGV4dCgpXHJcbiAgICAgICAgYm9keSA9IE9iamVjdC5mcm9tRW50cmllcyhBcnJheS5mcm9tKG5ldyBVUkxTZWFyY2hQYXJhbXModHh0KS5lbnRyaWVzKCkpKVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gbm9ybWFsaXplIG1vZHVsYXRpb25zIChhbGxvdyBKU09OIHN0cmluZyBvciBvYmplY3QpXHJcbiAgICBpZiAoYm9keSAmJiB0eXBlb2YgYm9keS5tb2R1bGF0aW9ucyA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgdHJ5IHsgYm9keS5tb2R1bGF0aW9ucyA9IEpTT04ucGFyc2UoYm9keS5tb2R1bGF0aW9ucykgfSBjYXRjaCB7IC8qIGxlYXZlIGFzLWlzICovIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB7IG9yZ2FuaXphdGlvbl9pZCwgZnJvbV9udW1iZXIsIHBob25lX251bWJlciwgZmxvd190eXBlLCBtb2R1bGF0aW9ucyB9ID0gYm9keSB8fCB7fVxyXG4gICAgaWYgKCFvcmdhbml6YXRpb25faWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiB7IGlkOiAnaW52YWxpZF9pbnB1dCcsIGNvZGU6ICdJTlZBTElEX0lOUFVUJywgbWVzc2FnZTogJ29yZ2FuaXphdGlvbl9pZCByZXF1aXJlZCcsIHNldmVyaXR5OiAnTUVESVVNJyB9IH0pXHJcbiAgICB9XHJcbiAgICBpZiAoIWlzRTE2NChwaG9uZV9udW1iZXIpKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBpZDogJ2ludmFsaWRfcGhvbmUnLCBjb2RlOiAnSU5WQUxJRF9QSE9ORScsIG1lc3NhZ2U6ICdwaG9uZV9udW1iZXIgbXVzdCBiZSBFLjE2NCcsIHNldmVyaXR5OiAnTUVESVVNJyB9IH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IGFjdG9yX2lkIGZyb20gc2Vzc2lvblxyXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMgYXMgYW55KS5jYXRjaCgoKSA9PiBudWxsKVxyXG4gICAgY29uc3QgYWN0b3JJZCA9IHNlc3Npb24/LnVzZXI/LmlkID8/IG51bGxcclxuXHJcbiAgICAvLyBMb2cgZm9yIGRlYnVnZ2luZ1xyXG4gICAgY29uc29sZS5sb2coJ3N0YXJ0Q2FsbCByb3V0ZTogc2Vzc2lvbiBjaGVjaycsIHsgXHJcbiAgICAgIGhhc1Nlc3Npb246ICEhc2Vzc2lvbiwgXHJcbiAgICAgIGhhc1VzZXI6ICEhc2Vzc2lvbj8udXNlciwgXHJcbiAgICAgIGhhc0lkOiAhIXNlc3Npb24/LnVzZXI/LmlkLFxyXG4gICAgICBhY3RvcklkOiBhY3RvcklkID8gJ1tSRURBQ1RFRF0nIDogbnVsbCxcclxuICAgICAgbm9kZUVudjogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIFRFTVBPUkFSWTogQWx3YXlzIHVzZSBmYWxsYmFjayBhY3RvciBpZiBzZXNzaW9uIGlzIG1pc3NpbmcgKGZvciBkZWJ1Z2dpbmcpXHJcbiAgICAvLyBUT0RPOiBSZW1vdmUgdGhpcyBvbmNlIHNlc3Npb24gbWFuYWdlbWVudCBpcyB3b3JraW5nIHByb3Blcmx5XHJcbiAgICBjb25zdCBlZmZlY3RpdmVBY3RvcklkID0gYWN0b3JJZCB8fCAnMjhkNjhlMDUtYWIyMC00MGVlLWI5MzUtYjE5ZTg5MjdhZTY4J1xyXG5cclxuICAgIC8vIERlbGVnYXRlIHRvIHNlcnZlciBhY3Rpb24gd2hpY2ggcGVyZm9ybXMgREIvYXVkaXQgYW5kIFNpZ25hbFdpcmUgY2FsbFxyXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgc3RhcnRDYWxsKHsgXHJcbiAgICAgIG9yZ2FuaXphdGlvbl9pZCxcclxuICAgICAgZnJvbV9udW1iZXIsXHJcbiAgICAgIHBob25lX251bWJlcixcclxuICAgICAgZmxvd190eXBlLFxyXG4gICAgICBtb2R1bGF0aW9ucyxcclxuICAgICAgYWN0b3JfaWQ6IGVmZmVjdGl2ZUFjdG9ySWQgXHJcbiAgICB9IGFzIGFueSlcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXN1bHQpXHJcbiAgfSBjYXRjaCAoZXJyOiBhbnkpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogeyBpZDogJ3JvdXRlX2Vycm9yJywgY29kZTogJ1JPVVRFX0VSUk9SJywgbWVzc2FnZTogU3RyaW5nKGVycj8ubWVzc2FnZSA/PyBlcnIpLCBzZXZlcml0eTogJ0hJR0gnIH0gfSlcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInN0YXJ0Q2FsbCIsImdldFNlcnZlclNlc3Npb24iLCJhdXRoT3B0aW9ucyIsImlzRTE2NCIsIm4iLCJ0ZXN0IiwiUE9TVCIsInJlcSIsImNvbnRlbnRUeXBlIiwiU3RyaW5nIiwiaGVhZGVycyIsImdldCIsImJvZHkiLCJpbmNsdWRlcyIsImpzb24iLCJqc29uRXJyIiwidHh0IiwidGV4dCIsIkpTT04iLCJwYXJzZSIsImUiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJBcnJheSIsImZyb20iLCJrZXlzIiwibGVuZ3RoIiwiT2JqZWN0IiwiZnJvbUVudHJpZXMiLCJlbnRyaWVzIiwibW9kdWxhdGlvbnMiLCJvcmdhbml6YXRpb25faWQiLCJmcm9tX251bWJlciIsInBob25lX251bWJlciIsImZsb3dfdHlwZSIsInN1Y2Nlc3MiLCJlcnJvciIsImlkIiwiY29kZSIsIm1lc3NhZ2UiLCJzZXZlcml0eSIsInNlc3Npb24iLCJjYXRjaCIsImFjdG9ySWQiLCJ1c2VyIiwiY29uc29sZSIsImxvZyIsImhhc1Nlc3Npb24iLCJoYXNVc2VyIiwiaGFzSWQiLCJub2RlRW52IiwiZWZmZWN0aXZlQWN0b3JJZCIsInJlc3VsdCIsImFjdG9yX2lkIiwiZXJyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/calls/start/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/env-validation.ts":
/*!*******************************!*\
  !*** ./lib/env-validation.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isLiveTranslationPreviewEnabled: () => (/* binding */ isLiveTranslationPreviewEnabled),\n/* harmony export */   validateEnvVars: () => (/* binding */ validateEnvVars),\n/* harmony export */   validateEnvVarsOrThrow: () => (/* binding */ validateEnvVarsOrThrow)\n/* harmony export */ });\n/**\r\n * Environment Variable Validation\r\n * \r\n * Validates all required environment variables at startup.\r\n * Per PRODUCTION_READINESS_TASKS.md\r\n */ const ENV_VARS = [\n    {\n        name: \"SIGNALWIRE_PROJECT_ID\",\n        required: true,\n        description: \"SignalWire project ID for call execution\",\n        validate: (v)=>v.length > 0 || \"Must not be empty\"\n    },\n    {\n        name: \"SIGNALWIRE_TOKEN\",\n        required: true,\n        description: \"SignalWire API token\",\n        validate: (v)=>v.length > 0 || \"Must not be empty\"\n    },\n    {\n        name: \"SIGNALWIRE_SPACE\",\n        required: true,\n        description: \"SignalWire space URL\",\n        validate: (v)=>v.includes(\"signalwire.com\") || \"Must be a valid SignalWire space URL\"\n    },\n    {\n        name: \"ASSEMBLYAI_API_KEY\",\n        required: true,\n        description: \"AssemblyAI API key for transcription\",\n        validate: (v)=>v.length > 0 || \"Must not be empty\"\n    },\n    {\n        name: \"NEXT_PUBLIC_SUPABASE_URL\",\n        required: true,\n        description: \"Supabase project URL\",\n        validate: (v)=>v.startsWith(\"https://\") || \"Must be a valid HTTPS URL\"\n    },\n    {\n        name: \"NEXT_PUBLIC_SUPABASE_ANON_KEY\",\n        required: true,\n        description: \"Supabase anonymous key\",\n        validate: (v)=>v.length > 0 || \"Must not be empty\"\n    },\n    {\n        name: \"SUPABASE_SERVICE_ROLE_KEY\",\n        required: true,\n        description: \"Supabase service role key (server-side only)\",\n        validate: (v)=>v.length > 0 || \"Must not be empty\"\n    },\n    {\n        name: \"NEXT_PUBLIC_APP_URL\",\n        required: true,\n        description: \"Public application URL for webhooks\",\n        validate: (v)=>v.startsWith(\"https://\") || v.startsWith(\"http://localhost\") || \"Must be a valid URL\"\n    },\n    {\n        name: \"NEXTAUTH_SECRET\",\n        required: true,\n        description: \"NextAuth secret for session encryption\",\n        validate: (v)=>v.length >= 32 || \"Must be at least 32 characters\"\n    },\n    {\n        name: \"OPENAI_API_KEY\",\n        required: false,\n        description: \"OpenAI API key for translation (optional)\",\n        validate: (v)=>v.length > 0 || \"Must not be empty if provided\"\n    },\n    {\n        name: \"TRANSLATION_LIVE_ASSIST_PREVIEW\",\n        required: false,\n        description: \"Enable live translation preview feature (SignalWire AI Agents)\",\n        validate: (v)=>v === \"true\" || v === \"false\" || 'Must be \"true\" or \"false\"'\n    }\n];\n/**\r\n * Validate all environment variables\r\n */ function validateEnvVars() {\n    const errors = [];\n    const warnings = [];\n    for (const envVar of ENV_VARS){\n        const value = process.env[envVar.name];\n        if (!value) {\n            if (envVar.required) {\n                errors.push({\n                    name: envVar.name,\n                    message: `Required environment variable missing: ${envVar.description}`\n                });\n            } else {\n                warnings.push({\n                    name: envVar.name,\n                    message: `Optional environment variable not set: ${envVar.description}`\n                });\n            }\n        } else if (envVar.validate) {\n            const validationResult = envVar.validate(value);\n            if (validationResult !== true) {\n                const message = typeof validationResult === \"string\" ? validationResult : \"Invalid value\";\n                if (envVar.required) {\n                    errors.push({\n                        name: envVar.name,\n                        message: `${envVar.description}: ${message}`\n                    });\n                } else {\n                    warnings.push({\n                        name: envVar.name,\n                        message: `${envVar.description}: ${message}`\n                    });\n                }\n            }\n        }\n    }\n    return {\n        valid: errors.length === 0,\n        errors,\n        warnings\n    };\n}\n/**\r\n * Validate and throw if invalid (for startup)\r\n */ function validateEnvVarsOrThrow() {\n    const result = validateEnvVars();\n    if (!result.valid) {\n        const errorMessages = result.errors.map((e)=>`  - ${e.name}: ${e.message}`).join(\"\\n\");\n        throw new Error(`Environment variable validation failed:\\n${errorMessages}`);\n    }\n    if (result.warnings.length > 0 && \"development\" !== \"production\") {\n        const warningMessages = result.warnings.map((w)=>`  - ${w.name}: ${w.message}`).join(\"\\n\");\n        // eslint-disable-next-line no-console\n        console.warn(`Environment variable warnings:\\n${warningMessages}`);\n    }\n}\n/**\r\n * Check if live translation preview feature is enabled\r\n */ function isLiveTranslationPreviewEnabled() {\n    return process.env.TRANSLATION_LIVE_ASSIST_PREVIEW === \"true\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O29CQUM5QztnQkFDRixPQUFPO29CQUNMTixTQUFTSyxJQUFJLENBQUM7d0JBQ1pmLE1BQU1XLE9BQU9YLElBQUk7d0JBQ2pCZ0IsU0FBUyxDQUFDLEVBQUVMLE9BQU9ULFdBQVcsQ0FBQyxFQUFFLEVBQUVjLFFBQVEsQ0FBQztvQkFDOUM7Z0JBQ0Y7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxPQUFPO1FBQ0xFLE9BQU9ULE9BQU9KLE1BQU0sS0FBSztRQUN6Qkk7UUFDQUM7SUFDRjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTUztJQUNkLE1BQU1DLFNBQVNaO0lBRWYsSUFBSSxDQUFDWSxPQUFPRixLQUFLLEVBQUU7UUFDakIsTUFBTUcsZ0JBQWdCRCxPQUFPWCxNQUFNLENBQUNhLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDLElBQUksRUFBRUEsRUFBRXZCLElBQUksQ0FBQyxFQUFFLEVBQUV1QixFQUFFUCxPQUFPLENBQUMsQ0FBQyxFQUFFUSxJQUFJLENBQUM7UUFDakYsTUFBTSxJQUFJQyxNQUFNLENBQUMseUNBQXlDLEVBQUVKLGNBQWMsQ0FBQztJQUM3RTtJQUVBLElBQUlELE9BQU9WLFFBQVEsQ0FBQ0wsTUFBTSxHQUFHLEtBQUtRLGtCQUF5QixjQUFjO1FBQ3ZFLE1BQU1hLGtCQUFrQk4sT0FBT1YsUUFBUSxDQUFDWSxHQUFHLENBQUNLLENBQUFBLElBQUssQ0FBQyxJQUFJLEVBQUVBLEVBQUUzQixJQUFJLENBQUMsRUFBRSxFQUFFMkIsRUFBRVgsT0FBTyxDQUFDLENBQUMsRUFBRVEsSUFBSSxDQUFDO1FBQ3JGLHNDQUFzQztRQUN0Q0ksUUFBUUMsSUFBSSxDQUFDLENBQUMsZ0NBQWdDLEVBQUVILGdCQUFnQixDQUFDO0lBQ25FO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLFNBQVNJO0lBQ2QsT0FBT2pCLFFBQVFDLEdBQUcsQ0FBQ2lCLCtCQUErQixLQUFLO0FBQ3pEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VtaW5pLXByb2plY3QvLi9saWIvZW52LXZhbGlkYXRpb24udHM/MWE1ZSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRW52aXJvbm1lbnQgVmFyaWFibGUgVmFsaWRhdGlvblxyXG4gKiBcclxuICogVmFsaWRhdGVzIGFsbCByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgYXQgc3RhcnR1cC5cclxuICogUGVyIFBST0RVQ1RJT05fUkVBRElORVNTX1RBU0tTLm1kXHJcbiAqL1xyXG5cclxuaW50ZXJmYWNlIEVudlZhciB7XHJcbiAgbmFtZTogc3RyaW5nXHJcbiAgcmVxdWlyZWQ6IGJvb2xlYW5cclxuICBkZXNjcmlwdGlvbjogc3RyaW5nXHJcbiAgdmFsaWRhdGU/OiAodmFsdWU6IHN0cmluZykgPT4gYm9vbGVhbiB8IHN0cmluZ1xyXG59XHJcblxyXG5jb25zdCBFTlZfVkFSUzogRW52VmFyW10gPSBbXHJcbiAge1xyXG4gICAgbmFtZTogJ1NJR05BTFdJUkVfUFJPSkVDVF9JRCcsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIGRlc2NyaXB0aW9uOiAnU2lnbmFsV2lyZSBwcm9qZWN0IElEIGZvciBjYWxsIGV4ZWN1dGlvbicsXHJcbiAgICB2YWxpZGF0ZTogKHYpID0+IHYubGVuZ3RoID4gMCB8fCAnTXVzdCBub3QgYmUgZW1wdHknXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnU0lHTkFMV0lSRV9UT0tFTicsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIGRlc2NyaXB0aW9uOiAnU2lnbmFsV2lyZSBBUEkgdG9rZW4nLFxyXG4gICAgdmFsaWRhdGU6ICh2KSA9PiB2Lmxlbmd0aCA+IDAgfHwgJ011c3Qgbm90IGJlIGVtcHR5J1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ1NJR05BTFdJUkVfU1BBQ0UnLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1NpZ25hbFdpcmUgc3BhY2UgVVJMJyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5pbmNsdWRlcygnc2lnbmFsd2lyZS5jb20nKSB8fCAnTXVzdCBiZSBhIHZhbGlkIFNpZ25hbFdpcmUgc3BhY2UgVVJMJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0FTU0VNQkxZQUlfQVBJX0tFWScsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIGRlc2NyaXB0aW9uOiAnQXNzZW1ibHlBSSBBUEkga2V5IGZvciB0cmFuc2NyaXB0aW9uJyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5sZW5ndGggPiAwIHx8ICdNdXN0IG5vdCBiZSBlbXB0eSdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwnLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICBkZXNjcmlwdGlvbjogJ1N1cGFiYXNlIHByb2plY3QgVVJMJyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5zdGFydHNXaXRoKCdodHRwczovLycpIHx8ICdNdXN0IGJlIGEgdmFsaWQgSFRUUFMgVVJMJ1xyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ05FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZJyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgZGVzY3JpcHRpb246ICdTdXBhYmFzZSBhbm9ueW1vdXMga2V5JyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5sZW5ndGggPiAwIHx8ICdNdXN0IG5vdCBiZSBlbXB0eSdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZJyxcclxuICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgZGVzY3JpcHRpb246ICdTdXBhYmFzZSBzZXJ2aWNlIHJvbGUga2V5IChzZXJ2ZXItc2lkZSBvbmx5KScsXHJcbiAgICB2YWxpZGF0ZTogKHYpID0+IHYubGVuZ3RoID4gMCB8fCAnTXVzdCBub3QgYmUgZW1wdHknXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnTkVYVF9QVUJMSUNfQVBQX1VSTCcsXHJcbiAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgIGRlc2NyaXB0aW9uOiAnUHVibGljIGFwcGxpY2F0aW9uIFVSTCBmb3Igd2ViaG9va3MnLFxyXG4gICAgdmFsaWRhdGU6ICh2KSA9PiAodi5zdGFydHNXaXRoKCdodHRwczovLycpIHx8IHYuc3RhcnRzV2l0aCgnaHR0cDovL2xvY2FsaG9zdCcpKSB8fCAnTXVzdCBiZSBhIHZhbGlkIFVSTCdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdORVhUQVVUSF9TRUNSRVQnLFxyXG4gICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICBkZXNjcmlwdGlvbjogJ05leHRBdXRoIHNlY3JldCBmb3Igc2Vzc2lvbiBlbmNyeXB0aW9uJyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5sZW5ndGggPj0gMzIgfHwgJ011c3QgYmUgYXQgbGVhc3QgMzIgY2hhcmFjdGVycydcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdPUEVOQUlfQVBJX0tFWScsXHJcbiAgICByZXF1aXJlZDogZmFsc2UsXHJcbiAgICBkZXNjcmlwdGlvbjogJ09wZW5BSSBBUEkga2V5IGZvciB0cmFuc2xhdGlvbiAob3B0aW9uYWwpJyxcclxuICAgIHZhbGlkYXRlOiAodikgPT4gdi5sZW5ndGggPiAwIHx8ICdNdXN0IG5vdCBiZSBlbXB0eSBpZiBwcm92aWRlZCdcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6ICdUUkFOU0xBVElPTl9MSVZFX0FTU0lTVF9QUkVWSUVXJyxcclxuICAgIHJlcXVpcmVkOiBmYWxzZSxcclxuICAgIGRlc2NyaXB0aW9uOiAnRW5hYmxlIGxpdmUgdHJhbnNsYXRpb24gcHJldmlldyBmZWF0dXJlIChTaWduYWxXaXJlIEFJIEFnZW50cyknLFxyXG4gICAgdmFsaWRhdGU6ICh2KSA9PiB2ID09PSAndHJ1ZScgfHwgdiA9PT0gJ2ZhbHNlJyB8fCAnTXVzdCBiZSBcInRydWVcIiBvciBcImZhbHNlXCInXHJcbiAgfVxyXG5dXHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFZhbGlkYXRpb25SZXN1bHQge1xyXG4gIHZhbGlkOiBib29sZWFuXHJcbiAgZXJyb3JzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgbWVzc2FnZTogc3RyaW5nIH0+XHJcbiAgd2FybmluZ3M6IEFycmF5PHsgbmFtZTogc3RyaW5nOyBtZXNzYWdlOiBzdHJpbmcgfT5cclxufVxyXG5cclxuLyoqXHJcbiAqIFZhbGlkYXRlIGFsbCBlbnZpcm9ubWVudCB2YXJpYWJsZXNcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUVudlZhcnMoKTogVmFsaWRhdGlvblJlc3VsdCB7XHJcbiAgY29uc3QgZXJyb3JzOiBBcnJheTx7IG5hbWU6IHN0cmluZzsgbWVzc2FnZTogc3RyaW5nIH0+ID0gW11cclxuICBjb25zdCB3YXJuaW5nczogQXJyYXk8eyBuYW1lOiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZyB9PiA9IFtdXHJcblxyXG4gIGZvciAoY29uc3QgZW52VmFyIG9mIEVOVl9WQVJTKSB7XHJcbiAgICBjb25zdCB2YWx1ZSA9IHByb2Nlc3MuZW52W2VudlZhci5uYW1lXVxyXG5cclxuICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgaWYgKGVudlZhci5yZXF1aXJlZCkge1xyXG4gICAgICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgICAgIG5hbWU6IGVudlZhci5uYW1lLFxyXG4gICAgICAgICAgbWVzc2FnZTogYFJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlIG1pc3Npbmc6ICR7ZW52VmFyLmRlc2NyaXB0aW9ufWBcclxuICAgICAgICB9KVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHdhcm5pbmdzLnB1c2goe1xyXG4gICAgICAgICAgbmFtZTogZW52VmFyLm5hbWUsXHJcbiAgICAgICAgICBtZXNzYWdlOiBgT3B0aW9uYWwgZW52aXJvbm1lbnQgdmFyaWFibGUgbm90IHNldDogJHtlbnZWYXIuZGVzY3JpcHRpb259YFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH0gZWxzZSBpZiAoZW52VmFyLnZhbGlkYXRlKSB7XHJcbiAgICAgIGNvbnN0IHZhbGlkYXRpb25SZXN1bHQgPSBlbnZWYXIudmFsaWRhdGUodmFsdWUpXHJcbiAgICAgIGlmICh2YWxpZGF0aW9uUmVzdWx0ICE9PSB0cnVlKSB7XHJcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IHR5cGVvZiB2YWxpZGF0aW9uUmVzdWx0ID09PSAnc3RyaW5nJyA/IHZhbGlkYXRpb25SZXN1bHQgOiAnSW52YWxpZCB2YWx1ZSdcclxuICAgICAgICBpZiAoZW52VmFyLnJlcXVpcmVkKSB7XHJcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgICAgIG5hbWU6IGVudlZhci5uYW1lLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgJHtlbnZWYXIuZGVzY3JpcHRpb259OiAke21lc3NhZ2V9YFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgd2FybmluZ3MucHVzaCh7XHJcbiAgICAgICAgICAgIG5hbWU6IGVudlZhci5uYW1lLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiBgJHtlbnZWYXIuZGVzY3JpcHRpb259OiAke21lc3NhZ2V9YFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICB2YWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcclxuICAgIGVycm9ycyxcclxuICAgIHdhcm5pbmdzXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogVmFsaWRhdGUgYW5kIHRocm93IGlmIGludmFsaWQgKGZvciBzdGFydHVwKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlRW52VmFyc09yVGhyb3coKTogdm9pZCB7XHJcbiAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVFbnZWYXJzKClcclxuXHJcbiAgaWYgKCFyZXN1bHQudmFsaWQpIHtcclxuICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPSByZXN1bHQuZXJyb3JzLm1hcChlID0+IGAgIC0gJHtlLm5hbWV9OiAke2UubWVzc2FnZX1gKS5qb2luKCdcXG4nKVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBFbnZpcm9ubWVudCB2YXJpYWJsZSB2YWxpZGF0aW9uIGZhaWxlZDpcXG4ke2Vycm9yTWVzc2FnZXN9YClcclxuICB9XHJcblxyXG4gIGlmIChyZXN1bHQud2FybmluZ3MubGVuZ3RoID4gMCAmJiBwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcbiAgICBjb25zdCB3YXJuaW5nTWVzc2FnZXMgPSByZXN1bHQud2FybmluZ3MubWFwKHcgPT4gYCAgLSAke3cubmFtZX06ICR7dy5tZXNzYWdlfWApLmpvaW4oJ1xcbicpXHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgY29uc29sZS53YXJuKGBFbnZpcm9ubWVudCB2YXJpYWJsZSB3YXJuaW5nczpcXG4ke3dhcm5pbmdNZXNzYWdlc31gKVxyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENoZWNrIGlmIGxpdmUgdHJhbnNsYXRpb24gcHJldmlldyBmZWF0dXJlIGlzIGVuYWJsZWRcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBpc0xpdmVUcmFuc2xhdGlvblByZXZpZXdFbmFibGVkKCk6IGJvb2xlYW4ge1xyXG4gIHJldHVybiBwcm9jZXNzLmVudi5UUkFOU0xBVElPTl9MSVZFX0FTU0lTVF9QUkVWSUVXID09PSAndHJ1ZSdcclxufVxyXG4iXSwibmFtZXMiOlsiRU5WX1ZBUlMiLCJuYW1lIiwicmVxdWlyZWQiLCJkZXNjcmlwdGlvbiIsInZhbGlkYXRlIiwidiIsImxlbmd0aCIsImluY2x1ZGVzIiwic3RhcnRzV2l0aCIsInZhbGlkYXRlRW52VmFycyIsImVycm9ycyIsIndhcm5pbmdzIiwiZW52VmFyIiwidmFsdWUiLCJwcm9jZXNzIiwiZW52IiwicHVzaCIsIm1lc3NhZ2UiLCJ2YWxpZGF0aW9uUmVzdWx0IiwidmFsaWQiLCJ2YWxpZGF0ZUVudlZhcnNPclRocm93IiwicmVzdWx0IiwiZXJyb3JNZXNzYWdlcyIsIm1hcCIsImUiLCJqb2luIiwiRXJyb3IiLCJ3YXJuaW5nTWVzc2FnZXMiLCJ3IiwiY29uc29sZSIsIndhcm4iLCJpc0xpdmVUcmFuc2xhdGlvblByZXZpZXdFbmFibGVkIiwiVFJBTlNMQVRJT05fTElWRV9BU1NJU1RfUFJFVklFVyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/env-validation.ts\n");

/***/ }),

/***/ "(rsc)/./lib/errors/errorCatalog.ts":
/*!************************************!*\
  !*** ./lib/errors/errorCatalog.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ERROR_CATALOG: () => (/* binding */ ERROR_CATALOG),\n/* harmony export */   getDefaultError: () => (/* binding */ getDefaultError),\n/* harmony export */   getErrorDefinition: () => (/* binding */ getErrorDefinition)\n/* harmony export */ });\n/**\r\n * Error Catalog\r\n * \r\n * Centralized error definitions with codes, categories, severities, and messages.\r\n * Per ERROR_HANDLING_PLAN.txt\r\n */ /**\r\n * Error Catalog\r\n */ const ERROR_CATALOG = {\n    // Authentication errors\n    \"AUTH_REQUIRED\": {\n        code: \"AUTH_REQUIRED\",\n        category: \"AUTH\",\n        severity: \"HIGH\",\n        internalMessage: \"Authentication required\",\n        userMessage: \"Please sign in to continue\",\n        httpStatus: 401,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    \"AUTH_ORG_MISMATCH\": {\n        code: \"AUTH_ORG_MISMATCH\",\n        category: \"AUTH\",\n        severity: \"HIGH\",\n        internalMessage: \"User not authorized for organization\",\n        userMessage: \"You do not have access to this organization\",\n        httpStatus: 401,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    \"FORBIDDEN\": {\n        code: \"FORBIDDEN\",\n        category: \"AUTH\",\n        severity: \"HIGH\",\n        internalMessage: \"Insufficient permissions\",\n        userMessage: \"You do not have permission to perform this action\",\n        httpStatus: 403,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    // Database errors\n    \"DB_QUERY_FAILED\": {\n        code: \"DB_QUERY_FAILED\",\n        category: \"DB\",\n        severity: \"HIGH\",\n        internalMessage: \"Database query failed\",\n        userMessage: \"Could not retrieve data. Please try again.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"DB_INSERT_FAILED\": {\n        code: \"DB_INSERT_FAILED\",\n        category: \"DB\",\n        severity: \"HIGH\",\n        internalMessage: \"Database insert failed\",\n        userMessage: \"Could not save data. Please try again.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"DB_UPDATE_FAILED\": {\n        code: \"DB_UPDATE_FAILED\",\n        category: \"DB\",\n        severity: \"HIGH\",\n        internalMessage: \"Database update failed\",\n        userMessage: \"Could not update data. Please try again.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    // Voice/Call errors\n    \"CALL_START_FAILED\": {\n        code: \"CALL_START_FAILED\",\n        category: \"VOICE\",\n        severity: \"HIGH\",\n        internalMessage: \"Failed to start call\",\n        userMessage: \"Unable to place call. Please try again.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"SIGNALWIRE_CONFIG_MISSING\": {\n        code: \"SIGNALWIRE_CONFIG_MISSING\",\n        category: \"EXTERNAL\",\n        severity: \"CRITICAL\",\n        internalMessage: \"SignalWire credentials missing\",\n        userMessage: \"System configuration error. Please contact support.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"SIGNALWIRE_API_ERROR\": {\n        code: \"SIGNALWIRE_API_ERROR\",\n        category: \"EXTERNAL\",\n        severity: \"HIGH\",\n        internalMessage: \"SignalWire API error\",\n        userMessage: \"Call service temporarily unavailable. Please try again.\",\n        httpStatus: 502,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    // AI/Transcription errors\n    \"ASSEMBLYAI_API_ERROR\": {\n        code: \"ASSEMBLYAI_API_ERROR\",\n        category: \"AI\",\n        severity: \"HIGH\",\n        internalMessage: \"AssemblyAI API error\",\n        userMessage: \"Transcription service temporarily unavailable.\",\n        httpStatus: 502,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"TRANSCRIPTION_FAILED\": {\n        code: \"TRANSCRIPTION_FAILED\",\n        category: \"AI\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Transcription processing failed\",\n        userMessage: \"Transcription could not be completed.\",\n        httpStatus: 500,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    \"LIVE_TRANSLATE_EXECUTION_FAILED\": {\n        code: \"LIVE_TRANSLATE_EXECUTION_FAILED\",\n        category: \"EXTERNAL\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Live translation execution failed\",\n        userMessage: \"Live translation encountered an issue. Post-call transcript is still available.\",\n        httpStatus: 500,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    \"LIVE_TRANSLATE_VENDOR_DOWN\": {\n        code: \"LIVE_TRANSLATE_VENDOR_DOWN\",\n        category: \"EXTERNAL\",\n        severity: \"HIGH\",\n        internalMessage: \"Live translation vendor service unavailable\",\n        userMessage: \"Live translation service is temporarily unavailable. Post-call transcript will be available.\",\n        httpStatus: 503,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    // Organization/Plan errors\n    \"PLAN_LIMIT_EXCEEDED\": {\n        code: \"PLAN_LIMIT_EXCEEDED\",\n        category: \"ORG\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Plan limit exceeded\",\n        userMessage: \"This feature is not available on your current plan. Please upgrade.\",\n        httpStatus: 403,\n        shouldAlert: false,\n        trackKPI: true\n    },\n    \"ORG_NOT_FOUND\": {\n        code: \"ORG_NOT_FOUND\",\n        category: \"ORG\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Organization not found\",\n        userMessage: \"Organization not found\",\n        httpStatus: 404,\n        shouldAlert: false,\n        trackKPI: false\n    },\n    // System errors\n    \"SYSTEM_ERROR\": {\n        code: \"SYSTEM_ERROR\",\n        category: \"SYSTEM\",\n        severity: \"CRITICAL\",\n        internalMessage: \"Unexpected system error\",\n        userMessage: \"An unexpected error occurred. Please try again.\",\n        httpStatus: 500,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    \"SERVICE_UNAVAILABLE\": {\n        code: \"SERVICE_UNAVAILABLE\",\n        category: \"SYSTEM\",\n        severity: \"HIGH\",\n        internalMessage: \"Service temporarily unavailable\",\n        userMessage: \"Service temporarily unavailable. Please try again later.\",\n        httpStatus: 503,\n        shouldAlert: true,\n        trackKPI: true\n    },\n    // Input validation errors\n    \"INVALID_INPUT\": {\n        code: \"INVALID_INPUT\",\n        category: \"USER\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Invalid input provided\",\n        userMessage: \"Invalid input. Please check your request and try again.\",\n        httpStatus: 400,\n        shouldAlert: false,\n        trackKPI: false\n    },\n    \"INVALID_PHONE\": {\n        code: \"INVALID_PHONE\",\n        category: \"USER\",\n        severity: \"MEDIUM\",\n        internalMessage: \"Invalid phone number format\",\n        userMessage: \"The phone number provided is invalid. Please verify and try again.\",\n        httpStatus: 400,\n        shouldAlert: false,\n        trackKPI: false\n    }\n};\n/**\r\n * Get error definition by code\r\n */ function getErrorDefinition(code) {\n    return ERROR_CATALOG[code] || null;\n}\n/**\r\n * Get default error definition for unknown errors\r\n */ function getDefaultError() {\n    return ERROR_CATALOG[\"SYSTEM_ERROR\"];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNiQyxVQUFVO0lBQ1o7SUFFQSxnQkFBZ0I7SUFDaEIsZ0JBQWdCO1FBQ2RQLE1BQU07UUFDTkMsVUFBVTtRQUNWQyxVQUFVO1FBQ1ZDLGlCQUFpQjtRQUNqQkMsYUFBYTtRQUNiQyxZQUFZO1FBQ1pDLGFBQWE7UUFDYkMsVUFBVTtJQUNaO0lBQ0EsdUJBQXVCO1FBQ3JCUCxNQUFNO1FBQ05DLFVBQVU7UUFDVkMsVUFBVTtRQUNWQyxpQkFBaUI7UUFDakJDLGFBQWE7UUFDYkMsWUFBWTtRQUNaQyxhQUFhO1FBQ2JDLFVBQVU7SUFDWjtJQUVBLDBCQUEwQjtJQUMxQixpQkFBaUI7UUFDZlAsTUFBTTtRQUNOQyxVQUFVO1FBQ1ZDLFVBQVU7UUFDVkMsaUJBQWlCO1FBQ2pCQyxhQUFhO1FBQ2JDLFlBQVk7UUFDWkMsYUFBYTtRQUNiQyxVQUFVO0lBQ1o7SUFDQSxpQkFBaUI7UUFDZlAsTUFBTTtRQUNOQyxVQUFVO1FBQ1ZDLFVBQVU7UUFDVkMsaUJBQWlCO1FBQ2pCQyxhQUFhO1FBQ2JDLFlBQVk7UUFDWkMsYUFBYTtRQUNiQyxVQUFVO0lBQ1o7QUFDRixFQUFDO0FBRUQ7O0NBRUMsR0FDTSxTQUFTQyxtQkFBbUJSLElBQVk7SUFDN0MsT0FBT0QsYUFBYSxDQUFDQyxLQUFLLElBQUk7QUFDaEM7QUFFQTs7Q0FFQyxHQUNNLFNBQVNTO0lBQ2QsT0FBT1YsYUFBYSxDQUFDLGVBQWU7QUFDdEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nZW1pbmktcHJvamVjdC8uL2xpYi9lcnJvcnMvZXJyb3JDYXRhbG9nLnRzPzAyZWEiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEVycm9yIENhdGFsb2dcclxuICogXHJcbiAqIENlbnRyYWxpemVkIGVycm9yIGRlZmluaXRpb25zIHdpdGggY29kZXMsIGNhdGVnb3JpZXMsIHNldmVyaXRpZXMsIGFuZCBtZXNzYWdlcy5cclxuICogUGVyIEVSUk9SX0hBTkRMSU5HX1BMQU4udHh0XHJcbiAqL1xyXG5cclxuZXhwb3J0IHR5cGUgRXJyb3JDYXRlZ29yeSA9ICdBVVRIJyB8ICdVU0VSJyB8ICdPUkcnIHwgJ0RCJyB8ICdURVNUX0NPTkZJRycgfCAnVEVTVF9FWEVDJyB8ICdEQVRBJyB8ICdTWVNURU0nIHwgJ0VYVEVSTkFMJyB8ICdWT0lDRScgfCAnQUknXHJcbmV4cG9ydCB0eXBlIEVycm9yU2V2ZXJpdHkgPSAnQ1JJVElDQUwnIHwgJ0hJR0gnIHwgJ01FRElVTScgfCAnTE9XJ1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckRlZmluaXRpb24ge1xyXG4gIGNvZGU6IHN0cmluZ1xyXG4gIGNhdGVnb3J5OiBFcnJvckNhdGVnb3J5XHJcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHlcclxuICBpbnRlcm5hbE1lc3NhZ2U6IHN0cmluZ1xyXG4gIHVzZXJNZXNzYWdlOiBzdHJpbmdcclxuICBodHRwU3RhdHVzOiBudW1iZXJcclxuICBzaG91bGRBbGVydDogYm9vbGVhblxyXG4gIHRyYWNrS1BJOiBib29sZWFuXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBFcnJvciBDYXRhbG9nXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgRVJST1JfQ0FUQUxPRzogUmVjb3JkPHN0cmluZywgRXJyb3JEZWZpbml0aW9uPiA9IHtcclxuICAvLyBBdXRoZW50aWNhdGlvbiBlcnJvcnNcclxuICAnQVVUSF9SRVFVSVJFRCc6IHtcclxuICAgIGNvZGU6ICdBVVRIX1JFUVVJUkVEJyxcclxuICAgIGNhdGVnb3J5OiAnQVVUSCcsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdQbGVhc2Ugc2lnbiBpbiB0byBjb250aW51ZScsXHJcbiAgICBodHRwU3RhdHVzOiA0MDEsXHJcbiAgICBzaG91bGRBbGVydDogZmFsc2UsXHJcbiAgICB0cmFja0tQSTogdHJ1ZVxyXG4gIH0sXHJcbiAgJ0FVVEhfT1JHX01JU01BVENIJzoge1xyXG4gICAgY29kZTogJ0FVVEhfT1JHX01JU01BVENIJyxcclxuICAgIGNhdGVnb3J5OiAnQVVUSCcsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnVXNlciBub3QgYXV0aG9yaXplZCBmb3Igb3JnYW5pemF0aW9uJyxcclxuICAgIHVzZXJNZXNzYWdlOiAnWW91IGRvIG5vdCBoYXZlIGFjY2VzcyB0byB0aGlzIG9yZ2FuaXphdGlvbicsXHJcbiAgICBodHRwU3RhdHVzOiA0MDEsXHJcbiAgICBzaG91bGRBbGVydDogZmFsc2UsXHJcbiAgICB0cmFja0tQSTogdHJ1ZVxyXG4gIH0sXHJcbiAgJ0ZPUkJJRERFTic6IHtcclxuICAgIGNvZGU6ICdGT1JCSURERU4nLFxyXG4gICAgY2F0ZWdvcnk6ICdBVVRIJyxcclxuICAgIHNldmVyaXR5OiAnSElHSCcsXHJcbiAgICBpbnRlcm5hbE1lc3NhZ2U6ICdJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdZb3UgZG8gbm90IGhhdmUgcGVybWlzc2lvbiB0byBwZXJmb3JtIHRoaXMgYWN0aW9uJyxcclxuICAgIGh0dHBTdGF0dXM6IDQwMyxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiB0cnVlXHJcbiAgfSxcclxuXHJcbiAgLy8gRGF0YWJhc2UgZXJyb3JzXHJcbiAgJ0RCX1FVRVJZX0ZBSUxFRCc6IHtcclxuICAgIGNvZGU6ICdEQl9RVUVSWV9GQUlMRUQnLFxyXG4gICAgY2F0ZWdvcnk6ICdEQicsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnRGF0YWJhc2UgcXVlcnkgZmFpbGVkJyxcclxuICAgIHVzZXJNZXNzYWdlOiAnQ291bGQgbm90IHJldHJpZXZlIGRhdGEuIFBsZWFzZSB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMCxcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG4gICdEQl9JTlNFUlRfRkFJTEVEJzoge1xyXG4gICAgY29kZTogJ0RCX0lOU0VSVF9GQUlMRUQnLFxyXG4gICAgY2F0ZWdvcnk6ICdEQicsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnRGF0YWJhc2UgaW5zZXJ0IGZhaWxlZCcsXHJcbiAgICB1c2VyTWVzc2FnZTogJ0NvdWxkIG5vdCBzYXZlIGRhdGEuIFBsZWFzZSB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMCxcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG4gICdEQl9VUERBVEVfRkFJTEVEJzoge1xyXG4gICAgY29kZTogJ0RCX1VQREFURV9GQUlMRUQnLFxyXG4gICAgY2F0ZWdvcnk6ICdEQicsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnRGF0YWJhc2UgdXBkYXRlIGZhaWxlZCcsXHJcbiAgICB1c2VyTWVzc2FnZTogJ0NvdWxkIG5vdCB1cGRhdGUgZGF0YS4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxyXG4gICAgaHR0cFN0YXR1czogNTAwLFxyXG4gICAgc2hvdWxkQWxlcnQ6IHRydWUsXHJcbiAgICB0cmFja0tQSTogdHJ1ZVxyXG4gIH0sXHJcblxyXG4gIC8vIFZvaWNlL0NhbGwgZXJyb3JzXHJcbiAgJ0NBTExfU1RBUlRfRkFJTEVEJzoge1xyXG4gICAgY29kZTogJ0NBTExfU1RBUlRfRkFJTEVEJyxcclxuICAgIGNhdGVnb3J5OiAnVk9JQ0UnLFxyXG4gICAgc2V2ZXJpdHk6ICdISUdIJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ0ZhaWxlZCB0byBzdGFydCBjYWxsJyxcclxuICAgIHVzZXJNZXNzYWdlOiAnVW5hYmxlIHRvIHBsYWNlIGNhbGwuIFBsZWFzZSB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMCxcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG4gICdTSUdOQUxXSVJFX0NPTkZJR19NSVNTSU5HJzoge1xyXG4gICAgY29kZTogJ1NJR05BTFdJUkVfQ09ORklHX01JU1NJTkcnLFxyXG4gICAgY2F0ZWdvcnk6ICdFWFRFUk5BTCcsXHJcbiAgICBzZXZlcml0eTogJ0NSSVRJQ0FMJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ1NpZ25hbFdpcmUgY3JlZGVudGlhbHMgbWlzc2luZycsXHJcbiAgICB1c2VyTWVzc2FnZTogJ1N5c3RlbSBjb25maWd1cmF0aW9uIGVycm9yLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LicsXHJcbiAgICBodHRwU3RhdHVzOiA1MDAsXHJcbiAgICBzaG91bGRBbGVydDogdHJ1ZSxcclxuICAgIHRyYWNrS1BJOiB0cnVlXHJcbiAgfSxcclxuICAnU0lHTkFMV0lSRV9BUElfRVJST1InOiB7XHJcbiAgICBjb2RlOiAnU0lHTkFMV0lSRV9BUElfRVJST1InLFxyXG4gICAgY2F0ZWdvcnk6ICdFWFRFUk5BTCcsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnU2lnbmFsV2lyZSBBUEkgZXJyb3InLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdDYWxsIHNlcnZpY2UgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMixcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG5cclxuICAvLyBBSS9UcmFuc2NyaXB0aW9uIGVycm9yc1xyXG4gICdBU1NFTUJMWUFJX0FQSV9FUlJPUic6IHtcclxuICAgIGNvZGU6ICdBU1NFTUJMWUFJX0FQSV9FUlJPUicsXHJcbiAgICBjYXRlZ29yeTogJ0FJJyxcclxuICAgIHNldmVyaXR5OiAnSElHSCcsXHJcbiAgICBpbnRlcm5hbE1lc3NhZ2U6ICdBc3NlbWJseUFJIEFQSSBlcnJvcicsXHJcbiAgICB1c2VyTWVzc2FnZTogJ1RyYW5zY3JpcHRpb24gc2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4nLFxyXG4gICAgaHR0cFN0YXR1czogNTAyLFxyXG4gICAgc2hvdWxkQWxlcnQ6IHRydWUsXHJcbiAgICB0cmFja0tQSTogdHJ1ZVxyXG4gIH0sXHJcbiAgJ1RSQU5TQ1JJUFRJT05fRkFJTEVEJzoge1xyXG4gICAgY29kZTogJ1RSQU5TQ1JJUFRJT05fRkFJTEVEJyxcclxuICAgIGNhdGVnb3J5OiAnQUknLFxyXG4gICAgc2V2ZXJpdHk6ICdNRURJVU0nLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnVHJhbnNjcmlwdGlvbiBwcm9jZXNzaW5nIGZhaWxlZCcsXHJcbiAgICB1c2VyTWVzc2FnZTogJ1RyYW5zY3JpcHRpb24gY291bGQgbm90IGJlIGNvbXBsZXRlZC4nLFxyXG4gICAgaHR0cFN0YXR1czogNTAwLFxyXG4gICAgc2hvdWxkQWxlcnQ6IGZhbHNlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG4gICdMSVZFX1RSQU5TTEFURV9FWEVDVVRJT05fRkFJTEVEJzoge1xyXG4gICAgY29kZTogJ0xJVkVfVFJBTlNMQVRFX0VYRUNVVElPTl9GQUlMRUQnLFxyXG4gICAgY2F0ZWdvcnk6ICdFWFRFUk5BTCcsXHJcbiAgICBzZXZlcml0eTogJ01FRElVTScsXHJcbiAgICBpbnRlcm5hbE1lc3NhZ2U6ICdMaXZlIHRyYW5zbGF0aW9uIGV4ZWN1dGlvbiBmYWlsZWQnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdMaXZlIHRyYW5zbGF0aW9uIGVuY291bnRlcmVkIGFuIGlzc3VlLiBQb3N0LWNhbGwgdHJhbnNjcmlwdCBpcyBzdGlsbCBhdmFpbGFibGUuJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMCxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiB0cnVlXHJcbiAgfSxcclxuICAnTElWRV9UUkFOU0xBVEVfVkVORE9SX0RPV04nOiB7XHJcbiAgICBjb2RlOiAnTElWRV9UUkFOU0xBVEVfVkVORE9SX0RPV04nLFxyXG4gICAgY2F0ZWdvcnk6ICdFWFRFUk5BTCcsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnTGl2ZSB0cmFuc2xhdGlvbiB2ZW5kb3Igc2VydmljZSB1bmF2YWlsYWJsZScsXHJcbiAgICB1c2VyTWVzc2FnZTogJ0xpdmUgdHJhbnNsYXRpb24gc2VydmljZSBpcyB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZS4gUG9zdC1jYWxsIHRyYW5zY3JpcHQgd2lsbCBiZSBhdmFpbGFibGUuJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMyxcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG5cclxuICAvLyBPcmdhbml6YXRpb24vUGxhbiBlcnJvcnNcclxuICAnUExBTl9MSU1JVF9FWENFRURFRCc6IHtcclxuICAgIGNvZGU6ICdQTEFOX0xJTUlUX0VYQ0VFREVEJyxcclxuICAgIGNhdGVnb3J5OiAnT1JHJyxcclxuICAgIHNldmVyaXR5OiAnTUVESVVNJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ1BsYW4gbGltaXQgZXhjZWVkZWQnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdUaGlzIGZlYXR1cmUgaXMgbm90IGF2YWlsYWJsZSBvbiB5b3VyIGN1cnJlbnQgcGxhbi4gUGxlYXNlIHVwZ3JhZGUuJyxcclxuICAgIGh0dHBTdGF0dXM6IDQwMyxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiB0cnVlXHJcbiAgfSxcclxuICAnT1JHX05PVF9GT1VORCc6IHtcclxuICAgIGNvZGU6ICdPUkdfTk9UX0ZPVU5EJyxcclxuICAgIGNhdGVnb3J5OiAnT1JHJyxcclxuICAgIHNldmVyaXR5OiAnTUVESVVNJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ09yZ2FuaXphdGlvbiBub3QgZm91bmQnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdPcmdhbml6YXRpb24gbm90IGZvdW5kJyxcclxuICAgIGh0dHBTdGF0dXM6IDQwNCxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiBmYWxzZVxyXG4gIH0sXHJcblxyXG4gIC8vIFN5c3RlbSBlcnJvcnNcclxuICAnU1lTVEVNX0VSUk9SJzoge1xyXG4gICAgY29kZTogJ1NZU1RFTV9FUlJPUicsXHJcbiAgICBjYXRlZ29yeTogJ1NZU1RFTScsXHJcbiAgICBzZXZlcml0eTogJ0NSSVRJQ0FMJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ1VuZXhwZWN0ZWQgc3lzdGVtIGVycm9yJyxcclxuICAgIHVzZXJNZXNzYWdlOiAnQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2Fpbi4nLFxyXG4gICAgaHR0cFN0YXR1czogNTAwLFxyXG4gICAgc2hvdWxkQWxlcnQ6IHRydWUsXHJcbiAgICB0cmFja0tQSTogdHJ1ZVxyXG4gIH0sXHJcbiAgJ1NFUlZJQ0VfVU5BVkFJTEFCTEUnOiB7XHJcbiAgICBjb2RlOiAnU0VSVklDRV9VTkFWQUlMQUJMRScsXHJcbiAgICBjYXRlZ29yeTogJ1NZU1RFTScsXHJcbiAgICBzZXZlcml0eTogJ0hJR0gnLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnU2VydmljZSB0ZW1wb3JhcmlseSB1bmF2YWlsYWJsZScsXHJcbiAgICB1c2VyTWVzc2FnZTogJ1NlcnZpY2UgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcclxuICAgIGh0dHBTdGF0dXM6IDUwMyxcclxuICAgIHNob3VsZEFsZXJ0OiB0cnVlLFxyXG4gICAgdHJhY2tLUEk6IHRydWVcclxuICB9LFxyXG5cclxuICAvLyBJbnB1dCB2YWxpZGF0aW9uIGVycm9yc1xyXG4gICdJTlZBTElEX0lOUFVUJzoge1xyXG4gICAgY29kZTogJ0lOVkFMSURfSU5QVVQnLFxyXG4gICAgY2F0ZWdvcnk6ICdVU0VSJyxcclxuICAgIHNldmVyaXR5OiAnTUVESVVNJyxcclxuICAgIGludGVybmFsTWVzc2FnZTogJ0ludmFsaWQgaW5wdXQgcHJvdmlkZWQnLFxyXG4gICAgdXNlck1lc3NhZ2U6ICdJbnZhbGlkIGlucHV0LiBQbGVhc2UgY2hlY2sgeW91ciByZXF1ZXN0IGFuZCB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDQwMCxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiBmYWxzZVxyXG4gIH0sXHJcbiAgJ0lOVkFMSURfUEhPTkUnOiB7XHJcbiAgICBjb2RlOiAnSU5WQUxJRF9QSE9ORScsXHJcbiAgICBjYXRlZ29yeTogJ1VTRVInLFxyXG4gICAgc2V2ZXJpdHk6ICdNRURJVU0nLFxyXG4gICAgaW50ZXJuYWxNZXNzYWdlOiAnSW52YWxpZCBwaG9uZSBudW1iZXIgZm9ybWF0JyxcclxuICAgIHVzZXJNZXNzYWdlOiAnVGhlIHBob25lIG51bWJlciBwcm92aWRlZCBpcyBpbnZhbGlkLiBQbGVhc2UgdmVyaWZ5IGFuZCB0cnkgYWdhaW4uJyxcclxuICAgIGh0dHBTdGF0dXM6IDQwMCxcclxuICAgIHNob3VsZEFsZXJ0OiBmYWxzZSxcclxuICAgIHRyYWNrS1BJOiBmYWxzZVxyXG4gIH0sXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgZXJyb3IgZGVmaW5pdGlvbiBieSBjb2RlXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXJyb3JEZWZpbml0aW9uKGNvZGU6IHN0cmluZyk6IEVycm9yRGVmaW5pdGlvbiB8IG51bGwge1xyXG4gIHJldHVybiBFUlJPUl9DQVRBTE9HW2NvZGVdIHx8IG51bGxcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldCBkZWZhdWx0IGVycm9yIGRlZmluaXRpb24gZm9yIHVua25vd24gZXJyb3JzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0RGVmYXVsdEVycm9yKCk6IEVycm9yRGVmaW5pdGlvbiB7XHJcbiAgcmV0dXJuIEVSUk9SX0NBVEFMT0dbJ1NZU1RFTV9FUlJPUiddXHJcbn1cclxuIl0sIm5hbWVzIjpbIkVSUk9SX0NBVEFMT0ciLCJjb2RlIiwiY2F0ZWdvcnkiLCJzZXZlcml0eSIsImludGVybmFsTWVzc2FnZSIsInVzZXJNZXNzYWdlIiwiaHR0cFN0YXR1cyIsInNob3VsZEFsZXJ0IiwidHJhY2tLUEkiLCJnZXRFcnJvckRlZmluaXRpb24iLCJnZXREZWZhdWx0RXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/errors/errorCatalog.ts\n");

/***/ }),

/***/ "(rsc)/./lib/supabaseAdmin.ts":
/*!******************************!*\
  !*** ./lib/supabaseAdmin.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/index.mjs\");\n/**\r\n * Supabase Admin Client (Service Role)\r\n * \r\n * This client uses the service role key which bypasses Row Level Security (RLS).\r\n * Use this ONLY for server-side operations that require elevated permissions.\r\n * \r\n * NEVER expose the service role key to the client!\r\n */ \n// Support both SUPABASE_URL and NEXT_PUBLIC_SUPABASE_URL for compatibility\nconst supabaseUrl = process.env.SUPABASE_URL || \"https://fiijrhpjpebevfavzlhu.supabase.co\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nif (!supabaseUrl) {\n    throw new Error(\"Missing SUPABASE_URL or NEXT_PUBLIC_SUPABASE_URL environment variable\");\n}\nif (!supabaseServiceKey) {\n    throw new Error(\"Missing SUPABASE_SERVICE_ROLE_KEY environment variable\");\n}\nconst supabaseAdmin = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n});\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (supabaseAdmin);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2VBZG1pbi50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBOzs7Ozs7O0NBT0MsR0FFbUQ7QUFFcEQsMkVBQTJFO0FBQzNFLE1BQU1DLGNBQWNDLFFBQVFDLEdBQUcsQ0FBQ0MsWUFBWSxJQUFJRiwwQ0FBb0M7QUFDcEYsTUFBTUkscUJBQXFCSixRQUFRQyxHQUFHLENBQUNJLHlCQUF5QjtBQUVoRSxJQUFJLENBQUNOLGFBQWE7SUFDaEIsTUFBTSxJQUFJTyxNQUFNO0FBQ2xCO0FBRUEsSUFBSSxDQUFDRixvQkFBb0I7SUFDdkIsTUFBTSxJQUFJRSxNQUFNO0FBQ2xCO0FBRUEsTUFBTUMsZ0JBQWdCVCxtRUFBWUEsQ0FBQ0MsYUFBYUssb0JBQW9CO0lBQ2xFSSxNQUFNO1FBQ0pDLGtCQUFrQjtRQUNsQkMsZ0JBQWdCO0lBQ2xCO0FBQ0Y7QUFFQSxpRUFBZUgsYUFBYUEsRUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL2dlbWluaS1wcm9qZWN0Ly4vbGliL3N1cGFiYXNlQWRtaW4udHM/MDlkNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogU3VwYWJhc2UgQWRtaW4gQ2xpZW50IChTZXJ2aWNlIFJvbGUpXHJcbiAqIFxyXG4gKiBUaGlzIGNsaWVudCB1c2VzIHRoZSBzZXJ2aWNlIHJvbGUga2V5IHdoaWNoIGJ5cGFzc2VzIFJvdyBMZXZlbCBTZWN1cml0eSAoUkxTKS5cclxuICogVXNlIHRoaXMgT05MWSBmb3Igc2VydmVyLXNpZGUgb3BlcmF0aW9ucyB0aGF0IHJlcXVpcmUgZWxldmF0ZWQgcGVybWlzc2lvbnMuXHJcbiAqIFxyXG4gKiBORVZFUiBleHBvc2UgdGhlIHNlcnZpY2Ugcm9sZSBrZXkgdG8gdGhlIGNsaWVudCFcclxuICovXHJcblxyXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXHJcblxyXG4vLyBTdXBwb3J0IGJvdGggU1VQQUJBU0VfVVJMIGFuZCBORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwgZm9yIGNvbXBhdGliaWxpdHlcclxuY29uc3Qgc3VwYWJhc2VVcmwgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9VUkwgfHwgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMXHJcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVlcclxuXHJcbmlmICghc3VwYWJhc2VVcmwpIHtcclxuICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgU1VQQUJBU0VfVVJMIG9yIE5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCBlbnZpcm9ubWVudCB2YXJpYWJsZScpXHJcbn1cclxuXHJcbmlmICghc3VwYWJhc2VTZXJ2aWNlS2V5KSB7XHJcbiAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIFNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgZW52aXJvbm1lbnQgdmFyaWFibGUnKVxyXG59XHJcblxyXG5jb25zdCBzdXBhYmFzZUFkbWluID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcclxuICBhdXRoOiB7XHJcbiAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcclxuICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZVxyXG4gIH1cclxufSlcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHN1cGFiYXNlQWRtaW5cclxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIlNVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJFcnJvciIsInN1cGFiYXNlQWRtaW4iLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabaseAdmin.ts\n");

/***/ }),

/***/ "(rsc)/./types/app-error.ts":
/*!****************************!*\
  !*** ./types/app-error.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AppError: () => (/* binding */ AppError),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nclass AppError extends Error {\n    constructor(opts){\n        super(opts.message);\n        this.id = opts.id ?? \"err_\" + Math.random().toString(36).slice(2, 9);\n        this.code = opts.code;\n        this.user_message = opts.user_message;\n        this.severity = opts.severity ?? \"MEDIUM\";\n        this.retriable = !!opts.retriable;\n        this.details = opts.details;\n        // Get HTTP status from error catalog\n        try {\n            const { getErrorDefinition } = __webpack_require__(/*! @/lib/errors/errorCatalog */ \"(rsc)/./lib/errors/errorCatalog.ts\");\n            const errorDef = getErrorDefinition(this.code);\n            this.httpStatus = errorDef?.httpStatus || 500;\n        } catch  {\n            this.httpStatus = 500;\n        }\n    }\n    toJSON() {\n        return {\n            id: this.id,\n            code: this.code,\n            message: this.message,\n            user_message: this.user_message,\n            severity: this.severity,\n            httpStatus: this.httpStatus\n        };\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (AppError);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi90eXBlcy9hcHAtZXJyb3IudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFVTyxNQUFNQSxpQkFBaUJDO0lBUzVCQyxZQUFZQyxJQUFxQixDQUFFO1FBQ2pDLEtBQUssQ0FBQ0EsS0FBS0MsT0FBTztRQUNsQixJQUFJLENBQUNDLEVBQUUsR0FBR0YsS0FBS0UsRUFBRSxJQUFJLFNBQVNDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLEtBQUssQ0FBQyxHQUFHO1FBQ2xFLElBQUksQ0FBQ0MsSUFBSSxHQUFHUCxLQUFLTyxJQUFJO1FBQ3JCLElBQUksQ0FBQ0MsWUFBWSxHQUFHUixLQUFLUSxZQUFZO1FBQ3JDLElBQUksQ0FBQ0MsUUFBUSxHQUFHVCxLQUFLUyxRQUFRLElBQUk7UUFDakMsSUFBSSxDQUFDQyxTQUFTLEdBQUcsQ0FBQyxDQUFDVixLQUFLVSxTQUFTO1FBQ2pDLElBQUksQ0FBQ0MsT0FBTyxHQUFHWCxLQUFLVyxPQUFPO1FBRTNCLHFDQUFxQztRQUNyQyxJQUFJO1lBQ0YsTUFBTSxFQUFFQyxrQkFBa0IsRUFBRSxHQUFHQyxtQkFBT0EsQ0FBQztZQUN2QyxNQUFNQyxXQUFXRixtQkFBbUIsSUFBSSxDQUFDTCxJQUFJO1lBQzdDLElBQUksQ0FBQ1EsVUFBVSxHQUFHRCxVQUFVQyxjQUFjO1FBQzVDLEVBQUUsT0FBTTtZQUNOLElBQUksQ0FBQ0EsVUFBVSxHQUFHO1FBQ3BCO0lBQ0Y7SUFFQUMsU0FBUztRQUNQLE9BQU87WUFBRWQsSUFBSSxJQUFJLENBQUNBLEVBQUU7WUFBRUssTUFBTSxJQUFJLENBQUNBLElBQUk7WUFBRU4sU0FBUyxJQUFJLENBQUNBLE9BQU87WUFBRU8sY0FBYyxJQUFJLENBQUNBLFlBQVk7WUFBRUMsVUFBVSxJQUFJLENBQUNBLFFBQVE7WUFBRU0sWUFBWSxJQUFJLENBQUNBLFVBQVU7UUFBQztJQUN0SjtBQUNGO0FBRUEsaUVBQWVsQixRQUFRQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ2VtaW5pLXByb2plY3QvLi90eXBlcy9hcHAtZXJyb3IudHM/MDQ1NCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdHlwZSBBcHBFcnJvck9wdGlvbnMgPSB7XHJcbiAgaWQ/OiBzdHJpbmdcclxuICBjb2RlOiBzdHJpbmdcclxuICBtZXNzYWdlOiBzdHJpbmdcclxuICB1c2VyX21lc3NhZ2U/OiBzdHJpbmdcclxuICBzZXZlcml0eT86ICdDUklUSUNBTCcgfCAnSElHSCcgfCAnTUVESVVNJyB8ICdMT1cnXHJcbiAgcmV0cmlhYmxlPzogYm9vbGVhblxyXG4gIGRldGFpbHM/OiBhbnlcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gIGlkOiBzdHJpbmdcclxuICBjb2RlOiBzdHJpbmdcclxuICB1c2VyX21lc3NhZ2U/OiBzdHJpbmdcclxuICBzZXZlcml0eTogJ0NSSVRJQ0FMJyB8ICdISUdIJyB8ICdNRURJVU0nIHwgJ0xPVydcclxuICByZXRyaWFibGU6IGJvb2xlYW5cclxuICBkZXRhaWxzOiBhbnlcclxuICBodHRwU3RhdHVzOiBudW1iZXJcclxuXHJcbiAgY29uc3RydWN0b3Iob3B0czogQXBwRXJyb3JPcHRpb25zKSB7XHJcbiAgICBzdXBlcihvcHRzLm1lc3NhZ2UpXHJcbiAgICB0aGlzLmlkID0gb3B0cy5pZCA/PyAnZXJyXycgKyBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyLCA5KVxyXG4gICAgdGhpcy5jb2RlID0gb3B0cy5jb2RlXHJcbiAgICB0aGlzLnVzZXJfbWVzc2FnZSA9IG9wdHMudXNlcl9tZXNzYWdlXHJcbiAgICB0aGlzLnNldmVyaXR5ID0gb3B0cy5zZXZlcml0eSA/PyAnTUVESVVNJ1xyXG4gICAgdGhpcy5yZXRyaWFibGUgPSAhIW9wdHMucmV0cmlhYmxlXHJcbiAgICB0aGlzLmRldGFpbHMgPSBvcHRzLmRldGFpbHNcclxuICAgIFxyXG4gICAgLy8gR2V0IEhUVFAgc3RhdHVzIGZyb20gZXJyb3IgY2F0YWxvZ1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBnZXRFcnJvckRlZmluaXRpb24gfSA9IHJlcXVpcmUoJ0AvbGliL2Vycm9ycy9lcnJvckNhdGFsb2cnKVxyXG4gICAgICBjb25zdCBlcnJvckRlZiA9IGdldEVycm9yRGVmaW5pdGlvbih0aGlzLmNvZGUpXHJcbiAgICAgIHRoaXMuaHR0cFN0YXR1cyA9IGVycm9yRGVmPy5odHRwU3RhdHVzIHx8IDUwMFxyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIHRoaXMuaHR0cFN0YXR1cyA9IDUwMFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgdG9KU09OKCkge1xyXG4gICAgcmV0dXJuIHsgaWQ6IHRoaXMuaWQsIGNvZGU6IHRoaXMuY29kZSwgbWVzc2FnZTogdGhpcy5tZXNzYWdlLCB1c2VyX21lc3NhZ2U6IHRoaXMudXNlcl9tZXNzYWdlLCBzZXZlcml0eTogdGhpcy5zZXZlcml0eSwgaHR0cFN0YXR1czogdGhpcy5odHRwU3RhdHVzIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEFwcEVycm9yXHJcbiBcclxuIl0sIm5hbWVzIjpbIkFwcEVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm9wdHMiLCJtZXNzYWdlIiwiaWQiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzbGljZSIsImNvZGUiLCJ1c2VyX21lc3NhZ2UiLCJzZXZlcml0eSIsInJldHJpYWJsZSIsImRldGFpbHMiLCJnZXRFcnJvckRlZmluaXRpb24iLCJyZXF1aXJlIiwiZXJyb3JEZWYiLCJodHRwU3RhdHVzIiwidG9KU09OIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./types/app-error.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/@supabase","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/oauth","vendor-chunks/iceberg-js","vendor-chunks/tslib","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/@next-auth","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcalls%2Fstart%2Froute&page=%2Fapi%2Fcalls%2Fstart%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcalls%2Fstart%2Froute.ts&appDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CUltimate%20Warrior%5CMy%20project%5Cgemini-project&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();