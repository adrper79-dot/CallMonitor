(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{621:function(e,n,i){Promise.resolve().then(i.bind(i,1265)),Promise.resolve().then(i.bind(i,5613))},1265:function(e,n,i){"use strict";i.d(n,{default:function(){return l}});var t=i(7437);i(2265);var r=i(605);function l(e){let{children:n}=e;return(0,t.jsx)(r.SessionProvider,{children:n})}},5613:function(e,n,i){"use strict";i.d(n,{default:function(){return a}});var t=i(7437),r=i(2265),l=i(605);function a(){let{data:e}=(0,l.useSession)(),[n,i]=(0,r.useState)(""),[a,d]=(0,r.useState)(""),[s,o]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),[c,g]=(0,r.useState)(null),[x,b]=(0,r.useState)("signin"),[f,h]=(0,r.useState)("email"),[m,v]=(0,r.useState)(null),[y,j]=(0,r.useState)(null);async function S(e){if(e.preventDefault(),g("processing"),"signup"===x){if(!n||!s){g("Please fill in all required fields");return}try{let e=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:s,name:u||void 0})}),t=await e.json();if(!e.ok){var i;g((null==t?void 0:null===(i=t.error)||void 0===i?void 0:i.message)||"Signup failed");return}g("Account created! Signing in...");let r=await (0,l.signIn)("credentials",{username:n,password:s,redirect:!1});r&&r.error?g("Account created, but sign-in failed. Please try signing in manually."):g("signed-in")}catch(e){g("Signup failed: "+((null==e?void 0:e.message)||"Unknown error"))}}else if("email"===f){let e=(n||"").trim();if(!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(e)){g("invalid email");return}let i=await (0,l.signIn)("email",{email:e,redirect:!1});i&&i.error?g("failed"):g("sent")}else{let e=(a||n).trim();if(!e||!s){g("Please enter username/email and password");return}let i=await (0,l.signIn)("credentials",{username:e,password:s,redirect:!1});i&&i.error?g("failed"):g("signed-in")}}async function w(){g("redirecting"),await (0,l.signIn)("google",{callbackUrl:window.location.href})}if((0,r.useEffect)(()=>{let e=!0;return fetch("/api/_health/auth-providers").then(e=>e.json()).then(n=>{!e||(v(!!((null==n?void 0:n.adapterEnv)&&(null==n?void 0:n.resendEnv))),j(!!(null==n?void 0:n.googleEnv)),(null==n?void 0:n.adapterEnv)||h("credentials"))}).catch(()=>{e&&(v(!1),j(!1))}),()=>{e=!1}},[]),e){var C,k;return(0,t.jsxs)("div",{style:{padding:8,background:"#f3f4f6",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("span",{children:["Signed in as ",(null===(C=e.user)||void 0===C?void 0:C.email)||(null===(k=e.user)||void 0===k?void 0:k.name)]}),(0,t.jsx)("button",{onClick:()=>(0,l.signOut)(),style:{padding:"4px 8px",fontSize:"12px"},children:"Sign out"})]})}return(0,t.jsxs)("div",{style:{padding:16,background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12},children:[(0,t.jsxs)("button",{type:"button",onClick:()=>{b("signin"),g(null)},style:{padding:6,fontWeight:"signin"===x?"bold":"normal"},children:["signin"===x?"•":" "," Sign In"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>{b("signup"),g(null)},style:{padding:6,fontWeight:"signup"===x?"bold":"normal"},children:["signup"===x?"•":" "," Sign Up"]})]}),y&&"signin"===x&&(0,t.jsx)("div",{style:{marginBottom:12},children:(0,t.jsxs)("button",{type:"button",onClick:w,style:{padding:"8px 16px",width:"100%",background:"#fff",border:"1px solid #d1d5db",borderRadius:"4px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[(0,t.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 18 18",children:[(0,t.jsx)("path",{fill:"#4285F4",d:"M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z"}),(0,t.jsx)("path",{fill:"#34A853",d:"M9 18c2.43 0 4.467-.806 5.956-2.184l-2.908-2.258c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332C2.438 15.983 5.482 18 9 18z"}),(0,t.jsx)("path",{fill:"#FBBC05",d:"M3.964 10.707c-.18-.54-.282-1.117-.282-1.707s.102-1.167.282-1.707V4.961H.957C.347 6.175 0 7.55 0 9s.348 2.825.957 4.039l3.007-2.332z"}),(0,t.jsx)("path",{fill:"#EA4335",d:"M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0 5.482 0 2.438 2.017.957 4.961L3.964 7.293C4.672 5.163 6.656 3.58 9 3.58z"})]}),"Sign in with Google"]})}),"signin"===x&&(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[!1!==m&&(0,t.jsxs)("button",{type:"button",onClick:()=>h("email"),style:{padding:6,fontSize:"12px"},children:["email"===f?"•":" "," Email link"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>h("credentials"),style:{padding:6,fontSize:"12px"},children:["credentials"===f?"•":" "," Username/Password"]})]}),(0,t.jsxs)("form",{onSubmit:S,style:{display:"flex",flexDirection:"column",gap:8},children:["signup"===x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{"aria-label":"name",placeholder:"Name (optional)",value:u,onChange:e=>p(e.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("input",{"aria-label":"email",placeholder:"Email *",type:"email",value:n,onChange:e=>i(e.target.value),required:!0,style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("input",{"aria-label":"password",placeholder:"Password (min 8 characters) *",type:"password",value:s,onChange:e=>o(e.target.value),required:!0,minLength:8,style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("button",{type:"submit",style:{padding:"8px 16px",background:"#4f46e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Create Account"})]}):"email"===f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{"aria-label":"email",placeholder:"Email",type:"email",value:n,onChange:e=>i(e.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("button",{type:"submit",style:{padding:"8px 16px",background:"#4f46e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Send sign-in link"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{"aria-label":"username",placeholder:"Username or Email",value:a,onChange:e=>d(e.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("input",{"aria-label":"password",placeholder:"Password",type:"password",value:s,onChange:e=>o(e.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #d1d5db"}}),(0,t.jsx)("button",{type:"submit",style:{padding:"8px 16px",background:"#4f46e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Sign in"})]}),c&&(0,t.jsx)("div",{style:{padding:"8px",borderRadius:"4px",background:c.includes("failed")||c.includes("error")?"#fee2e2":"#d1fae5",color:c.includes("failed")||c.includes("error")?"#991b1b":"#065f46",fontSize:"14px"},children:c})]})]})}}},function(e){e.O(0,[605,971,117,744],function(){return e(e.s=621)}),_N_E=e.O()}]);