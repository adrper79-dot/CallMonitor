{
  "query": "\n      SELECT\n        p.oid,\n        p.polname AS policy_name,\n        n.nspname AS schema,\n        c.relname AS table_name,\n        p.polcmd AS cmd,\n        p.polpermissive AS permissive,\n        CASE WHEN p.polqual IS NULL THEN NULL ELSE pg_get_expr(p.polqual, p.polrelid) END AS qual,\n        CASE WHEN p.polwithcheck IS NULL THEN NULL ELSE pg_get_expr(p.polwithcheck, p.polrelid) END AS with_check,\n        p.polroles::text AS roles_raw\n      FROM pg_policy p\n      JOIN pg_class c ON p.polrelid = c.oid\n      JOIN pg_namespace n ON c.relnamespace = n.oid\n      WHERE n.nspname = 'public'\n      ORDER BY c.relname, p.polname;\n    ",
  "rows": [
    {
      "oid": 24591,
      "policy_name": "deny_all_access_grants",
      "schema": "public",
      "table_name": "access_grants_archived",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": "false",
      "roles_raw": "{0}"
    },
    {
      "oid": 48104,
      "policy_name": "Allow all operations on accounts",
      "schema": "public",
      "table_name": "accounts",
      "cmd": "*",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36781,
      "policy_name": "Service role can manage AI audit logs",
      "schema": "public",
      "table_name": "ai_agent_audit_log",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36780,
      "policy_name": "Users can view own organization AI audit logs",
      "schema": "public",
      "table_name": "ai_agent_audit_log",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46534,
      "policy_name": "ai_runs_insert_all",
      "schema": "public",
      "table_name": "ai_runs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46533,
      "policy_name": "ai_runs_select_org",
      "schema": "public",
      "table_name": "ai_runs",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM calls\n  WHERE ((calls.id = ai_runs.call_id) AND (calls.organization_id = get_user_organization_id()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46535,
      "policy_name": "ai_runs_update_all",
      "schema": "public",
      "table_name": "ai_runs",
      "cmd": "w",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18794,
      "policy_name": "allow_public_insert_alerts",
      "schema": "public",
      "table_name": "alert_acknowledgements",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 18795,
      "policy_name": "allow_public_select_alerts",
      "schema": "public",
      "table_name": "alert_acknowledgements",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24285,
      "policy_name": "alerts_tenant_policy",
      "schema": "public",
      "table_name": "alerts",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = (current_setting('jwt.claims.organization_id'::text))::uuid)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33768,
      "policy_name": "artifact_provenance_insert_all",
      "schema": "public",
      "table_name": "artifact_provenance",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 33767,
      "policy_name": "artifact_provenance_select_org",
      "schema": "public",
      "table_name": "artifact_provenance",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44024,
      "policy_name": "attention_decisions_insert_service",
      "schema": "public",
      "table_name": "attention_decisions",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 44023,
      "policy_name": "attention_decisions_select_org",
      "schema": "public",
      "table_name": "attention_decisions",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44022,
      "policy_name": "attention_events_insert_service",
      "schema": "public",
      "table_name": "attention_events",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 44021,
      "policy_name": "attention_events_select_org",
      "schema": "public",
      "table_name": "attention_events",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44019,
      "policy_name": "attention_policies_insert_admin",
      "schema": "public",
      "table_name": "attention_policies",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 44018,
      "policy_name": "attention_policies_select_org",
      "schema": "public",
      "table_name": "attention_policies",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44020,
      "policy_name": "attention_policies_update_admin",
      "schema": "public",
      "table_name": "attention_policies",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46561,
      "policy_name": "audit_logs_insert_all",
      "schema": "public",
      "table_name": "audit_logs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 28142,
      "policy_name": "audit_logs_insert_org_members",
      "schema": "public",
      "table_name": "audit_logs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "((EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = audit_logs.organization_id) AND (om.user_id = auth.uid())))) AND (user_id = auth.uid()))",
      "roles_raw": "{16481}"
    },
    {
      "oid": 46560,
      "policy_name": "audit_logs_select_org",
      "schema": "public",
      "table_name": "audit_logs",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39842,
      "policy_name": "Service role can manage checklists",
      "schema": "public",
      "table_name": "call_confirmation_checklists",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39841,
      "policy_name": "Users can update own org checklists",
      "schema": "public",
      "table_name": "call_confirmation_checklists",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39840,
      "policy_name": "Users can view own org checklists",
      "schema": "public",
      "table_name": "call_confirmation_checklists",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39836,
      "policy_name": "Service role can manage confirmations",
      "schema": "public",
      "table_name": "call_confirmations",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39835,
      "policy_name": "Users can create confirmations for own org",
      "schema": "public",
      "table_name": "call_confirmations",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "roles_raw": "{0}"
    },
    {
      "oid": 39834,
      "policy_name": "Users can view own org confirmations",
      "schema": "public",
      "table_name": "call_confirmations",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33831,
      "policy_name": "call_export_bundles_insert_org",
      "schema": "public",
      "table_name": "call_export_bundles",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 33830,
      "policy_name": "call_export_bundles_select_org",
      "schema": "public",
      "table_name": "call_export_bundles",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43854,
      "policy_name": "caller_id_default_rules_insert",
      "schema": "public",
      "table_name": "caller_id_default_rules",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 43853,
      "policy_name": "caller_id_default_rules_select",
      "schema": "public",
      "table_name": "caller_id_default_rules",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43855,
      "policy_name": "caller_id_default_rules_update",
      "schema": "public",
      "table_name": "caller_id_default_rules",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43851,
      "policy_name": "caller_id_permissions_insert",
      "schema": "public",
      "table_name": "caller_id_permissions",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 43850,
      "policy_name": "caller_id_permissions_select",
      "schema": "public",
      "table_name": "caller_id_permissions",
      "cmd": "r",
      "permissive": true,
      "qual": "((user_id = auth.uid()) OR (organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text]))))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43852,
      "policy_name": "caller_id_permissions_update",
      "schema": "public",
      "table_name": "caller_id_permissions",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24284,
      "policy_name": "calls_creator_policy",
      "schema": "public",
      "table_name": "calls",
      "cmd": "w",
      "permissive": true,
      "qual": "(created_by = auth.uid())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46528,
      "policy_name": "calls_insert_org",
      "schema": "public",
      "table_name": "calls",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46527,
      "policy_name": "calls_select_org",
      "schema": "public",
      "table_name": "calls",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24283,
      "policy_name": "calls_tenant_policy",
      "schema": "public",
      "table_name": "calls",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = (current_setting('jwt.claims.organization_id'::text))::uuid)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46529,
      "policy_name": "calls_update_org",
      "schema": "public",
      "table_name": "calls",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25804,
      "policy_name": "cas_delete_calls",
      "schema": "public",
      "table_name": "calls",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = calls.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25801,
      "policy_name": "cas_insert_calls",
      "schema": "public",
      "table_name": "calls",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = calls.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 25800,
      "policy_name": "cas_select_calls",
      "schema": "public",
      "table_name": "calls",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = calls.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25802,
      "policy_name": "cas_update_calls",
      "schema": "public",
      "table_name": "calls",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = calls.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = calls.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46548,
      "policy_name": "campaigns_delete_org",
      "schema": "public",
      "table_name": "campaigns",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46546,
      "policy_name": "campaigns_insert_org",
      "schema": "public",
      "table_name": "campaigns",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46545,
      "policy_name": "campaigns_select_org",
      "schema": "public",
      "table_name": "campaigns",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46547,
      "policy_name": "campaigns_update_org",
      "schema": "public",
      "table_name": "campaigns",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24593,
      "policy_name": "deny_all_capabilities",
      "schema": "public",
      "table_name": "capabilities_archived",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": "false",
      "roles_raw": "{0}"
    },
    {
      "oid": 21530,
      "policy_name": "Public read access to carrier status",
      "schema": "public",
      "table_name": "carrier_status",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21532,
      "policy_name": "Service role can update carrier status",
      "schema": "public",
      "table_name": "carrier_status",
      "cmd": "w",
      "permissive": true,
      "qual": "(auth.role() = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39933,
      "policy_name": "Service role can manage restrictions",
      "schema": "public",
      "table_name": "compliance_restrictions",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39932,
      "policy_name": "Users can view compliance restrictions",
      "schema": "public",
      "table_name": "compliance_restrictions",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39935,
      "policy_name": "Admins can manage violations",
      "schema": "public",
      "table_name": "compliance_violations",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE ((om.user_id = auth.uid()) AND (om.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39936,
      "policy_name": "Service role can manage violations",
      "schema": "public",
      "table_name": "compliance_violations",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39934,
      "policy_name": "Users can view own org violations",
      "schema": "public",
      "table_name": "compliance_violations",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39838,
      "policy_name": "Admins can manage org templates",
      "schema": "public",
      "table_name": "confirmation_templates",
      "cmd": "*",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE ((om.user_id = auth.uid()) AND (om.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39839,
      "policy_name": "Service role can manage templates",
      "schema": "public",
      "table_name": "confirmation_templates",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39837,
      "policy_name": "Users can view own org templates",
      "schema": "public",
      "table_name": "confirmation_templates",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43752,
      "policy_name": "crm_object_links_insert_service",
      "schema": "public",
      "table_name": "crm_object_links",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 43751,
      "policy_name": "crm_object_links_select_org",
      "schema": "public",
      "table_name": "crm_object_links",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43754,
      "policy_name": "crm_sync_log_insert_service",
      "schema": "public",
      "table_name": "crm_sync_log",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 43753,
      "policy_name": "crm_sync_log_select_org",
      "schema": "public",
      "table_name": "crm_sync_log",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44028,
      "policy_name": "digest_items_insert_service",
      "schema": "public",
      "table_name": "digest_items",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 44027,
      "policy_name": "digest_items_select_org",
      "schema": "public",
      "table_name": "digest_items",
      "cmd": "r",
      "permissive": true,
      "qual": "(digest_id IN ( SELECT d.id\n   FROM digests d\n  WHERE (d.organization_id IN ( SELECT org_members.organization_id\n           FROM org_members\n          WHERE (org_members.user_id = auth.uid())))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44026,
      "policy_name": "digests_insert_service",
      "schema": "public",
      "table_name": "digests",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 44025,
      "policy_name": "digests_select_org",
      "schema": "public",
      "table_name": "digests",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39722,
      "policy_name": "Service role can manage disclosure logs",
      "schema": "public",
      "table_name": "disclosure_logs",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39721,
      "policy_name": "Users can view own organization disclosure logs",
      "schema": "public",
      "table_name": "disclosure_logs",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 35130,
      "policy_name": "evidence_bundles_insert_org",
      "schema": "public",
      "table_name": "evidence_bundles",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "((organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE (om.user_id = auth.uid()))) OR (auth.uid() IS NULL))",
      "roles_raw": "{0}"
    },
    {
      "oid": 35114,
      "policy_name": "evidence_bundles_select_org",
      "schema": "public",
      "table_name": "evidence_bundles",
      "cmd": "r",
      "permissive": true,
      "qual": "((organization_id = get_user_organization_id()) OR is_admin())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 35131,
      "policy_name": "evidence_bundles_update_tsa",
      "schema": "public",
      "table_name": "evidence_bundles",
      "cmd": "w",
      "permissive": true,
      "qual": "((organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE (om.user_id = auth.uid()))) OR (auth.uid() IS NULL))",
      "with_check": "((organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE (om.user_id = auth.uid()))) OR (auth.uid() IS NULL))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46537,
      "policy_name": "evidence_manifests_insert_all",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46536,
      "policy_name": "evidence_manifests_select_org",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24590,
      "policy_name": "org_members_delete_evidence_manifests",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24587,
      "policy_name": "org_members_insert_evidence_manifests",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24586,
      "policy_name": "org_members_select_evidence_manifests",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24588,
      "policy_name": "org_members_update_evidence_manifests",
      "schema": "public",
      "table_name": "evidence_manifests",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 36362,
      "policy_name": "export_compliance_log_select_org",
      "schema": "public",
      "table_name": "export_compliance_log",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42502,
      "policy_name": "external_entities_insert_admin",
      "schema": "public",
      "table_name": "external_entities",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 42501,
      "policy_name": "external_entities_select_org",
      "schema": "public",
      "table_name": "external_entities",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42503,
      "policy_name": "external_entities_update_admin",
      "schema": "public",
      "table_name": "external_entities",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42505,
      "policy_name": "external_entity_identifiers_insert_service",
      "schema": "public",
      "table_name": "external_entity_identifiers",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 42504,
      "policy_name": "external_entity_identifiers_select_org",
      "schema": "public",
      "table_name": "external_entity_identifiers",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42506,
      "policy_name": "external_entity_identifiers_update_admin",
      "schema": "public",
      "table_name": "external_entity_identifiers",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42510,
      "policy_name": "external_entity_links_insert_admin",
      "schema": "public",
      "table_name": "external_entity_links",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 42509,
      "policy_name": "external_entity_links_select_org",
      "schema": "public",
      "table_name": "external_entity_links",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42508,
      "policy_name": "external_entity_observations_insert_service",
      "schema": "public",
      "table_name": "external_entity_observations",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 42507,
      "policy_name": "external_entity_observations_select_org",
      "schema": "public",
      "table_name": "external_entity_observations",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33872,
      "policy_name": "incidents_insert_all",
      "schema": "public",
      "table_name": "incidents",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 33871,
      "policy_name": "incidents_select_org",
      "schema": "public",
      "table_name": "incidents",
      "cmd": "r",
      "permissive": true,
      "qual": "((organization_id = get_user_organization_id()) OR is_admin())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33873,
      "policy_name": "incidents_update_org",
      "schema": "public",
      "table_name": "incidents",
      "cmd": "w",
      "permissive": true,
      "qual": "((organization_id = get_user_organization_id()) OR is_admin())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43749,
      "policy_name": "integrations_delete_admin",
      "schema": "public",
      "table_name": "integrations",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43747,
      "policy_name": "integrations_insert_admin",
      "schema": "public",
      "table_name": "integrations",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 43746,
      "policy_name": "integrations_select_org",
      "schema": "public",
      "table_name": "integrations",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 43748,
      "policy_name": "integrations_update_admin",
      "schema": "public",
      "table_name": "integrations",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 17604,
      "policy_name": "allow_anon_select",
      "schema": "public",
      "table_name": "kpi_logs",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 17603,
      "policy_name": "allow_service_role",
      "schema": "public",
      "table_name": "kpi_logs",
      "cmd": "*",
      "permissive": true,
      "qual": "(auth.role() = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46573,
      "policy_name": "kpi_logs_insert_all",
      "schema": "public",
      "table_name": "kpi_logs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46572,
      "policy_name": "kpi_logs_select_org",
      "schema": "public",
      "table_name": "kpi_logs",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM test_configs\n  WHERE ((test_configs.id = kpi_logs.test_id) AND (test_configs.organization_id = get_user_organization_id()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36395,
      "policy_name": "legal_holds_manage_admin",
      "schema": "public",
      "table_name": "legal_holds",
      "cmd": "*",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36394,
      "policy_name": "legal_holds_select_org",
      "schema": "public",
      "table_name": "legal_holds",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46571,
      "policy_name": "monitored_numbers_delete_org",
      "schema": "public",
      "table_name": "monitored_numbers",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46569,
      "policy_name": "monitored_numbers_insert_org",
      "schema": "public",
      "table_name": "monitored_numbers",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46568,
      "policy_name": "monitored_numbers_select_org",
      "schema": "public",
      "table_name": "monitored_numbers",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46570,
      "policy_name": "monitored_numbers_update_org",
      "schema": "public",
      "table_name": "monitored_numbers",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21531,
      "policy_name": "Public read access to incidents",
      "schema": "public",
      "table_name": "network_incidents",
      "cmd": "r",
      "permissive": true,
      "qual": "(is_active = true)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21533,
      "policy_name": "Service role can insert incidents",
      "schema": "public",
      "table_name": "network_incidents",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(auth.role() = 'service_role'::text)",
      "roles_raw": "{0}"
    },
    {
      "oid": 43750,
      "policy_name": "oauth_tokens_service_only",
      "schema": "public",
      "table_name": "oauth_tokens",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46526,
      "policy_name": "org_members_delete_owner",
      "schema": "public",
      "table_name": "org_members",
      "cmd": "d",
      "permissive": true,
      "qual": "((organization_id = get_user_organization_id()) AND (EXISTS ( SELECT 1\n   FROM org_members org_members_1\n  WHERE ((org_members_1.organization_id = org_members_1.organization_id) AND (org_members_1.user_id = auth.uid()) AND (org_members_1.role = 'owner'::text)))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46525,
      "policy_name": "org_members_insert_owner",
      "schema": "public",
      "table_name": "org_members",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "((organization_id = get_user_organization_id()) AND (EXISTS ( SELECT 1\n   FROM org_members org_members_1\n  WHERE ((org_members_1.organization_id = org_members_1.organization_id) AND (org_members_1.user_id = auth.uid()) AND (org_members_1.role = 'owner'::text)))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46524,
      "policy_name": "org_members_select_org",
      "schema": "public",
      "table_name": "org_members",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39404,
      "policy_name": "Org admins can view SSO configs",
      "schema": "public",
      "table_name": "org_sso_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39405,
      "policy_name": "Org owners can create SSO configs",
      "schema": "public",
      "table_name": "org_sso_configs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = 'owner'::text))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 39407,
      "policy_name": "Org owners can delete SSO configs",
      "schema": "public",
      "table_name": "org_sso_configs",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = 'owner'::text))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39406,
      "policy_name": "Org owners can update SSO configs",
      "schema": "public",
      "table_name": "org_sso_configs",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = 'owner'::text))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46522,
      "policy_name": "organizations_insert_admin",
      "schema": "public",
      "table_name": "organizations",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "is_admin()",
      "roles_raw": "{0}"
    },
    {
      "oid": 46521,
      "policy_name": "organizations_select_admin",
      "schema": "public",
      "table_name": "organizations",
      "cmd": "r",
      "permissive": true,
      "qual": "is_admin()",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46520,
      "policy_name": "organizations_select_own",
      "schema": "public",
      "table_name": "organizations",
      "cmd": "r",
      "permissive": true,
      "qual": "(id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46523,
      "policy_name": "organizations_update_owner",
      "schema": "public",
      "table_name": "organizations",
      "cmd": "w",
      "permissive": true,
      "qual": "((id = get_user_organization_id()) AND (EXISTS ( SELECT 1\n   FROM org_members\n  WHERE ((org_members.organization_id = organizations.id) AND (org_members.user_id = auth.uid()) AND (org_members.role = 'owner'::text)))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39931,
      "policy_name": "Service role can manage QA disclosures",
      "schema": "public",
      "table_name": "qa_evaluation_disclosures",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39930,
      "policy_name": "Users can view own org QA disclosures",
      "schema": "public",
      "table_name": "qa_evaluation_disclosures",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24461,
      "policy_name": "Users can insert own recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24462,
      "policy_name": "Users can update own recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24460,
      "policy_name": "Users can view own recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25789,
      "policy_name": "cas_delete_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_recorder'::tool_type) AND (ta.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25786,
      "policy_name": "cas_insert_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_recorder'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 25785,
      "policy_name": "cas_select_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_recorder'::tool_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25787,
      "policy_name": "cas_update_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_recorder'::tool_type))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_recorder'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24575,
      "policy_name": "org_members_delete_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24572,
      "policy_name": "org_members_insert_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24571,
      "policy_name": "org_members_select_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24573,
      "policy_name": "org_members_update_recordings",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46531,
      "policy_name": "recordings_insert_all",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46530,
      "policy_name": "recordings_select_org",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46532,
      "policy_name": "recordings_update_org",
      "schema": "public",
      "table_name": "recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39570,
      "policy_name": "report_access_log_user_access",
      "schema": "public",
      "table_name": "report_access_log",
      "cmd": "*",
      "permissive": true,
      "qual": "(user_id = auth.uid())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18799,
      "policy_name": "allow_org_report_access",
      "schema": "public",
      "table_name": "report_schedules",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18800,
      "policy_name": "allow_org_report_insert",
      "schema": "public",
      "table_name": "report_schedules",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 36293,
      "policy_name": "retention_policies_select_org",
      "schema": "public",
      "table_name": "retention_policies",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36294,
      "policy_name": "retention_policies_update_admin",
      "schema": "public",
      "table_name": "retention_policies",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24594,
      "policy_name": "deny_all_role_capabilities",
      "schema": "public",
      "table_name": "role_capabilities_archived",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": "false",
      "roles_raw": "{0}"
    },
    {
      "oid": 24592,
      "policy_name": "deny_all_roles",
      "schema": "public",
      "table_name": "roles_archived",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": "false",
      "roles_raw": "{0}"
    },
    {
      "oid": 24464,
      "policy_name": "Users can create scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24465,
      "policy_name": "Users can update own scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24463,
      "policy_name": "Users can view own scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25794,
      "policy_name": "cas_delete_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scorecards.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25791,
      "policy_name": "cas_insert_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scorecards.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 25790,
      "policy_name": "cas_select_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scorecards.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25792,
      "policy_name": "cas_update_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scorecards.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scorecards.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24580,
      "policy_name": "org_members_delete_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24577,
      "policy_name": "org_members_insert_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24576,
      "policy_name": "org_members_select_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24578,
      "policy_name": "org_members_update_scorecards",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46556,
      "policy_name": "scorecards_delete_org",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46554,
      "policy_name": "scorecards_insert_org",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46553,
      "policy_name": "scorecards_select_org",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46555,
      "policy_name": "scorecards_update_org",
      "schema": "public",
      "table_name": "scorecards",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24467,
      "policy_name": "Users can insert scored recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24468,
      "policy_name": "Users can update own scored recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24466,
      "policy_name": "Users can view own scored recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25814,
      "policy_name": "cas_delete_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scored_recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25811,
      "policy_name": "cas_insert_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scored_recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 25810,
      "policy_name": "cas_select_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scored_recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25812,
      "policy_name": "cas_update_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scored_recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = scored_recordings.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_analysis'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24585,
      "policy_name": "org_members_delete_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24582,
      "policy_name": "org_members_insert_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 24581,
      "policy_name": "org_members_select_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24583,
      "policy_name": "org_members_update_scored_recordings",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM org_members om\n  WHERE ((om.organization_id = om.organization_id) AND (om.user_id = auth.uid()))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46558,
      "policy_name": "scored_recordings_insert_org",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46557,
      "policy_name": "scored_recordings_select_org",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46559,
      "policy_name": "scored_recordings_update_org",
      "schema": "public",
      "table_name": "scored_recordings",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42516,
      "policy_name": "search_documents_insert_service",
      "schema": "public",
      "table_name": "search_documents",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 42515,
      "policy_name": "search_documents_select_org",
      "schema": "public",
      "table_name": "search_documents",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 42518,
      "policy_name": "search_events_insert_service",
      "schema": "public",
      "table_name": "search_events",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 42517,
      "policy_name": "search_events_select_org",
      "schema": "public",
      "table_name": "search_events",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 48105,
      "policy_name": "Allow all operations on sessions",
      "schema": "public",
      "table_name": "sessions",
      "cmd": "*",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39433,
      "policy_name": "Org admins can view SSO events",
      "schema": "public",
      "table_name": "sso_login_events",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18888,
      "policy_name": "Allow all to read stock messages",
      "schema": "public",
      "table_name": "stock_messages",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39685,
      "policy_name": "Service role can manage events",
      "schema": "public",
      "table_name": "stripe_events",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39681,
      "policy_name": "Users can view own organization events",
      "schema": "public",
      "table_name": "stripe_events",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39684,
      "policy_name": "Service role can manage invoices",
      "schema": "public",
      "table_name": "stripe_invoices",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39680,
      "policy_name": "Users can view own organization invoices",
      "schema": "public",
      "table_name": "stripe_invoices",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39683,
      "policy_name": "Service role can manage payment methods",
      "schema": "public",
      "table_name": "stripe_payment_methods",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39679,
      "policy_name": "Users can view own organization payment methods",
      "schema": "public",
      "table_name": "stripe_payment_methods",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39682,
      "policy_name": "Service role can manage subscriptions",
      "schema": "public",
      "table_name": "stripe_subscriptions",
      "cmd": "*",
      "permissive": true,
      "qual": "((auth.jwt() ->> 'role'::text) = 'service_role'::text)",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 39678,
      "policy_name": "Users can view own organization subscriptions",
      "schema": "public",
      "table_name": "stripe_subscriptions",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33255,
      "policy_name": "Owners and admins can delete surveys",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33253,
      "policy_name": "Owners and admins can insert surveys",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 33254,
      "policy_name": "Owners and admins can update surveys",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33252,
      "policy_name": "Users can view their org's surveys",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46552,
      "policy_name": "surveys_delete_org",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46550,
      "policy_name": "surveys_insert_org",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46549,
      "policy_name": "surveys_select_org",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46551,
      "policy_name": "surveys_update_org",
      "schema": "public",
      "table_name": "surveys",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 35057,
      "policy_name": "Admins can create invites",
      "schema": "public",
      "table_name": "team_invites",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 35058,
      "policy_name": "Admins can update invites",
      "schema": "public",
      "table_name": "team_invites",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 35056,
      "policy_name": "Users can view org invites",
      "schema": "public",
      "table_name": "team_invites",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 17568,
      "policy_name": "Allow public select on test_configs",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25809,
      "policy_name": "cas_delete_test_configs",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "d",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = test_configs.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25806,
      "policy_name": "cas_insert_test_configs",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = test_configs.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 25805,
      "policy_name": "cas_select_test_configs",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = test_configs.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 25807,
      "policy_name": "cas_update_test_configs",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "w",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = test_configs.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type))))",
      "with_check": "(EXISTS ( SELECT 1\n   FROM tool_access ta\n  WHERE ((ta.organization_id = test_configs.organization_id) AND (ta.user_id = auth.uid()) AND (ta.tool = 'call_monitor'::tool_type) AND (ta.role = ANY (ARRAY['admin'::tool_role_type, 'editor'::tool_role_type])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 46565,
      "policy_name": "test_configs_delete_org",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46563,
      "policy_name": "test_configs_insert_org",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46562,
      "policy_name": "test_configs_select_org",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46564,
      "policy_name": "test_configs_update_org",
      "schema": "public",
      "table_name": "test_configs",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 17569,
      "policy_name": "Allow public select on test_results",
      "schema": "public",
      "table_name": "test_results",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46567,
      "policy_name": "test_results_insert_all",
      "schema": "public",
      "table_name": "test_results",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46566,
      "policy_name": "test_results_select_org",
      "schema": "public",
      "table_name": "test_results",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM test_configs\n  WHERE ((test_configs.id = test_results.test_config_id) AND (test_configs.organization_id = get_user_organization_id()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46575,
      "policy_name": "test_statistics_insert_all",
      "schema": "public",
      "table_name": "test_statistics",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 46574,
      "policy_name": "test_statistics_select_org",
      "schema": "public",
      "table_name": "test_statistics",
      "cmd": "r",
      "permissive": true,
      "qual": "(EXISTS ( SELECT 1\n   FROM test_configs\n  WHERE ((test_configs.id = test_statistics.test_config_id) AND (test_configs.organization_id = get_user_organization_id()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46576,
      "policy_name": "test_statistics_update_all",
      "schema": "public",
      "table_name": "test_statistics",
      "cmd": "w",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21682,
      "policy_name": "Org admins can manage tool access",
      "schema": "public",
      "table_name": "tool_access_archived",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = 'admin'::text))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 21683,
      "policy_name": "Org admins can update tool access",
      "schema": "public",
      "table_name": "tool_access_archived",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = 'admin'::text))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21681,
      "policy_name": "Users can view tool access for their org",
      "schema": "public",
      "table_name": "tool_access_archived",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 24595,
      "policy_name": "deny_all_tool_access",
      "schema": "public",
      "table_name": "tool_access_archived",
      "cmd": "*",
      "permissive": true,
      "qual": "false",
      "with_check": "false",
      "roles_raw": "{0}"
    },
    {
      "oid": 21685,
      "policy_name": "Tool admins can update settings",
      "schema": "public",
      "table_name": "tool_settings",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT tool_team_members.organization_id\n   FROM tool_team_members\n  WHERE ((tool_team_members.user_id = auth.uid()) AND (tool_team_members.role = 'admin'::tool_role_type))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21684,
      "policy_name": "Users can view tool settings for their org",
      "schema": "public",
      "table_name": "tool_settings",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 21687,
      "policy_name": "Tool admins can manage team members",
      "schema": "public",
      "table_name": "tool_team_members",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT tool_team_members_1.organization_id\n   FROM tool_team_members tool_team_members_1\n  WHERE ((tool_team_members_1.user_id = auth.uid()) AND (tool_team_members_1.role = 'admin'::tool_role_type))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 21686,
      "policy_name": "Users can view tool team members in their org",
      "schema": "public",
      "table_name": "tool_team_members",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33733,
      "policy_name": "transcript_versions_insert_all",
      "schema": "public",
      "table_name": "transcript_versions",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 33732,
      "policy_name": "transcript_versions_select_org",
      "schema": "public",
      "table_name": "transcript_versions",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 48106,
      "policy_name": "Allow all operations on users",
      "schema": "public",
      "table_name": "users",
      "cmd": "*",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 48107,
      "policy_name": "Allow all operations on verification_tokens",
      "schema": "public",
      "table_name": "verification_tokens",
      "cmd": "*",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46540,
      "policy_name": "voice_configs_insert_org",
      "schema": "public",
      "table_name": "voice_configs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46538,
      "policy_name": "voice_configs_select_org",
      "schema": "public",
      "table_name": "voice_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46539,
      "policy_name": "voice_configs_update_org",
      "schema": "public",
      "table_name": "voice_configs",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33251,
      "policy_name": "Owners and admins can delete voice targets",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33249,
      "policy_name": "Owners and admins can insert voice targets",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "roles_raw": "{0}"
    },
    {
      "oid": 33250,
      "policy_name": "Owners and admins can update voice targets",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 33248,
      "policy_name": "Users can view their org's voice targets",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid())))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46544,
      "policy_name": "voice_targets_delete_org",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "d",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46542,
      "policy_name": "voice_targets_insert_org",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(organization_id = get_user_organization_id())",
      "roles_raw": "{0}"
    },
    {
      "oid": 46541,
      "policy_name": "voice_targets_select_org",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 46543,
      "policy_name": "voice_targets_update_org",
      "schema": "public",
      "table_name": "voice_targets",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id = get_user_organization_id())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18796,
      "policy_name": "allow_org_webhook_access",
      "schema": "public",
      "table_name": "webhook_configs",
      "cmd": "r",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 18797,
      "policy_name": "allow_org_webhook_insert",
      "schema": "public",
      "table_name": "webhook_configs",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "true",
      "roles_raw": "{0}"
    },
    {
      "oid": 18798,
      "policy_name": "allow_org_webhook_update",
      "schema": "public",
      "table_name": "webhook_configs",
      "cmd": "w",
      "permissive": true,
      "qual": "true",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36323,
      "policy_name": "webhook_failures_select_org",
      "schema": "public",
      "table_name": "webhook_failures",
      "cmd": "r",
      "permissive": true,
      "qual": "((organization_id IS NULL) OR (organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE (org_members.user_id = auth.uid()))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 36324,
      "policy_name": "webhook_failures_update_admin",
      "schema": "public",
      "table_name": "webhook_failures",
      "cmd": "w",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT org_members.organization_id\n   FROM org_members\n  WHERE ((org_members.user_id = auth.uid()) AND (org_members.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44040,
      "policy_name": "webrtc_sessions_insert_own",
      "schema": "public",
      "table_name": "webrtc_sessions",
      "cmd": "a",
      "permissive": true,
      "qual": null,
      "with_check": "(user_id = auth.uid())",
      "roles_raw": "{0}"
    },
    {
      "oid": 44039,
      "policy_name": "webrtc_sessions_select_org_admin",
      "schema": "public",
      "table_name": "webrtc_sessions",
      "cmd": "r",
      "permissive": true,
      "qual": "(organization_id IN ( SELECT om.organization_id\n   FROM org_members om\n  WHERE ((om.user_id = auth.uid()) AND (om.role = ANY (ARRAY['owner'::text, 'admin'::text])))))",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44038,
      "policy_name": "webrtc_sessions_select_own",
      "schema": "public",
      "table_name": "webrtc_sessions",
      "cmd": "r",
      "permissive": true,
      "qual": "(user_id = auth.uid())",
      "with_check": null,
      "roles_raw": "{0}"
    },
    {
      "oid": 44041,
      "policy_name": "webrtc_sessions_update_own",
      "schema": "public",
      "table_name": "webrtc_sessions",
      "cmd": "w",
      "permissive": true,
      "qual": "(user_id = auth.uid())",
      "with_check": null,
      "roles_raw": "{0}"
    }
  ]
}